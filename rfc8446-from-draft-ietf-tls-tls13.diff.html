<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.42: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Darwin EKRs-MBP.lan 18.7.0 Darwin Kernel Version 18.7.0: Thu Jun 18 20:50:10 PDT 2020; root:xnu-4903.278.43~1/RELEASE_X86_64 x86_64 --> 
<!-- Using awk: /usr/local/bin/gawk: GNU Awk 5.1.0, API: 3.0 (GNU MPFR 4.0.2, GNU MP 6.2.0) --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.1 --> 
<!-- Using wdiff: /usr/local/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tls-tls13.txt - rfc8446.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('a[name$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk.parentNode.parentNode;
    old_chunk.style.outline = "1px solid red";
    window.location.hash = "#" + new_str;
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tls-tls13.txt&nbsp;</th><th> </th><th>&nbsp;rfc8446.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Network Working Group</span>                                        E. Rescorla</td><td> </td><td class="rblock"><span class="insert">Internet Engineering Task Force (IETF)</span>                       E. Rescorla</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Internet-Draft                                                RTFM, Inc.</span></td><td> </td><td class="rblock"><span class="insert">Request for Comments: 8446                                       Mozilla</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">Obsoletes: 5077, 5246, 6961 <span class="delete">(if                            July 22, 2020</span></td><td> </td><td class="rblock">Obsoletes: 5077, 5246, 6961                                  <span class="insert">August 2018</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">           approved)</span></td><td> </td><td class="rblock">Updates: 5705, 6066</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">Updates: <span class="delete">4492,</span> 5705, 6066 <span class="delete">(if approved)</span></td><td> </td><td class="rblock"><span class="insert">Category:</span> Standards Track</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Intended status:</span> Standards Track</td><td> </td><td class="rblock"><span class="insert">ISSN: 2070-1721</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Expires: January 23, 2021</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        The Transport Layer Security (TLS) Protocol Version 1.3</td><td> </td><td class="right">        The Transport Layer Security (TLS) Protocol Version 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                      draft-ietf-tls-tls13-latest</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document specifies version 1.3 of the Transport Layer Security</td><td> </td><td class="right">   This document specifies version 1.3 of the Transport Layer Security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (TLS) protocol.  TLS allows client/server applications to communicate</td><td> </td><td class="right">   (TLS) protocol.  TLS allows client/server applications to communicate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   over the Internet in a way that is designed to prevent eavesdropping,</td><td> </td><td class="right">   over the Internet in a way that is designed to prevent eavesdropping,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   tampering, and message forgery.</td><td> </td><td class="right">   tampering, and message forgery.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This document updates RFCs <span class="delete">4492, 5705,</span> and <span class="delete">6066</span> and <span class="delete">it</span> obsoletes RFCs</td><td> </td><td class="rblock">   This document updates RFCs <span class="insert">5705</span> and <span class="insert">6066,</span> and obsoletes RFCs 5077,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   5077, 5246, and 6961.  This document also specifies new requirements</td><td> </td><td class="rblock">   5246, and 6961.  This document also specifies new requirements for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   for TLS 1.2 implementations.</td><td> </td><td class="rblock">   TLS 1.2 implementations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Status of This Memo</td><td> </td><td class="right">Status of This Memo</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This <span class="delete">Internet-Draft</span> is <span class="delete">submitted in full conformance with the</span></td><td> </td><td class="rblock">   This is <span class="insert">an</span> Internet <span class="insert">Standards Track document.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   provisions of BCP 78 and BCP 79.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Internet-Drafts are working documents of the</span> Internet <span class="delete">Engineering</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Task Force (IETF).  Note that other groups may also distribute</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   working documents as Internet-Drafts.  The list of current Internet-</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Drafts is at https://datatracker.ietf.org/drafts/current/.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Internet-Drafts are draft documents valid for</span> a <span class="delete">maximum</span> of <span class="delete">six months</span></td><td> </td><td class="rblock">   <span class="insert">This document is</span> a <span class="insert">product of the Internet Engineering Task Force</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and <span class="delete">may be updated, replaced, or obsoleted</span> by <span class="delete">other documents at any</span></td><td> </td><td class="rblock"><span class="insert">   (IETF).  It represents the consensus</span> of <span class="insert">the IETF community.  It has</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   time.  It</span> is <span class="delete">inappropriate to use Internet-Drafts as reference</span></td><td> </td><td class="rblock"><span class="insert">   received public review</span> and <span class="insert">has been approved for publication</span> by <span class="insert">the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   material or to cite them other than as "work</span> in <span class="delete">progress."</span></td><td> </td><td class="rblock"><span class="insert">   Internet Engineering Steering Group (IESG).  Further information on</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Internet Standards</span> is <span class="insert">available</span> in <span class="insert">Section 2 of RFC 7841.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">This Internet-Draft will expire</span> on <span class="delete">January 23, 2021.</span></td><td> </td><td class="rblock">   <span class="insert">Information about the current status of this document, any errata,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and how to provide feedback</span> on <span class="insert">it may be obtained at</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   https://www.rfc-editor.org/info/rfc8446.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Copyright (c) 20<span class="delete">20</span> IETF Trust and the persons identified as the</td><td> </td><td class="rblock">   Copyright (c) 20<span class="insert">18</span> IETF Trust and the persons identified as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Provisions Relating to IETF Documents</td><td> </td><td class="right">   Provisions Relating to IETF Documents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (https://trustee.ietf.org/license-info) in effect on the date of</td><td> </td><td class="right">   (https://trustee.ietf.org/license-info) in effect on the date of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   publication of this document.  Please review these documents</td><td> </td><td class="right">   publication of this document.  Please review these documents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   carefully, as they describe your rights and restrictions with respect</td><td> </td><td class="right">   carefully, as they describe your rights and restrictions with respect</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to this document.  Code Components extracted from this document must</td><td> </td><td class="right">   to this document.  Code Components extracted from this document must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   include Simplified BSD License text as described in Section 4.e of</td><td> </td><td class="right">   include Simplified BSD License text as described in Section 4.e of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the Trust Legal Provisions and are provided without warranty as</td><td> </td><td class="right">   the Trust Legal Provisions and are provided without warranty as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 2, line 25</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 3, line 7</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   modifications of such material outside the IETF Standards Process.</td><td> </td><td class="right">   modifications of such material outside the IETF Standards Process.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Without obtaining an adequate license from the person(s) controlling</td><td> </td><td class="right">   Without obtaining an adequate license from the person(s) controlling</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the copyright in such materials, this document may not be modified</td><td> </td><td class="right">   the copyright in such materials, this document may not be modified</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   outside the IETF Standards Process, and derivative works of it may</td><td> </td><td class="right">   outside the IETF Standards Process, and derivative works of it may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   not be created outside the IETF Standards Process, except to format</td><td> </td><td class="right">   not be created outside the IETF Standards Process, except to format</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it for publication as an RFC or to translate it into languages other</td><td> </td><td class="right">   it for publication as an RFC or to translate it into languages other</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   than English.</td><td> </td><td class="right">   than English.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.  Introduction  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . .   5</span></td><td> </td><td class="rblock">   1. Introduction <span class="insert">....................................................6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     1.1.  Conventions and Terminology <span class="delete">. . . . . . . . . . . . . . .   6</span></td><td> </td><td class="rblock">      1.1. Conventions and Terminology <span class="insert">................................7</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     1.2.  <span class="delete">Change Log  . . . . . . . . . . . . . . . . . . . . . . .   7</span></td><td> </td><td class="rblock">      1.2. Major Differences from TLS 1.2 <span class="insert">.............................8</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     1.3.</span>  Major Differences from TLS 1.2  <span class="delete">. . . . . . . . . . . . .  16</span></td><td> </td><td class="rblock"><span class="insert">      1.3.</span> Updates Affecting TLS 1.2 <span class="insert">..................................9</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     1.4.</span>  Updates Affecting TLS 1.2 <span class="delete">. . . . . . . . . . . . . . . .  17</span></td><td> </td><td class="rblock">   2. Protocol Overview <span class="insert">..............................................10</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   2.  Protocol Overview <span class="delete">. . . . . . . . . . . . . . . . . . . . . .  18</span></td><td> </td><td class="rblock">      2.1. Incorrect DHE Share <span class="insert">.......................................14</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     2.1.  Incorrect DHE Share <span class="delete">. . . . . . . . . . . . . . . . . . .  21</span></td><td> </td><td class="rblock">      2.2. Resumption and Pre-Shared Key (PSK) <span class="insert">.......................15</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     2.2.  Resumption and Pre-Shared Key (PSK) <span class="delete">. . . . . . . . . . .  22</span></td><td> </td><td class="rblock">      2.3. 0-RTT Data <span class="insert">................................................17</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     2.3.  0-RTT Data  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . .  24</span></td><td> </td><td class="rblock">   3. Presentation Language <span class="insert">..........................................19</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   3.  Presentation Language <span class="delete">. . . . . . . . . . . . . . . . . . . .  26</span></td><td> </td><td class="rblock">      3.1. Basic Block Size <span class="insert">..........................................19</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.1.  Basic Block Size  <span class="delete">. . . . . . . . . . . . . . . . . . . .  26</span></td><td> </td><td class="rblock">      3.2. Miscellaneous <span class="insert">.............................................20</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.2.  Miscellaneous <span class="delete">. . . . . . . . . . . . . . . . . . . . . .  26</span></td><td> </td><td class="rblock">      3.3. Numbers <span class="insert">...................................................20</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.3.  Numbers <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . . .  27</span></td><td> </td><td class="rblock">      3.4. Vectors <span class="insert">...................................................20</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.4.  Vectors <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . . .  27</span></td><td> </td><td class="rblock">      3.5. Enumerateds <span class="insert">...............................................21</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.5.  Enumerateds <span class="delete">. . . . . . . . . . . . . . . . . . . . . . .  28</span></td><td> </td><td class="rblock">      3.6. Constructed Types <span class="insert">.........................................22</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.6.  Constructed Types <span class="delete">. . . . . . . . . . . . . . . . . . . .  29</span></td><td> </td><td class="rblock">      3.7. Constants <span class="insert">.................................................23</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.7.  Constants <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . .  29</span></td><td> </td><td class="rblock">      3.8. Variants <span class="insert">..................................................23</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.8.  Variants  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . .  30</span></td><td> </td><td class="rblock">   4. Handshake Protocol <span class="insert">.............................................24</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   4.  Handshake Protocol  <span class="delete">. . . . . . . . . . . . . . . . . . . . .  31</span></td><td> </td><td class="rblock">      4.1. Key Exchange Messages <span class="insert">.....................................25</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.1.  Key Exchange Messages <span class="delete">. . . . . . . . . . . . . . . . . .  32</span></td><td> </td><td class="rblock">           4.1.1. Cryptographic Negotiation <span class="insert">..........................26</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.1.1.  Cryptographic Negotiation <span class="delete">. . . . . . . . . . . . . .  32</span></td><td> </td><td class="rblock">           4.1.2. Client Hello <span class="insert">.......................................27</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.1.2.  Client Hello  <span class="delete">. . . . . . . . . . . . . . . . . . . .  33</span></td><td> </td><td class="rblock">           4.1.3. Server Hello <span class="insert">.......................................31</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.1.3.  Server Hello  <span class="delete">. . . . . . . . . . . . . . . . . . . .  36</span></td><td> </td><td class="rblock">           4.1.4. Hello Retry Request <span class="insert">................................33</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.1.4.  Hello Retry Request <span class="delete">. . . . . . . . . . . . . . . . .  38</span></td><td> </td><td class="rblock">      4.2. Extensions <span class="insert">................................................35</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.2.  Extensions  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . .  40</span></td><td> </td><td class="rblock">           4.2.1. Supported Versions <span class="insert">.................................39</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.1.  Supported Versions  <span class="delete">. . . . . . . . . . . . . . . . .  43</span></td><td> </td><td class="rblock">           4.2.2. Cookie <span class="insert">.............................................40</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.2.  Cookie  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . .  45</span></td><td> </td><td class="rblock">           4.2.3. Signature Algorithms <span class="insert">...............................41</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.3.  Signature Algorithms  <span class="delete">. . . . . . . . . . . . . . . .  46</span></td><td> </td><td class="rblock">           4.2.4. Certificate Authorities <span class="insert">............................45</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.4.  Certificate Authorities <span class="delete">. . . . . . . . . . . . . . .  50</span></td><td> </td><td class="rblock">           4.2.5. OID Filters <span class="insert">........................................45</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.5.  OID Filters <span class="delete">. . . . . . . . . . . . . . . . . . . . .  50</span></td><td> </td><td class="rblock">           4.2.6. Post-Handshake Client Authentication <span class="insert">...............47</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.6.  Post-Handshake Client Authentication  <span class="delete">. . . . . . . .  51</span></td><td> </td><td class="rblock">           4.2.7. <span class="insert">Supported</span> Groups <span class="insert">...................................47</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.7.  <span class="delete">Negotiated</span> Groups <span class="delete">. . . . . . . . . . . . . . . . . .  52</span></td><td> </td><td class="rblock">           4.2.8. Key Share <span class="insert">..........................................48</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.8.  Key Share <span class="delete">. . . . . . . . . . . . . . . . . . . . . .  53</span></td><td> </td><td class="rblock">           4.2.9. Pre-Shared Key Exchange Modes <span class="insert">......................51</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.9.  Pre-Shared Key Exchange Modes <span class="delete">. . . . . . . . . . . .  56</span></td><td> </td><td class="rblock">           4.2.10. Early Data Indication <span class="insert">.............................52</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.10. Early Data Indication <span class="delete">. . . . . . . . . . . . . . . .  57</span></td><td> </td><td class="rblock">           4.2.11. Pre-Shared Key Extension <span class="insert">..........................55</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.2.11. Pre-Shared Key Extension  <span class="delete">. . . . . . . . . . . . . .  60</span></td><td> </td><td class="rblock">      4.3. Server Parameters <span class="insert">.........................................59</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.3.  Server Parameters <span class="delete">. . . . . . . . . . . . . . . . . . . .  63</span></td><td> </td><td class="rblock">           4.3.1. Encrypted Extensions <span class="insert">...............................60</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.3.1.  Encrypted Extensions  <span class="delete">. . . . . . . . . . . . . . . .  63</span></td><td> </td><td class="rblock">           4.3.2. Certificate Request <span class="insert">................................60</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.3.2.  Certificate Request <span class="delete">. . . . . . . . . . . . . . . . .  64</span></td><td> </td><td class="rblock">      4.4. Authentication Messages <span class="insert">...................................61</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.4.  Authentication Messages <span class="delete">. . . . . . . . . . . . . . . . .  65</span></td><td> </td><td class="rblock">           4.4.1. The Transcript Hash <span class="insert">................................63</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.4.1.  The Transcript Hash <span class="delete">. . . . . . . . . . . . . . . . .  66</span></td><td> </td><td class="rblock">           4.4.2. Certificate <span class="insert">........................................64</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.4.2.  Certificate <span class="delete">. . . . . . . . . . . . . . . . . . . . .  67</span></td><td> </td><td class="rblock">           4.4.3. Certificate Verify <span class="insert">.................................69</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.4.3.  Certificate Verify  <span class="delete">. . . . . . . . . . . . . . . . .  72</span></td><td> </td><td class="rblock">           4.4.4. Finished <span class="insert">...........................................71</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.4.4.  Finished  <span class="delete">. . . . . . . . . . . . . . . . . . . . . .  74</span></td><td> </td><td class="rblock">      4.5. End of Early Data <span class="insert">.........................................72</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.5.  End of Early Data <span class="delete">. . . . . . . . . . . . . . . . . . . .  75</span></td><td> </td><td class="rblock">      4.6. Post-Handshake Messages <span class="insert">...................................73</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.6.  Post-Handshake Messages <span class="delete">. . . . . . . . . . . . . . . . .  76</span></td><td> </td><td class="rblock">           4.6.1. New Session Ticket Message <span class="insert">.........................73</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.6.1.  New Session Ticket Message  <span class="delete">. . . . . . . . . . . . .  76</span></td><td> </td><td class="rblock">           4.6.2. Post-Handshake Authentication <span class="insert">......................75</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.6.2.  Post-Handshake Authentication <span class="delete">. . . . . . . . . . . .  78</span></td><td> </td><td class="rblock">           4.6.3. Key and <span class="insert">Initialization Vector</span> Update <span class="insert">...............76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.6.3.  Key and <span class="delete">IV</span> Update <span class="delete">. . . . . . . . . . . . . . . . . .  79</span></td><td> </td><td class="rblock">   5. Record Protocol <span class="insert">................................................77</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   5.  Record Protocol <span class="delete">. . . . . . . . . . . . . . . . . . . . . . .  80</span></td><td> </td><td class="rblock">      5.1. Record Layer <span class="insert">..............................................78</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.1.  Record Layer  <span class="delete">. . . . . . . . . . . . . . . . . . . . . .  81</span></td><td> </td><td class="rblock">      5.2. Record Payload Protection <span class="insert">.................................80</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.2.  Record Payload Protection <span class="delete">. . . . . . . . . . . . . . . .  83</span></td><td> </td><td class="rblock">      5.3. Per-Record Nonce <span class="insert">..........................................82</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.3.  Per-Record Nonce  <span class="delete">. . . . . . . . . . . . . . . . . . . .  85</span></td><td> </td><td class="rblock">      5.4. Record Padding <span class="insert">............................................83</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.4.  Record Padding  <span class="delete">. . . . . . . . . . . . . . . . . . . . .  86</span></td><td> </td><td class="rblock">      5.5. Limits on Key Usage <span class="insert">.......................................84</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.5.  Limits on Key Usage <span class="delete">. . . . . . . . . . . . . . . . . . .  87</span></td><td> </td><td class="rblock">   6. Alert Protocol <span class="insert">.................................................85</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   6.  Alert Protocol  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . .  87</span></td><td> </td><td class="rblock">      6.1. Closure Alerts <span class="insert">............................................87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     6.1.  Closure Alerts  <span class="delete">. . . . . . . . . . . . . . . . . . . . .  89</span></td><td> </td><td class="rblock">      6.2. Error Alerts <span class="insert">..............................................88</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     6.2.  Error Alerts  <span class="delete">. . . . . . . . . . . . . . . . . . . . . .  90</span></td><td> </td><td class="rblock">   7. Cryptographic Computations <span class="insert">.....................................90</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   7.  Cryptographic Computations  <span class="delete">. . . . . . . . . . . . . . . . .  93</span></td><td> </td><td class="rblock">      7.1. Key Schedule <span class="insert">..............................................91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.1.  Key Schedule  <span class="delete">. . . . . . . . . . . . . . . . . . . . . .  93</span></td><td> </td><td class="rblock">      7.2. Updating Traffic Secrets <span class="insert">..................................94</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.2.  Updating Traffic Secrets  <span class="delete">. . . . . . . . . . . . . . . .  96</span></td><td> </td><td class="rblock">      7.3. Traffic Key Calculation <span class="insert">...................................95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.3.  Traffic Key Calculation <span class="delete">. . . . . . . . . . . . . . . . .  97</span></td><td> </td><td class="rblock">      7.4. (EC)DHE Shared Secret Calculation <span class="insert">.........................95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.4.  (EC)DHE Shared Secret Calculation <span class="delete">. . . . . . . . . . . .  98</span></td><td> </td><td class="rblock">           7.4.1. Finite Field Diffie-Hellman <span class="insert">........................95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.4.1.  Finite Field Diffie-Hellman <span class="delete">. . . . . . . . . . . . .  98</span></td><td> </td><td class="rblock">           7.4.2. Elliptic Curve Diffie-Hellman <span class="insert">......................96</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.4.2.  Elliptic Curve Diffie-Hellman <span class="delete">. . . . . . . . . . . .  98</span></td><td> </td><td class="rblock">      7.5. Exporters <span class="insert">.................................................97</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.5.  Exporters <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . .  99</span></td><td> </td><td class="rblock">   8. 0-RTT and Anti-Replay <span class="insert">..........................................98</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   8.  0-RTT and Anti-Replay <span class="delete">. . . . . . . . . . . . . . . . . . . .  99</span></td><td> </td><td class="rblock">      8.1. Single-Use Tickets <span class="insert">........................................99</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     8.1.  Single-Use Tickets  <span class="delete">. . . . . . . . . . . . . . . . . . . 101</span></td><td> </td><td class="rblock">      8.2. Client Hello Recording <span class="insert">....................................99</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     8.2.  Client Hello Recording  <span class="delete">. . . . . . . . . . . . . . . . . 101</span></td><td> </td><td class="rblock">      8.3. Freshness Checks <span class="insert">.........................................101</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     8.3.  Freshness Checks  <span class="delete">. . . . . . . . . . . . . . . . . . . . 102</span></td><td> </td><td class="rblock">   9. Compliance Requirements <span class="insert">.......................................102</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   9.  Compliance Requirements <span class="delete">. . . . . . . . . . . . . . . . . . . 104</span></td><td> </td><td class="rblock">      9.1. Mandatory-to-Implement Cipher Suites <span class="insert">.....................102</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     9.1.  Mandatory-to-Implement Cipher Suites  <span class="delete">. . . . . . . . . . 104</span></td><td> </td><td class="rblock">      9.2. Mandatory-to-Implement Extensions <span class="insert">........................103</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     9.2.  Mandatory-to-Implement Extensions <span class="delete">. . . . . . . . . . . . 104</span></td><td> </td><td class="rblock">      9.3. Protocol Invariants <span class="insert">......................................104</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     9.3.  Protocol Invariants <span class="delete">. . . . . . . . . . . . . . . . . . . 105</span></td><td> </td><td class="rblock">   10. Security Considerations <span class="insert">......................................106</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   10. Security Considerations <span class="delete">. . . . . . . . . . . . . . . . . . . 106</span></td><td> </td><td class="rblock">   11. IANA Considerations <span class="insert">..........................................106</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   11. IANA Considerations <span class="delete">. . . . . . . . . . . . . . . . . . . . . 107</span></td><td> </td><td class="rblock">   12. References <span class="insert">...................................................109</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   12. References  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . . . 108</span></td><td> </td><td class="rblock">      12.1. Normative References <span class="insert">....................................109</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     12.1.  Normative References <span class="delete">. . . . . . . . . . . . . . . . . . 108</span></td><td> </td><td class="rblock">      12.2. Informative References <span class="insert">..................................112</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     12.2.  Informative References <span class="delete">. . . . . . . . . . . . . . . . . 111</span></td><td> </td><td class="rblock">   Appendix A. State Machine <span class="insert">........................................120</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix A.  State Machine  <span class="delete">. . . . . . . . . . . . . . . . . . . 119</span></td><td> </td><td class="rblock">     A.1. Client <span class="insert">....................................................120</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.1.  Client  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . . . 119</span></td><td> </td><td class="rblock">     A.2. Server <span class="insert">....................................................121</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.2.  Server  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . . . . 120</span></td><td> </td><td class="rblock">   Appendix B. Protocol Data Structures and Constant Values <span class="insert">.........122</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix B.  Protocol Data Structures and Constant Values <span class="delete">. . . . 120</span></td><td> </td><td class="rblock">     B.1. Record Layer <span class="insert">..............................................122</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     B.1.  Record Layer  <span class="delete">. . . . . . . . . . . . . . . . . . . . . . 121</span></td><td> </td><td class="rblock">     B.2. Alert Messages <span class="insert">............................................123</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     B.2.  Alert Messages  <span class="delete">. . . . . . . . . . . . . . . . . . . . . 121</span></td><td> </td><td class="rblock">     B.3. Handshake Protocol <span class="insert">........................................124</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     B.3.  Handshake Protocol  <span class="delete">. . . . . . . . . . . . . . . . . . . 123</span></td><td> </td><td class="rblock">       B.3.1. Key Exchange Messages <span class="insert">.................................125</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       B.3.1.  Key Exchange Messages <span class="delete">. . . . . . . . . . . . . . . . 123</span></td><td> </td><td class="rblock">       B.3.2. Server Parameters Messages <span class="insert">............................131</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       B.3.2.  Server Parameters Messages  <span class="delete">. . . . . . . . . . . . . 128</span></td><td> </td><td class="rblock">       B.3.3. Authentication Messages <span class="insert">...............................132</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       B.3.3.  Authentication Messages <span class="delete">. . . . . . . . . . . . . . . 129</span></td><td> </td><td class="rblock">       B.3.4. Ticket Establishment <span class="insert">..................................132</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       B.3.4.  Ticket Establishment  <span class="delete">. . . . . . . . . . . . . . . . 130</span></td><td> </td><td class="rblock">       B.3.5. Updating Keys <span class="insert">.........................................133</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       B.3.5.  Updating Keys <span class="delete">. . . . . . . . . . . . . . . . . . . . 131</span></td><td> </td><td class="rblock">     B.4. Cipher Suites <span class="insert">.............................................133</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     B.4.  Cipher Suites <span class="delete">. . . . . . . . . . . . . . . . . . . . . . 131</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix C.  Implementation Notes . . . . . . . . . . . . . . . . 132</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     C.1.  Random Number Generation and Seeding  . . . . . . . . . . 132</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     C.2.  Certificates and Authentication . . . . . . . . . . . . . 133</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     C.3.  Implementation Pitfalls . . . . . . . . . . . . . . . . . 133</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     C.4.  Client Tracking Prevention  . . . . . . . . . . . . . . . 134</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     C.5.  Unauthenticated Operation . . . . . . . . . . . . . . . . 135</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix D.  Backward Compatibility . . . . . . . . . . . . . . . 135</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     D.1.  Negotiating with an older server  . . . . . . . . . . . . 136</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     D.2.  Negotiating with an older client  . . . . . . . . . . . . 137</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     D.3.  0-RTT backwards compatibility . . . . . . . . . . . . . . 137</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     D.4.  Middlebox Compatibility Mode  . . . . . . . . . . . . . . 137</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     D.5.  Backwards Compatibility Security Restrictions . . . . . . 138</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix E.  Overview of Security Properties  . . . . . . . . . . 139</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     E.1.  Handshake . . . . . . . . . . . . . . . . . . . . . . . . 139</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.1.1.  Key Derivation and HKDF . . . . . . . . . . . . . . . 142</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.1.2.  Client Authentication . . . . . . . . . . . . . . . . 143</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.1.3.  0-RTT . . . . . . . . . . . . . . . . . . . . . . . . 143</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.1.4.  Exporter Independence . . . . . . . . . . . . . . . . 143</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.1.5.  Post-Compromise Security  . . . . . . . . . . . . . . 144</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.1.6.  External References . . . . . . . . . . . . . . . . . 144</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     E.2.  Record Layer  . . . . . . . . . . . . . . . . . . . . . . 144</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.2.1.  External References . . . . . . . . . . . . . . . . . 145</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     E.3.  Traffic Analysis  . . . . . . . . . . . . . . . . . . . . 145</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     E.4.  Side Channel Attacks  . . . . . . . . . . . . . . . . . . 146</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     E.5.  Replay Attacks on 0-RTT . . . . . . . . . . . . . . . . . 147</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       E.5.1.  Replay and Exporters  . . . . . . . . . . . . . . . . 148</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     E.6.  PSK Identity Exposure . . . . . . . . . . . . . . . . . . 149</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     E.7.  Attacks on Static RSA . . . . . . . . . . . . . . . . . . 149</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix F.  Working Group Information  . . . . . . . . . . . . . 149</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix G.  Contributors . . . . . . . . . . . . . . . . . . . . 149</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . . 156</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">1.  Introduction</span></td><td> </td><td class="rblock">   <span class="insert">Appendix C. Implementation Notes .................................134</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.1. Random Number Generation and Seeding ......................134</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.2. Certificates and Authentication ...........................135</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.3. Implementation Pitfalls ...................................135</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.4. Client Tracking Prevention ................................137</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.5. Unauthenticated Operation .................................137</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Appendix D. Backward Compatibility ...............................138</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     D.1. Negotiating with an Older Server ..........................139</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     D.2. Negotiating with an Older Client ..........................139</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     D.3. 0-RTT Backward Compatibility ..............................140</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     D.4. Middlebox Compatibility Mode ..............................140</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     D.5. Security Restrictions Related to Backward Compatibility ...141</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Appendix E. Overview of Security Properties ......................142</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.1. Handshake .................................................142</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.1.1. Key Derivation and HKDF ...............................145</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.1.2. Client Authentication .................................146</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.1.3. 0-RTT .................................................146</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.1.4. Exporter Independence .................................146</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.1.5. Post-Compromise Security ..............................146</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.1.6. External References ...................................147</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.2. Record Layer ..............................................147</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.2.1. External References ...................................148</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.3. Traffic Analysis ..........................................148</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.4. Side-Channel Attacks ......................................149</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.5. Replay Attacks on 0-RTT ...................................150</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       E.5.1. Replay and Exporters ..................................151</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.6. PSK Identity Exposure .....................................152</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.7. Sharing PSKs ..............................................152</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     E.8. Attacks on Static RSA .....................................152</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Contributors .....................................................153</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Author's Address .................................................160</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</span></td><td> </td><td class="rblock"><span class="insert">1.  Introduction</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft is maintained in GitHub.  Suggested changes should be submitted</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   as pull requests at https://github.com/tlswg/tls13-spec.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Instructions are on that page as well.  Editorial changes can be</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   managed in GitHub, but any substantive change should be discussed on</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   the TLS mailing list.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The primary goal of TLS is to provide a secure channel between two</td><td> </td><td class="right">   The primary goal of TLS is to provide a secure channel between two</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   communicating peers; the only requirement from the underlying</td><td> </td><td class="right">   communicating peers; the only requirement from the underlying</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   transport is a reliable, in-order<span class="delete">,</span> data stream.  Specifically, the</td><td> </td><td class="rblock">   transport is a reliable, in-order data stream.  Specifically, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secure channel should provide the following properties:</td><td> </td><td class="right">   secure channel should provide the following properties:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Authentication: The server side of the channel is always</td><td> </td><td class="right">   -  Authentication: The server side of the channel is always</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authenticated; the client side is optionally authenticated.</td><td> </td><td class="right">      authenticated; the client side is optionally authenticated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Authentication can happen via asymmetric cryptography (e.g., RSA</td><td> </td><td class="right">      Authentication can happen via asymmetric cryptography (e.g., RSA</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      [RSA], <span class="delete">ECDSA</span> [ECDSA], <span class="delete">EdDSA</span> [RFC8032]) or a pre-shared key (PSK).</td><td> </td><td class="rblock">      [RSA], <span class="insert">the Elliptic Curve Digital Signature Algorithm (ECDSA)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      [ECDSA], <span class="insert">or the Edwards-Curve Digital Signature Algorithm (EdDSA)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      [RFC8032]) or a <span class="insert">symmetric</span> pre-shared key (PSK).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Confidentiality: Data sent over the channel after establishment is</td><td> </td><td class="right">   -  Confidentiality: Data sent over the channel after establishment is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      only visible to the endpoints.  TLS does not hide the length of</td><td> </td><td class="right">      only visible to the endpoints.  TLS does not hide the length of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the data it transmits, though endpoints are able to pad TLS</td><td> </td><td class="right">      the data it transmits, though endpoints are able to pad TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      records in order to obscure lengths and improve protection against</td><td> </td><td class="right">      records in order to obscure lengths and improve protection against</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      traffic analysis techniques.</td><td> </td><td class="right">      traffic analysis techniques.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Integrity: Data sent over the channel after establishment cannot</td><td> </td><td class="right">   -  Integrity: Data sent over the channel after establishment cannot</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      be modified by attackers.</td><td> </td><td class="rblock">      be modified by attackers<span class="insert"> without detection</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These properties should be true even in the face of an attacker who</td><td> </td><td class="right">   These properties should be true even in the face of an attacker who</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   has complete control of the network, as described in [RFC3552].  See</td><td> </td><td class="right">   has complete control of the network, as described in [RFC3552].  See</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Appendix E for a more complete statement of the relevant security</td><td> </td><td class="right">   Appendix E for a more complete statement of the relevant security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   properties.</td><td> </td><td class="right">   properties.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS consists of two primary components:</td><td> </td><td class="right">   TLS consists of two primary components:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A handshake protocol (Section 4) that authenticates the</td><td> </td><td class="right">   -  A handshake protocol (Section 4) that authenticates the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      communicating parties, negotiates cryptographic modes and</td><td> </td><td class="right">      communicating parties, negotiates cryptographic modes and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 6, line 18</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 7, line 18</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshaking and how to interpret the authentication certificates</td><td> </td><td class="right">   handshaking and how to interpret the authentication certificates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exchanged are left to the judgment of the designers and implementors</td><td> </td><td class="right">   exchanged are left to the judgment of the designers and implementors</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of protocols that run on top of TLS.</td><td> </td><td class="right">   of protocols that run on top of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document defines TLS version 1.3.  While TLS 1.3 is not directly</td><td> </td><td class="right">   This document defines TLS version 1.3.  While TLS 1.3 is not directly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compatible with previous versions, all versions of TLS incorporate a</td><td> </td><td class="right">   compatible with previous versions, all versions of TLS incorporate a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   versioning mechanism which allows clients and servers to</td><td> </td><td class="right">   versioning mechanism which allows clients and servers to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   interoperably negotiate a common version if one is supported by both</td><td> </td><td class="right">   interoperably negotiate a common version if one is supported by both</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   peers.</td><td> </td><td class="right">   peers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This document supersedes and obsoletes previous versions of TLS</td><td> </td><td class="rblock">   This document supersedes and obsoletes previous versions of TLS<span class="insert">,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   including version 1.2 [RFC5246].  It also obsoletes the TLS ticket</td><td> </td><td class="right">   including version 1.2 [RFC5246].  It also obsoletes the TLS ticket</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanism defined in [RFC5077] and replaces it with the mechanism</td><td> </td><td class="right">   mechanism defined in [RFC5077] and replaces it with the mechanism</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   defined in Section 2.2.  <span class="delete">Section 4.2.7 updates [RFC4492] by modifying</span></td><td> </td><td class="rblock">   defined in Section 2.2.  Because TLS 1.3 changes the way keys are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   the protocol attributes used to negotiate Elliptic Curves.</span>  Because</td><td> </td><td class="rblock">   derived, it updates [RFC5705] as described in Section 7.5.  It also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS 1.3 changes the way keys are derived, it updates [RFC5705] as</td><td> </td><td class="rblock">   changes how <span class="insert">Online Certificate Status Protocol (OCSP)</span> messages are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   described in Section 7.5.  It also changes how <span class="delete">OCSP</span> messages are</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   carried and therefore updates [RFC6066] and obsoletes [RFC6961] as</td><td> </td><td class="right">   carried and therefore updates [RFC6066] and obsoletes [RFC6961] as</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   described in <span class="delete">section </span>Section 4.4.2.1.</td><td> </td><td class="rblock">   described in Section 4.4.2.1.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.1.  Conventions and Terminology</td><td> </td><td class="right">1.1.  Conventions and Terminology</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td> </td><td class="rblock">   "OPTIONAL" in this document are to be interpreted as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td> </td><td class="rblock">   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   capitals, as shown here.</td><td> </td><td class="right">   capitals, as shown here.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following terms are used:</td><td> </td><td class="right">   The following terms are used:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client: The endpoint initiating the TLS connection.</td><td> </td><td class="rblock">   client:  The endpoint initiating the TLS connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">connection: A transport-layer connection between two endpoints.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   endpoint: Either the client or server of the connection.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   handshake: An initial negotiation between client and server that</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   establishes the parameters of their subsequent interactions within</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   TLS.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   peer: An endpoint.  When discussing a particular endpoint, "peer"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   refers to the endpoint that is not the primary subject of discussion.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   receiver: An endpoint that is receiving records.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   sender: An endpoint that is transmitting records.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   server: The endpoint which did not initiate the TLS connection.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">1.2.  Change Log</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   RFC EDITOR PLEASE DELETE THIS SECTION.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   (*) indicates changes to the wire protocol which may require</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   implementations to update.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-28</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Add a section on exposure of PSK identities.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-27</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  SHOULD-&gt;MUST for being able to process "supported_versions"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      without 0x0304.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Much editorial cleanup.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-26</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify that you can't negotiate pre-TLS 1.3 with</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      supported_versions.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-25</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add the header to additional data (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Minor clarifications.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  IANA cleanup.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-24</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Require that CH2 have version 0303 (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Some clarifications</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-23</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Renumber key_share (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add a new extension and new code points to allow negotiating PSS</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      separately for certificates and CertificateVerify (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Slightly restrict when CCS must be accepted to make implementation</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      easier.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Document protocol invariants</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add some text on the security of static RSA.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-22</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Implement changes for improved middlebox penetration (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Move server_certificate_type to encrypted extensions (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Allow resumption with a different SNI (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Padding extension can change on HRR (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Allow an empty ticket_nonce (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove requirement to immediately respond to close_notify with</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      close_notify (allowing half-close)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-21</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add a per-ticket nonce so that each ticket is associated with a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      different PSK (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify that clients should send alerts with the handshake key if</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      possible.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Update state machine to show rekeying events</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add discussion of 0-RTT and replay.  Recommend that</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      implementations implement some anti-replay mechanism.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-20</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add "post_handshake_auth" extension to negotiate post-handshake</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      authentication (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Shorten labels for HKDF-Expand-Label so that we can fit within one</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      compression block (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Define how RFC 7250 works (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Re-enable post-handshake client authentication even when you do</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      PSK.  The previous prohibition was editorial error.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove cert_type and user_mapping, which don't work on TLS 1.3</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      anyway.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Added the no_application_protocol alert from [RFC7301] to the list</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      of extensions.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Added discussion of traffic analysis and side channel attacks.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-19</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Hash context_value input to Exporters (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add an additional Derive-Secret stage to Exporters (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Hash ClientHello1 in the transcript when HRR is used.  This</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      reduces the state that needs to be carried in cookies. (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Restructure CertificateRequest to have the selectors in</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      extensions.  This also allowed defining a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      "certificate_authorities" extension which can be used by the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      client instead of trusted_ca_keys (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Tighten record framing requirements and require checking of them</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Consolidate "ticket_early_data_info" and "early_data" into a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      single extension (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Change end_of_early_data to be a handshake message (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add pre-extract Derive-Secret stages to key schedule (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove spurious requirement to implement "pre_shared_key".</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify location of "early_data" from server (it goes in EE, as</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      indicated by the table in S 10).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Require peer public key validation</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add state machine diagram.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-18</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove unnecessary resumption_psk which is the only thing expanded</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      from the resumption master secret. (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Fix signature_algorithms entry in extensions table.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Restate rule from RFC 6066 that you can't resume unless SNI is the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      same.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-17</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove 0-RTT Finished and resumption_context, and replace with a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      psk_binder field in the PSK itself (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Restructure PSK key exchange negotiation modes (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add max_early_data_size field to TicketEarlyDataInfo (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add a 0-RTT exporter and change the transcript for the regular</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      exporter (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Merge TicketExtensions and Extensions registry.  Changes</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ticket_early_data_info code point (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Replace Client.key_shares in response to HRR (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove redundant labels for traffic key derivation (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Harmonize requirements about cipher suite matching: for resumption</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      you need to match KDF but for 0-RTT you need whole cipher suite.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      This allows PSKs to actually negotiate cipher suites. (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Move SCT and OCSP into Certificate.extensions (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Explicitly allow non-offered extensions in NewSessionTicket</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Explicitly allow predicting client Finished for NST</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify conditions for allowing 0-RTT with PSK</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-16</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Revise version negotiation (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Change RSASSA-PSS and EdDSA SignatureScheme codepoints for better</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      backwards compatibility (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Move HelloRetryRequest.selected_group to an extension (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify the behavior of no exporter context and make it the same</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      as an empty context.(*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  New KeyUpdate format that allows for requesting/not-requesting an</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      answer.  This also means changes to the key schedule to support</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      independent updates (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  New certificate_required alert (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Forbid CertificateRequest with 0-RTT and PSK.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Relax requirement to check SNI for 0-RTT.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-15</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  New negotiation syntax as discussed in Berlin (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Require CertificateRequest.context to be empty during handshake</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Forbid empty tickets (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Forbid application data messages in between post-handshake</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      messages from the same flight (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clean up alert guidance (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clearer guidance on what is needed for TLS 1.2.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Guidance on 0-RTT time windows.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Rename a bunch of fields.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove old PRNG text.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Explicitly require checking that handshake records not span key</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      changes.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-14</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Allow cookies to be longer (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove the "context" from EarlyDataIndication as it was undefined</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      and nobody used it (*)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove 0-RTT EncryptedExtensions and replace the ticket_age</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      extension with an obfuscated version.  Also necessitates a change</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      to NewSessionTicket (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Move the downgrade sentinel to the end of ServerHello.Random to</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      accommodate tlsdate (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Define ecdsa_sha1 (*).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Allow resumption even after fatal alerts.  This matches current</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      practice.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove non-closure warning alerts.  Require treating unknown</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      alerts as fatal.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Make the rules for accepting 0-RTT less restrictive.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify 0-RTT backward-compatibility rules.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify how 0-RTT and PSK identities interact.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add a section describing the data limits for each cipher.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Major editorial restructuring.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Replace the Security Analysis section with a WIP draft.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-13</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Allow server to send SupportedGroups.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove 0-RTT client authentication</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove (EC)DHE 0-RTT.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Flesh out 0-RTT PSK mode and shrink EarlyDataIndication</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Turn PSK-resumption response into an index to save room</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Move CertificateStatus to an extension</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Extra fields in NewSessionTicket.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Restructure key schedule and add a resumption_context value.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Require DH public keys and secrets to be zero-padded to the size</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      of the group.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove the redundant length fields in KeyShareEntry.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Define a cookie field for HRR.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-12</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Provide a list of the PSK cipher suites.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove the ability for the ServerHello to have no extensions (this</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      aligns the syntax with the text).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Clarify that the server can send application data after its first</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      flight (0.5 RTT data)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Revise signature algorithm negotiation to group hash, signature</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      algorithm, and curve together.  This is backwards compatible.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Make ticket lifetime mandatory and limit it to a week.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Make the purpose strings lower-case.  This matches how people are</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      implementing for interop.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Define exporters.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Editorial cleanup</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-11</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Port the CFRG curves &amp; signatures work from RFC4492bis.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove sequence number and version from additional_data, which is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      now empty.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Reorder values in HkdfLabel.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add support for version anti-downgrade mechanism.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Update IANA considerations section and relax some of the policies.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Unify authentication modes.  Add post-handshake client</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      authentication.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove early_handshake content type.  Terminate 0-RTT data with an</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      alert.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Reset sequence number upon key change (as proposed by Fournet et</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      al.)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-10</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove ClientCertificateTypes field from CertificateRequest and</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      add extensions.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Merge client and server key shares into a single extension.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-09</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Change to RSA-PSS signatures for handshake messages.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove support for DSA.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Update key schedule per suggestions by Hugo, Hoeteck, and Bjoern</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Tackmann.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add support for per-record padding.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Switch to encrypted record ContentType.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Change HKDF labeling to include protocol version and value</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      lengths.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Shift the final decision to abort a handshake due to incompatible</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      certificates to the client rather than having servers abort early.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Deprecate SHA-1 with signatures.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add MTI algorithms.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-08</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove support for weak and lesser used named curves.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove support for MD5 and SHA-224 hashes with signatures.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Update lists of available AEAD cipher suites and error alerts.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Reduce maximum permitted record expansion for AEAD from 2048 to</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      256 octets.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Require digital signatures even when a previous configuration is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      used.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Merge EarlyDataIndication and KnownConfiguration.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Change code point for server_configuration to avoid collision with</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      server_hello_done.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Relax certificate_list ordering requirement to match current</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      practice.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-07</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Integration of semi-ephemeral DH proposal.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Add initial 0-RTT support.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove resumption and replace with PSK + tickets.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Move ClientKeyShare into an extension.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Move to HKDF.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-06</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Prohibit RC4 negotiation for backwards compatibility.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Freeze &amp; deprecate record layer version field.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Update format of signatures with context.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove explicit IV.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-05</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Prohibit SSL negotiation for backwards compatibility.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Fix which MS is used for exporters.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-04</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Modify key computations to include session hash.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove ChangeCipherSpec.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Renumber the new handshake messages to be somewhat more consistent</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      with existing convention and to remove a duplicate registration.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove renegotiation.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove point format negotiation.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft-03</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove GMT time.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Merge in support for ECC from RFC 4492 but without explicit</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      curves.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Remove the unnecessary length field from the AD input to AEAD</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ciphers.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Rename {Client,Server}KeyExchange to {Client,Server}KeyShare.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Add an explicit HelloRetryRequest to reject the client'</span>s.</td><td> </td><td class="rblock">   <span class="insert">connection:  A transport-layer connection between two endpoint</span>s.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Increment version number</span>.</td><td> </td><td class="rblock">   <span class="insert">endpoint:  Either the client or server of the connection</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Rework handshake to provide 1-RTT mode.</span></td><td> </td><td class="rblock">   <span class="insert">handshake:  An initial negotiation between client and server that</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      establishes the parameters of their subsequent interactions</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      within TLS.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Remove custom DHE groups.</span></td><td> </td><td class="rblock">   <span class="insert">peer:  An endpoint.  When discussing a particular endpoint, "peer"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      refers to the endpoint that is not the primary subject of</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      discussion.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Remove support for compression</span>.</td><td> </td><td class="rblock">   <span class="insert">receiver:  An endpoint that is receiving records</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Remove support for static RSA and DH key exchange</span>.</td><td> </td><td class="rblock">   <span class="insert">sender:  An endpoint that is transmitting records</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Remove support for non-AEAD ciphers</span>.</td><td> </td><td class="rblock">   <span class="insert">server:  The endpoint that did not initiate the TLS connection</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">1.<span class="delete">3</span>.  Major Differences from TLS 1.2</td><td> </td><td class="rblock">1.<span class="insert">2</span>.  Major Differences from TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following is a list of the major functional differences between</td><td> </td><td class="right">   The following is a list of the major functional differences between</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS 1.2 and TLS 1.3.  It is not intended to be exhaustive and there</td><td> </td><td class="rblock">   TLS 1.2 and TLS 1.3.  It is not intended to be exhaustive<span class="insert">,</span> and there</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are many minor differences.</td><td> </td><td class="right">   are many minor differences.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  The list of supported symmetric algorithms has been pruned of all</td><td> </td><td class="rblock">   -  The list of supported symmetric <span class="insert">encryption</span> algorithms has been</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      algorithms that are considered legacy.  Those that remain all <span class="delete">use</span></td><td> </td><td class="rblock">      pruned of all algorithms that are considered legacy.  Those that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Authenticated Encryption with Associated Data (AEAD) algorithms.</td><td> </td><td class="rblock">      remain <span class="insert">are</span> all Authenticated Encryption with Associated Data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      The <span class="delete">ciphersuite</span> concept has been changed to separate the</td><td> </td><td class="rblock">      (AEAD) algorithms.  The <span class="insert">cipher suite</span> concept has been changed to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      authentication and key exchange mechanisms from the record</td><td> </td><td class="rblock">      separate the authentication and key exchange mechanisms from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      protection algorithm (including secret key length) and a hash to</td><td> </td><td class="rblock">      record protection algorithm (including secret key length) and a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      be used with the key derivation function and <span class="delete">HMAC.</span></td><td> </td><td class="rblock">      hash to be used with <span class="insert">both</span> the key derivation function and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      <span class="insert">handshake message authentication code (MAC).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  A <span class="delete">0-RTT</span> mode was added, saving a <span class="delete">round-trip</span> at connection setup</td><td> </td><td class="rblock">   -  A <span class="insert">zero round-trip time (0-RTT)</span> mode was added, saving a <span class="insert">round trip</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      for some application data, at the cost of certain security</td><td> </td><td class="rblock">      at connection setup for some application data, at the cost of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      properties.</td><td> </td><td class="rblock">      certain security properties.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Static RSA and Diffie-Hellman cipher suites have been removed; all</td><td> </td><td class="right">   -  Static RSA and Diffie-Hellman cipher suites have been removed; all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      public-key based key exchange mechanisms now provide forward</td><td> </td><td class="right">      public-key based key exchange mechanisms now provide forward</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      secrecy.</td><td> </td><td class="right">      secrecy.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  All handshake messages after the ServerHello are now encrypted.</td><td> </td><td class="right">   -  All handshake messages after the ServerHello are now encrypted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      The newly introduced <span class="delete">EncryptedExtension</span> message allows various</td><td> </td><td class="rblock">      The newly introduced <span class="insert">EncryptedExtensions</span> message allows various</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      extensions previously sent in clear in the ServerHello to also</td><td> </td><td class="rblock">      extensions previously sent in <span class="insert">the</span> clear in the ServerHello to also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      enjoy confidentiality <span class="delete">protection from active attackers.</span></td><td> </td><td class="rblock">      enjoy confidentiality <span class="insert">protection.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  The key derivation functions have been <span class="delete">re-designed.</span>  The new</td><td> </td><td class="rblock">   -  The key derivation functions have been <span class="insert">redesigned.</span>  The new design</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      design allows easier analysis by cryptographers due to their</td><td> </td><td class="rblock">      allows easier analysis by cryptographers due to their improved key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      improved key separation properties.  The HMAC-based <span class="delete">Extract-and-</span></td><td> </td><td class="rblock">      separation properties.  The HMAC-based <span class="insert">Extract-and-Expand</span> Key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Expand</span> Key Derivation Function (HKDF) is used as an underlying</td><td> </td><td class="rblock">      Derivation Function (HKDF) is used as an underlying primitive.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      primitive.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The handshake state machine has been significantly restructured to</td><td> </td><td class="right">   -  The handshake state machine has been significantly restructured to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      be more consistent and to remove superfluous messages such as</td><td> </td><td class="right">      be more consistent and to remove superfluous messages such as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ChangeCipherSpec (except when needed for middlebox compatibility).</td><td> </td><td class="right">      ChangeCipherSpec (except when needed for middlebox compatibility).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Elliptic curve algorithms are now in the base <span class="delete">spec</span> and new</td><td> </td><td class="rblock">   -  Elliptic curve algorithms are now in the base <span class="insert">spec,</span> and new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      signature algorithms, such as <span class="delete">ed25519 and ed448,</span> are included.</td><td> </td><td class="rblock">      signature algorithms, such as <span class="insert">EdDSA,</span> are included.  TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      TLS 1.3 removed point format negotiation in favor of a single</td><td> </td><td class="rblock">      removed point format negotiation in favor of a single point format</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      point format for each curve.</td><td> </td><td class="rblock">      for each curve.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Other cryptographic improvements including <span class="delete">the removal of</span></td><td> </td><td class="rblock">   -  Other cryptographic improvements <span class="insert">were made,</span> including changing the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      compression and custom DHE groups,</span> changing the RSA padding to use</td><td> </td><td class="rblock">      RSA padding to use <span class="insert">the RSA Probabilistic Signature Scheme</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">RSASSA-PSS,</span> and the removal of <span class="delete">DSA.</span></td><td> </td><td class="rblock"><span class="insert">      (RSASSA-PSS),</span> and the removal of <span class="insert">compression, the Digital</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Signature Algorithm (DSA), and custom Ephemeral Diffie-Hellman</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (DHE) groups.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The TLS 1.2 version negotiation mechanism has been deprecated in</td><td> </td><td class="right">   -  The TLS 1.2 version negotiation mechanism has been deprecated in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      favor of a version list in an extension.  This increases</td><td> </td><td class="right">      favor of a version list in an extension.  This increases</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compatibility with existing servers that incorrectly implemented</td><td> </td><td class="right">      compatibility with existing servers that incorrectly implemented</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      version negotiation.</td><td> </td><td class="right">      version negotiation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Session resumption with and without server-side state as well as</td><td> </td><td class="right">   -  Session resumption with and without server-side state as well as</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the PSK-based ciphersuites of earlier TLS versions have been</td><td> </td><td class="rblock">      the PSK-based cipher<span class="insert"> </span>suites of earlier TLS versions have been</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      replaced by a single new PSK exchange.</td><td> </td><td class="right">      replaced by a single new PSK exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  <span class="delete">Updated references</span> to point to the updated versions of RFCs, as</td><td> </td><td class="rblock">   -  <span class="insert">References have been updated</span> to point to the updated versions of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      appropriate (e.g., RFC 5280 rather than RFC 3280).</td><td> </td><td class="rblock">      RFCs, as appropriate (e.g., RFC 5280 rather than RFC 3280).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">1.<span class="delete">4</span>.  Updates Affecting TLS 1.2</td><td> </td><td class="rblock">1.<span class="insert">3</span>.  Updates Affecting TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document defines several changes that optionally affect</td><td> </td><td class="right">   This document defines several changes that optionally affect</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementations of TLS 1.2, including those which do not also support</td><td> </td><td class="right">   implementations of TLS 1.2, including those which do not also support</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3:</td><td> </td><td class="right">   TLS 1.3:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A version downgrade protection mechanism is described in</td><td> </td><td class="right">   -  A version downgrade protection mechanism is described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 4.1.3.</td><td> </td><td class="right">      Section 4.1.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  RSASSA-PSS signature schemes are defined in Section 4.2.3.</td><td> </td><td class="right">   -  RSASSA-PSS signature schemes are defined in Section 4.2.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The "supported_versions" ClientHello extension can be used to</td><td> </td><td class="right">   -  The "supported_versions" ClientHello extension can be used to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiate the version of TLS to use, in preference to the</td><td> </td><td class="right">      negotiate the version of TLS to use, in preference to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      legacy_version field of the ClientHello.</td><td> </td><td class="right">      legacy_version field of the ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The "signature_algorithms_cert" extension allows a client to</td><td> </td><td class="right">   -  The "signature_algorithms_cert" extension allows a client to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      indicate which signature algorithms it can validate in X.509</td><td> </td><td class="right">      indicate which signature algorithms it can validate in X.509</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      certificates</td><td> </td><td class="rblock">      certificates<span class="insert">.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Additionally, this document clarifies some compliance requirements</td><td> </td><td class="right">   Additionally, this document clarifies some compliance requirements</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for earlier versions of TLS; see Section 9.3.</td><td> </td><td class="right">   for earlier versions of TLS; see Section 9.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">2.  Protocol Overview</td><td> </td><td class="right">2.  Protocol Overview</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The cryptographic parameters used by the secure channel are produced</td><td> </td><td class="right">   The cryptographic parameters used by the secure channel are produced</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   by the TLS handshake protocol.  This sub-protocol of TLS is used by</td><td> </td><td class="right">   by the TLS handshake protocol.  This sub-protocol of TLS is used by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client and server when first communicating with each other.  The</td><td> </td><td class="right">   the client and server when first communicating with each other.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake protocol allows peers to negotiate a protocol version,</td><td> </td><td class="right">   handshake protocol allows peers to negotiate a protocol version,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   select cryptographic algorithms, optionally authenticate each other,</td><td> </td><td class="right">   select cryptographic algorithms, optionally authenticate each other,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and establish shared secret keying material.  Once the handshake is</td><td> </td><td class="right">   and establish shared secret keying material.  Once the handshake is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   complete, the peers use the established keys to protect the</td><td> </td><td class="right">   complete, the peers use the established keys to protect the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   application<span class="delete"> </span>layer traffic.</td><td> </td><td class="rblock">   application<span class="insert">-</span>layer traffic.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A failure of the handshake or other protocol error triggers the</td><td> </td><td class="right">   A failure of the handshake or other protocol error triggers the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   termination of the connection, optionally preceded by an alert</td><td> </td><td class="right">   termination of the connection, optionally preceded by an alert</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message (Section 6).</td><td> </td><td class="right">   message (Section 6).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS supports three basic key exchange modes:</td><td> </td><td class="right">   TLS supports three basic key exchange modes:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  (EC)DHE (Diffie-Hellman over either finite fields or elliptic</td><td> </td><td class="right">   -  (EC)DHE (Diffie-Hellman over either finite fields or elliptic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      curves)</td><td> </td><td class="right">      curves)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 18, line 28</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 11, line 4</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message (Section 6).</td><td> </td><td class="right">   message (Section 6).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS supports three basic key exchange modes:</td><td> </td><td class="right">   TLS supports three basic key exchange modes:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  (EC)DHE (Diffie-Hellman over either finite fields or elliptic</td><td> </td><td class="right">   -  (EC)DHE (Diffie-Hellman over either finite fields or elliptic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      curves)</td><td> </td><td class="right">      curves)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  PSK-only</td><td> </td><td class="right">   -  PSK-only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  PSK with (EC)DHE</td><td> </td><td class="right">   -  PSK with (EC)DHE</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                         </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Figure 1 below shows the basic full TLS handshake:</td><td> </td><td class="right">   Figure 1 below shows the basic full TLS handshake:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Client                                           <span class="delete">    </span>Server</td><td> </td><td class="rblock">       Client                                           Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Key  ^ ClientHello</td><td> </td><td class="right">Key  ^ ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Exch | + key_share*</td><td> </td><td class="right">Exch | + key_share*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     | + signature_algorithms*</td><td> </td><td class="right">     | + signature_algorithms*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     | + psk_key_exchange_modes*</td><td> </td><td class="right">     | + psk_key_exchange_modes*</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     v + pre_shared_key*         --------&gt;</td><td> </td><td class="rblock">     v + pre_shared_key*       --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                       ServerHello  ^ Key</td><td> </td><td class="rblock">                                                  ServerHello  ^ Key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      + key_share*  | Exch</td><td> </td><td class="rblock">                                                 + key_share*  | Exch</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                 + pre_shared_key*  v</td><td> </td><td class="rblock">                                            + pre_shared_key*  v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                             {EncryptedExtensions}  ^  Server</td><td> </td><td class="rblock">                                        {EncryptedExtensions}  ^  Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                             {CertificateRequest*}  v  Params</td><td> </td><td class="rblock">                                        {CertificateRequest*}  v  Params</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                    {Certificate*}  ^</td><td> </td><td class="rblock">                                               {Certificate*}  ^</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                              {CertificateVerify*}  | Auth</td><td> </td><td class="rblock">                                         {CertificateVerify*}  | Auth</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        {Finished}  v</td><td> </td><td class="rblock">                                                   {Finished}  v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                 &lt;--------     [Application Data*]</td><td> </td><td class="rblock">                               &lt;--------  [Application Data*]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     ^ {Certificate*}</td><td> </td><td class="right">     ^ {Certificate*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Auth | {CertificateVerify*}</td><td> </td><td class="right">Auth | {CertificateVerify*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     v {Finished}                --------&gt;</td><td> </td><td class="rblock">     v {Finished}              --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       [Application Data]        &lt;-------&gt;      [Application Data]</td><td> </td><td class="rblock">       [Application Data]      &lt;-------&gt;  [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              +  Indicates noteworthy extensions sent in the</td><td> </td><td class="right">              +  Indicates noteworthy extensions sent in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                 previously noted message.</td><td> </td><td class="right">                 previously noted message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              *  Indicates optional or situation-dependent</td><td> </td><td class="right">              *  Indicates optional or situation-dependent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                 messages/extensions that are not always sent.</td><td> </td><td class="right">                 messages/extensions that are not always sent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              {} Indicates messages protected using keys</td><td> </td><td class="right">              {} Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                 derived from a [sender]_handshake_traffic_secret.</td><td> </td><td class="right">                 derived from a [sender]_handshake_traffic_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              [] Indicates messages protected using keys</td><td> </td><td class="right">              [] Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 derived from [sender]_application_traffic_secret_N</td><td> </td><td class="rblock">                 derived from [sender]_application_traffic_secret_N<span class="insert">.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               Figure 1: Message <span class="delete">flow for f</span>ull TLS Handshake</td><td> </td><td class="rblock">               Figure 1: Message <span class="insert">Flow for F</span>ull TLS Handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The handshake can be thought of as having three phases (indicated in</td><td> </td><td class="right">   The handshake can be thought of as having three phases (indicated in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the diagram above):</td><td> </td><td class="right">   the diagram above):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Key Exchange: Establish shared keying material and select the</td><td> </td><td class="right">   -  Key Exchange: Establish shared keying material and select the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      cryptographic parameters.  Everything after this phase is</td><td> </td><td class="right">      cryptographic parameters.  Everything after this phase is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      encrypted.</td><td> </td><td class="right">      encrypted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Server Parameters: Establish other handshake parameters (whether</td><td> </td><td class="rblock">   -  Server Parameters: Establish other handshake parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the client is authenticated, <span class="delete">application layer</span> protocol support,</td><td> </td><td class="rblock">      (whether the client is authenticated, <span class="insert">application-layer</span> protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      etc.).</td><td> </td><td class="rblock">      support, etc.).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Authentication: Authenticate the server (and<span class="delete"> optionally</span> the</td><td> </td><td class="rblock">   -  Authentication: Authenticate the server (and<span class="insert">, optionally,</span> the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client) and provide key confirmation and handshake integrity.</td><td> </td><td class="right">      client) and provide key confirmation and handshake integrity.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the Key Exchange phase, the client sends the ClientHello</td><td> </td><td class="right">   In the Key Exchange phase, the client sends the ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (Section 4.1.2) message, which contains a random nonce</td><td> </td><td class="right">   (Section 4.1.2) message, which contains a random nonce</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (ClientHello.random); its offered protocol versions; a list of</td><td> </td><td class="right">   (ClientHello.random); its offered protocol versions; a list of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   symmetric cipher/HKDF hash pairs; either a set of Diffie-Hellman key</td><td> </td><td class="right">   symmetric cipher/HKDF hash pairs; either a set of Diffie-Hellman key</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   shares (in the "key_share" <span class="delete">extension Section 4.2.8),</span> a set of <span class="delete">pre-</span></td><td> </td><td class="rblock">   shares (in the "key_share" <span class="insert">(Section 4.2.8) extension),</span> a set of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   shared</span> key labels (in the "pre_shared_key" <span class="delete">extension Section</span> 4.2.11)</td><td> </td><td class="rblock">   <span class="insert">pre-shared</span> key labels (in the "pre_shared_key" <span class="insert">(Section</span> 4.2.11)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   or both; and potentially additional extensions.  Additional fields</td><td> </td><td class="rblock">   <span class="insert">extension),</span> or both; and potentially additional extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and/or messages may also be present for middlebox compatibility.</td><td> </td><td class="rblock">   Additional fields and/or messages may also be present for middlebox</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   compatibility.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server processes the ClientHello and determines the appropriate</td><td> </td><td class="right">   The server processes the ClientHello and determines the appropriate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cryptographic parameters for the connection.  It then responds with</td><td> </td><td class="right">   cryptographic parameters for the connection.  It then responds with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   its own ServerHello (Section 4.1.3), which indicates the negotiated</td><td> </td><td class="right">   its own ServerHello (Section 4.1.3), which indicates the negotiated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection parameters.  The combination of the ClientHello and the</td><td> </td><td class="right">   connection parameters.  The combination of the ClientHello and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello determines the shared keys.  If (EC)DHE key establishment</td><td> </td><td class="right">   ServerHello determines the shared keys.  If (EC)DHE key establishment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is in use, then the ServerHello contains a "key_share" extension with</td><td> </td><td class="right">   is in use, then the ServerHello contains a "key_share" extension with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server's ephemeral Diffie-Hellman share; the server's share MUST</td><td> </td><td class="right">   the server's ephemeral Diffie-Hellman share; the server's share MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be in the same group as one of the client's shares.  If PSK key</td><td> </td><td class="right">   be in the same group as one of the client's shares.  If PSK key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   establishment is in use, then the ServerHello contains a</td><td> </td><td class="right">   establishment is in use, then the ServerHello contains a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 20, line 45</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 13, line 10</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateRequest:  if certificate-based client authentication is</td><td> </td><td class="right">   CertificateRequest:  if certificate-based client authentication is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      desired, the desired parameters for that certificate.  This</td><td> </td><td class="right">      desired, the desired parameters for that certificate.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message is omitted if client authentication is not desired.</td><td> </td><td class="right">      message is omitted if client authentication is not desired.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [Section 4.3.2]</td><td> </td><td class="right">      [Section 4.3.2]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Finally, the client and server exchange Authentication messages.  TLS</td><td> </td><td class="right">   Finally, the client and server exchange Authentication messages.  TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   uses the same set of messages every time that certificate-based</td><td> </td><td class="right">   uses the same set of messages every time that certificate-based</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   authentication is needed.  (PSK-based authentication happens as a</td><td> </td><td class="right">   authentication is needed.  (PSK-based authentication happens as a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   side effect of key exchange.)  Specifically:</td><td> </td><td class="right">   side effect of key exchange.)  Specifically:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Certificate:  <span class="delete">t</span>he certificate of the endpoint and any per-certificate</td><td> </td><td class="rblock">   Certificate:  <span class="insert">T</span>he certificate of the endpoint and any per-certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extensions.  This message is omitted by the server if not</td><td> </td><td class="right">      extensions.  This message is omitted by the server if not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authenticating with a certificate and by the client if the server</td><td> </td><td class="right">      authenticating with a certificate and by the client if the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      did not send CertificateRequest (thus indicating that the client</td><td> </td><td class="right">      did not send CertificateRequest (thus indicating that the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      should not authenticate with a certificate).  Note that if raw</td><td> </td><td class="right">      should not authenticate with a certificate).  Note that if raw</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      public keys [RFC7250] or the cached information extension</td><td> </td><td class="right">      public keys [RFC7250] or the cached information extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [RFC7924] are in use, then this message will not contain a</td><td> </td><td class="right">      [RFC7924] are in use, then this message will not contain a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate but rather some other value corresponding to the</td><td> </td><td class="right">      certificate but rather some other value corresponding to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server's long-term key.  [Section 4.4.2]</td><td> </td><td class="right">      server's long-term key.  [Section 4.4.2]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   CertificateVerify:  <span class="delete">a</span> signature over the entire handshake using the</td><td> </td><td class="rblock">   CertificateVerify:  <span class="insert">A</span> signature over the entire handshake using the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      private key corresponding to the public key in the Certificate</td><td> </td><td class="right">      private key corresponding to the public key in the Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message.  This message is omitted if the endpoint is not</td><td> </td><td class="right">      message.  This message is omitted if the endpoint is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authenticating via a certificate.  [Section 4.4.3]</td><td> </td><td class="right">      authenticating via a certificate.  [Section 4.4.3]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Finished:  <span class="delete">a</span> MAC (Message Authentication Code) over the entire</td><td> </td><td class="rblock">   Finished:  <span class="insert">A</span> MAC (Message Authentication Code) over the entire</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      handshake.  This message provides key confirmation, binds the</td><td> </td><td class="right">      handshake.  This message provides key confirmation, binds the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      endpoint's identity to the exchanged keys, and in PSK mode also</td><td> </td><td class="right">      endpoint's identity to the exchanged keys, and in PSK mode also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authenticates the handshake.  [Section 4.4.4]</td><td> </td><td class="right">      authenticates the handshake.  [Section 4.4.4]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Upon receiving the server's messages, the client responds with its</td><td> </td><td class="right">   Upon receiving the server's messages, the client responds with its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Authentication messages, namely Certificate and CertificateVerify (if</td><td> </td><td class="right">   Authentication messages, namely Certificate and CertificateVerify (if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requested), and Finished.</td><td> </td><td class="right">   requested), and Finished.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   At this point, the handshake is complete, and the client and server</td><td> </td><td class="right">   At this point, the handshake is complete, and the client and server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   derive the keying material required by the record layer to exchange</td><td> </td><td class="right">   derive the keying material required by the record layer to exchange</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application-layer data protected through authenticated encryption.</td><td> </td><td class="right">   application-layer data protected through authenticated encryption.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Application <span class="delete">data</span> MUST NOT be sent prior to sending the Finished</td><td> </td><td class="rblock">   Application <span class="insert">Data</span> MUST NOT be sent prior to sending the Finished</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   message, except as specified in <span class="delete">[Section 2.3].</span>  Note that while the</td><td> </td><td class="rblock">   message, except as specified in <span class="insert">Section 2.3.</span>  Note that while the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server may send <span class="delete">application data</span> prior to receiving the client's</td><td> </td><td class="rblock">   server may send <span class="insert">Application Data</span> prior to receiving the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Authentication messages, any data sent at that point is, of course,</td><td> </td><td class="right">   Authentication messages, any data sent at that point is, of course,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   being sent to an unauthenticated peer.</td><td> </td><td class="right">   being sent to an unauthenticated peer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">2.1.  Incorrect DHE Share</td><td> </td><td class="right">2.1.  Incorrect DHE Share</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the client has not provided a sufficient "key_share" extension</td><td> </td><td class="right">   If the client has not provided a sufficient "key_share" extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (e.g., it includes only DHE or ECDHE groups unacceptable to or</td><td> </td><td class="right">   (e.g., it includes only DHE or ECDHE groups unacceptable to or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unsupported by the server), the server corrects the mismatch with a</td><td> </td><td class="right">   unsupported by the server), the server corrects the mismatch with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest and the client needs to restart the handshake with</td><td> </td><td class="right">   HelloRetryRequest and the client needs to restart the handshake with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   an appropriate "key_share" extension, as shown in Figure 2.  If no</td><td> </td><td class="right">   an appropriate "key_share" extension, as shown in Figure 2.  If no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   common cryptographic parameters can be negotiated, the server MUST</td><td> </td><td class="right">   common cryptographic parameters can be negotiated, the server MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   abort the handshake with an appropriate alert.</td><td> </td><td class="right">   abort the handshake with an appropriate alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        <span class="delete">    </span>Client                                               Server</td><td> </td><td class="rblock">        Client                                               Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            ClientHello</td><td> </td><td class="rblock">        ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            + key_share             --------&gt;</td><td> </td><td class="rblock">        + key_share             --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      HelloRetryRequest</td><td> </td><td class="rblock">                                                  HelloRetryRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                    &lt;--------               + key_share</td><td> </td><td class="rblock">                                &lt;--------               + key_share</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            ClientHello</td><td> </td><td class="rblock">        ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            + key_share             --------&gt;</td><td> </td><td class="rblock">        + key_share             --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                            ServerHello</td><td> </td><td class="rblock">                                                        ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                            + key_share</td><td> </td><td class="rblock">                                                        + key_share</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                  {EncryptedExtensions}</td><td> </td><td class="rblock">                                              {EncryptedExtensions}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                  {CertificateRequest*}</td><td> </td><td class="rblock">                                              {CertificateRequest*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                         {Certificate*}</td><td> </td><td class="rblock">                                                     {Certificate*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                   {CertificateVerify*}</td><td> </td><td class="rblock">                                               {CertificateVerify*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                             {Finished}</td><td> </td><td class="rblock">                                                         {Finished}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                    &lt;--------       [Application Data*]</td><td> </td><td class="rblock">                                &lt;--------       [Application Data*]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            {Certificate*}</td><td> </td><td class="rblock">        {Certificate*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            {CertificateVerify*}</td><td> </td><td class="rblock">        {CertificateVerify*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            {Finished}              --------&gt;</td><td> </td><td class="rblock">        {Finished}              --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            [Application Data]      &lt;-------&gt;        [Application Data]</td><td> </td><td class="rblock">        [Application Data]      &lt;-------&gt;        [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Figure 2: Message <span class="delete">flow</span> for a <span class="delete">full handshake</span> with <span class="delete">mismatched</span></td><td> </td><td class="rblock">             Figure 2: Message <span class="insert">Flow</span> for a <span class="insert">Full Handshake</span> with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                parameters</span></td><td> </td><td class="rblock">                           <span class="insert">Mismatched Parameters</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note: The handshake transcript incorporates the initial <span class="delete">ClientHello/</span></td><td> </td><td class="rblock">   Note: The handshake transcript incorporates the initial</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   HelloRetryRequest</span> exchange; it is not reset with the new ClientHello.</td><td> </td><td class="rblock">   <span class="insert">ClientHello/HelloRetryRequest</span> exchange; it is not reset with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   new ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS also allows several optimized variants of the basic handshake, as</td><td> </td><td class="right">   TLS also allows several optimized variants of the basic handshake, as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   described in the following sections.</td><td> </td><td class="right">   described in the following sections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">2.2.  Resumption and Pre-Shared Key (PSK)</td><td> </td><td class="right">2.2.  Resumption and Pre-Shared Key (PSK)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Although TLS PSKs can be established out of band, PSKs can also be</td><td> </td><td class="right">   Although TLS PSKs can be established out of band, PSKs can also be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   established in a previous connection and then used to establish a new</td><td> </td><td class="right">   established in a previous connection and then used to establish a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection ("session resumption" or "resuming" with a PSK).  Once a</td><td> </td><td class="right">   connection ("session resumption" or "resuming" with a PSK).  Once a</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake has completed, the server can send t<span class="delete">o t</span>he client a PSK</td><td> </td><td class="rblock">   handshake has completed, the server can send the client a PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   identity that corresponds to a unique key derived from the initial</td><td> </td><td class="right">   identity that corresponds to a unique key derived from the initial</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake (see Section 4.6.1).  The client can then use that PSK</td><td> </td><td class="right">   handshake (see Section 4.6.1).  The client can then use that PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   identity in future handshakes to negotiate the use of the associated</td><td> </td><td class="right">   identity in future handshakes to negotiate the use of the associated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSK.  If the server accepts the PSK, then the security context of the</td><td> </td><td class="right">   PSK.  If the server accepts the PSK, then the security context of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   new connection is cryptographically tied to the original connection</td><td> </td><td class="right">   new connection is cryptographically tied to the original connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and the key derived from the initial handshake is used to bootstrap</td><td> </td><td class="right">   and the key derived from the initial handshake is used to bootstrap</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the cryptographic state instead of a full handshake.  In TLS 1.2 and</td><td> </td><td class="right">   the cryptographic state instead of a full handshake.  In TLS 1.2 and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   below, this functionality was provided by "session IDs" and "session</td><td> </td><td class="right">   below, this functionality was provided by "session IDs" and "session</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   tickets" [RFC5077].  Both mechanisms are obsoleted in TLS 1.3.</td><td> </td><td class="right">   tickets" [RFC5077].  Both mechanisms are obsoleted in TLS 1.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSKs can be used with (EC)DHE key exchange in order to provide</td><td> </td><td class="right">   PSKs can be used with (EC)DHE key exchange in order to provide</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   forward secrecy in combination with shared keys, or can be used</td><td> </td><td class="right">   forward secrecy in combination with shared keys, or can be used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alone, at the cost of losing forward secrecy for the application</td><td> </td><td class="right">   alone, at the cost of losing forward secrecy for the application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   data.</td><td> </td><td class="right">   data.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Figure 3 shows a pair of handshakes in which the first establishes a</td><td> </td><td class="rblock">   Figure 3 shows a pair of handshakes in which the first <span class="insert">handshake</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   PSK and the second uses it:</td><td> </td><td class="rblock">   establishes a PSK and the second <span class="insert">handshake</span> uses it:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Client                                               Server</td><td> </td><td class="right">          Client                                               Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Initial Handshake:</td><td> </td><td class="right">   Initial Handshake:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ClientHello</td><td> </td><td class="right">          ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          + key_share               --------&gt;</td><td> </td><td class="right">          + key_share               --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                          ServerHello</td><td> </td><td class="right">                                                          ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                          + key_share</td><td> </td><td class="right">                                                          + key_share</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                {EncryptedExtensions}</td><td> </td><td class="right">                                                {EncryptedExtensions}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                {CertificateRequest*}</td><td> </td><td class="right">                                                {CertificateRequest*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 23, line 42</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 16, line 40</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          + pre_shared_key          --------&gt;</td><td> </td><td class="right">          + pre_shared_key          --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                          ServerHello</td><td> </td><td class="right">                                                          ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                     + pre_shared_key</td><td> </td><td class="right">                                                     + pre_shared_key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                         + key_share*</td><td> </td><td class="right">                                                         + key_share*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                {EncryptedExtensions}</td><td> </td><td class="right">                                                {EncryptedExtensions}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                           {Finished}</td><td> </td><td class="right">                                                           {Finished}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                    &lt;--------     [Application Data*]</td><td> </td><td class="right">                                    &lt;--------     [Application Data*]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          {Finished}                --------&gt;</td><td> </td><td class="right">          {Finished}                --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          [Application Data]        &lt;-------&gt;      [Application Data]</td><td> </td><td class="right">          [Application Data]        &lt;-------&gt;      [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               Figure 3: Message <span class="delete">flow for r</span>esumption and PSK</td><td> </td><td class="rblock">               Figure 3: Message <span class="insert">Flow for R</span>esumption and PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As the server is authenticating via a PSK, it does not send a</td><td> </td><td class="right">   As the server is authenticating via a PSK, it does not send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Certificate or a CertificateVerify message.  When a client offers</td><td> </td><td class="right">   Certificate or a CertificateVerify message.  When a client offers</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   resumption via PSK, it SHOULD also supply a "key_share" extension to</td><td> </td><td class="rblock">   resumption via <span class="insert">a</span> PSK, it SHOULD also supply a "key_share" extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the server to allow the server to decline resumption and fall back to</td><td> </td><td class="rblock">   to the server to allow the server to decline resumption and fall back</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   a full handshake, if needed.  The server responds with a</td><td> </td><td class="rblock">   to a full handshake, if needed.  The server responds with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "pre_shared_key" extension to negotiate use of PSK key establishment</td><td> </td><td class="rblock">   "pre_shared_key" extension to negotiate <span class="insert">the</span> use of PSK key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and can (as shown here) respond with a "key_share" extension to do</td><td> </td><td class="rblock">   establishment and can (as shown here) respond with a "key_share"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (EC)DHE key establishment, thus providing forward secrecy.</td><td> </td><td class="rblock">   extension to do (EC)DHE key establishment, thus providing forward</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   secrecy.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When PSKs are provisioned out of band, the PSK identity and the KDF</td><td> </td><td class="right">   When PSKs are provisioned out of band, the PSK identity and the KDF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   hash algorithm to be used with the PSK MUST also be provisioned.</td><td> </td><td class="right">   hash algorithm to be used with the PSK MUST also be provisioned.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note:  When using an out-of-band provisioned pre-shared secret, a</td><td> </td><td class="right">   Note:  When using an out-of-band provisioned pre-shared secret, a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      critical consideration is using sufficient entropy during the key</td><td> </td><td class="right">      critical consideration is using sufficient entropy during the key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      generation, as discussed in [RFC4086].  Deriving a shared secret</td><td> </td><td class="right">      generation, as discussed in [RFC4086].  Deriving a shared secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      from a password or other low-entropy sources is not secure.  A</td><td> </td><td class="right">      from a password or other low-entropy sources is not secure.  A</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      low-entropy secret, or password, is subject to dictionary attacks</td><td> </td><td class="right">      low-entropy secret, or password, is subject to dictionary attacks</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      based on the PSK binder.  The specified PSK authentication is not</td><td> </td><td class="right">      based on the PSK binder.  The specified PSK authentication is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 25, line 5</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 18, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When clients and servers share a PSK (either obtained externally or</td><td> </td><td class="right">   When clients and servers share a PSK (either obtained externally or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   via a previous handshake), TLS 1.3 allows clients to send data on the</td><td> </td><td class="right">   via a previous handshake), TLS 1.3 allows clients to send data on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   first flight ("early data").  The client uses the PSK to authenticate</td><td> </td><td class="right">   first flight ("early data").  The client uses the PSK to authenticate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server and to encrypt the early data.</td><td> </td><td class="right">   the server and to encrypt the early data.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As shown in Figure 4, the 0-RTT data is just added to the 1-RTT</td><td> </td><td class="right">   As shown in Figure 4, the 0-RTT data is just added to the 1-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake in the first flight.  The rest of the handshake uses the</td><td> </td><td class="right">   handshake in the first flight.  The rest of the handshake uses the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   same messages as for a 1-RTT handshake with PSK resumption.</td><td> </td><td class="right">   same messages as for a 1-RTT handshake with PSK resumption.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">         <span class="delete">   </span>Client                                               Server</td><td> </td><td class="rblock">         Client                                               Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            ClientHello</td><td> </td><td class="rblock">         ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            + early_data</td><td> </td><td class="rblock">         + early_data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            + key_share*</td><td> </td><td class="rblock">         + key_share*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            + psk_key_exchange_modes</td><td> </td><td class="rblock">         + psk_key_exchange_modes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            + pre_shared_key</td><td> </td><td class="rblock">         + pre_shared_key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            (Application Data*)     --------&gt;</td><td> </td><td class="rblock">         (Application Data*)     --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                            ServerHello</td><td> </td><td class="rblock">                                                         ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                       + pre_shared_key</td><td> </td><td class="rblock">                                                    + pre_shared_key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                           + key_share*</td><td> </td><td class="rblock">                                                        + key_share*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                  {EncryptedExtensions}</td><td> </td><td class="rblock">                                               {EncryptedExtensions}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                          + early_data*</td><td> </td><td class="rblock">                                                       + early_data*</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                             {Finished}</td><td> </td><td class="rblock">                                                          {Finished}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                    &lt;--------       [Application Data*]</td><td> </td><td class="rblock">                                 &lt;--------       [Application Data*]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            (EndOfEarlyData)</td><td> </td><td class="rblock">         (EndOfEarlyData)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            {Finished}              --------&gt;</td><td> </td><td class="rblock">         {Finished}              --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            [Application Data]      &lt;-------&gt;        [Application Data]</td><td> </td><td class="rblock">         [Application Data]      &lt;-------&gt;        [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  +  Indicates noteworthy extensions sent in the</td><td> </td><td class="rblock">               +  Indicates noteworthy extensions sent in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                     previously noted message.</td><td> </td><td class="rblock">                  previously noted message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0063" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  *  Indicates optional or situation-dependent</td><td> </td><td class="rblock">               *  Indicates optional or situation-dependent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                     messages/extensions that are not always sent.</td><td> </td><td class="rblock">                  messages/extensions that are not always sent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0064" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  () Indicates messages protected using keys</td><td> </td><td class="rblock">               () Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                     derived from client_early_traffic_secret.</td><td> </td><td class="rblock">                  derived from <span class="insert">a</span> client_early_traffic_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0065" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  {} Indicates messages protected using keys</td><td> </td><td class="rblock">               {} Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                     derived from a [sender]_handshake_traffic_secret.</td><td> </td><td class="rblock">                  derived from a [sender]_handshake_traffic_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0066" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  [] Indicates messages protected using keys</td><td> </td><td class="rblock">               [] Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                     derived from <span class="delete">[sender]_application_traffic_secret_N</span></td><td> </td><td class="rblock">                  derived from <span class="insert">[sender]_application_traffic_secret_N.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0067" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          <span class="delete">Figure 4: Message flow for a zero round trip h</span>andshake</td><td> </td><td class="rblock">          <span class="insert">     Figure 4: Message Flow for a 0-RTT H</span>andshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   IMPORTANT NOTE: The security properties for 0-RTT data are weaker</td><td> </td><td class="right">   IMPORTANT NOTE: The security properties for 0-RTT data are weaker</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   than those for other kinds of TLS data.  Specifically:</td><td> </td><td class="right">   than those for other kinds of TLS data.  Specifically:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   1.  This data is not forward secret, as it is encrypted solely under</td><td> </td><td class="right">   1.  This data is not forward secret, as it is encrypted solely under</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       keys derived using the offered PSK.</td><td> </td><td class="right">       keys derived using the offered PSK.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   2.  There are no guarantees of non-replay between connections.</td><td> </td><td class="right">   2.  There are no guarantees of non-replay between connections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Protection against replay for ordinary TLS 1.3 1-RTT data is</td><td> </td><td class="right">       Protection against replay for ordinary TLS 1.3 1-RTT data is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       provided via the server's Random value, but 0-RTT data does not</td><td> </td><td class="right">       provided via the server's Random value, but 0-RTT data does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       depend on the ServerHello and therefore has weaker guarantees.</td><td> </td><td class="right">       depend on the ServerHello and therefore has weaker guarantees.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       This is especially relevant if the data is authenticated either</td><td> </td><td class="right">       This is especially relevant if the data is authenticated either</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       with TLS client authentication or inside the application</td><td> </td><td class="right">       with TLS client authentication or inside the application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       protocol.  The same warnings apply to any use of the</td><td> </td><td class="right">       protocol.  The same warnings apply to any use of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       early_exporter_master_secret.</td><td> </td><td class="right">       early_exporter_master_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0-RTT data cannot be duplicated within a connection (i.e., the server</td><td> </td><td class="right">   0-RTT data cannot be duplicated within a connection (i.e., the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0068" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   will not process the same data twice for the same connection) and an</td><td> </td><td class="rblock">   will not process the same data twice for the same connection)<span class="insert">,</span> and an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attacker will not be able to make 0-RTT data appear to be 1-RTT data</td><td> </td><td class="right">   attacker will not be able to make 0-RTT data appear to be 1-RTT data</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0069" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (because it is protected with different <span class="delete">keys.)</span>  Appendix E.5 contains</td><td> </td><td class="rblock">   (because it is protected with different <span class="insert">keys).</span>  Appendix E.5 contains</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   a description of potential <span class="delete">attacks</span> and Section 8 describes mechanisms</td><td> </td><td class="rblock">   a description of potential <span class="insert">attacks,</span> and Section 8 describes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   which the server can use to limit the impact of replay.</td><td> </td><td class="rblock">   mechanisms which the server can use to limit the impact of replay.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.  Presentation Language</td><td> </td><td class="right">3.  Presentation Language</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document deals with the formatting of data in an external</td><td> </td><td class="right">   This document deals with the formatting of data in an external</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   representation.  The following very basic and somewhat casually</td><td> </td><td class="right">   representation.  The following very basic and somewhat casually</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   defined presentation syntax will be used.</td><td> </td><td class="right">   defined presentation syntax will be used.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.1.  Basic Block Size</td><td> </td><td class="right">3.1.  Basic Block Size</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The representation of all data items is explicitly specified.  The</td><td> </td><td class="right">   The representation of all data items is explicitly specified.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0070" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   basic data block size is one byte (i.e., 8 bits).  Multiple<span class="delete"> </span>byte data</td><td> </td><td class="rblock">   basic data block size is one byte (i.e., 8 bits).  Multiple<span class="insert">-</span>byte data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   items are concatenations of bytes, from left to right, from top to</td><td> </td><td class="right">   items are concatenations of bytes, from left to right, from top to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   bottom.  From the byte stream, a multi-byte item (a numeric in the</td><td> </td><td class="right">   bottom.  From the byte stream, a multi-byte item (a numeric in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0071" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   example) is formed (using C notation) by:</td><td> </td><td class="rblock">   <span class="insert">following </span>example) is formed (using C notation) by:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      value = (byte[0] &lt;&lt; 8*(n-1)) | (byte[1] &lt;&lt; 8*(n-2)) |</td><td> </td><td class="right">      value = (byte[0] &lt;&lt; 8*(n-1)) | (byte[1] &lt;&lt; 8*(n-2)) |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              ... | byte[n-1];</td><td> </td><td class="right">              ... | byte[n-1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This byte ordering for multi-byte values is the commonplace network</td><td> </td><td class="right">   This byte ordering for multi-byte values is the commonplace network</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   byte order or big-endian format.</td><td> </td><td class="right">   byte order or big-endian format.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.2.  Miscellaneous</td><td> </td><td class="right">3.2.  Miscellaneous</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Comments begin with "/*" and end with "*/".</td><td> </td><td class="right">   Comments begin with "/*" and end with "*/".</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0072" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Optional components are denoted by enclosing them in "[[ ]]" <span class="delete">double</span></td><td> </td><td class="rblock">   Optional components are denoted by enclosing them in "[[ ]]" <span class="insert">(double</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   brackets.</span></td><td> </td><td class="rblock"><span class="insert">   brackets).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0073" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Single-byte entities containing uninterpreted data are of type</td><td> </td><td class="rblock">   Single-byte entities containing uninterpreted data are of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   opaque.</td><td> </td><td class="rblock">   type opaque.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A type alias T' for an existing type T is defined by:</td><td> </td><td class="right">   A type alias T' for an existing type T is defined by:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      T T';</td><td> </td><td class="right">      T T';</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.3.  Numbers</td><td> </td><td class="right">3.3.  Numbers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The basic numeric data type is an unsigned byte (uint8).  All larger</td><td> </td><td class="right">   The basic numeric data type is an unsigned byte (uint8).  All larger</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0074" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   numeric data types are <span class="delete">formed</span> from fixed-length series of bytes</td><td> </td><td class="rblock">   numeric data types are <span class="insert">constructed</span> from <span class="insert">a</span> fixed-length series of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   concatenated as described in Section 3.1 and are also unsigned.  The</td><td> </td><td class="rblock">   bytes concatenated as described in Section 3.1 and are also unsigned.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   following numeric types are predefined.</td><td> </td><td class="rblock">   The following numeric types are predefined.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      uint8 uint16[2];</td><td> </td><td class="right">      uint8 uint16[2];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      uint8 uint24[3];</td><td> </td><td class="right">      uint8 uint24[3];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      uint8 uint32[4];</td><td> </td><td class="right">      uint8 uint32[4];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      uint8 uint64[8];</td><td> </td><td class="right">      uint8 uint64[8];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All values, here and elsewhere in the specification, are transmitted</td><td> </td><td class="right">   All values, here and elsewhere in the specification, are transmitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in network byte (big-endian) order; the uint32 represented by the hex</td><td> </td><td class="right">   in network byte (big-endian) order; the uint32 represented by the hex</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   bytes 01 02 03 04 is equivalent to the decimal value 16909060.</td><td> </td><td class="right">   bytes 01 02 03 04 is equivalent to the decimal value 16909060.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 27, line 41</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 21, line 10</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Here, T' occupies n bytes in the data stream, where n is a multiple</td><td> </td><td class="right">   Here, T' occupies n bytes in the data stream, where n is a multiple</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the size of T.  The length of the vector is not included in the</td><td> </td><td class="right">   of the size of T.  The length of the vector is not included in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   encoded stream.</td><td> </td><td class="right">   encoded stream.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the following example, Datum is defined to be three consecutive</td><td> </td><td class="right">   In the following example, Datum is defined to be three consecutive</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   bytes that the protocol does not interpret, while Data is three</td><td> </td><td class="right">   bytes that the protocol does not interpret, while Data is three</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   consecutive Datum, consuming a total of nine bytes.</td><td> </td><td class="right">   consecutive Datum, consuming a total of nine bytes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      opaque Datum[3];      /* three uninterpreted bytes */</td><td> </td><td class="right">      opaque Datum[3];      /* three uninterpreted bytes */</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0075" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Datum Data[9];        /* <span class="delete">3</span> consecutive 3-byte vectors */</td><td> </td><td class="rblock">      Datum Data[9];        /* <span class="insert">three</span> consecutive 3-byte vectors */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Variable-length vectors are defined by specifying a subrange of legal</td><td> </td><td class="right">   Variable-length vectors are defined by specifying a subrange of legal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   lengths, inclusively, using the notation &lt;floor..ceiling&gt;.  When</td><td> </td><td class="right">   lengths, inclusively, using the notation &lt;floor..ceiling&gt;.  When</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   these are encoded, the actual length precedes the vector's contents</td><td> </td><td class="right">   these are encoded, the actual length precedes the vector's contents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in the byte stream.  The length will be in the form of a number</td><td> </td><td class="right">   in the byte stream.  The length will be in the form of a number</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   consuming as many bytes as required to hold the vector's specified</td><td> </td><td class="right">   consuming as many bytes as required to hold the vector's specified</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   maximum (ceiling) length.  A variable-length vector with an actual</td><td> </td><td class="right">   maximum (ceiling) length.  A variable-length vector with an actual</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   length field of zero is referred to as an empty vector.</td><td> </td><td class="right">   length field of zero is referred to as an empty vector.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      T T'&lt;floor..ceiling&gt;;</td><td> </td><td class="right">      T T'&lt;floor..ceiling&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0076" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   In the following example, <span class="delete">mandatory</span> is a vector that must contain</td><td> </td><td class="rblock">   In the following example, <span class="insert">"mandatory"</span> is a vector that must contain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   between 300 and 400 bytes of type opaque.  It can never be empty.</td><td> </td><td class="right">   between 300 and 400 bytes of type opaque.  It can never be empty.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The actual length field consumes two bytes, a uint16, which is</td><td> </td><td class="right">   The actual length field consumes two bytes, a uint16, which is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sufficient to represent the value 400 (see Section 3.3).  Similarly,</td><td> </td><td class="right">   sufficient to represent the value 400 (see Section 3.3).  Similarly,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0077" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">longer</span> can represent up to 800 bytes of data, or 400 uint16 elements,</td><td> </td><td class="rblock">   <span class="insert">"longer"</span> can represent up to 800 bytes of data, or 400 uint16</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and it may be empty.  Its encoding will include a two-byte actual</td><td> </td><td class="rblock">   elements, and it may be empty.  Its encoding will include a two-byte</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   length field prepended to the vector.  The length of an encoded</td><td> </td><td class="rblock">   actual length field prepended to the vector.  The length of an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   vector must be an exact multiple of the length of a single element</td><td> </td><td class="rblock">   encoded vector must be an exact multiple of the length of a single</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (e.g., a 17-byte vector of uint16 would be illegal).</td><td> </td><td class="rblock">   element (e.g., a 17-byte vector of uint16 would be illegal).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      opaque mandatory&lt;300..400&gt;;</td><td> </td><td class="right">      opaque mandatory&lt;300..400&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0078" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            /* length field is <span class="delete">2</span> bytes, cannot be empty */</td><td> </td><td class="rblock">            /* length field is <span class="insert">two</span> bytes, cannot be empty */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      uint16 longer&lt;0..800&gt;;</td><td> </td><td class="right">      uint16 longer&lt;0..800&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            /* zero to 400 16-bit unsigned integers */</td><td> </td><td class="right">            /* zero to 400 16-bit unsigned integers */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.5.  Enumerateds</td><td> </td><td class="right">3.5.  Enumerateds</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0079" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   An additional sparse data <span class="delete">type is available</span> called <span class="delete">enum</span> or</td><td> </td><td class="rblock">   An additional sparse data <span class="insert">type,</span> called <span class="insert">"enum"</span> or <span class="insert">"enumerated", is</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">enumerated.</span>  Each definition is a different type.  Only enumerateds</td><td> </td><td class="rblock"><span class="insert">   available.</span>  Each definition is a different type.  Only enumerateds of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   of the same type may be assigned or compared.  Every element of an</td><td> </td><td class="rblock">   the same type may be assigned or compared.  Every element of an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   enumerated must be assigned a value, as demonstrated in the following</td><td> </td><td class="right">   enumerated must be assigned a value, as demonstrated in the following</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   example.  Since the elements of the enumerated are not ordered, they</td><td> </td><td class="right">   example.  Since the elements of the enumerated are not ordered, they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   can be assigned any unique value, in any order.</td><td> </td><td class="right">   can be assigned any unique value, in any order.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum { e1(v1), e2(v2), ... , en(vn) [[, (n)]] } Te;</td><td> </td><td class="right">      enum { e1(v1), e2(v2), ... , en(vn) [[, (n)]] } Te;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Future extensions or additions to the protocol may define new values.</td><td> </td><td class="right">   Future extensions or additions to the protocol may define new values.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations need to be able to parse and ignore unknown values</td><td> </td><td class="right">   Implementations need to be able to parse and ignore unknown values</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unless the definition of the field states otherwise.</td><td> </td><td class="right">   unless the definition of the field states otherwise.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> page 29, line 22</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> page 22, line 41</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   applies.  The value includes the minimum and maximum inclusive values</td><td> </td><td class="right">   applies.  The value includes the minimum and maximum inclusive values</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in that range, separated by two period characters.  This is</td><td> </td><td class="right">   in that range, separated by two period characters.  This is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   principally useful for reserving regions of the space.</td><td> </td><td class="right">   principally useful for reserving regions of the space.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum { sad(0), meh(1..254), happy(255) } Mood;</td><td> </td><td class="right">      enum { sad(0), meh(1..254), happy(255) } Mood;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.6.  Constructed Types</td><td> </td><td class="right">3.6.  Constructed Types</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure types may be constructed from primitive types for</td><td> </td><td class="right">   Structure types may be constructed from primitive types for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   convenience.  Each specification declares a new, unique type.  The</td><td> </td><td class="right">   convenience.  Each specification declares a new, unique type.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0080" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   syntax <span class="delete">for definition</span> is much like that of C.</td><td> </td><td class="rblock">   syntax <span class="insert">used for definitions</span> is much like that of C.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          T1 f1;</td><td> </td><td class="right">          T1 f1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          T2 f2;</td><td> </td><td class="right">          T2 f2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ...</td><td> </td><td class="right">          ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Tn fn;</td><td> </td><td class="right">          Tn fn;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } T;</td><td> </td><td class="right">      } T;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Fixed- and variable-length vector fields are allowed using the</td><td> </td><td class="right">   Fixed- and variable-length vector fields are allowed using the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   standard vector syntax.  Structures V1 and V2 in the variants example</td><td> </td><td class="right">   standard vector syntax.  Structures V1 and V2 in the variants example</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0081" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">below</span> demonstrate this.</td><td> </td><td class="rblock">   <span class="insert">(Section 3.8)</span> demonstrate this.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The fields within a structure may be qualified using the type's name,</td><td> </td><td class="right">   The fields within a structure may be qualified using the type's name,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with a syntax much like that available for enumerateds.  For example,</td><td> </td><td class="right">   with a syntax much like that available for enumerateds.  For example,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   T.f2 refers to the second field of the previous declaration.</td><td> </td><td class="right">   T.f2 refers to the second field of the previous declaration.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.7.  Constants</td><td> </td><td class="right">3.7.  Constants</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Fields and variables may be assigned a fixed value using "=", as in:</td><td> </td><td class="right">   Fields and variables may be assigned a fixed value using "=", as in:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          T1 f1 = 8;  /* T.f1 must always be 8 */</td><td> </td><td class="right">          T1 f1 = 8;  /* T.f1 must always be 8 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          T2 f2;</td><td> </td><td class="right">          T2 f2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } T;</td><td> </td><td class="right">      } T;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">3.8.  Variants</td><td> </td><td class="right">3.8.  Variants</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Defined structures may have variants based on some knowledge that is</td><td> </td><td class="right">   Defined structures may have variants based on some knowledge that is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   available within the environment.  The selector must be an enumerated</td><td> </td><td class="right">   available within the environment.  The selector must be an enumerated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   type that defines the possible variants the structure defines.  Each</td><td> </td><td class="right">   type that defines the possible variants the structure defines.  Each</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0082" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   arm of the select specifies the type of that variant's field and an</td><td> </td><td class="rblock">   arm of the select <span class="insert">(below)</span> specifies the type of that variant's field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   optional field label.  The mechanism by which the variant is selected</td><td> </td><td class="rblock">   and an optional field label.  The mechanism by which the variant is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   at runtime is not prescribed by the presentation language.</td><td> </td><td class="rblock">   selected at runtime is not prescribed by the presentation language.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          T1 f1;</td><td> </td><td class="right">          T1 f1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          T2 f2;</td><td> </td><td class="right">          T2 f2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ....</td><td> </td><td class="right">          ....</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Tn fn;</td><td> </td><td class="right">          Tn fn;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (E) {</td><td> </td><td class="right">          select (E) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case e1: Te1 [[fe1]];</td><td> </td><td class="right">              case e1: Te1 [[fe1]];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case e2: Te2 [[fe2]];</td><td> </td><td class="right">              case e2: Te2 [[fe2]];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              ....</td><td> </td><td class="right">              ....</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> page 31, line 10</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> page 24, line 32</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case apple:  V1;</td><td> </td><td class="right">              case apple:  V1;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case orange: V2;</td><td> </td><td class="right">              case orange: V2;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          };</td><td> </td><td class="right">          };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } VariantRecord;</td><td> </td><td class="right">      } VariantRecord;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.  Handshake Protocol</td><td> </td><td class="right">4.  Handshake Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The handshake protocol is used to negotiate the security parameters</td><td> </td><td class="right">   The handshake protocol is used to negotiate the security parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of a connection.  Handshake messages are supplied to the TLS record</td><td> </td><td class="right">   of a connection.  Handshake messages are supplied to the TLS record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   layer, where they are encapsulated within one or more TLSPlaintext or</td><td> </td><td class="right">   layer, where they are encapsulated within one or more TLSPlaintext or</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0083" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLSCiphertext structures<span class="delete">,</span> which are processed and transmitted as</td><td> </td><td class="rblock">   TLSCiphertext structures which are processed and transmitted as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specified by the current active connection state.</td><td> </td><td class="right">   specified by the current active connection state.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          client_hello(1),</td><td> </td><td class="right">          client_hello(1),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          server_hello(2),</td><td> </td><td class="right">          server_hello(2),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          new_session_ticket(4),</td><td> </td><td class="right">          new_session_ticket(4),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          end_of_early_data(5),</td><td> </td><td class="right">          end_of_early_data(5),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          encrypted_extensions(8),</td><td> </td><td class="right">          encrypted_extensions(8),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate(11),</td><td> </td><td class="right">          certificate(11),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate_request(13),</td><td> </td><td class="right">          certificate_request(13),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate_verify(15),</td><td> </td><td class="right">          certificate_verify(15),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          finished(20),</td><td> </td><td class="right">          finished(20),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          key_update(24),</td><td> </td><td class="right">          key_update(24),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          message_hash(254),</td><td> </td><td class="right">          message_hash(254),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (255)</td><td> </td><td class="right">          (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } HandshakeType;</td><td> </td><td class="right">      } HandshakeType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          HandshakeType msg_type;    /* handshake type */</td><td> </td><td class="right">          HandshakeType msg_type;    /* handshake type */</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0084" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          uint24 length;             /* bytes in message */</td><td> </td><td class="rblock">          uint24 length;             /* <span class="insert">remaining </span>bytes in message */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (Handshake.msg_type) {</td><td> </td><td class="right">          select (Handshake.msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case client_hello:          ClientHello;</td><td> </td><td class="right">              case client_hello:          ClientHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case server_hello:          ServerHello;</td><td> </td><td class="right">              case server_hello:          ServerHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case end_of_early_data:     EndOfEarlyData;</td><td> </td><td class="right">              case end_of_early_data:     EndOfEarlyData;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case encrypted_extensions:  EncryptedExtensions;</td><td> </td><td class="right">              case encrypted_extensions:  EncryptedExtensions;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate_request:   CertificateRequest;</td><td> </td><td class="right">              case certificate_request:   CertificateRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate:           Certificate;</td><td> </td><td class="right">              case certificate:           Certificate;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate_verify:    CertificateVerify;</td><td> </td><td class="right">              case certificate_verify:    CertificateVerify;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case finished:              Finished;</td><td> </td><td class="right">              case finished:              Finished;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case new_session_ticket:    NewSessionTicket;</td><td> </td><td class="right">              case new_session_ticket:    NewSessionTicket;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> page 32, line 9</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> page 25, line 49</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake message in an unexpected order MUST abort the handshake</td><td> </td><td class="right">   handshake message in an unexpected order MUST abort the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with an "unexpected_message" alert.</td><td> </td><td class="right">   with an "unexpected_message" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New handshake message types are assigned by IANA as described in</td><td> </td><td class="right">   New handshake message types are assigned by IANA as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 11.</td><td> </td><td class="right">   Section 11.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.1.  Key Exchange Messages</td><td> </td><td class="right">4.1.  Key Exchange Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The key exchange messages are used to determine the security</td><td> </td><td class="right">   The key exchange messages are used to determine the security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   capabilities of the client and the server and to establish shared</td><td> </td><td class="right">   capabilities of the client and the server and to establish shared</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0085" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   secrets including the traffic keys used to protect the rest of the</td><td> </td><td class="rblock">   secrets<span class="insert">,</span> including the traffic keys used to protect the rest of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake and the data.</td><td> </td><td class="right">   handshake and the data.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.1.1.  Cryptographic Negotiation</td><td> </td><td class="right">4.1.1.  Cryptographic Negotiation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In TLS, the cryptographic negotiation proceeds by the client offering</td><td> </td><td class="right">   In TLS, the cryptographic negotiation proceeds by the client offering</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the following four sets of options in its ClientHello:</td><td> </td><td class="right">   the following four sets of options in its ClientHello:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A list of cipher suites which indicates the AEAD algorithm/HKDF</td><td> </td><td class="right">   -  A list of cipher suites which indicates the AEAD algorithm/HKDF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      hash pairs which the client supports.</td><td> </td><td class="right">      hash pairs which the client supports.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A "supported_groups" (Section 4.2.7) extension which indicates the</td><td> </td><td class="right">   -  A "supported_groups" (Section 4.2.7) extension which indicates the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (EC)DHE groups which the client supports and a "key_share"</td><td> </td><td class="right">      (EC)DHE groups which the client supports and a "key_share"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (Section 4.2.8) extension which contains (EC)DHE shares for some</td><td> </td><td class="right">      (Section 4.2.8) extension which contains (EC)DHE shares for some</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      or all of these groups.</td><td> </td><td class="right">      or all of these groups.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A "signature_algorithms" (Section 4.2.3) extension which indicates</td><td> </td><td class="right">   -  A "signature_algorithms" (Section 4.2.3) extension which indicates</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0086" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the signature algorithms which the client can accept.</td><td> </td><td class="rblock">      the signature algorithms which the client can accept.  <span class="insert">A</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      "signature_algorithms_cert" extension (Section 4.2.3) may also be</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      added to indicate certificate-specific signature algorithms.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A "pre_shared_key" (Section 4.2.11) extension which contains a</td><td> </td><td class="right">   -  A "pre_shared_key" (Section 4.2.11) extension which contains a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      list of symmetric key identities known to the client and a</td><td> </td><td class="right">      list of symmetric key identities known to the client and a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "psk_key_exchange_modes" (Section 4.2.9) extension which indicates</td><td> </td><td class="right">      "psk_key_exchange_modes" (Section 4.2.9) extension which indicates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the key exchange modes that may be used with PSKs.</td><td> </td><td class="right">      the key exchange modes that may be used with PSKs.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server does not select a PSK, then the first three of these</td><td> </td><td class="right">   If the server does not select a PSK, then the first three of these</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   options are entirely orthogonal: the server independently selects a</td><td> </td><td class="right">   options are entirely orthogonal: the server independently selects a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher suite, an (EC)DHE group and key share for key establishment,</td><td> </td><td class="right">   cipher suite, an (EC)DHE group and key share for key establishment,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and a signature algorithm/certificate pair to authenticate itself to</td><td> </td><td class="right">   and a signature algorithm/certificate pair to authenticate itself to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client.  If there is no overlap between the received</td><td> </td><td class="right">   the client.  If there is no overlap between the received</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0087" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "supported_groups" and the groups supported by the server then the</td><td> </td><td class="rblock">   "supported_groups" and the groups supported by the server<span class="insert">,</span> then the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server MUST abort the handshake with a "handshake_failure" or an</td><td> </td><td class="right">   server MUST abort the handshake with a "handshake_failure" or an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "insufficient_security" alert.</td><td> </td><td class="right">   "insufficient_security" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server selects a PSK, then it MUST also select a key</td><td> </td><td class="right">   If the server selects a PSK, then it MUST also select a key</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0088" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   establishment mode from the set indicated by client's</td><td> </td><td class="rblock">   establishment mode from the set indicated by <span class="insert">the </span>client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "psk_key_exchange_modes" extension (at present, PSK alone or with</td><td> </td><td class="right">   "psk_key_exchange_modes" extension (at present, PSK alone or with</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0089" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (EC)DHE).  Note that if the PSK can be used without <span class="delete">(EC)DHE</span> then <span class="delete">non-</span></td><td> </td><td class="rblock">   (EC)DHE).  Note that if the PSK can be used without <span class="insert">(EC)DHE,</span> then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   overlap</span> in the "supported_groups" parameters need not be fatal, as it</td><td> </td><td class="rblock">   <span class="insert">non-overlap</span> in the "supported_groups" parameters need not be fatal,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   is in the non-PSK case discussed in the previous paragraph.</td><td> </td><td class="rblock">   as it is in the non-PSK case discussed in the previous paragraph.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server selects an (EC)DHE group and the client did not offer a</td><td> </td><td class="right">   If the server selects an (EC)DHE group and the client did not offer a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compatible "key_share" extension in the initial ClientHello, the</td><td> </td><td class="right">   compatible "key_share" extension in the initial ClientHello, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server MUST respond with a HelloRetryRequest (Section 4.1.4) message.</td><td> </td><td class="right">   server MUST respond with a HelloRetryRequest (Section 4.1.4) message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server successfully selects parameters and does not require a</td><td> </td><td class="right">   If the server successfully selects parameters and does not require a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest, it indicates the selected parameters in the</td><td> </td><td class="right">   HelloRetryRequest, it indicates the selected parameters in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello as follows:</td><td> </td><td class="right">   ServerHello as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  If PSK is being used, then the server will send a "pre_shared_key"</td><td> </td><td class="right">   -  If PSK is being used, then the server will send a "pre_shared_key"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extension indicating the selected key.</td><td> </td><td class="right">      extension indicating the selected key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0090" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  If PSK is not being used, then (EC)DHE and certificate-based</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      authentication are always used.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When (EC)DHE is in use, the server will also provide a "key_share"</td><td> </td><td class="right">   -  When (EC)DHE is in use, the server will also provide a "key_share"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0091" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      extension.</td><td> </td><td class="rblock">      extension.  <span class="insert">If PSK is not being used, then (EC)DHE and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      certificate-based authentication are always used.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When authenticating via a certificate, the server will send the</td><td> </td><td class="right">   -  When authenticating via a certificate, the server will send the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificate (Section 4.4.2) and CertificateVerify (Section 4.4.3)</td><td> </td><td class="right">      Certificate (Section 4.4.2) and CertificateVerify (Section 4.4.3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      messages.  In TLS 1.3 as defined by this document, either a PSK or</td><td> </td><td class="right">      messages.  In TLS 1.3 as defined by this document, either a PSK or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      a certificate is always used, but not both.  Future documents may</td><td> </td><td class="right">      a certificate is always used, but not both.  Future documents may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      define how to use them together.</td><td> </td><td class="right">      define how to use them together.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server is unable to negotiate a supported set of parameters</td><td> </td><td class="right">   If the server is unable to negotiate a supported set of parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (i.e., there is no overlap between the client and server parameters),</td><td> </td><td class="right">   (i.e., there is no overlap between the client and server parameters),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it MUST abort the handshake with either a "handshake_failure" or</td><td> </td><td class="right">   it MUST abort the handshake with either a "handshake_failure" or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "insufficient_security" fatal alert (see Section 6).</td><td> </td><td class="right">   "insufficient_security" fatal alert (see Section 6).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.1.2.  Client Hello</td><td> </td><td class="right">4.1.2.  Client Hello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When a client first connects to a server, it is REQUIRED to send the</td><td> </td><td class="right">   When a client first connects to a server, it is REQUIRED to send the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello as its first TLS message.  The client will also send a</td><td> </td><td class="right">   ClientHello as its first TLS message.  The client will also send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello when the server has responded to its ClientHello with a</td><td> </td><td class="right">   ClientHello when the server has responded to its ClientHello with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest.  In that case, the client MUST send the same</td><td> </td><td class="right">   HelloRetryRequest.  In that case, the client MUST send the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0092" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ClientHello without modification, except:</td><td> </td><td class="rblock">   ClientHello without modification, except<span class="insert"> as follows</span>:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  If a "key_share" extension was supplied in the HelloRetryRequest,</td><td> </td><td class="right">   -  If a "key_share" extension was supplied in the HelloRetryRequest,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      replacing the list of shares with a list containing a single</td><td> </td><td class="right">      replacing the list of shares with a list containing a single</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      KeyShareEntry from the indicated group.</td><td> </td><td class="right">      KeyShareEntry from the indicated group.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Removing the "early_data" extension (Section 4.2.10) if one was</td><td> </td><td class="right">   -  Removing the "early_data" extension (Section 4.2.10) if one was</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0093" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      present.  Early data is not permitted after HelloRetryRequest.</td><td> </td><td class="rblock">      present.  Early data is not permitted after <span class="insert">a </span>HelloRetryRequest.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Including a "cookie" extension if one was provided in the</td><td> </td><td class="right">   -  Including a "cookie" extension if one was provided in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      HelloRetryRequest.</td><td> </td><td class="right">      HelloRetryRequest.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Updating the "pre_shared_key" extension if present by recomputing</td><td> </td><td class="right">   -  Updating the "pre_shared_key" extension if present by recomputing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the "obfuscated_ticket_age" and binder values and (optionally)</td><td> </td><td class="right">      the "obfuscated_ticket_age" and binder values and (optionally)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      removing any PSKs which are incompatible with the server's</td><td> </td><td class="right">      removing any PSKs which are incompatible with the server's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      indicated cipher suite.</td><td> </td><td class="right">      indicated cipher suite.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Optionally adding, removing, or changing the length of the</td><td> </td><td class="right">   -  Optionally adding, removing, or changing the length of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "padding" extension [RFC7685].</td><td> </td><td class="right">      "padding" extension [RFC7685].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Other modifications that may be allowed by an extension defined in</td><td> </td><td class="right">   -  Other modifications that may be allowed by an extension defined in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the future and present in the HelloRetryRequest.</td><td> </td><td class="right">      the future and present in the HelloRetryRequest.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0094" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Because TLS 1.3 forbids renegotiation, if a server has negotiated TLS</td><td> </td><td class="rblock">   Because TLS 1.3 forbids renegotiation, if a server has negotiated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3 and receives a ClientHello at any other time, it MUST terminate</td><td> </td><td class="rblock">   TLS 1.3 and receives a ClientHello at any other time, it MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the connection with an "unexpected_message" alert.</td><td> </td><td class="rblock">   terminate the connection with an "unexpected_message" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If a server established a TLS connection with a previous version of</td><td> </td><td class="right">   If a server established a TLS connection with a previous version of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS and receives a TLS 1.3 ClientHello in a renegotiation, it MUST</td><td> </td><td class="right">   TLS and receives a TLS 1.3 ClientHello in a renegotiation, it MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   retain the previous protocol version.  In particular, it MUST NOT</td><td> </td><td class="right">   retain the previous protocol version.  In particular, it MUST NOT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiate TLS 1.3.</td><td> </td><td class="right">   negotiate TLS 1.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      uint16 ProtocolVersion;</td><td> </td><td class="right">      uint16 ProtocolVersion;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      opaque Random[32];</td><td> </td><td class="right">      opaque Random[32];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> page 34, line 36</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> page 29, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ProtocolVersion legacy_version = 0x0303;    /* TLS v1.2 */</td><td> </td><td class="right">          ProtocolVersion legacy_version = 0x0303;    /* TLS v1.2 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Random random;</td><td> </td><td class="right">          Random random;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque legacy_session_id&lt;0..32&gt;;</td><td> </td><td class="right">          opaque legacy_session_id&lt;0..32&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          CipherSuite cipher_suites&lt;2..2^16-2&gt;;</td><td> </td><td class="right">          CipherSuite cipher_suites&lt;2..2^16-2&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque legacy_compression_methods&lt;1..2^8-1&gt;;</td><td> </td><td class="right">          opaque legacy_compression_methods&lt;1..2^8-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;8..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;8..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ClientHello;</td><td> </td><td class="right">      } ClientHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0095" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   legacy_version  In previous versions of TLS, this field was used for</td><td> </td><td class="rblock">   legacy_version<span class="insert">:</span>  In previous versions of TLS, this field was used for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      version negotiation and represented the highest version number</td><td> </td><td class="right">      version negotiation and represented the highest version number</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      supported by the client.  Experience has shown that many servers</td><td> </td><td class="right">      supported by the client.  Experience has shown that many servers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      do not properly implement version negotiation, leading to "version</td><td> </td><td class="right">      do not properly implement version negotiation, leading to "version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      intolerance" in which the server rejects an otherwise acceptable</td><td> </td><td class="right">      intolerance" in which the server rejects an otherwise acceptable</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0096" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ClientHello with a version number higher than it supports.  In TLS</td><td> </td><td class="rblock">      ClientHello with a version number higher than it supports.  In</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.3, the client indicates its version preferences in the</td><td> </td><td class="rblock">      TLS 1.3, the client indicates its version preferences in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "supported_versions" extension (Section 4.2.1) and the</td><td> </td><td class="right">      "supported_versions" extension (Section 4.2.1) and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      legacy_version field MUST be set to 0x0303, which is the version</td><td> </td><td class="right">      legacy_version field MUST be set to 0x0303, which is the version</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0097" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      number for TLS 1.2.  (See Appendix D for details about backward</td><td> </td><td class="rblock">      number for TLS 1.2.  <span class="insert">TLS 1.3 ClientHellos are identified as having</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      compatibility.)</td><td> </td><td class="rblock"><span class="insert">      a legacy_version of 0x0303 and a supported_versions extension</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      present with 0x0304 as the highest version indicated therein.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      (See Appendix D for details about backward compatibility.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0098" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   random  32 bytes generated by a secure random number generator.  See</td><td> </td><td class="rblock">   random<span class="insert">:</span>  32 bytes generated by a secure random number generator.  See</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Appendix C for additional information.</td><td> </td><td class="right">      Appendix C for additional information.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0099" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">legacy_session_id</span>  Versions of TLS before TLS 1.3 supported a</td><td> </td><td class="rblock">   <span class="insert">legacy_session_id:</span>  Versions of TLS before TLS 1.3 supported a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "session resumption" feature which has been merged with <span class="delete">Pre-Shared</span></td><td> </td><td class="rblock">      "session resumption" feature which has been merged with <span class="insert">pre-shared</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Keys</span> in this version (see Section 2.2).  A client which has a</td><td> </td><td class="rblock"><span class="insert">      keys</span> in this version (see Section 2.2).  A client which has a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      cached session ID set by a pre-TLS 1.3 server SHOULD set this</td><td> </td><td class="right">      cached session ID set by a pre-TLS 1.3 server SHOULD set this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0100" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      field to that value.  In compatibility mode (see Appendix <span class="delete">D.4)</span></td><td> </td><td class="rblock">      field to that value.  In compatibility mode (see Appendix <span class="insert">D.4),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      this field MUST be non-empty, so a client not offering a pre-TLS</td><td> </td><td class="rblock">      this field MUST be non-empty, so a client not offering a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.3 session MUST generate a new 32-byte value.  This value need</td><td> </td><td class="rblock">      pre-TLS 1.3 session MUST generate a new 32-byte value.  This value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      not be random but SHOULD be unpredictable to avoid implementations</td><td> </td><td class="rblock">      need not be random but SHOULD be unpredictable to avoid</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      fixating on a specific value (also known as ossification).</td><td> </td><td class="rblock">      implementations fixating on a specific value (also known as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Otherwise, it MUST be set as a <span class="delete">zero length</span> vector (i.e., a single</td><td> </td><td class="rblock">      ossification).  Otherwise, it MUST be set as a <span class="insert">zero-length</span> vector</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">zero</span> byte length field).</td><td> </td><td class="rblock">      (i.e., a <span class="insert">zero-valued</span> single byte length field).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0101" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">cipher_suites  This is a</span> list of the symmetric cipher options</td><td> </td><td class="rblock">   <span class="insert">cipher_suites:  A</span> list of the symmetric cipher options supported by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      supported by the client, specifically the record protection</td><td> </td><td class="rblock">      the client, specifically the record protection algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      algorithm (including secret key length) and a hash to be used with</td><td> </td><td class="rblock">      (including secret key length) and a hash to be used with HKDF, in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      HKDF, in descending order of client preference.  If the list</td><td> </td><td class="rblock">      descending order of client preference.  <span class="insert">Values are defined in</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      contains cipher suites that the server does not recognize, <span class="delete">support</span></td><td> </td><td class="rblock"><span class="insert">      Appendix B.4.</span>  If the list contains cipher suites that the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      or wish to use, the server MUST ignore those cipher suites and</td><td> </td><td class="rblock">      does not recognize, <span class="insert">support,</span> or wish to use, the server MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      process the remaining ones as usual.  <span class="delete">Values are defined in</span></td><td> </td><td class="rblock">      ignore those cipher suites and process the remaining ones as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Appendix B.4.</span>  If the client is attempting a PSK key</td><td> </td><td class="rblock">      usual.  If the client is attempting a PSK key establishment, it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      establishment, it SHOULD advertise at least one cipher suite</td><td> </td><td class="rblock">      SHOULD advertise at least one cipher suite indicating a Hash</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      indicating a Hash associated with the PSK.</td><td> </td><td class="rblock">      associated with the PSK.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0102" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   legacy_compression_methods  Versions of TLS before 1.3 supported</td><td> </td><td class="rblock">   legacy_compression_methods<span class="insert">:</span>  Versions of TLS before 1.3 supported</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compression with the list of supported compression methods being</td><td> </td><td class="right">      compression with the list of supported compression methods being</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      sent in this field.  For every TLS 1.3 ClientHello, this vector</td><td> </td><td class="right">      sent in this field.  For every TLS 1.3 ClientHello, this vector</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MUST contain exactly one byte, set to zero, which corresponds to</td><td> </td><td class="right">      MUST contain exactly one byte, set to zero, which corresponds to</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0103" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the "null" compression method in prior versions of TLS.  If a TLS</td><td> </td><td class="rblock">      the "null" compression method in prior versions of TLS.  If a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.3 ClientHello is received with any other value in this field,</td><td> </td><td class="rblock">      TLS 1.3 ClientHello is received with any other value in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the server MUST abort the handshake with an "illegal_parameter"</td><td> </td><td class="rblock">      field, the server MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      alert.  Note that TLS 1.3 servers might receive TLS 1.2 or prior</td><td> </td><td class="rblock">      "illegal_parameter" alert.  Note that TLS 1.3 servers might</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ClientHellos which contain other compression methods and (if</td><td> </td><td class="rblock">      receive TLS 1.2 or prior ClientHellos which contain other</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      negotiating such a prior version) MUST follow the procedures for</td><td> </td><td class="rblock">      compression methods and (if negotiating such a prior version) MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the appropriate prior version of TLS.  <span class="delete">TLS 1.3 ClientHellos are</span></td><td> </td><td class="rblock">      follow the procedures for the appropriate prior version of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      identified as having a legacy_version of 0x0303 and a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      supported_versions extension present with 0x0304 as the highest</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      version indicated therein.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0104" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extensions  Clients request extended functionality from servers by</td><td> </td><td class="rblock">   extensions<span class="insert">:</span>  Clients request extended functionality from servers by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      sending data in the extensions field.  The actual "Extension"</td><td> </td><td class="right">      sending data in the extensions field.  The actual "Extension"</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0105" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      format is defined in Section 4.2.  In TLS 1.3, use of certain</td><td> </td><td class="rblock">      format is defined in Section 4.2.  In TLS 1.3, <span class="insert">the</span> use of certain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      extensions is mandatory, as functionality <span class="delete">is</span> moved into extensions</td><td> </td><td class="rblock">      extensions is mandatory, as functionality <span class="insert">has</span> moved into</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      to preserve ClientHello compatibility with previous versions of</td><td> </td><td class="rblock">      extensions to preserve ClientHello compatibility with previous</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      TLS.  Servers MUST ignore unrecognized extensions.</td><td> </td><td class="rblock">      versions of TLS.  Servers MUST ignore unrecognized extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All versions of TLS allow an extensions field to optionally follow</td><td> </td><td class="right">   All versions of TLS allow an extensions field to optionally follow</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the compression_methods field.  TLS 1.3 ClientHello messages always</td><td> </td><td class="right">   the compression_methods field.  TLS 1.3 ClientHello messages always</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0106" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   contain extensions (minimally "supported_versions", <span class="delete">otherwise</span> they</td><td> </td><td class="rblock">   contain extensions (minimally "supported_versions", <span class="insert">otherwise,</span> they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   will be interpreted as TLS 1.2 ClientHello messages).  However, TLS</td><td> </td><td class="rblock">   will be interpreted as TLS 1.2 ClientHello messages).  However,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3 servers might receive ClientHello messages without an extensions</td><td> </td><td class="rblock">   TLS 1.3 servers might receive ClientHello messages without an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   field from prior versions of TLS.  The presence of extensions can be</td><td> </td><td class="rblock">   extensions field from prior versions of TLS.  The presence of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   detected by determining whether there are bytes following the</td><td> </td><td class="rblock">   extensions can be detected by determining whether there are bytes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   compression_methods field at the end of the ClientHello.  Note that</td><td> </td><td class="rblock">   following the compression_methods field at the end of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   this method of detecting optional data differs from the normal TLS</td><td> </td><td class="rblock">   ClientHello.  Note that this method of detecting optional data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   method of having a variable-length field, but it is used for</td><td> </td><td class="rblock">   differs from the normal TLS method of having a variable-length field,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   compatibility with TLS before extensions were defined.  TLS 1.3</td><td> </td><td class="rblock">   but it is used for compatibility with TLS before extensions were</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   servers will need to perform this check first and only attempt to</td><td> </td><td class="rblock">   defined.  TLS 1.3 servers will need to perform this check first and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   negotiate TLS 1.3 if the "supported_versions" extension is present.</td><td> </td><td class="rblock">   only attempt to negotiate TLS 1.3 if the "supported_versions"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If negotiating a version of TLS prior to 1.3, a server MUST check</td><td> </td><td class="rblock">   extension is present.  If negotiating a version of TLS prior to 1.3,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that the message either contains no data after</td><td> </td><td class="rblock">   a server MUST check that the message either contains no data after</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   legacy_compression_methods or that it contains a valid extensions</td><td> </td><td class="right">   legacy_compression_methods or that it contains a valid extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   block with no data following.  If not, then it MUST abort the</td><td> </td><td class="right">   block with no data following.  If not, then it MUST abort the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake with a "decode_error" alert.</td><td> </td><td class="right">   handshake with a "decode_error" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the event that a client requests additional functionality using</td><td> </td><td class="right">   In the event that a client requests additional functionality using</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0107" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extensions<span class="delete">,</span> and this functionality is not supplied by the server, the</td><td> </td><td class="rblock">   extensions and this functionality is not supplied by the server, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client MAY abort the handshake.</td><td> </td><td class="right">   client MAY abort the handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   After sending the ClientHello message, the client waits for a</td><td> </td><td class="right">   After sending the ClientHello message, the client waits for a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello or HelloRetryRequest message.  If early data is in use,</td><td> </td><td class="right">   ServerHello or HelloRetryRequest message.  If early data is in use,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0108" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the client may transmit early <span class="delete">application d</span>ata (Section 2.3) while</td><td> </td><td class="rblock">   the client may transmit early <span class="insert">Application D</span>ata (Section 2.3) while</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   waiting for the next handshake message.</td><td> </td><td class="right">   waiting for the next handshake message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.1.3.  Server Hello</td><td> </td><td class="right">4.1.3.  Server Hello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server will send this message in response to a ClientHello</td><td> </td><td class="right">   The server will send this message in response to a ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message to proceed with the handshake if it is able to negotiate an</td><td> </td><td class="right">   message to proceed with the handshake if it is able to negotiate an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   acceptable set of handshake parameters based on the ClientHello.</td><td> </td><td class="right">   acceptable set of handshake parameters based on the ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ProtocolVersion legacy_version = 0x0303;    /* TLS v1.2 */</td><td> </td><td class="right">          ProtocolVersion legacy_version = 0x0303;    /* TLS v1.2 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Random random;</td><td> </td><td class="right">          Random random;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque legacy_session_id_echo&lt;0..32&gt;;</td><td> </td><td class="right">          opaque legacy_session_id_echo&lt;0..32&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          CipherSuite cipher_suite;</td><td> </td><td class="right">          CipherSuite cipher_suite;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8 legacy_compression_method = 0;</td><td> </td><td class="right">          uint8 legacy_compression_method = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;6..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;6..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ServerHello;</td><td> </td><td class="right">      } ServerHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0109" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   legacy_version  In previous versions of TLS, this field was used for</td><td> </td><td class="rblock">   legacy_version<span class="insert">:</span>  In previous versions of TLS, this field was used for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      version negotiation and represented the selected version number</td><td> </td><td class="right">      version negotiation and represented the selected version number</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      for the connection.  Unfortunately, some middleboxes fail when</td><td> </td><td class="right">      for the connection.  Unfortunately, some middleboxes fail when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      presented with new values.  In TLS 1.3, the TLS server indicates</td><td> </td><td class="right">      presented with new values.  In TLS 1.3, the TLS server indicates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      its version using the "supported_versions" extension</td><td> </td><td class="right">      its version using the "supported_versions" extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (Section 4.2.1), and the legacy_version field MUST be set to</td><td> </td><td class="right">      (Section 4.2.1), and the legacy_version field MUST be set to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      0x0303, which is the version number for TLS 1.2.  (See Appendix D</td><td> </td><td class="right">      0x0303, which is the version number for TLS 1.2.  (See Appendix D</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      for details about backward compatibility.)</td><td> </td><td class="right">      for details about backward compatibility.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0110" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">random</span>  32 bytes generated by a secure random number generator.  See</td><td> </td><td class="rblock">   <span class="insert">random:</span>  32 bytes generated by a secure random number generator.  See</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Appendix C for additional information.  The last <span class="delete">eight</span> bytes MUST</td><td> </td><td class="rblock">      Appendix C for additional information.  The last <span class="insert">8</span> bytes MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      be overwritten as described below if negotiating TLS 1.2 or TLS</td><td> </td><td class="rblock">      overwritten as described below if negotiating TLS 1.2 or TLS 1.1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.1, but the remaining bytes MUST be random.  This structure is</td><td> </td><td class="rblock">      but the remaining bytes MUST be random.  This structure is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      generated by the server and MUST be generated independently of the</td><td> </td><td class="right">      generated by the server and MUST be generated independently of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello.random.</td><td> </td><td class="right">      ClientHello.random.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0111" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   legacy_session_id_echo  The contents of the client's</td><td> </td><td class="rblock">   legacy_session_id_echo<span class="insert">:</span>  The contents of the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      legacy_session_id field.  Note that this field is echoed even if</td><td> </td><td class="right">      legacy_session_id field.  Note that this field is echoed even if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the client's value corresponded to a cached pre-TLS 1.3 session</td><td> </td><td class="right">      the client's value corresponded to a cached pre-TLS 1.3 session</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      which the server has chosen not to resume.  A client which</td><td> </td><td class="right">      which the server has chosen not to resume.  A client which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      receives a legacy_session_id_echo field that does not match what</td><td> </td><td class="right">      receives a legacy_session_id_echo field that does not match what</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      it sent in the ClientHello MUST abort the handshake with an</td><td> </td><td class="right">      it sent in the ClientHello MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "illegal_parameter" alert.</td><td> </td><td class="right">      "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0112" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">cipher_suite</span>  The single cipher suite selected by the server from the</td><td> </td><td class="rblock">   <span class="insert">cipher_suite:</span>  The single cipher suite selected by the server from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      list in ClientHello.cipher_suites.  A client which receives a</td><td> </td><td class="rblock">      the list in ClientHello.cipher_suites.  A client which receives a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      cipher suite that was not offered MUST abort the handshake with an</td><td> </td><td class="right">      cipher suite that was not offered MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "illegal_parameter" alert.</td><td> </td><td class="right">      "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0113" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">legacy_compression_method</span>  A single byte which MUST have the value 0.</td><td> </td><td class="rblock">   <span class="insert">legacy_compression_method:</span>  A single byte which MUST have the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      value 0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0114" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extensions  A list of extensions.  The ServerHello MUST only include</td><td> </td><td class="rblock">   extensions<span class="insert">:</span>  A list of extensions.  The ServerHello MUST only include</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extensions which are required to establish the cryptographic</td><td> </td><td class="right">      extensions which are required to establish the cryptographic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      context and negotiate the protocol version.  All TLS 1.3</td><td> </td><td class="right">      context and negotiate the protocol version.  All TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ServerHello messages MUST contain the "supported_versions"</td><td> </td><td class="right">      ServerHello messages MUST contain the "supported_versions"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extension.  Current ServerHello messages additionally contain</td><td> </td><td class="right">      extension.  Current ServerHello messages additionally contain</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0115" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      either the "pre_shared_key" or "key_share" <span class="delete">extensions,</span> or both</td><td> </td><td class="rblock">      either the "pre_shared_key" <span class="insert">extension</span> or <span class="insert">the</span> "key_share"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">when</span> using a PSK with (EC)DHE key <span class="delete">establishment.</span>  Other extensions</td><td> </td><td class="rblock">      <span class="insert">extension,</span> or both <span class="insert">(when</span> using a PSK with (EC)DHE key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      are sent separately in the EncryptedExtensions message.</td><td> </td><td class="rblock">      <span class="insert">establishment).</span>  Other extensions <span class="insert">(see Section 4.2)</span> are sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      separately in the EncryptedExtensions message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For reasons of backward compatibility with middleboxes (see</td><td> </td><td class="right">   For reasons of backward compatibility with middleboxes (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0116" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix D.4) the HelloRetryRequest message uses the same structure</td><td> </td><td class="rblock">   Appendix D.4)<span class="insert">,</span> the HelloRetryRequest message uses the same structure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as the ServerHello, but with Random set to the special value of the</td><td> </td><td class="right">   as the ServerHello, but with Random set to the special value of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SHA-256 of "HelloRetryRequest":</td><td> </td><td class="right">   SHA-256 of "HelloRetryRequest":</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     CF 21 AD 74 E5 9A 61 11 BE 1D 8C 02 1E 65 B8 91</td><td> </td><td class="right">     CF 21 AD 74 E5 9A 61 11 BE 1D 8C 02 1E 65 B8 91</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     C2 A2 11 16 7A BB 8C 5E 07 9E 09 E2 C8 A8 33 9C</td><td> </td><td class="right">     C2 A2 11 16 7A BB 8C 5E 07 9E 09 E2 C8 A8 33 9C</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Upon receiving a message with type server_hello, implementations MUST</td><td> </td><td class="right">   Upon receiving a message with type server_hello, implementations MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0117" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   first examine the Random value and if it matches this value, process</td><td> </td><td class="rblock">   first examine the Random value and<span class="insert">,</span> if it matches this value, process</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it as described in Section 4.1.4).</td><td> </td><td class="right">   it as described in Section 4.1.4).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 has a downgrade protection mechanism embedded in the server's</td><td> </td><td class="right">   TLS 1.3 has a downgrade protection mechanism embedded in the server's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   random value.  TLS 1.3 servers which negotiate TLS 1.2 or below in</td><td> </td><td class="right">   random value.  TLS 1.3 servers which negotiate TLS 1.2 or below in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0118" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   response to a ClientHello MUST set the last <span class="delete">eight</span> bytes of their</td><td> </td><td class="rblock">   response to a ClientHello MUST set the last <span class="insert">8</span> bytes of their Random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Random value <span class="delete">specially.</span></td><td> </td><td class="rblock">   value <span class="insert">specially in their ServerHello.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0119" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If negotiating TLS 1.2, TLS 1.3 servers MUST set the last <span class="delete">eight</span> bytes</td><td> </td><td class="rblock">   If negotiating TLS 1.2, TLS 1.3 servers MUST set the last <span class="insert">8</span> bytes of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   of their Random value to the bytes:</td><td> </td><td class="rblock">   their Random value to the bytes:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     44 4F 57 4E 47 52 44 01</td><td> </td><td class="right">     44 4F 57 4E 47 52 44 01</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0120" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If negotiating TLS 1.1 or below, TLS 1.3 servers <span class="delete">MUST</span> and TLS 1.2</td><td> </td><td class="rblock">   If negotiating TLS 1.1 or below, TLS 1.3 servers <span class="insert">MUST,</span> and TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   servers <span class="delete">SHOULD</span> set the last <span class="delete">eight</span> bytes of their <span class="delete">Random</span> value to the</td><td> </td><td class="rblock">   servers <span class="insert">SHOULD,</span> set the last <span class="insert">8</span> bytes of their <span class="insert">ServerHello.Random</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   bytes:</td><td> </td><td class="rblock">   value to the bytes:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     44 4F 57 4E 47 52 44 00</td><td> </td><td class="right">     44 4F 57 4E 47 52 44 00</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 clients receiving a ServerHello indicating TLS 1.2 or below</td><td> </td><td class="right">   TLS 1.3 clients receiving a ServerHello indicating TLS 1.2 or below</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0121" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   MUST check that the last <span class="delete">eight</span> bytes are not equal to either of these</td><td> </td><td class="rblock">   MUST check that the last <span class="insert">8</span> bytes are not equal to either of these</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   values.  TLS 1.2 clients SHOULD also check that the last <span class="delete">eight</span> bytes</td><td> </td><td class="rblock">   values.  TLS 1.2 clients SHOULD also check that the last <span class="insert">8</span> bytes are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   are not equal to the second value if the ServerHello indicates TLS</td><td> </td><td class="rblock">   not equal to the second value if the ServerHello indicates TLS 1.1 or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.1 or below.  If a match is found, the client MUST abort the</td><td> </td><td class="rblock">   below.  If a match is found, the client MUST abort the handshake with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake with an "illegal_parameter" alert.  This mechanism provides</td><td> </td><td class="rblock">   an "illegal_parameter" alert.  This mechanism provides limited</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   limited protection against downgrade attacks over and above what is</td><td> </td><td class="rblock">   protection against downgrade attacks over and above what is provided</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   provided by the Finished exchange: because the ServerKeyExchange, a</td><td> </td><td class="rblock">   by the Finished exchange: because the ServerKeyExchange, a message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   message present in TLS 1.2 and below, includes a signature over both</td><td> </td><td class="rblock">   present in TLS 1.2 and below, includes a signature over both random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   random values, it is not possible for an active attacker to modify</td><td> </td><td class="rblock">   values, it is not possible for an active attacker to modify the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the random values without detection as long as ephemeral ciphers are</td><td> </td><td class="rblock">   random values without detection as long as ephemeral ciphers are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   used.  It does not provide downgrade protection when static RSA is</td><td> </td><td class="rblock">   used.  It does not provide downgrade protection when static RSA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   used.</td><td> </td><td class="rblock">   is used.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: This is a change from [RFC5246], so in practice many TLS 1.2</td><td> </td><td class="right">   Note: This is a change from [RFC5246], so in practice many TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   clients and servers will not behave as specified above.</td><td> </td><td class="right">   clients and servers will not behave as specified above.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A legacy TLS client performing renegotiation with TLS 1.2 or prior</td><td> </td><td class="right">   A legacy TLS client performing renegotiation with TLS 1.2 or prior</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and which receives a TLS 1.3 ServerHello during renegotiation MUST</td><td> </td><td class="right">   and which receives a TLS 1.3 ServerHello during renegotiation MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   abort the handshake with a "protocol_version" alert.  Note that</td><td> </td><td class="right">   abort the handshake with a "protocol_version" alert.  Note that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   renegotiation is not possible when TLS 1.3 has been negotiated.</td><td> </td><td class="right">   renegotiation is not possible when TLS 1.3 has been negotiated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0122" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH Implementations of</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   draft versions (see Section 4.2.1.1) of this specification SHOULD NOT</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   implement this mechanism on either client and server.  A pre-RFC</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   client connecting to RFC servers, or vice versa, will appear to</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   downgrade to TLS 1.2.  With the mechanism enabled, this will cause an</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   interoperability failure.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.1.4.  Hello Retry Request</td><td> </td><td class="right">4.1.4.  Hello Retry Request</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server will send this message in response to a ClientHello</td><td> </td><td class="right">   The server will send this message in response to a ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message if it is able to find an acceptable set of parameters but the</td><td> </td><td class="right">   message if it is able to find an acceptable set of parameters but the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello does not contain sufficient information to proceed with</td><td> </td><td class="right">   ClientHello does not contain sufficient information to proceed with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the handshake.  As discussed in Section 4.1.3, the HelloRetryRequest</td><td> </td><td class="right">   the handshake.  As discussed in Section 4.1.3, the HelloRetryRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   has the same format as a ServerHello message, and the legacy_version,</td><td> </td><td class="right">   has the same format as a ServerHello message, and the legacy_version,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0123" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   legacy_session_id_echo, cipher_suite, and legacy_compression<span class="delete"> methods</span></td><td> </td><td class="rblock">   legacy_session_id_echo, cipher_suite, and legacy_compression<span class="insert">_method</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fields have the same meaning.  However, for convenience we discuss</td><td> </td><td class="right">   fields have the same meaning.  However, for convenience we discuss</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0124" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">HelloRetryRequest</span> throughout this document as if it were a distinct</td><td> </td><td class="rblock">   <span class="insert">"HelloRetryRequest"</span> throughout this document as if it were a distinct</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message.</td><td> </td><td class="right">   message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0125" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The server's extensions MUST contain <span class="delete">"supported_versions" and</span></td><td> </td><td class="rblock">   The server's extensions MUST contain <span class="insert">"supported_versions".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   otherwise the server</span> SHOULD <span class="delete">send only</span> the extensions necessary for</td><td> </td><td class="rblock"><span class="insert">   Additionally, it</span> SHOULD <span class="insert">contain</span> the <span class="insert">minimal set of</span> extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the client to generate a correct ClientHello pair.  As with</td><td> </td><td class="rblock">   necessary for the client to generate a correct ClientHello pair.  As</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ServerHello, a HelloRetryRequest MUST NOT contain any extensions that</td><td> </td><td class="rblock">   with <span class="insert">the</span> ServerHello, a HelloRetryRequest MUST NOT contain any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   were not first offered by the client in its ClientHello, with the</td><td> </td><td class="rblock">   extensions that were not first offered by the client in its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   exception of optionally the "cookie" (see Section 4.2.2) extension.</td><td> </td><td class="rblock">   ClientHello, with the exception of optionally the "cookie" (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Section 4.2.2) extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Upon receipt of a HelloRetryRequest, the client MUST check the</td><td> </td><td class="right">   Upon receipt of a HelloRetryRequest, the client MUST check the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   legacy_version, legacy_session_id_echo, cipher_suite, and</td><td> </td><td class="right">   legacy_version, legacy_session_id_echo, cipher_suite, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   legacy_compression_method as specified in Section 4.1.3 and then</td><td> </td><td class="right">   legacy_compression_method as specified in Section 4.1.3 and then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   process the extensions, starting with determining the version using</td><td> </td><td class="right">   process the extensions, starting with determining the version using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "supported_versions".  Clients MUST abort the handshake with an</td><td> </td><td class="right">   "supported_versions".  Clients MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "illegal_parameter" alert if the HelloRetryRequest would not result</td><td> </td><td class="right">   "illegal_parameter" alert if the HelloRetryRequest would not result</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in any change in the ClientHello.  If a client receives a second</td><td> </td><td class="right">   in any change in the ClientHello.  If a client receives a second</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest in the same connection (i.e., where the ClientHello</td><td> </td><td class="right">   HelloRetryRequest in the same connection (i.e., where the ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   was itself in response to a HelloRetryRequest), it MUST abort the</td><td> </td><td class="right">   was itself in response to a HelloRetryRequest), it MUST abort the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l13" /><small>skipping to change at</small><em> page 39, line 36</em></th><th> </th><th><a name="part-r13" /><small>skipping to change at</small><em> page 34, line 15</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Otherwise, the client MUST process all extensions in the</td><td> </td><td class="right">   Otherwise, the client MUST process all extensions in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest and send a second updated ClientHello.  The</td><td> </td><td class="right">   HelloRetryRequest and send a second updated ClientHello.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest extensions defined in this specification are:</td><td> </td><td class="right">   HelloRetryRequest extensions defined in this specification are:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  supported_versions (see Section 4.2.1)</td><td> </td><td class="right">   -  supported_versions (see Section 4.2.1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  cookie (see Section 4.2.2)</td><td> </td><td class="right">   -  cookie (see Section 4.2.2)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  key_share (see Section 4.2.8)</td><td> </td><td class="right">   -  key_share (see Section 4.2.8)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0126" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">A client which receives a cipher suite that was not offered MUST</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   abort the handshake.  Servers MUST ensure that they negotiate the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   same cipher suite when receiving a conformant updated ClientHello (if</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the server selects the cipher suite as the first step in the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   negotiation, then this will happen automatically).  Upon receiving</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the ServerHello, clients MUST check that the cipher suite supplied in</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the ServerHello is the same as that in the HelloRetryRequest and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   otherwise abort the handshake with an "illegal_parameter" alert.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In addition, in its updated ClientHello, the client SHOULD NOT offer</td><td> </td><td class="right">   In addition, in its updated ClientHello, the client SHOULD NOT offer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   any pre-shared keys associated with a hash other than that of the</td><td> </td><td class="right">   any pre-shared keys associated with a hash other than that of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   selected cipher suite.  This allows the client to avoid having to</td><td> </td><td class="right">   selected cipher suite.  This allows the client to avoid having to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compute partial hash transcripts for multiple hashes in the second</td><td> </td><td class="right">   compute partial hash transcripts for multiple hashes in the second</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0127" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ClientHello.  <span class="delete">A client which receives a cipher suite that was not</span></td><td> </td><td class="rblock">   ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   offered MUST abort the handshake.  Servers MUST ensure that they</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   negotiate the same cipher suite when receiving a conformant updated</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ClientHello (if the server selects the cipher suite as the first step</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   in the negotiation, then this will happen automatically).  Upon</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   receiving the ServerHello, clients MUST check that the cipher suite</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   supplied in the ServerHello is the same as that in the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   HelloRetryRequest and otherwise abort the handshake with an</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   "illegal_parameter" alert.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The value of selected_version in the HelloRetryRequest</td><td> </td><td class="right">   The value of selected_version in the HelloRetryRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "supported_versions" extension MUST be retained in the ServerHello,</td><td> </td><td class="right">   "supported_versions" extension MUST be retained in the ServerHello,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and a client MUST abort the handshake with an "illegal_parameter"</td><td> </td><td class="right">   and a client MUST abort the handshake with an "illegal_parameter"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alert if the value changes.</td><td> </td><td class="right">   alert if the value changes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.  Extensions</td><td> </td><td class="right">4.2.  Extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A number of TLS messages contain tag-length-value encoded extensions</td><td> </td><td class="right">   A number of TLS messages contain tag-length-value encoded extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   structures.</td><td> </td><td class="right">   structures.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0128" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       ExtensionType extension_type;</td><td> </td><td class="rblock">        ExtensionType extension_type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       opaque extension_data&lt;0..2^16-1&gt;;</td><td> </td><td class="rblock">        opaque extension_data&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } Extension;</td><td> </td><td class="rblock">    } Extension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0129" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   enum {</td><td> </td><td class="rblock">    enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       server_name(0),                             /* RFC 6066 */</td><td> </td><td class="rblock">        server_name(0),                             /* RFC 6066 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       max_fragment_length(1),                     /* RFC 6066 */</td><td> </td><td class="rblock">        max_fragment_length(1),                     /* RFC 6066 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       status_request(5),                          /* RFC 6066 */</td><td> </td><td class="rblock">        status_request(5),                          /* RFC 6066 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       supported_groups(10),                       /* RFC <span class="delete">4492,</span> 7919 */</td><td> </td><td class="rblock">        supported_groups(10),                       /* RFC <span class="insert">8422,</span> 7919 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       signature_algorithms(13),                   /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        signature_algorithms(13),                   /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       use_srtp(14),                               /* RFC 5764 */</td><td> </td><td class="rblock">        use_srtp(14),                               /* RFC 5764 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       heartbeat(15),                              /* RFC 6520 */</td><td> </td><td class="rblock">        heartbeat(15),                              /* RFC 6520 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       application_layer_protocol_negotiation(16), /* RFC 7301 */</td><td> </td><td class="rblock">        application_layer_protocol_negotiation(16), /* RFC 7301 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       signed_certificate_timestamp(18),           /* RFC 6962 */</td><td> </td><td class="rblock">        signed_certificate_timestamp(18),           /* RFC 6962 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       client_certificate_type(19),                /* RFC 7250 */</td><td> </td><td class="rblock">        client_certificate_type(19),                /* RFC 7250 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       server_certificate_type(20),                /* RFC 7250 */</td><td> </td><td class="rblock">        server_certificate_type(20),                /* RFC 7250 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       padding(21),                                /* RFC 7685 */</td><td> </td><td class="rblock">        padding(21),                                /* RFC 7685 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       pre_shared_key(41),                         /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        pre_shared_key(41),                         /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       early_data(42),                             /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        early_data(42),                             /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       supported_versions(43),                     /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        supported_versions(43),                     /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       cookie(44),                                 /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        cookie(44),                                 /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       psk_key_exchange_modes(45),                 /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        psk_key_exchange_modes(45),                 /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       certificate_authorities(47),                /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        certificate_authorities(47),                /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       oid_filters(48),                            /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        oid_filters(48),                            /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       post_handshake_auth(49),                    /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        post_handshake_auth(49),                    /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       signature_algorithms_cert(50),              /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        signature_algorithms_cert(50),              /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       key_share(51),                              /* <span class="delete">[[this document]]</span> */</td><td> </td><td class="rblock">        key_share(51),                              /* <span class="insert">RFC 8446</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       (65535)</td><td> </td><td class="rblock">        (65535)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } ExtensionType;</td><td> </td><td class="rblock">    } ExtensionType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Here:</td><td> </td><td class="right">   Here:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  "extension_type" identifies the particular extension type.</td><td> </td><td class="right">   -  "extension_type" identifies the particular extension type.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  "extension_data" contains information specific to the particular</td><td> </td><td class="right">   -  "extension_data" contains information specific to the particular</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extension type.</td><td> </td><td class="right">      extension type.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The list of extension types is maintained by IANA as described in</td><td> </td><td class="right">   The list of extension types is maintained by IANA as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 11.</td><td> </td><td class="right">   Section 11.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Extensions are generally structured in a request/response fashion,</td><td> </td><td class="right">   Extensions are generally structured in a request/response fashion,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   though some extensions are just indications with no corresponding</td><td> </td><td class="right">   though some extensions are just indications with no corresponding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   response.  The client sends its extension requests in the ClientHello</td><td> </td><td class="right">   response.  The client sends its extension requests in the ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0130" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">message</span> and the server sends its extension responses in the</td><td> </td><td class="rblock">   <span class="insert">message,</span> and the server sends its extension responses in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ServerHello, EncryptedExtensions, <span class="delete">HelloRetryRequest</span> and Certificate</td><td> </td><td class="rblock">   ServerHello, EncryptedExtensions, <span class="insert">HelloRetryRequest,</span> and Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages.  The server sends extension requests in the</td><td> </td><td class="right">   messages.  The server sends extension requests in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateRequest message which a client MAY respond to with a</td><td> </td><td class="right">   CertificateRequest message which a client MAY respond to with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Certificate message.  The server MAY also send unsolicited extensions</td><td> </td><td class="right">   Certificate message.  The server MAY also send unsolicited extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in the NewSessionTicket, though the client does not respond directly</td><td> </td><td class="right">   in the NewSessionTicket, though the client does not respond directly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to these.</td><td> </td><td class="right">   to these.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST NOT send extension responses if the remote</td><td> </td><td class="right">   Implementations MUST NOT send extension responses if the remote</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   endpoint did not send the corresponding extension requests, with the</td><td> </td><td class="right">   endpoint did not send the corresponding extension requests, with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0131" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   exception of the "cookie" extension in HelloRetryRequest.  Upon</td><td> </td><td class="rblock">   exception of the "cookie" extension in <span class="insert">the </span>HelloRetryRequest.  Upon</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receiving such an extension, an endpoint MUST abort the handshake</td><td> </td><td class="right">   receiving such an extension, an endpoint MUST abort the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with an "unsupported_extension" alert.</td><td> </td><td class="right">   with an "unsupported_extension" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The table below indicates the messages where a given extension may</td><td> </td><td class="right">   The table below indicates the messages where a given extension may</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0132" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   appear, using the following notation: CH (ClientHello), SH</td><td> </td><td class="rblock">   appear, using the following notation: CH (ClientHello),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (ServerHello), EE (EncryptedExtensions), CT (Certificate), CR</td><td> </td><td class="rblock">   SH (ServerHello), EE (EncryptedExtensions), CT (Certificate),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (CertificateRequest), NST <span class="delete">(NewSessionTicket)</span> and HRR</td><td> </td><td class="rblock">   CR (CertificateRequest), NST <span class="insert">(NewSessionTicket),</span> and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (HelloRetryRequest).  If an implementation receives an extension</td><td> </td><td class="rblock">   HRR (HelloRetryRequest).  If an implementation receives an extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which it recognizes and which is not specified for the message in</td><td> </td><td class="right">   which it recognizes and which is not specified for the message in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0133" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   which it appears it MUST abort the handshake with an</td><td> </td><td class="rblock">   which it appears<span class="insert">,</span> it MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "illegal_parameter" alert.</td><td> </td><td class="right">   "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0134" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    +--------------------------------------------------+-------------+</td><td> </td><td class="rblock">   +--------------------------------------------------+-------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | Extension                                        |     TLS 1.3 |</td><td> </td><td class="rblock">   | Extension                                        |     TLS 1.3 |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    +--------------------------------------------------+-------------+</td><td> </td><td class="rblock">   +--------------------------------------------------+-------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | server_name [RFC6066]                            |      CH, EE |</td><td> </td><td class="rblock">   | server_name [RFC6066]                            |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | max_fragment_length [RFC6066]                    |      CH, EE |</td><td> </td><td class="rblock">   | max_fragment_length [RFC6066]                    |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | status_request [RFC6066]                         |  CH, CR, CT |</td><td> </td><td class="rblock">   | status_request [RFC6066]                         |  CH, CR, CT |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | supported_groups [RFC7919]                       |      CH, EE |</td><td> </td><td class="rblock">   | supported_groups [RFC7919]                       |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | signature_algorithms <span class="delete">[RFC5246]</span>                   |      CH, CR |</td><td> </td><td class="rblock">   | signature_algorithms <span class="insert">(RFC 8446)</span>                  |      CH, CR |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | use_srtp [RFC5764]                               |      CH, EE |</td><td> </td><td class="rblock">   | use_srtp [RFC5764]                               |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | heartbeat [RFC6520]                              |      CH, EE |</td><td> </td><td class="rblock">   | heartbeat [RFC6520]                              |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | application_layer_protocol_negotiation [RFC7301] |      CH, EE |</td><td> </td><td class="rblock">   | application_layer_protocol_negotiation [RFC7301] |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | signed_certificate_timestamp [RFC6962]           |  CH, CR, CT |</td><td> </td><td class="rblock">   | signed_certificate_timestamp [RFC6962]           |  CH, CR, CT |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | client_certificate_type [RFC7250]                |      CH, EE |</td><td> </td><td class="rblock">   | client_certificate_type [RFC7250]                |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | server_certificate_type [RFC7250]                |      CH, EE |</td><td> </td><td class="rblock">   | server_certificate_type [RFC7250]                |      CH, EE |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | padding [RFC7685]                                |          CH |</td><td> </td><td class="rblock">   | padding [RFC7685]                                |          CH |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | key_share <span class="delete">[[this document]]</span>                      | CH, SH, HRR |</td><td> </td><td class="rblock">   | key_share <span class="insert">(RFC 8446)</span>                             | CH, SH, HRR |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | pre_shared_key <span class="delete">[[this document]]</span>                 |      CH, SH |</td><td> </td><td class="rblock">   | pre_shared_key <span class="insert">(RFC 8446)</span>                        |      CH, SH |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | psk_key_exchange_modes <span class="delete">[[this document]]</span>         |          CH |</td><td> </td><td class="rblock">   | psk_key_exchange_modes <span class="insert">(RFC 8446)</span>                |          CH |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | early_data <span class="delete">[[this document]]</span>                     | CH, EE, NST |</td><td> </td><td class="rblock">   | early_data <span class="insert">(RFC 8446)</span>                            | CH, EE, NST |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | cookie <span class="delete">[[this document]]</span>                         |     CH, HRR |</td><td> </td><td class="rblock">   | cookie <span class="insert">(RFC 8446)</span>                                |     CH, HRR |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | supported_versions <span class="delete">[[this document]]</span>             | CH, SH, HRR |</td><td> </td><td class="rblock">   | supported_versions <span class="insert">(RFC 8446)</span>                    | CH, SH, HRR |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | certificate_authorities <span class="delete">[[this document]]</span>        |      CH, CR |</td><td> </td><td class="rblock">   | certificate_authorities <span class="insert">(RFC 8446)</span>               |      CH, CR |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | oid_filters <span class="delete">[[this document]]</span>                    |          CR |</td><td> </td><td class="rblock">   | oid_filters <span class="insert">(RFC 8446)</span>                           |          CR |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | post_handshake_auth <span class="delete">[[this document]]</span>            |          CH |</td><td> </td><td class="rblock">   | post_handshake_auth <span class="insert">(RFC 8446)</span>                   |          CH |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    |                                                  |             |</td><td> </td><td class="rblock">   |                                                  |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    | signature_algorithms_cert <span class="delete">[[this document]]</span>      |      CH, CR |</td><td> </td><td class="rblock">   | signature_algorithms_cert <span class="insert">(RFC 8446)</span>             |      CH, CR |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    +--------------------------------------------------+-------------+</td><td> </td><td class="rblock">   +--------------------------------------------------+-------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When multiple extensions of different types are present, the</td><td> </td><td class="right">   When multiple extensions of different types are present, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions MAY appear in any order, with the exception of</td><td> </td><td class="right">   extensions MAY appear in any order, with the exception of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0135" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "pre_shared_key" <span class="delete">Section 4.2.11</span> which MUST be the last extension in</td><td> </td><td class="rblock">   "pre_shared_key" <span class="insert">(Section 4.2.11)</span> which MUST be the last extension in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the <span class="delete">ClientHello.</span>  There MUST NOT be more than one extension of the</td><td> </td><td class="rblock">   the <span class="insert">ClientHello (but can appear anywhere in the ServerHello</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   extensions block).</span>  There MUST NOT be more than one extension of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   same type in a given extension block.</td><td> </td><td class="right">   same type in a given extension block.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In TLS 1.3, unlike TLS 1.2, extensions are negotiated for each</td><td> </td><td class="right">   In TLS 1.3, unlike TLS 1.2, extensions are negotiated for each</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake even when in resumption-PSK mode.  However, 0-RTT</td><td> </td><td class="right">   handshake even when in resumption-PSK mode.  However, 0-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parameters are those negotiated in the previous handshake; mismatches</td><td> </td><td class="right">   parameters are those negotiated in the previous handshake; mismatches</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   may require rejecting 0-RTT (see Section 4.2.10).</td><td> </td><td class="right">   may require rejecting 0-RTT (see Section 4.2.10).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   There are subtle (and not so subtle) interactions that may occur in</td><td> </td><td class="right">   There are subtle (and not so subtle) interactions that may occur in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   this protocol between new features and existing features which may</td><td> </td><td class="right">   this protocol between new features and existing features which may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   result in a significant reduction in overall security.  The following</td><td> </td><td class="right">   result in a significant reduction in overall security.  The following</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l14" /><small>skipping to change at</small><em> page 44, line 16</em></th><th> </th><th><a name="part-r14" /><small>skipping to change at</small><em> page 39, line 28</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which versions of TLS it supports and by the server to indicate which</td><td> </td><td class="right">   which versions of TLS it supports and by the server to indicate which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   version it is using.  The extension contains a list of supported</td><td> </td><td class="right">   version it is using.  The extension contains a list of supported</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   versions in preference order, with the most preferred version first.</td><td> </td><td class="right">   versions in preference order, with the most preferred version first.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations of this specification MUST send this extension in the</td><td> </td><td class="right">   Implementations of this specification MUST send this extension in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello containing all versions of TLS which they are prepared to</td><td> </td><td class="right">   ClientHello containing all versions of TLS which they are prepared to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiate (for this specification, that means minimally 0x0304, but</td><td> </td><td class="right">   negotiate (for this specification, that means minimally 0x0304, but</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   if previous versions of TLS are allowed to be negotiated, they MUST</td><td> </td><td class="right">   if previous versions of TLS are allowed to be negotiated, they MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be present as well).</td><td> </td><td class="right">   be present as well).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If this extension is not present, servers which are compliant with</td><td> </td><td class="right">   If this extension is not present, servers which are compliant with</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0136" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   this specification<span class="delete">, and which also support TLS 1.2,</span> MUST negotiate</td><td> </td><td class="rblock">   this specification<span class="insert"> and which also support TLS 1.2</span> MUST negotiate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.2 or prior as specified in [RFC5246], even if</td><td> </td><td class="right">   TLS 1.2 or prior as specified in [RFC5246], even if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello.legacy_version is 0x0304 or later.  Servers MAY abort the</td><td> </td><td class="right">   ClientHello.legacy_version is 0x0304 or later.  Servers MAY abort the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake upon receiving a ClientHello with legacy_version 0x0304 or</td><td> </td><td class="right">   handshake upon receiving a ClientHello with legacy_version 0x0304 or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   later.</td><td> </td><td class="right">   later.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If this extension is present in the ClientHello, servers MUST NOT use</td><td> </td><td class="right">   If this extension is present in the ClientHello, servers MUST NOT use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the ClientHello.legacy_version value for version negotiation and MUST</td><td> </td><td class="right">   the ClientHello.legacy_version value for version negotiation and MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   use only the "supported_versions" extension to determine client</td><td> </td><td class="right">   use only the "supported_versions" extension to determine client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   preferences.  Servers MUST only select a version of TLS present in</td><td> </td><td class="right">   preferences.  Servers MUST only select a version of TLS present in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that extension and MUST ignore any unknown versions that are present</td><td> </td><td class="right">   that extension and MUST ignore any unknown versions that are present</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l15" /><small>skipping to change at</small><em> page 44, line 46</em></th><th> </th><th><a name="part-r15" /><small>skipping to change at</small><em> page 40, line 9</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension.  A server which negotiates TLS 1.3 MUST respond by sending</td><td> </td><td class="right">   extension.  A server which negotiates TLS 1.3 MUST respond by sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a "supported_versions" extension containing the selected version</td><td> </td><td class="right">   a "supported_versions" extension containing the selected version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   value (0x0304).  It MUST set the ServerHello.legacy_version field to</td><td> </td><td class="right">   value (0x0304).  It MUST set the ServerHello.legacy_version field to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0x0303 (TLS 1.2).  Clients MUST check for this extension prior to</td><td> </td><td class="right">   0x0303 (TLS 1.2).  Clients MUST check for this extension prior to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   processing the rest of the ServerHello (although they will have to</td><td> </td><td class="right">   processing the rest of the ServerHello (although they will have to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parse the ServerHello in order to read the extension).  If this</td><td> </td><td class="right">   parse the ServerHello in order to read the extension).  If this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension is present, clients MUST ignore the</td><td> </td><td class="right">   extension is present, clients MUST ignore the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello.legacy_version value and MUST use only the</td><td> </td><td class="right">   ServerHello.legacy_version value and MUST use only the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "supported_versions" extension to determine the selected version.  If</td><td> </td><td class="right">   "supported_versions" extension to determine the selected version.  If</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the "supported_versions" extension in the ServerHello contains a</td><td> </td><td class="right">   the "supported_versions" extension in the ServerHello contains a</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0137" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   version not offered by the client or contains a version prior to TLS</td><td> </td><td class="rblock">   version not offered by the client or contains a version prior to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3, the client MUST abort the handshake with an "illegal_parameter"</td><td> </td><td class="rblock">   TLS 1.3, the client MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   alert.</td><td> </td><td class="rblock">   "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">4.2.1.1.  Draft Version Indicator</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   RFC EDITOR: PLEASE REMOVE THIS SECTION</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   While the eventual version indicator for the RFC version of TLS 1.3</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   will be 0x0304, implementations of draft versions of this</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   specification SHOULD instead advertise 0x7f00 | draft_version in the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ServerHello and HelloRetryRequest "supported_versions" extension.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   For instance, draft-17 would be encoded as the 0x7f11.  This allows</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   pre-RFC implementations to safely negotiate with each other, even if</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   they would otherwise be incompatible.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.2.  Cookie</td><td> </td><td class="right">4.2.2.  Cookie</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque cookie&lt;1..2^16-1&gt;;</td><td> </td><td class="right">          opaque cookie&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Cookie;</td><td> </td><td class="right">      } Cookie;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Cookies serve two primary purposes:</td><td> </td><td class="right">   Cookies serve two primary purposes:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Allowing the server to force the client to demonstrate</td><td> </td><td class="right">   -  Allowing the server to force the client to demonstrate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      reachability at their apparent network address (thus providing a</td><td> </td><td class="right">      reachability at their apparent network address (thus providing a</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0138" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      measure of DoS protection).  This is primarily useful for <span class="delete">non-</span></td><td> </td><td class="rblock">      measure of DoS protection).  This is primarily useful for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      connection-oriented</span> transports (see [RFC6347] for an example of</td><td> </td><td class="rblock">      <span class="insert">non-connection-oriented</span> transports (see [RFC6347] for an example</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      this).</td><td> </td><td class="rblock">      of this).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Allowing the server to offload state to the client, thus allowing</td><td> </td><td class="right">   -  Allowing the server to offload state to the client, thus allowing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      it to send a HelloRetryRequest without storing any state.  The</td><td> </td><td class="right">      it to send a HelloRetryRequest without storing any state.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server can do this by storing the hash of the ClientHello in the</td><td> </td><td class="right">      server can do this by storing the hash of the ClientHello in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      HelloRetryRequest cookie (protected with some suitable integrity</td><td> </td><td class="right">      HelloRetryRequest cookie (protected with some suitable integrity</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0139" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      algorithm).</td><td> </td><td class="rblock">      <span class="insert">protection </span>algorithm).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When sending a HelloRetryRequest, the server MAY provide a "cookie"</td><td> </td><td class="right">   When sending a HelloRetryRequest, the server MAY provide a "cookie"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension to the client (this is an exception to the usual rule that</td><td> </td><td class="right">   extension to the client (this is an exception to the usual rule that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the only extensions that may be sent are those that appear in the</td><td> </td><td class="right">   the only extensions that may be sent are those that appear in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello).  When sending the new ClientHello, the client MUST copy</td><td> </td><td class="right">   ClientHello).  When sending the new ClientHello, the client MUST copy</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the contents of the extension received in the HelloRetryRequest into</td><td> </td><td class="right">   the contents of the extension received in the HelloRetryRequest into</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a "cookie" extension in the new ClientHello.  Clients MUST NOT use</td><td> </td><td class="right">   a "cookie" extension in the new ClientHello.  Clients MUST NOT use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cookies in their initial ClientHello in subsequent connections.</td><td> </td><td class="right">   cookies in their initial ClientHello in subsequent connections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0140" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   When a server is operating statelessly it may receive an unprotected</td><td> </td><td class="rblock">   When a server is operating statelessly<span class="insert">,</span> it may receive an unprotected</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   record of type change_cipher_spec between the first and second</td><td> </td><td class="right">   record of type change_cipher_spec between the first and second</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello (see Section 5).  Since the server is not storing any</td><td> </td><td class="right">   ClientHello (see Section 5).  Since the server is not storing any</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0141" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   state this will appear as if it were the first message to be</td><td> </td><td class="rblock">   state<span class="insert">,</span> this will appear as if it were the first message to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   received.  Servers operating statelessly MUST ignore these records.</td><td> </td><td class="right">   received.  Servers operating statelessly MUST ignore these records.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.3.  Signature Algorithms</td><td> </td><td class="right">4.2.3.  Signature Algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 provides two extensions for indicating which signature</td><td> </td><td class="right">   TLS 1.3 provides two extensions for indicating which signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   algorithms may be used in digital signatures.  The</td><td> </td><td class="right">   algorithms may be used in digital signatures.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "signature_algorithms_cert" extension applies to signatures in</td><td> </td><td class="right">   "signature_algorithms_cert" extension applies to signatures in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0142" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificates and the "signature_algorithms" extension, which</td><td> </td><td class="rblock">   certificates<span class="insert">,</span> and the "signature_algorithms" extension, which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   originally appeared in TLS 1.2, applies to signatures in</td><td> </td><td class="right">   originally appeared in TLS 1.2, applies to signatures in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateVerify messages.  The keys found in certificates MUST also</td><td> </td><td class="right">   CertificateVerify messages.  The keys found in certificates MUST also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be of appropriate type for the signature algorithms they are used</td><td> </td><td class="right">   be of appropriate type for the signature algorithms they are used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with.  This is a particular issue for RSA keys and PSS signatures, as</td><td> </td><td class="right">   with.  This is a particular issue for RSA keys and PSS signatures, as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   described below.  If no "signature_algorithms_cert" extension is</td><td> </td><td class="right">   described below.  If no "signature_algorithms_cert" extension is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   present, then the "signature_algorithms" extension also applies to</td><td> </td><td class="right">   present, then the "signature_algorithms" extension also applies to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signatures appearing in certificates.  Clients which desire the</td><td> </td><td class="right">   signatures appearing in certificates.  Clients which desire the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0143" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server to authenticate itself via a certificate MUST send</td><td> </td><td class="rblock">   server to authenticate itself via a certificate MUST send <span class="insert">the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">"signature_algorithms".</span>  If a server is authenticating via a</td><td> </td><td class="rblock"><span class="insert">   "signature_algorithms" extension.</span>  If a server is authenticating via</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate and the client has not sent a "signature_algorithms"</td><td> </td><td class="rblock">   a certificate and the client has not sent a "signature_algorithms"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension, then the server MUST abort the handshake with a</td><td> </td><td class="right">   extension, then the server MUST abort the handshake with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "missing_extension" alert (see Section 9.2).</td><td> </td><td class="right">   "missing_extension" alert (see Section 9.2).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "signature_algorithms_cert" extension was added to allow</td><td> </td><td class="right">   The "signature_algorithms_cert" extension was added to allow</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementations which supported different sets of algorithms for</td><td> </td><td class="right">   implementations which supported different sets of algorithms for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates and in TLS itself to clearly signal their capabilities.</td><td> </td><td class="right">   certificates and in TLS itself to clearly signal their capabilities.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.2 implementations SHOULD also process this extension.</td><td> </td><td class="right">   TLS 1.2 implementations SHOULD also process this extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations which have the same policy in both cases MAY omit the</td><td> </td><td class="right">   Implementations which have the same policy in both cases MAY omit the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "signature_algorithms_cert" extension.</td><td> </td><td class="right">   "signature_algorithms_cert" extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l16" /><small>skipping to change at</small><em> page 48, line 7</em></th><th> </th><th><a name="part-r16" /><small>skipping to change at</small><em> page 43, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Each SignatureScheme value lists a single signature algorithm that</td><td> </td><td class="right">   Each SignatureScheme value lists a single signature algorithm that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client is willing to verify.  The values are indicated in</td><td> </td><td class="right">   the client is willing to verify.  The values are indicated in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   descending order of preference.  Note that a signature algorithm</td><td> </td><td class="right">   descending order of preference.  Note that a signature algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   takes as input an arbitrary-length message, rather than a digest.</td><td> </td><td class="right">   takes as input an arbitrary-length message, rather than a digest.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Algorithms which traditionally act on a digest should be defined in</td><td> </td><td class="right">   Algorithms which traditionally act on a digest should be defined in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS to first hash the input with a specified hash algorithm and then</td><td> </td><td class="right">   TLS to first hash the input with a specified hash algorithm and then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   proceed as usual.  The code point groups listed above have the</td><td> </td><td class="right">   proceed as usual.  The code point groups listed above have the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   following meanings:</td><td> </td><td class="right">   following meanings:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0144" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   RSASSA-PKCS1-v1_5 algorithms  Indicates a signature algorithm using</td><td> </td><td class="rblock">   RSASSA-PKCS1-v1_5 algorithms<span class="insert">:</span>  Indicates a signature algorithm using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RSASSA-PKCS1-v1_5 [RFC8017] with the corresponding hash algorithm</td><td> </td><td class="right">      RSASSA-PKCS1-v1_5 [RFC8017] with the corresponding hash algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      as defined in [SHS].  These values refer solely to signatures</td><td> </td><td class="right">      as defined in [SHS].  These values refer solely to signatures</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      which appear in certificates (see Section 4.4.2.2) and are not</td><td> </td><td class="right">      which appear in certificates (see Section 4.4.2.2) and are not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      defined for use in signed TLS handshake messages, although they</td><td> </td><td class="right">      defined for use in signed TLS handshake messages, although they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MAY appear in "signature_algorithms" and</td><td> </td><td class="right">      MAY appear in "signature_algorithms" and</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0145" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "signature_algorithms_cert" for backward compatibility with TLS</td><td> </td><td class="rblock">      "signature_algorithms_cert" for backward compatibility with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">1.2,</span></td><td> </td><td class="rblock">      TLS <span class="insert">1.2.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0146" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ECDSA <span class="delete">algorithms</span>  Indicates a signature algorithm using ECDSA</td><td> </td><td class="rblock">   ECDSA <span class="insert">algorithms:</span>  Indicates a signature algorithm using ECDSA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      [ECDSA], the corresponding curve as defined in ANSI X9.62 <span class="delete">[X962]</span></td><td> </td><td class="rblock">      [ECDSA], the corresponding curve as defined in ANSI X9.62 <span class="insert">[ECDSA]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and FIPS 186-4 [DSS], and the corresponding hash algorithm as</td><td> </td><td class="right">      and FIPS 186-4 [DSS], and the corresponding hash algorithm as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      defined in [SHS].  The signature is represented as a DER-encoded</td><td> </td><td class="right">      defined in [SHS].  The signature is represented as a DER-encoded</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [X690] ECDSA-Sig-Value structure.</td><td> </td><td class="right">      [X690] ECDSA-Sig-Value structure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0147" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   RSASSA-PSS RSAE algorithms  Indicates a signature algorithm using</td><td> </td><td class="rblock">   RSASSA-PSS RSAE algorithms<span class="insert">:</span>  Indicates a signature algorithm using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RSASSA-PSS [RFC8017] with mask generation function 1.  The digest</td><td> </td><td class="right">      RSASSA-PSS [RFC8017] with mask generation function 1.  The digest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      used in the mask generation function and the digest being signed</td><td> </td><td class="right">      used in the mask generation function and the digest being signed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      are both the corresponding hash algorithm as defined in [SHS].</td><td> </td><td class="right">      are both the corresponding hash algorithm as defined in [SHS].</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0148" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      The length of the <span class="delete">s</span>alt MUST be equal to the length of the output</td><td> </td><td class="rblock">      The length of the <span class="insert">S</span>alt MUST be equal to the length of the output</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      of the digest algorithm.  If the public key is carried in an X.509</td><td> </td><td class="right">      of the digest algorithm.  If the public key is carried in an X.509</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate, it MUST use the rsaEncryption OID [RFC5280].</td><td> </td><td class="right">      certificate, it MUST use the rsaEncryption OID [RFC5280].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0149" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   EdDSA algorithms  Indicates a signature algorithm using EdDSA as</td><td> </td><td class="rblock">   EdDSA algorithms<span class="insert">:</span>  Indicates a signature algorithm using EdDSA as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      defined in [RFC8032] or its successors.  Note that these</td><td> </td><td class="right">      defined in [RFC8032] or its successors.  Note that these</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      correspond to the "PureEdDSA" algorithms and not the "prehash"</td><td> </td><td class="right">      correspond to the "PureEdDSA" algorithms and not the "prehash"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      variants.</td><td> </td><td class="right">      variants.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0150" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   RSASSA-PSS PSS algorithms  Indicates a signature algorithm using</td><td> </td><td class="rblock">   RSASSA-PSS PSS algorithms<span class="insert">:</span>  Indicates a signature algorithm using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RSASSA-PSS [RFC8017] with mask generation function 1.  The digest</td><td> </td><td class="right">      RSASSA-PSS [RFC8017] with mask generation function 1.  The digest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      used in the mask generation function and the digest being signed</td><td> </td><td class="right">      used in the mask generation function and the digest being signed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      are both the corresponding hash algorithm as defined in [SHS].</td><td> </td><td class="right">      are both the corresponding hash algorithm as defined in [SHS].</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0151" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      The length of the <span class="delete">s</span>alt MUST be equal to the length of the digest</td><td> </td><td class="rblock">      The length of the <span class="insert">S</span>alt MUST be equal to the length of the digest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      algorithm.  If the public key is carried in an X.509 certificate,</td><td> </td><td class="right">      algorithm.  If the public key is carried in an X.509 certificate,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      it MUST use the RSASSA-PSS OID [RFC5756].  When used in</td><td> </td><td class="right">      it MUST use the RSASSA-PSS OID [RFC5756].  When used in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate signatures, the algorithm parameters MUST be DER</td><td> </td><td class="right">      certificate signatures, the algorithm parameters MUST be DER</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      encoded.  If the corresponding public key's parameters are</td><td> </td><td class="right">      encoded.  If the corresponding public key's parameters are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      present, then the parameters in the signature MUST be identical to</td><td> </td><td class="right">      present, then the parameters in the signature MUST be identical to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      those in the public key.</td><td> </td><td class="right">      those in the public key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0152" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Legacy algorithms  Indicates algorithms which are being deprecated</td><td> </td><td class="rblock">   Legacy algorithms<span class="insert">:</span>  Indicates algorithms which are being deprecated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      because they use algorithms with known weaknesses, specifically</td><td> </td><td class="right">      because they use algorithms with known weaknesses, specifically</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0153" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      SHA-1 which is used in this context with either <span class="delete">with</span> RSA using</td><td> </td><td class="rblock">      SHA-1 which is used in this context with either <span class="insert">(1)</span> RSA using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      RSASSA-PKCS1-v1_5 or ECDSA.  These values refer solely to</td><td> </td><td class="rblock">      RSASSA-PKCS1-v1_5 or <span class="insert">(2)</span> ECDSA.  These values refer solely to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      signatures which appear in certificates (see Section 4.4.2.2) and</td><td> </td><td class="right">      signatures which appear in certificates (see Section 4.4.2.2) and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      are not defined for use in signed TLS handshake messages, although</td><td> </td><td class="right">      are not defined for use in signed TLS handshake messages, although</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      they MAY appear in "signature_algorithms" and</td><td> </td><td class="right">      they MAY appear in "signature_algorithms" and</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0154" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "signature_algorithms_cert" for backward compatibility with TLS</td><td> </td><td class="rblock">      "signature_algorithms_cert" for backward compatibility with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">1.2,</span> Endpoints SHOULD NOT negotiate these algorithms but are</td><td> </td><td class="rblock">      TLS <span class="insert">1.2.</span>  Endpoints SHOULD NOT negotiate these algorithms but are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      permitted to do so solely for backward compatibility.  Clients</td><td> </td><td class="right">      permitted to do so solely for backward compatibility.  Clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      offering these values MUST list them as the lowest priority</td><td> </td><td class="right">      offering these values MUST list them as the lowest priority</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0155" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (listed after all other algorithms in SignatureSchemeList).  TLS</td><td> </td><td class="rblock">      (listed after all other algorithms in SignatureSchemeList).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.3 servers MUST NOT offer a SHA-1 signed certificate unless no</td><td> </td><td class="rblock">      TLS 1.3 servers MUST NOT offer a SHA-1 signed certificate unless</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      valid certificate chain can be produced without it (see</td><td> </td><td class="rblock">      no valid certificate chain can be produced without it (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 4.4.2.2).</td><td> </td><td class="right">      Section 4.4.2.2).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The signatures on certificates that are self-signed or certificates</td><td> </td><td class="right">   The signatures on certificates that are self-signed or certificates</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0156" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that are trust anchors are not validated since they begin a</td><td> </td><td class="rblock">   that are trust anchors are not validated<span class="insert">,</span> since they begin a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certification path (see [RFC5280], Section 3.2).  A certificate that</td><td> </td><td class="right">   certification path (see [RFC5280], Section 3.2).  A certificate that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   begins a certification path MAY use a signature algorithm that is not</td><td> </td><td class="right">   begins a certification path MAY use a signature algorithm that is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   advertised as being supported in the "signature_algorithms"</td><td> </td><td class="right">   advertised as being supported in the "signature_algorithms"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension.</td><td> </td><td class="right">   extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that TLS 1.2 defines this extension differently.  TLS 1.3</td><td> </td><td class="right">   Note that TLS 1.2 defines this extension differently.  TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementations willing to negotiate TLS 1.2 MUST behave in</td><td> </td><td class="right">   implementations willing to negotiate TLS 1.2 MUST behave in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   accordance with the requirements of [RFC5246] when negotiating that</td><td> </td><td class="right">   accordance with the requirements of [RFC5246] when negotiating that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   version.  In particular:</td><td> </td><td class="right">   version.  In particular:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS 1.2 ClientHellos MAY omit this extension.</td><td> </td><td class="right">   -  TLS 1.2 ClientHellos MAY omit this extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  In TLS 1.2, the extension contained hash/signature pairs.  The</td><td> </td><td class="right">   -  In TLS 1.2, the extension contained hash/signature pairs.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      pairs are encoded in two octets, so SignatureScheme values have</td><td> </td><td class="right">      pairs are encoded in two octets, so SignatureScheme values have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      been allocated to align with TLS 1.2's encoding.  Some legacy</td><td> </td><td class="right">      been allocated to align with TLS 1.2's encoding.  Some legacy</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      pairs are left unallocated.  These algorithms are deprecated as of</td><td> </td><td class="right">      pairs are left unallocated.  These algorithms are deprecated as of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TLS 1.3.  They MUST NOT be offered or negotiated by any</td><td> </td><td class="right">      TLS 1.3.  They MUST NOT be offered or negotiated by any</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0157" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      implementation.  In particular, MD5 [SLOTH], SHA-224, and DSA MUST</td><td> </td><td class="rblock">      implementation.  In particular, MD5 [SLOTH], SHA-224, and DSA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      NOT be used.</td><td> </td><td class="rblock">      MUST NOT be used.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  ECDSA signature schemes align with TLS 1.2's ECDSA hash/signature</td><td> </td><td class="right">   -  ECDSA signature schemes align with TLS 1.2's ECDSA hash/signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      pairs.  However, the old semantics did not constrain the signing</td><td> </td><td class="right">      pairs.  However, the old semantics did not constrain the signing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      curve.  If TLS 1.2 is negotiated, implementations MUST be prepared</td><td> </td><td class="right">      curve.  If TLS 1.2 is negotiated, implementations MUST be prepared</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      to accept a signature that uses any curve that they advertised in</td><td> </td><td class="right">      to accept a signature that uses any curve that they advertised in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the "supported_groups" extension.</td><td> </td><td class="right">      the "supported_groups" extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Implementations that advertise support for RSASSA-PSS (which is</td><td> </td><td class="right">   -  Implementations that advertise support for RSASSA-PSS (which is</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0158" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      mandatory in TLS <span class="delete">1.3),</span> MUST be prepared to accept a signature</td><td> </td><td class="rblock">      mandatory in TLS <span class="insert">1.3)</span> MUST be prepared to accept a signature using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      using that scheme even when TLS 1.2 is negotiated.  In TLS 1.2,</td><td> </td><td class="rblock">      that scheme even when TLS 1.2 is negotiated.  In TLS 1.2,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RSASSA-PSS is used with RSA cipher suites.</td><td> </td><td class="right">      RSASSA-PSS is used with RSA cipher suites.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.4.  Certificate Authorities</td><td> </td><td class="right">4.2.4.  Certificate Authorities</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "certificate_authorities" extension is used to indicate the</td><td> </td><td class="right">   The "certificate_authorities" extension is used to indicate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0159" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate authorities which an endpoint supports and which SHOULD</td><td> </td><td class="rblock">   certificate authorities <span class="insert">(CAs)</span> which an endpoint supports and which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   be used by the receiving endpoint to guide certificate selection.</td><td> </td><td class="rblock">   SHOULD be used by the receiving endpoint to guide certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   selection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The body of the "certificate_authorities" extension consists of a</td><td> </td><td class="right">   The body of the "certificate_authorities" extension consists of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateAuthoritiesExtension structure.</td><td> </td><td class="right">   CertificateAuthoritiesExtension structure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      opaque DistinguishedName&lt;1..2^16-1&gt;;</td><td> </td><td class="right">      opaque DistinguishedName&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          DistinguishedName authorities&lt;3..2^16-1&gt;;</td><td> </td><td class="right">          DistinguishedName authorities&lt;3..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateAuthoritiesExtension;</td><td> </td><td class="right">      } CertificateAuthoritiesExtension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0160" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   authorities  A list of the distinguished names [X501] of acceptable</td><td> </td><td class="rblock">   authorities<span class="insert">:</span>  A list of the distinguished names [X501] of acceptable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate authorities, represented in DER-encoded [X690] format.</td><td> </td><td class="right">      certificate authorities, represented in DER-encoded [X690] format.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      These distinguished names specify a desired distinguished name for</td><td> </td><td class="right">      These distinguished names specify a desired distinguished name for</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0161" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      trust anchor or subordinate CA; thus, this message can be used to</td><td> </td><td class="rblock">      <span class="insert">a</span> trust anchor or subordinate CA; thus, this message can be used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      describe known trust anchors as well as a desired authorization</td><td> </td><td class="rblock">      to describe known trust anchors as well as a desired authorization</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      space.</td><td> </td><td class="right">      space.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client MAY send the "certificate_authorities" extension in the</td><td> </td><td class="right">   The client MAY send the "certificate_authorities" extension in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello message.  The server MAY send it in the</td><td> </td><td class="right">   ClientHello message.  The server MAY send it in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateRequest message.</td><td> </td><td class="right">   CertificateRequest message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0162" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The "trusted_ca_keys" <span class="delete">extension,</span> which serves a similar purpose</td><td> </td><td class="rblock">   The "trusted_ca_keys" <span class="insert">extension [RFC6066],</span> which serves a similar</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[RFC6066],</span> but is more complicated, is not used in TLS 1.3 (although</td><td> </td><td class="rblock">   purpose but is more complicated, is not used in TLS 1.3 (although it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   it may appear in ClientHello messages from clients which are offering</td><td> </td><td class="rblock">   may appear in ClientHello messages from clients which are offering</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   prior versions of TLS).</td><td> </td><td class="right">   prior versions of TLS).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.5.  OID Filters</td><td> </td><td class="right">4.2.5.  OID Filters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0163" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The "oid_filters" extension allows servers to provide a set of <span class="delete">OID/</span></td><td> </td><td class="rblock">   The "oid_filters" extension allows servers to provide a set of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   value</span> pairs which it would like the client's certificate to match.</td><td> </td><td class="rblock">   <span class="insert">OID/value</span> pairs which it would like the client's certificate to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This extension, if provided by the server, MUST only be sent in the</td><td> </td><td class="rblock">   match.  This extension, if provided by the server, MUST only be sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   CertificateRequest message.</td><td> </td><td class="rblock">   in the CertificateRequest message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque certificate_extension_oid&lt;1..2^8-1&gt;;</td><td> </td><td class="right">          opaque certificate_extension_oid&lt;1..2^8-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque certificate_extension_values&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          opaque certificate_extension_values&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } OIDFilter;</td><td> </td><td class="right">      } OIDFilter;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          OIDFilter filters&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          OIDFilter filters&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } OIDFilterExtension;</td><td> </td><td class="right">      } OIDFilterExtension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0164" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   filters  A list of certificate extension OIDs [RFC5280] with their</td><td> </td><td class="rblock">   filters<span class="insert">:</span>  A list of certificate extension OIDs [RFC5280] with their</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      allowed value(s) and represented in DER-encoded [X690] format.</td><td> </td><td class="right">      allowed value(s) and represented in DER-encoded [X690] format.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Some certificate extension OIDs allow multiple values (e.g.,</td><td> </td><td class="right">      Some certificate extension OIDs allow multiple values (e.g.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Extended Key Usage).  If the server has included a non-empty</td><td> </td><td class="right">      Extended Key Usage).  If the server has included a non-empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      filters list, the client certificate included in the response MUST</td><td> </td><td class="right">      filters list, the client certificate included in the response MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      contain all of the specified extension OIDs that the client</td><td> </td><td class="right">      contain all of the specified extension OIDs that the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      recognizes.  For each extension OID recognized by the client, all</td><td> </td><td class="right">      recognizes.  For each extension OID recognized by the client, all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      of the specified values MUST be present in the client certificate</td><td> </td><td class="right">      of the specified values MUST be present in the client certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (but the certificate MAY have other values as well).  However, the</td><td> </td><td class="right">      (but the certificate MAY have other values as well).  However, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client MUST ignore and skip any unrecognized certificate extension</td><td> </td><td class="right">      client MUST ignore and skip any unrecognized certificate extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      OIDs.  If the client ignored some of the required certificate</td><td> </td><td class="right">      OIDs.  If the client ignored some of the required certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extension OIDs and supplied a certificate that does not satisfy</td><td> </td><td class="right">      extension OIDs and supplied a certificate that does not satisfy</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the request, the server MAY at its discretion either continue the</td><td> </td><td class="right">      the request, the server MAY at its discretion either continue the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0165" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      connection without client authentication<span class="delete">,</span> or abort the handshake</td><td> </td><td class="rblock">      connection without client authentication or abort the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      with an "unsupported_certificate" alert.  Any given OID MUST NOT</td><td> </td><td class="right">      with an "unsupported_certificate" alert.  Any given OID MUST NOT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      appear more than once in the filters list.</td><td> </td><td class="right">      appear more than once in the filters list.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PKIX RFCs define a variety of certificate extension OIDs and their</td><td> </td><td class="right">   PKIX RFCs define a variety of certificate extension OIDs and their</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   corresponding value types.  Depending on the type, matching</td><td> </td><td class="right">   corresponding value types.  Depending on the type, matching</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate extension values are not necessarily bitwise-equal.  It</td><td> </td><td class="right">   certificate extension values are not necessarily bitwise-equal.  It</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is expected that TLS implementations will rely on their PKI libraries</td><td> </td><td class="right">   is expected that TLS implementations will rely on their PKI libraries</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to perform certificate selection using certificate extension OIDs.</td><td> </td><td class="right">   to perform certificate selection using certificate extension OIDs.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document defines matching rules for two standard certificate</td><td> </td><td class="right">   This document defines matching rules for two standard certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l17" /><small>skipping to change at</small><em> page 52, line 8</em></th><th> </th><th><a name="part-r17" /><small>skipping to change at</small><em> page 47, line 18</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is willing to perform post-handshake authentication (Section 4.6.2).</td><td> </td><td class="right">   is willing to perform post-handshake authentication (Section 4.6.2).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers MUST NOT send a post-handshake CertificateRequest to clients</td><td> </td><td class="right">   Servers MUST NOT send a post-handshake CertificateRequest to clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which do not offer this extension.  Servers MUST NOT send this</td><td> </td><td class="right">   which do not offer this extension.  Servers MUST NOT send this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension.</td><td> </td><td class="right">   extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {} PostHandshakeAuth;</td><td> </td><td class="right">      struct {} PostHandshakeAuth;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "extension_data" field of the "post_handshake_auth" extension is</td><td> </td><td class="right">   The "extension_data" field of the "post_handshake_auth" extension is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   zero length.</td><td> </td><td class="right">   zero length.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0166" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">4.2.7.  <span class="delete">Negotia</span>ted Groups</td><td> </td><td class="rblock">4.2.7.  <span class="insert">Suppor</span>ted Groups</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When sent by the client, the "supported_groups" extension indicates</td><td> </td><td class="right">   When sent by the client, the "supported_groups" extension indicates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the named groups which the client supports for key exchange, ordered</td><td> </td><td class="right">   the named groups which the client supports for key exchange, ordered</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   from most preferred to least preferred.</td><td> </td><td class="right">   from most preferred to least preferred.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: In versions of TLS prior to TLS 1.3, this extension was named</td><td> </td><td class="right">   Note: In versions of TLS prior to TLS 1.3, this extension was named</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "elliptic_curves" and only contained elliptic curve groups.  See</td><td> </td><td class="right">   "elliptic_curves" and only contained elliptic curve groups.  See</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0167" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [RFC<span class="delete">449</span>2] and [RFC7919].  This extension was also used to negotiate</td><td> </td><td class="rblock">   [RFC<span class="insert">842</span>2] and [RFC7919].  This extension was also used to negotiate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ECDSA curves.  Signature algorithms are now negotiated independently</td><td> </td><td class="right">   ECDSA curves.  Signature algorithms are now negotiated independently</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (see Section 4.2.3).</td><td> </td><td class="right">   (see Section 4.2.3).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "extension_data" field of this extension contains a</td><td> </td><td class="right">   The "extension_data" field of this extension contains a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "NamedGroupList" value:</td><td> </td><td class="right">   "NamedGroupList" value:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          /* Elliptic Curve Groups (ECDHE) */</td><td> </td><td class="right">          /* Elliptic Curve Groups (ECDHE) */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          secp256r1(0x0017), secp384r1(0x0018), secp521r1(0x0019),</td><td> </td><td class="right">          secp256r1(0x0017), secp384r1(0x0018), secp521r1(0x0019),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l18" /><small>skipping to change at</small><em> page 52, line 43</em></th><th> </th><th><a name="part-r18" /><small>skipping to change at</small><em> page 48, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          /* Reserved Code Points */</td><td> </td><td class="right">          /* Reserved Code Points */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ffdhe_private_use(0x01FC..0x01FF),</td><td> </td><td class="right">          ffdhe_private_use(0x01FC..0x01FF),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ecdhe_private_use(0xFE00..0xFEFF),</td><td> </td><td class="right">          ecdhe_private_use(0xFE00..0xFEFF),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (0xFFFF)</td><td> </td><td class="right">          (0xFFFF)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } NamedGroup;</td><td> </td><td class="right">      } NamedGroup;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          NamedGroup named_group_list&lt;2..2^16-1&gt;;</td><td> </td><td class="right">          NamedGroup named_group_list&lt;2..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } NamedGroupList;</td><td> </td><td class="right">      } NamedGroupList;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0168" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Elliptic Curve Groups <span class="delete">(ECDHE)</span>  Indicates support for the</td><td> </td><td class="rblock">   Elliptic Curve Groups <span class="insert">(ECDHE):</span>  Indicates support for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      corresponding named curve, defined <span class="delete">either</span> in FIPS 186-4 [DSS] or</td><td> </td><td class="rblock">      corresponding named curve, defined in <span class="insert">either</span> FIPS 186-4 [DSS] or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">in</span> [RFC7748].  Values 0xFE00 through 0xFEFF are reserved for</td><td> </td><td class="rblock">      [RFC7748].  Values 0xFE00 through 0xFEFF are reserved for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">private use.</span></td><td> </td><td class="rblock">      <span class="insert">Private Use [RFC8126].</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0169" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Finite Field Groups (DHE)<span class="delete">  Indicates support of</span> the corresponding</td><td> </td><td class="rblock">   Finite Field Groups (DHE)<span class="insert">:  Indicates support for</span> the corresponding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      finite field group, defined in [RFC7919].  Values 0x01FC through</td><td> </td><td class="right">      finite field group, defined in [RFC7919].  Values 0x01FC through</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0170" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      0x01FF are reserved for <span class="delete">private u</span>se.</td><td> </td><td class="rblock">      0x01FF are reserved for <span class="insert">Private U</span>se.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0171" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Items in named_group_list are ordered according to the <span class="delete">client</span>'s</td><td> </td><td class="rblock">   Items in named_group_list are ordered according to the <span class="insert">sender</span>'s</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   preferences (most preferred choice first).</td><td> </td><td class="right">   preferences (most preferred choice first).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As of TLS 1.3, servers are permitted to send the "supported_groups"</td><td> </td><td class="right">   As of TLS 1.3, servers are permitted to send the "supported_groups"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension to the client.  Clients MUST NOT act upon any information</td><td> </td><td class="right">   extension to the client.  Clients MUST NOT act upon any information</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   found in "supported_groups" prior to successful completion of the</td><td> </td><td class="right">   found in "supported_groups" prior to successful completion of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake but MAY use the information learned from a successfully</td><td> </td><td class="right">   handshake but MAY use the information learned from a successfully</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   completed handshake to change what groups they use in their</td><td> </td><td class="right">   completed handshake to change what groups they use in their</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "key_share" extension in subsequent connections.  If the server has a</td><td> </td><td class="right">   "key_share" extension in subsequent connections.  If the server has a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   group it prefers to the ones in the "key_share" extension but is</td><td> </td><td class="right">   group it prefers to the ones in the "key_share" extension but is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   still willing to accept the ClientHello, it SHOULD send</td><td> </td><td class="right">   still willing to accept the ClientHello, it SHOULD send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "supported_groups" to update the client's view of its preferences;</td><td> </td><td class="right">   "supported_groups" to update the client's view of its preferences;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   this extension SHOULD contain all groups the server supports,</td><td> </td><td class="right">   this extension SHOULD contain all groups the server supports,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   regardless of whether they are currently supported by the client.</td><td> </td><td class="right">   regardless of whether they are currently supported by the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.8.  Key Share</td><td> </td><td class="right">4.2.8.  Key Share</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "key_share" extension contains the endpoint's cryptographic</td><td> </td><td class="right">   The "key_share" extension contains the endpoint's cryptographic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parameters.</td><td> </td><td class="right">   parameters.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Clients MAY send an empty client_shares vector in order to request</td><td> </td><td class="right">   Clients MAY send an empty client_shares vector in order to request</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0172" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   group selection from the <span class="delete">server</span> at the cost of an additional round</td><td> </td><td class="rblock">   group selection from the <span class="insert">server,</span> at the cost of an additional round</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">trip.</span>  (see Section <span class="delete">4.1.4)</span></td><td> </td><td class="rblock">   <span class="insert">trip</span> (see Section <span class="insert">4.1.4).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          NamedGroup group;</td><td> </td><td class="right">          NamedGroup group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque key_exchange&lt;1..2^16-1&gt;;</td><td> </td><td class="right">          opaque key_exchange&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } KeyShareEntry;</td><td> </td><td class="right">      } KeyShareEntry;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0173" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   group  The named group for the key being exchanged.</td><td> </td><td class="rblock">   group<span class="insert">:</span>  The named group for the key being exchanged.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0174" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   key_exchange  Key exchange information.  The contents of this field</td><td> </td><td class="rblock">   key_exchange<span class="insert">:</span>  Key exchange information.  The contents of this field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      are determined by the specified group and its corresponding</td><td> </td><td class="right">      are determined by the specified group and its corresponding</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0175" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      definition.  Finite Field Diffie-Hellman [DH] parameters are</td><td> </td><td class="rblock">      definition.  Finite Field Diffie-Hellman [DH<span class="insert">76</span>] parameters are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      described in Section 4.2.8.1; Elliptic Curve Diffie-Hellman</td><td> </td><td class="right">      described in Section 4.2.8.1; Elliptic Curve Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      parameters are described in Section 4.2.8.2.</td><td> </td><td class="right">      parameters are described in Section 4.2.8.2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the ClientHello message, the "extension_data" field of this</td><td> </td><td class="right">   In the ClientHello message, the "extension_data" field of this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension contains a "KeyShareClientHello" value:</td><td> </td><td class="right">   extension contains a "KeyShareClientHello" value:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          KeyShareEntry client_shares&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          KeyShareEntry client_shares&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } KeyShareClientHello;</td><td> </td><td class="right">      } KeyShareClientHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0176" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client_shares  A list of offered KeyShareEntry values in descending</td><td> </td><td class="rblock">   client_shares<span class="insert">:</span>  A list of offered KeyShareEntry values in descending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      order of client preference.</td><td> </td><td class="right">      order of client preference.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This vector MAY be empty if the client is requesting a</td><td> </td><td class="right">   This vector MAY be empty if the client is requesting a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest.  Each KeyShareEntry value MUST correspond to a</td><td> </td><td class="right">   HelloRetryRequest.  Each KeyShareEntry value MUST correspond to a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   group offered in the "supported_groups" extension and MUST appear in</td><td> </td><td class="right">   group offered in the "supported_groups" extension and MUST appear in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the same order.  However, the values MAY be a non-contiguous subset</td><td> </td><td class="right">   the same order.  However, the values MAY be a non-contiguous subset</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the "supported_groups" extension and MAY omit the most preferred</td><td> </td><td class="right">   of the "supported_groups" extension and MAY omit the most preferred</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   groups.  Such a situation could arise if the most preferred groups</td><td> </td><td class="right">   groups.  Such a situation could arise if the most preferred groups</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are new and unlikely to be supported in enough places to make</td><td> </td><td class="right">   are new and unlikely to be supported in enough places to make</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pregenerating key shares for them efficient.</td><td> </td><td class="right">   pregenerating key shares for them efficient.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l19" /><small>skipping to change at</small><em> page 54, line 32</em></th><th> </th><th><a name="part-r19" /><small>skipping to change at</small><em> page 49, line 42</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers MAY check for violations of these rules and abort the</td><td> </td><td class="right">   Servers MAY check for violations of these rules and abort the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake with an "illegal_parameter" alert if one is violated.</td><td> </td><td class="right">   handshake with an "illegal_parameter" alert if one is violated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In a HelloRetryRequest message, the "extension_data" field of this</td><td> </td><td class="right">   In a HelloRetryRequest message, the "extension_data" field of this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension contains a KeyShareHelloRetryRequest value:</td><td> </td><td class="right">   extension contains a KeyShareHelloRetryRequest value:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          NamedGroup selected_group;</td><td> </td><td class="right">          NamedGroup selected_group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } KeyShareHelloRetryRequest;</td><td> </td><td class="right">      } KeyShareHelloRetryRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0177" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   selected_group  The mutually supported group the server intends to</td><td> </td><td class="rblock">   selected_group<span class="insert">:</span>  The mutually supported group the server intends to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiate and is requesting a retried ClientHello/KeyShare for.</td><td> </td><td class="right">      negotiate and is requesting a retried ClientHello/KeyShare for.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Upon receipt of this extension in a HelloRetryRequest, the client</td><td> </td><td class="right">   Upon receipt of this extension in a HelloRetryRequest, the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST verify that (1) the selected_group field corresponds to a group</td><td> </td><td class="right">   MUST verify that (1) the selected_group field corresponds to a group</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which was provided in the "supported_groups" extension in the</td><td> </td><td class="right">   which was provided in the "supported_groups" extension in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0178" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   original ClientHello<span class="delete">;</span> and (2) the selected_group field does not</td><td> </td><td class="rblock">   original ClientHello and (2) the selected_group field does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   correspond to a group which was provided in the "key_share" extension</td><td> </td><td class="right">   correspond to a group which was provided in the "key_share" extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in the original ClientHello.  If either of these checks fails, then</td><td> </td><td class="right">   in the original ClientHello.  If either of these checks fails, then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client MUST abort the handshake with an "illegal_parameter"</td><td> </td><td class="right">   the client MUST abort the handshake with an "illegal_parameter"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alert.  Otherwise, when sending the new ClientHello, the client MUST</td><td> </td><td class="right">   alert.  Otherwise, when sending the new ClientHello, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   replace the original "key_share" extension with one containing only a</td><td> </td><td class="right">   replace the original "key_share" extension with one containing only a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   new KeyShareEntry for the group indicated in the selected_group field</td><td> </td><td class="right">   new KeyShareEntry for the group indicated in the selected_group field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the triggering HelloRetryRequest.</td><td> </td><td class="right">   of the triggering HelloRetryRequest.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In a ServerHello message, the "extension_data" field of this</td><td> </td><td class="right">   In a ServerHello message, the "extension_data" field of this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension contains a KeyShareServerHello value:</td><td> </td><td class="right">   extension contains a KeyShareServerHello value:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          KeyShareEntry server_share;</td><td> </td><td class="right">          KeyShareEntry server_share;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } KeyShareServerHello;</td><td> </td><td class="right">      } KeyShareServerHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0179" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server_share  A single KeyShareEntry value that is in the same group</td><td> </td><td class="rblock">   server_share<span class="insert">:</span>  A single KeyShareEntry value that is in the same group</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      as one of the client's shares.</td><td> </td><td class="right">      as one of the client's shares.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If using (EC)DHE key establishment, servers offer exactly one</td><td> </td><td class="right">   If using (EC)DHE key establishment, servers offer exactly one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   KeyShareEntry in the ServerHello.  This value MUST be in the same</td><td> </td><td class="right">   KeyShareEntry in the ServerHello.  This value MUST be in the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   group as the KeyShareEntry value offered by the client that the</td><td> </td><td class="right">   group as the KeyShareEntry value offered by the client that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0180" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server has selected for the negotiated key exchange.  Servers MUST</td><td> </td><td class="rblock">   server has selected for the negotiated key exchange.  Servers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   NOT send a KeyShareEntry for any group not indicated in the</td><td> </td><td class="rblock">   MUST NOT send a KeyShareEntry for any group not indicated in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "supported_groups" extension and MUST NOT send a KeyShareEntry when</td><td> </td><td class="rblock">   <span class="insert">client's</span> "supported_groups" extension and MUST NOT send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   using the "psk_ke" PskKeyExchangeMode.  If using (EC)DHE key</td><td> </td><td class="rblock">   KeyShareEntry when using the "psk_ke" PskKeyExchangeMode.  If using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">establishment,</span> and a HelloRetryRequest containing a "key_share"</td><td> </td><td class="rblock">   (EC)DHE key <span class="insert">establishment</span> and a HelloRetryRequest containing a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extension was received by the client, the client MUST verify that the</td><td> </td><td class="rblock">   "key_share" extension was received by the client, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   selected NamedGroup in the ServerHello is the same as that in the</td><td> </td><td class="rblock">   verify that the selected NamedGroup in the ServerHello is the same as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   HelloRetryRequest.  If this check fails, the client MUST abort the</td><td> </td><td class="rblock">   that in the HelloRetryRequest.  If this check fails, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake with an "illegal_parameter" alert.</td><td> </td><td class="rblock">   abort the handshake with an "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.8.1.  Diffie-Hellman Parameters</td><td> </td><td class="right">4.2.8.1.  Diffie-Hellman Parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0181" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Diffie-Hellman [DH] parameters for both clients and servers are</td><td> </td><td class="rblock">   Diffie-Hellman [DH<span class="insert">76</span>] parameters for both clients and servers are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   encoded in the opaque key_exchange field of a KeyShareEntry in a</td><td> </td><td class="right">   encoded in the opaque key_exchange field of a KeyShareEntry in a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   KeyShare structure.  The opaque value contains the Diffie-Hellman</td><td> </td><td class="right">   KeyShare structure.  The opaque value contains the Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   public value (Y = g^X mod p) for the specified group (see [RFC7919]</td><td> </td><td class="right">   public value (Y = g^X mod p) for the specified group (see [RFC7919]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for group definitions) encoded as a big-endian integer and padded to</td><td> </td><td class="right">   for group definitions) encoded as a big-endian integer and padded to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the left with zeros to the size of p in bytes.</td><td> </td><td class="right">   the left with zeros to the size of p in bytes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: For a given Diffie-Hellman group, the padding results in all</td><td> </td><td class="right">   Note: For a given Diffie-Hellman group, the padding results in all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   public keys having the same length.</td><td> </td><td class="right">   public keys having the same length.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Peers MUST validate each other's public key Y by ensuring that 1 &lt; Y</td><td> </td><td class="right">   Peers MUST validate each other's public key Y by ensuring that 1 &lt; Y</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   &lt; p-1.  This check ensures that the remote peer is properly behaved</td><td> </td><td class="right">   &lt; p-1.  This check ensures that the remote peer is properly behaved</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and isn't forcing the local system into a small subgroup.</td><td> </td><td class="right">   and isn't forcing the local system into a small subgroup.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.8.2.  ECDHE Parameters</td><td> </td><td class="right">4.2.8.2.  ECDHE Parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ECDHE parameters for both clients and servers are encoded in the</td><td> </td><td class="right">   ECDHE parameters for both clients and servers are encoded in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   opaque key_exchange field of a KeyShareEntry in a KeyShare structure.</td><td> </td><td class="right">   opaque key_exchange field of a KeyShareEntry in a KeyShare structure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0182" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   For secp256r1, secp384r1 and secp521r1, the contents are the</td><td> </td><td class="rblock">   For secp256r1, secp384r1<span class="insert">,</span> and secp521r1, the contents are the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   serialized value of the following struct:</td><td> </td><td class="right">   serialized value of the following struct:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8 legacy_form = 4;</td><td> </td><td class="right">          uint8 legacy_form = 4;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque X[coordinate_length];</td><td> </td><td class="right">          opaque X[coordinate_length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque Y[coordinate_length];</td><td> </td><td class="right">          opaque Y[coordinate_length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } UncompressedPointRepresentation;</td><td> </td><td class="right">      } UncompressedPointRepresentation;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0183" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   X and Y<span class="delete"> respectively</span> are the binary representations of the x and y</td><td> </td><td class="rblock">   X and Y<span class="insert">, respectively,</span> are the binary representations of the x and y</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   values in network byte order.  There are no internal length markers,</td><td> </td><td class="right">   values in network byte order.  There are no internal length markers,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   so each number representation occupies as many octets as implied by</td><td> </td><td class="right">   so each number representation occupies as many octets as implied by</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0184" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the curve parameters.  For <span class="delete">P-256</span> this means that each of X and Y use</td><td> </td><td class="rblock">   the curve parameters.  For <span class="insert">P-256,</span> this means that each of X and Y use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   32 octets, padded on the left by zeros if necessary.  For <span class="delete">P-384</span> they</td><td> </td><td class="rblock">   32 octets, padded on the left by zeros if necessary.  For <span class="insert">P-384,</span> they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   take 48 octets <span class="delete">each, and for P-521</span> they take 66 octets each.</td><td> </td><td class="rblock">   take 48 octets <span class="insert">each.  For P-521,</span> they take 66 octets each.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0185" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   For the curves secp256r1, secp384r1 and secp521r1, peers MUST</td><td> </td><td class="rblock">   For the curves secp256r1, secp384r1<span class="insert">,</span> and secp521r1, peers MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   validate each other's public value Q by ensuring that the point is a</td><td> </td><td class="right">   validate each other's public value Q by ensuring that the point is a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   valid point on the elliptic curve.  The appropriate validation</td><td> </td><td class="right">   valid point on the elliptic curve.  The appropriate validation</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0186" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   procedures are defined in Section 4.3.7 of [<span class="delete">X962</span>] and alternatively</td><td> </td><td class="rblock">   procedures are defined in Section 4.3.7 of [<span class="insert">ECDSA</span>] and alternatively</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in Section 5.6.2.3 of [KEYAGREEMENT].  This process consists of three</td><td> </td><td class="right">   in Section 5.6.2.3 of [KEYAGREEMENT].  This process consists of three</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   steps: (1) verify that Q is not the point at infinity (O), (2) verify</td><td> </td><td class="right">   steps: (1) verify that Q is not the point at infinity (O), (2) verify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that for Q = (x, y) both integers x and y are in the correct</td><td> </td><td class="right">   that for Q = (x, y) both integers x and y are in the correct</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0187" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   interval, (3) ensure that (x, y) is a correct solution to the</td><td> </td><td class="rblock">   interval, <span class="insert">and</span> (3) ensure that (x, y) is a correct solution to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   elliptic curve equation.  For these curves, <span class="delete">implementers</span> do not need</td><td> </td><td class="rblock">   elliptic curve equation.  For these curves, <span class="insert">implementors</span> do not need</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to verify membership in the correct subgroup.</td><td> </td><td class="right">   to verify membership in the correct subgroup.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For X25519 and X448, the contents of the public value are the byte</td><td> </td><td class="right">   For X25519 and X448, the contents of the public value are the byte</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   string inputs and outputs of the corresponding functions defined in</td><td> </td><td class="right">   string inputs and outputs of the corresponding functions defined in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0188" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [RFC7748]<span class="delete">,</span> 32 bytes for X25519 and 56 bytes for X448.</td><td> </td><td class="rblock">   [RFC7748]<span class="insert">:</span> 32 bytes for X25519 and 56 bytes for X448.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Versions of TLS prior to 1.3 permitted point format</td><td> </td><td class="right">   Note: Versions of TLS prior to 1.3 permitted point format</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiation; TLS 1.3 removes this feature in favor of a single point</td><td> </td><td class="right">   negotiation; TLS 1.3 removes this feature in favor of a single point</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   format for each curve.</td><td> </td><td class="right">   format for each curve.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.9.  Pre-Shared Key Exchange Modes</td><td> </td><td class="right">4.2.9.  Pre-Shared Key Exchange Modes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to use PSKs, clients MUST also send a</td><td> </td><td class="right">   In order to use PSKs, clients MUST also send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "psk_key_exchange_modes" extension.  The semantics of this extension</td><td> </td><td class="right">   "psk_key_exchange_modes" extension.  The semantics of this extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are that the client only supports the use of PSKs with these modes,</td><td> </td><td class="right">   are that the client only supports the use of PSKs with these modes,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which restricts both the use of PSKs offered in this ClientHello and</td><td> </td><td class="right">   which restricts both the use of PSKs offered in this ClientHello and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   those which the server might supply via NewSessionTicket.</td><td> </td><td class="right">   those which the server might supply via NewSessionTicket.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A client MUST provide a "psk_key_exchange_modes" extension if it</td><td> </td><td class="right">   A client MUST provide a "psk_key_exchange_modes" extension if it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   offers a "pre_shared_key" extension.  If clients offer</td><td> </td><td class="right">   offers a "pre_shared_key" extension.  If clients offer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "pre_shared_key" without a "psk_key_exchange_modes" extension,</td><td> </td><td class="right">   "pre_shared_key" without a "psk_key_exchange_modes" extension,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   servers MUST abort the handshake.  Servers MUST NOT select a key</td><td> </td><td class="right">   servers MUST abort the handshake.  Servers MUST NOT select a key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exchange mode that is not listed by the client.  This extension also</td><td> </td><td class="right">   exchange mode that is not listed by the client.  This extension also</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0189" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   restricts the modes for use with PSK resumption<span class="delete">; s</span>ervers SHOULD NOT</td><td> </td><td class="rblock">   restricts the modes for use with PSK resumption<span class="insert">.  S</span>ervers SHOULD NOT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   send NewSessionTicket with tickets that are not compatible with the</td><td> </td><td class="right">   send NewSessionTicket with tickets that are not compatible with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   advertised modes; however, if a server does so, the impact will just</td><td> </td><td class="right">   advertised modes; however, if a server does so, the impact will just</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be that the client's attempts at resumption fail.</td><td> </td><td class="right">   be that the client's attempts at resumption fail.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server MUST NOT send a "psk_key_exchange_modes" extension.</td><td> </td><td class="right">   The server MUST NOT send a "psk_key_exchange_modes" extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum { psk_ke(0), psk_dhe_ke(1), (255) } PskKeyExchangeMode;</td><td> </td><td class="right">      enum { psk_ke(0), psk_dhe_ke(1), (255) } PskKeyExchangeMode;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          PskKeyExchangeMode ke_modes&lt;1..255&gt;;</td><td> </td><td class="right">          PskKeyExchangeMode ke_modes&lt;1..255&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } PskKeyExchangeModes;</td><td> </td><td class="right">      } PskKeyExchangeModes;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0190" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">psk_ke</span>  PSK-only key establishment.  In this mode, the server MUST</td><td> </td><td class="rblock">   <span class="insert">psk_ke:</span>  PSK-only key establishment.  In this mode, the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      NOT supply a "key_share" value.</td><td> </td><td class="rblock">      MUST NOT supply a "key_share" value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0191" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   psk_dhe_ke  PSK with (EC)DHE key establishment.  In this mode, the</td><td> </td><td class="rblock">   psk_dhe_ke<span class="insert">:</span>  PSK with (EC)DHE key establishment.  In this mode, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client and server MUST supply "key_share" values as described in</td><td> </td><td class="right">      client and server MUST supply "key_share" values as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 4.2.8.</td><td> </td><td class="right">      Section 4.2.8.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Any future values that are allocated must ensure that the transmitted</td><td> </td><td class="right">   Any future values that are allocated must ensure that the transmitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protocol messages unambiguously identify which mode was selected by</td><td> </td><td class="right">   protocol messages unambiguously identify which mode was selected by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server; at present, this is indicated by the presence of the</td><td> </td><td class="right">   the server; at present, this is indicated by the presence of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "key_share" in the ServerHello.</td><td> </td><td class="right">   "key_share" in the ServerHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.10.  Early Data Indication</td><td> </td><td class="right">4.2.10.  Early Data Indication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When a PSK is used and early data is allowed for that PSK, the client</td><td> </td><td class="right">   When a PSK is used and early data is allowed for that PSK, the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0192" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   can send <span class="delete">application data</span> in its first flight of messages.  If the</td><td> </td><td class="rblock">   can send <span class="insert">Application Data</span> in its first flight of messages.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client opts to do so, it MUST supply both the <span class="delete">"early_data" extension</span></td><td> </td><td class="rblock">   client opts to do so, it MUST supply both the "pre_shared_key" <span class="insert">and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   as well as the</span> "pre_shared_key" <span class="delete">extension.</span></td><td> </td><td class="rblock"><span class="insert">   "early_data" extensions.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "extension_data" field of this extension contains an</td><td> </td><td class="right">   The "extension_data" field of this extension contains an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "EarlyDataIndication" value.</td><td> </td><td class="right">   "EarlyDataIndication" value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {} Empty;</td><td> </td><td class="right">      struct {} Empty;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (Handshake.msg_type) {</td><td> </td><td class="right">          select (Handshake.msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case new_session_ticket:   uint32 max_early_data_size;</td><td> </td><td class="right">              case new_session_ticket:   uint32 max_early_data_size;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case client_hello:         Empty;</td><td> </td><td class="right">              case client_hello:         Empty;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case encrypted_extensions: Empty;</td><td> </td><td class="right">              case encrypted_extensions: Empty;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          };</td><td> </td><td class="right">          };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } EarlyDataIndication;</td><td> </td><td class="right">      } EarlyDataIndication;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0193" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   See Section 4.6.1 for the use of the max_early_data_size field.</td><td> </td><td class="rblock">   See Section 4.6.1 for <span class="insert">details regarding</span> the use of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   max_early_data_size field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The parameters for the 0-RTT data (version, symmetric cipher suite,</td><td> </td><td class="right">   The parameters for the 0-RTT data (version, symmetric cipher suite,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0194" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">ALPN</span> protocol, etc.) are those associated with the PSK in use.  For</td><td> </td><td class="rblock">   <span class="insert">Application-Layer Protocol Negotiation (ALPN) [RFC7301]</span> protocol,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   externally provisioned PSKs, the associated values are those</td><td> </td><td class="rblock">   etc.) are those associated with the PSK in use.  For externally</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   provisioned along with the key.  For PSKs established via a</td><td> </td><td class="rblock">   provisioned PSKs, the associated values are those provisioned along</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   NewSessionTicket message, the associated values are those which were</td><td> </td><td class="rblock">   with the key.  For PSKs established via a NewSessionTicket message,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   negotiated in the connection which established the PSK.  The PSK used</td><td> </td><td class="rblock">   the associated values are those which were negotiated in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   to encrypt the early data MUST be the first PSK listed in the</td><td> </td><td class="rblock">   connection which established the PSK.  The PSK used to encrypt the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client's "pre_shared_key" extension.</td><td> </td><td class="rblock">   early data MUST be the first PSK listed in the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   "pre_shared_key" extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For PSKs provisioned via NewSessionTicket, a server MUST validate</td><td> </td><td class="right">   For PSKs provisioned via NewSessionTicket, a server MUST validate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that the ticket age for the selected PSK identity (computed by</td><td> </td><td class="right">   that the ticket age for the selected PSK identity (computed by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   subtracting ticket_age_add from PskIdentity.obfuscated_ticket_age</td><td> </td><td class="right">   subtracting ticket_age_add from PskIdentity.obfuscated_ticket_age</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   modulo 2^32) is within a small tolerance of the time since the ticket</td><td> </td><td class="right">   modulo 2^32) is within a small tolerance of the time since the ticket</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   was issued (see Section 8).  If it is not, the server SHOULD proceed</td><td> </td><td class="right">   was issued (see Section 8).  If it is not, the server SHOULD proceed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with the handshake but reject 0-RTT, and SHOULD NOT take any other</td><td> </td><td class="right">   with the handshake but reject 0-RTT, and SHOULD NOT take any other</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   action that assumes that this ClientHello is fresh.</td><td> </td><td class="right">   action that assumes that this ClientHello is fresh.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0-RTT messages sent in the first flight have the same (encrypted)</td><td> </td><td class="right">   0-RTT messages sent in the first flight have the same (encrypted)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l20" /><small>skipping to change at</small><em> page 58, line 30</em></th><th> </th><th><a name="part-r20" /><small>skipping to change at</small><em> page 54, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A server which receives an "early_data" extension MUST behave in one</td><td> </td><td class="right">   A server which receives an "early_data" extension MUST behave in one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of three ways:</td><td> </td><td class="right">   of three ways:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Ignore the extension and return a regular 1-RTT response.  The</td><td> </td><td class="right">   -  Ignore the extension and return a regular 1-RTT response.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server then skips past early data by attempting to deprotect</td><td> </td><td class="right">      server then skips past early data by attempting to deprotect</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      received records using the handshake traffic key, discarding</td><td> </td><td class="right">      received records using the handshake traffic key, discarding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      records which fail deprotection (up to the configured</td><td> </td><td class="right">      records which fail deprotection (up to the configured</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      max_early_data_size).  Once a record is deprotected successfully,</td><td> </td><td class="right">      max_early_data_size).  Once a record is deprotected successfully,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      it is treated as the start of the client's second flight and the</td><td> </td><td class="right">      it is treated as the start of the client's second flight and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0195" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">the </span>server proceeds as with an ordinary 1-RTT handshake.</td><td> </td><td class="rblock">      server proceeds as with an ordinary 1-RTT handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Request that the client send another ClientHello by responding</td><td> </td><td class="right">   -  Request that the client send another ClientHello by responding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      with a HelloRetryRequest.  A client MUST NOT include the</td><td> </td><td class="right">      with a HelloRetryRequest.  A client MUST NOT include the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "early_data" extension in its followup ClientHello.  The server</td><td> </td><td class="right">      "early_data" extension in its followup ClientHello.  The server</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0196" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      then ignores early data by skipping all records with external</td><td> </td><td class="rblock">      then ignores early data by skipping all records with <span class="insert">an </span>external</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      content type of "application_data" (indicating that they are</td><td> </td><td class="right">      content type of "application_data" (indicating that they are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      encrypted), up to the configured max_early_data_size.</td><td> </td><td class="right">      encrypted), up to the configured max_early_data_size.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Return its own "early_data" extension in EncryptedExtensions,</td><td> </td><td class="right">   -  Return its own "early_data" extension in EncryptedExtensions,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      indicating that it intends to process the early data.  It is not</td><td> </td><td class="right">      indicating that it intends to process the early data.  It is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      possible for the server to accept only a subset of the early data</td><td> </td><td class="right">      possible for the server to accept only a subset of the early data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      messages.  Even though the server sends a message accepting early</td><td> </td><td class="right">      messages.  Even though the server sends a message accepting early</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      data, the actual early data itself may already be in flight by the</td><td> </td><td class="right">      data, the actual early data itself may already be in flight by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      time the server generates this message.</td><td> </td><td class="right">      time the server generates this message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to accept early data, the server MUST have accepted a PSK</td><td> </td><td class="right">   In order to accept early data, the server MUST have accepted a PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher suite and selected the first key offered in the client's</td><td> </td><td class="right">   cipher suite and selected the first key offered in the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "pre_shared_key" extension.  In addition, it MUST verify that the</td><td> </td><td class="right">   "pre_shared_key" extension.  In addition, it MUST verify that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0197" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   following values are the same as those associated with the selected</td><td> </td><td class="rblock">   following values are the same as those associated with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   PSK:</td><td> </td><td class="rblock">   selected PSK:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The TLS version number</td><td> </td><td class="right">   -  The TLS version number</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0198" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The selected cipher suite</td><td> </td><td class="right">   -  The selected cipher suite</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The selected ALPN [RFC7301] protocol, if any</td><td> </td><td class="right">   -  The selected ALPN [RFC7301] protocol, if any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These requirements are a superset of those needed to perform a 1-RTT</td><td> </td><td class="right">   These requirements are a superset of those needed to perform a 1-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake using the PSK in question.  For externally established</td><td> </td><td class="right">   handshake using the PSK in question.  For externally established</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSKs, the associated values are those provisioned along with the key.</td><td> </td><td class="right">   PSKs, the associated values are those provisioned along with the key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For PSKs established via a NewSessionTicket message, the associated</td><td> </td><td class="right">   For PSKs established via a NewSessionTicket message, the associated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   values are those negotiated in the connection during which the ticket</td><td> </td><td class="right">   values are those negotiated in the connection during which the ticket</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   was established.</td><td> </td><td class="right">   was established.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l21" /><small>skipping to change at</small><em> page 59, line 18</em></th><th> </th><th><a name="part-r21" /><small>skipping to change at</small><em> page 55, line 6</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These requirements are a superset of those needed to perform a 1-RTT</td><td> </td><td class="right">   These requirements are a superset of those needed to perform a 1-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake using the PSK in question.  For externally established</td><td> </td><td class="right">   handshake using the PSK in question.  For externally established</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSKs, the associated values are those provisioned along with the key.</td><td> </td><td class="right">   PSKs, the associated values are those provisioned along with the key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For PSKs established via a NewSessionTicket message, the associated</td><td> </td><td class="right">   For PSKs established via a NewSessionTicket message, the associated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   values are those negotiated in the connection during which the ticket</td><td> </td><td class="right">   values are those negotiated in the connection during which the ticket</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   was established.</td><td> </td><td class="right">   was established.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Future extensions MUST define their interaction with 0-RTT.</td><td> </td><td class="right">   Future extensions MUST define their interaction with 0-RTT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If any of these checks fail, the server MUST NOT respond with the</td><td> </td><td class="right">   If any of these checks fail, the server MUST NOT respond with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0199" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extension and must discard all the first<span class="delete"> </span>flight data using one of the</td><td> </td><td class="rblock">   extension and must discard all the first<span class="insert">-</span>flight data using one of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   first two mechanisms listed above (thus falling back to 1-RTT or</td><td> </td><td class="right">   first two mechanisms listed above (thus falling back to 1-RTT or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   2-RTT).  If the client attempts a 0-RTT handshake but the server</td><td> </td><td class="right">   2-RTT).  If the client attempts a 0-RTT handshake but the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   rejects it, the server will generally not have the 0-RTT record</td><td> </td><td class="right">   rejects it, the server will generally not have the 0-RTT record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protection keys and must instead use trial decryption (either with</td><td> </td><td class="right">   protection keys and must instead use trial decryption (either with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the 1-RTT handshake keys or by looking for a cleartext ClientHello in</td><td> </td><td class="right">   the 1-RTT handshake keys or by looking for a cleartext ClientHello in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0200" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the case of HelloRetryRequest) to find the first non-0-RTT message.</td><td> </td><td class="rblock">   the case of <span class="insert">a </span>HelloRetryRequest) to find the first non-0-RTT message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server chooses to accept the "early_data" extension, then it</td><td> </td><td class="right">   If the server chooses to accept the "early_data" extension, then it</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0201" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   MUST comply with the same error<span class="delete"> </span>handling requirements specified for</td><td> </td><td class="rblock">   MUST comply with the same error<span class="insert">-</span>handling requirements specified for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   all records when processing early data records.  Specifically, if the</td><td> </td><td class="right">   all records when processing early data records.  Specifically, if the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server fails to decrypt a 0-RTT record following an accepted</td><td> </td><td class="right">   server fails to decrypt a 0-RTT record following an accepted</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0202" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "early_data" extension it MUST terminate the connection with a</td><td> </td><td class="rblock">   "early_data" extension<span class="insert">,</span> it MUST terminate the connection with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "bad_record_mac" alert as per Section 5.2.</td><td> </td><td class="right">   "bad_record_mac" alert as per Section 5.2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server rejects the "early_data" extension, the client</td><td> </td><td class="right">   If the server rejects the "early_data" extension, the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0203" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   application MAY opt to retransmit the <span class="delete">application d</span>ata previously</td><td> </td><td class="rblock">   application MAY opt to retransmit the <span class="insert">Application D</span>ata previously</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sent in early data once the handshake has been completed.  Note that</td><td> </td><td class="right">   sent in early data once the handshake has been completed.  Note that</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0204" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   automatic <span class="delete">re-transmission</span> of early data could result in assumptions</td><td> </td><td class="rblock">   automatic <span class="insert">retransmission</span> of early data could result in <span class="insert">incorrect</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">about</span> the status of the <span class="delete">connection being incorrect.</span>  For instance,</td><td> </td><td class="rblock">   assumptions <span class="insert">regarding</span> the status of the <span class="insert">connection.</span>  For instance,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   when the negotiated connection selects a different ALPN protocol from</td><td> </td><td class="right">   when the negotiated connection selects a different ALPN protocol from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   what was used for the early data, an application might need to</td><td> </td><td class="right">   what was used for the early data, an application might need to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   construct different messages.  Similarly, if early data assumes</td><td> </td><td class="right">   construct different messages.  Similarly, if early data assumes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   anything about the connection state, it might be sent in error after</td><td> </td><td class="right">   anything about the connection state, it might be sent in error after</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the handshake completes.</td><td> </td><td class="right">   the handshake completes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0205" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   A TLS implementation SHOULD NOT automatically <span class="delete">re-send</span> early data;</td><td> </td><td class="rblock">   A TLS implementation SHOULD NOT automatically <span class="insert">resend</span> early data;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   applications are in a better position to decide when <span class="delete">re-transmission</span></td><td> </td><td class="rblock">   applications are in a better position to decide when <span class="insert">retransmission</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   is appropriate.  A TLS implementation MUST NOT automatically <span class="delete">re-send</span></td><td> </td><td class="rblock">   is appropriate.  A TLS implementation MUST NOT automatically <span class="insert">resend</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   early data unless the negotiated connection selects the same ALPN</td><td> </td><td class="right">   early data unless the negotiated connection selects the same ALPN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protocol.</td><td> </td><td class="right">   protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.2.11.  Pre-Shared Key Extension</td><td> </td><td class="right">4.2.11.  Pre-Shared Key Extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "pre_shared_key" extension is used to negotiate the identity of</td><td> </td><td class="right">   The "pre_shared_key" extension is used to negotiate the identity of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the pre-shared key to be used with a given handshake in association</td><td> </td><td class="right">   the pre-shared key to be used with a given handshake in association</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with PSK key establishment.</td><td> </td><td class="right">   with PSK key establishment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "extension_data" field of this extension contains a</td><td> </td><td class="right">   The "extension_data" field of this extension contains a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l22" /><small>skipping to change at</small><em> page 60, line 33</em></th><th> </th><th><a name="part-r22" /><small>skipping to change at</small><em> page 56, line 27</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          PskBinderEntry binders&lt;33..2^16-1&gt;;</td><td> </td><td class="right">          PskBinderEntry binders&lt;33..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } OfferedPsks;</td><td> </td><td class="right">      } OfferedPsks;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (Handshake.msg_type) {</td><td> </td><td class="right">          select (Handshake.msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case client_hello: OfferedPsks;</td><td> </td><td class="right">              case client_hello: OfferedPsks;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case server_hello: uint16 selected_identity;</td><td> </td><td class="right">              case server_hello: uint16 selected_identity;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          };</td><td> </td><td class="right">          };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } PreSharedKeyExtension;</td><td> </td><td class="right">      } PreSharedKeyExtension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0206" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">identity</span>  A label for a key.  For instance, a ticket defined in</td><td> </td><td class="rblock">   <span class="insert">identity:</span>  A label for a key.  For instance, a ticket <span class="insert">(as</span> defined in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Appendix <span class="delete">B.3.4</span> or a label for a pre-shared key established</td><td> </td><td class="rblock">      Appendix <span class="insert">B.3.4)</span> or a label for a pre-shared key established</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      externally.</td><td> </td><td class="right">      externally.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0207" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   obfuscated_ticket_age  An obfuscated version of the age of the key.</td><td> </td><td class="rblock">   obfuscated_ticket_age<span class="insert">:</span>  An obfuscated version of the age of the key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 4.2.11.1 describes how to form this value for identities</td><td> </td><td class="right">      Section 4.2.11.1 describes how to form this value for identities</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      established via the NewSessionTicket message.  For identities</td><td> </td><td class="right">      established via the NewSessionTicket message.  For identities</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0208" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      established externally an obfuscated_ticket_age of 0 SHOULD be</td><td> </td><td class="rblock">      established externally<span class="insert">,</span> an obfuscated_ticket_age of 0 SHOULD be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      used, and servers MUST ignore the value.</td><td> </td><td class="right">      used, and servers MUST ignore the value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0209" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   identities  A list of the identities that the client is willing to</td><td> </td><td class="rblock">   identities<span class="insert">:</span>  A list of the identities that the client is willing to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiate with the server.  If sent alongside the "early_data"</td><td> </td><td class="right">      negotiate with the server.  If sent alongside the "early_data"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extension (see Section 4.2.10), the first identity is the one used</td><td> </td><td class="right">      extension (see Section 4.2.10), the first identity is the one used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      for 0-RTT data.</td><td> </td><td class="right">      for 0-RTT data.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0210" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">binders</span>  A series of HMAC values, one for each <span class="delete">PSK offered</span> in the</td><td> </td><td class="rblock">   <span class="insert">binders:</span>  A series of HMAC values, one for each <span class="insert">value</span> in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">"pre_shared_keys" extension</span> and in the same order, computed as</td><td> </td><td class="rblock">      <span class="insert">identities list</span> and in the same order, computed as described</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      described below.</td><td> </td><td class="rblock">      below.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0211" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   selected_identity  The server's chosen identity expressed as a</td><td> </td><td class="rblock">   selected_identity<span class="insert">:</span>  The server's chosen identity expressed as a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (0-based) index into the identities in the client's list.</td><td> </td><td class="right">      (0-based) index into the identities in the client's list.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Each PSK is associated with a single Hash algorithm.  For PSKs</td><td> </td><td class="right">   Each PSK is associated with a single Hash algorithm.  For PSKs</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   established via the ticket mechanism (Section 4.6.1), this is the KDF</td><td> </td><td class="right">   established via the ticket mechanism (Section 4.6.1), this is the KDF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Hash algorithm on the connection where the ticket was established.</td><td> </td><td class="right">   Hash algorithm on the connection where the ticket was established.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For externally established PSKs, the Hash algorithm MUST be set when</td><td> </td><td class="right">   For externally established PSKs, the Hash algorithm MUST be set when</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0212" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the PSK is <span class="delete">established,</span> or default to SHA-256 if no such algorithm is</td><td> </td><td class="rblock">   the PSK is <span class="insert">established</span> or default to SHA-256 if no such algorithm is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   defined.  The server MUST ensure that it selects a compatible PSK (if</td><td> </td><td class="rblock">   defined.  The server MUST ensure that it selects a compatible PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   any) and cipher suite.</td><td> </td><td class="rblock">   (if any) and cipher suite.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In TLS versions prior to TLS 1.3, the Server Name Identification</td><td> </td><td class="right">   In TLS versions prior to TLS 1.3, the Server Name Identification</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (SNI) value was intended to be associated with the session (Section 3</td><td> </td><td class="right">   (SNI) value was intended to be associated with the session (Section 3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of [RFC6066]), with the server being required to enforce that the SNI</td><td> </td><td class="right">   of [RFC6066]), with the server being required to enforce that the SNI</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   value associated with the session matches the one specified in the</td><td> </td><td class="right">   value associated with the session matches the one specified in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   resumption handshake.  However, in reality the implementations were</td><td> </td><td class="right">   resumption handshake.  However, in reality the implementations were</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   not consistent on which of two supplied SNI values they would use,</td><td> </td><td class="right">   not consistent on which of two supplied SNI values they would use,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0213" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   leading to the consistency requirement being de<span class="delete">-</span>facto enforced by the</td><td> </td><td class="rblock">   leading to the consistency requirement being de<span class="insert"> </span>facto enforced by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   clients.  In TLS 1.3, the SNI value is always explicitly specified in</td><td> </td><td class="right">   clients.  In TLS 1.3, the SNI value is always explicitly specified in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the resumption handshake, and there is no need for the server to</td><td> </td><td class="right">   the resumption handshake, and there is no need for the server to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   associate an SNI value with the ticket.  Clients, however, SHOULD</td><td> </td><td class="right">   associate an SNI value with the ticket.  Clients, however, SHOULD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   store the SNI with the PSK to fulfill the requirements of</td><td> </td><td class="right">   store the SNI with the PSK to fulfill the requirements of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 4.6.1.</td><td> </td><td class="right">   Section 4.6.1.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0214" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Implementor's note: <span class="delete">when</span> session resumption is the primary use case</td><td> </td><td class="rblock">   Implementor's note: <span class="insert">When</span> session resumption is the primary use case</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   of <span class="delete">PSKs</span> the most straightforward way to implement the PSK/cipher</td><td> </td><td class="rblock">   of <span class="insert">PSKs,</span> the most straightforward way to implement the PSK/cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   suite matching requirements is to negotiate the cipher suite first</td><td> </td><td class="right">   suite matching requirements is to negotiate the cipher suite first</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0215" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and then exclude any incompatible PSKs.  Any unknown PSKs (e.g., <span class="delete">they</span></td><td> </td><td class="rblock">   and then exclude any incompatible PSKs.  Any unknown PSKs (e.g., <span class="insert">ones</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   are</span> not in the PSK database or <span class="delete">are</span> encrypted with an unknown key)</td><td> </td><td class="rblock">   not in the PSK database or encrypted with an unknown key) SHOULD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   SHOULD simply be ignored.  If no acceptable PSKs are found, the</td><td> </td><td class="rblock">   simply be ignored.  If no acceptable PSKs are found, the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server SHOULD perform a non-PSK handshake if possible.  If <span class="delete">backwards</span></td><td> </td><td class="rblock">   SHOULD perform a non-PSK handshake if possible.  If <span class="insert">backward</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   compatibility is important, <span class="delete">client provided,</span> externally established</td><td> </td><td class="rblock">   compatibility is important, <span class="insert">client-provided,</span> externally established</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSKs SHOULD influence cipher suite selection.</td><td> </td><td class="right">   PSKs SHOULD influence cipher suite selection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Prior to accepting PSK key establishment, the server MUST validate</td><td> </td><td class="right">   Prior to accepting PSK key establishment, the server MUST validate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the corresponding binder value (see Section 4.2.11.2 below).  If this</td><td> </td><td class="right">   the corresponding binder value (see Section 4.2.11.2 below).  If this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   value is not present or does not validate, the server MUST abort the</td><td> </td><td class="right">   value is not present or does not validate, the server MUST abort the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake.  Servers SHOULD NOT attempt to validate multiple binders;</td><td> </td><td class="right">   handshake.  Servers SHOULD NOT attempt to validate multiple binders;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0216" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">rather</span> they SHOULD select a single PSK and validate solely the binder</td><td> </td><td class="rblock">   <span class="insert">rather,</span> they SHOULD select a single PSK and validate solely the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that corresponds to that PSK.  See <span class="delete">[Section 8.2]</span> and <span class="delete">[Appendix E.6]</span></td><td> </td><td class="rblock">   binder that corresponds to that PSK.  See <span class="insert">Section 8.2</span> and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   for the security rationale for this requirement.  In order to accept</td><td> </td><td class="rblock">   <span class="insert">Appendix E.6</span> for the security rationale for this requirement.  In</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   PSK key establishment, the server sends a "pre_shared_key" extension</td><td> </td><td class="rblock">   order to accept PSK key establishment, the server sends a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   indicating the selected identity.</td><td> </td><td class="rblock">   "pre_shared_key" extension indicating the selected identity.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Clients MUST verify that the server's selected_identity is within the</td><td> </td><td class="right">   Clients MUST verify that the server's selected_identity is within the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   range supplied by the client, that the server selected a cipher suite</td><td> </td><td class="right">   range supplied by the client, that the server selected a cipher suite</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0217" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   indicating a Hash associated with the PSK and that a server</td><td> </td><td class="rblock">   indicating a Hash associated with the PSK<span class="insert">,</span> and that a server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "key_share" extension is present if required by the ClientHello</td><td> </td><td class="right">   "key_share" extension is present if required by the ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0218" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">"psk_key_exchange_modes".</span>  If these values are not <span class="delete">consistent</span> the</td><td> </td><td class="rblock">   <span class="insert">"psk_key_exchange_modes" extension.</span>  If these values are not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client MUST abort the handshake with an "illegal_parameter" alert.</td><td> </td><td class="rblock">   <span class="insert">consistent,</span> the client MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server supplies an "early_data" extension, the client MUST</td><td> </td><td class="right">   If the server supplies an "early_data" extension, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   verify that the server's selected_identity is 0.  If any other value</td><td> </td><td class="right">   verify that the server's selected_identity is 0.  If any other value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is returned, the client MUST abort the handshake with an</td><td> </td><td class="right">   is returned, the client MUST abort the handshake with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "illegal_parameter" alert.</td><td> </td><td class="right">   "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "pre_shared_key" extension MUST be the last extension in the</td><td> </td><td class="right">   The "pre_shared_key" extension MUST be the last extension in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello (this facilitates implementation as described below).</td><td> </td><td class="right">   ClientHello (this facilitates implementation as described below).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers MUST check that it is the last extension and otherwise fail</td><td> </td><td class="right">   Servers MUST check that it is the last extension and otherwise fail</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the handshake with an "illegal_parameter" alert.</td><td> </td><td class="right">   the handshake with an "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l23" /><small>skipping to change at</small><em> page 63, line 14</em></th><th> </th><th><a name="part-r23" /><small>skipping to change at</small><em> page 59, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the handshake includes a HelloRetryRequest, the initial</td><td> </td><td class="right">   If the handshake includes a HelloRetryRequest, the initial</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello and HelloRetryRequest are included in the transcript</td><td> </td><td class="right">   ClientHello and HelloRetryRequest are included in the transcript</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   along with the new ClientHello.  For instance, if the client sends</td><td> </td><td class="right">   along with the new ClientHello.  For instance, if the client sends</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello1, its binder will be computed over:</td><td> </td><td class="right">   ClientHello1, its binder will be computed over:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Transcript-Hash(Truncate(ClientHello1))</td><td> </td><td class="right">      Transcript-Hash(Truncate(ClientHello1))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Where Truncate() removes the binders list from the ClientHello.</td><td> </td><td class="right">   Where Truncate() removes the binders list from the ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0219" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If the server responds with <span class="delete">HelloRetryRequest,</span> and the client then</td><td> </td><td class="rblock">   If the server responds with <span class="insert">a HelloRetryRequest</span> and the client then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sends ClientHello2, its binder will be computed over:</td><td> </td><td class="right">   sends ClientHello2, its binder will be computed over:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Transcript-Hash(ClientHello1,</td><td> </td><td class="right">      Transcript-Hash(ClientHello1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      HelloRetryRequest,</td><td> </td><td class="right">                      HelloRetryRequest,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      Truncate(ClientHello2))</td><td> </td><td class="right">                      Truncate(ClientHello2))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The full ClientHello1/ClientHello2 is included in all other handshake</td><td> </td><td class="right">   The full ClientHello1/ClientHello2 is included in all other handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   hash computations.  Note that in the first flight,</td><td> </td><td class="right">   hash computations.  Note that in the first flight,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Truncate(ClientHello1) is hashed directly, but in the second flight,</td><td> </td><td class="right">   Truncate(ClientHello1) is hashed directly, but in the second flight,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello1 is hashed and then reinjected as a "message_hash"</td><td> </td><td class="right">   ClientHello1 is hashed and then reinjected as a "message_hash"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l24" /><small>skipping to change at</small><em> page 64, line 4</em></th><th> </th><th><a name="part-r24" /><small>skipping to change at</small><em> page 60, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.3.1.  Encrypted Extensions</td><td> </td><td class="right">4.3.1.  Encrypted Extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In all handshakes, the server MUST send the EncryptedExtensions</td><td> </td><td class="right">   In all handshakes, the server MUST send the EncryptedExtensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message immediately after the ServerHello message.  This is the first</td><td> </td><td class="right">   message immediately after the ServerHello message.  This is the first</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message that is encrypted under keys derived from the</td><td> </td><td class="right">   message that is encrypted under keys derived from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server_handshake_traffic_secret.</td><td> </td><td class="right">   server_handshake_traffic_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The EncryptedExtensions message contains extensions that can be</td><td> </td><td class="right">   The EncryptedExtensions message contains extensions that can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protected, i.e., any which are not needed to establish the</td><td> </td><td class="right">   protected, i.e., any which are not needed to establish the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0220" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   cryptographic context<span class="delete">,</span> but which are not associated with individual</td><td> </td><td class="rblock">   cryptographic context but which are not associated with individual</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates.  The client MUST check EncryptedExtensions for the</td><td> </td><td class="right">   certificates.  The client MUST check EncryptedExtensions for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   presence of any forbidden extensions and if any are found MUST abort</td><td> </td><td class="right">   presence of any forbidden extensions and if any are found MUST abort</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the handshake with an "illegal_parameter" alert.</td><td> </td><td class="right">   the handshake with an "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } EncryptedExtensions;</td><td> </td><td class="right">      } EncryptedExtensions;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0221" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extensions  A list of extensions.  For more information, see the</td><td> </td><td class="rblock">   extensions<span class="insert">:</span>  A list of extensions.  For more information, see the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      table in Section 4.2.</td><td> </td><td class="right">      table in Section 4.2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.3.2.  Certificate Request</td><td> </td><td class="right">4.3.2.  Certificate Request</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A server which is authenticating with a certificate MAY optionally</td><td> </td><td class="right">   A server which is authenticating with a certificate MAY optionally</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   request a certificate from the client.  This message, if sent, MUST</td><td> </td><td class="right">   request a certificate from the client.  This message, if sent, MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   follow EncryptedExtensions.</td><td> </td><td class="right">   follow EncryptedExtensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque certificate_request_context&lt;0..2^8-1&gt;;</td><td> </td><td class="right">          opaque certificate_request_context&lt;0..2^8-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;2..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;2..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateRequest;</td><td> </td><td class="right">      } CertificateRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0222" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate_request_context  An opaque string which identifies the</td><td> </td><td class="rblock">   certificate_request_context<span class="insert">:</span>  An opaque string which identifies the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate request and which will be echoed in the client's</td><td> </td><td class="right">      certificate request and which will be echoed in the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificate message.  The certificate_request_context MUST be</td><td> </td><td class="right">      Certificate message.  The certificate_request_context MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      unique within the scope of this connection (thus preventing replay</td><td> </td><td class="right">      unique within the scope of this connection (thus preventing replay</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      of client CertificateVerify messages).  This field SHALL be zero</td><td> </td><td class="right">      of client CertificateVerify messages).  This field SHALL be zero</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      length unless used for the post-handshake authentication exchanges</td><td> </td><td class="right">      length unless used for the post-handshake authentication exchanges</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      described in Section 4.6.2.  When requesting post-handshake</td><td> </td><td class="right">      described in Section 4.6.2.  When requesting post-handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authentication, the server SHOULD make the context unpredictable</td><td> </td><td class="right">      authentication, the server SHOULD make the context unpredictable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      to the client (e.g., by randomly generating it) in order to</td><td> </td><td class="right">      to the client (e.g., by randomly generating it) in order to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      prevent an attacker who has temporary access to the client's</td><td> </td><td class="right">      prevent an attacker who has temporary access to the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      private key from pre-computing valid CertificateVerify messages.</td><td> </td><td class="right">      private key from pre-computing valid CertificateVerify messages.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0223" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extensions  A set of extensions describing the parameters of the</td><td> </td><td class="rblock">   extensions<span class="insert">:</span>  A set of extensions describing the parameters of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate being requested.  The "signature_algorithms" extension</td><td> </td><td class="right">      certificate being requested.  The "signature_algorithms" extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MUST be specified, and other extensions may optionally be included</td><td> </td><td class="right">      MUST be specified, and other extensions may optionally be included</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      if defined for this message.  Clients MUST ignore unrecognized</td><td> </td><td class="right">      if defined for this message.  Clients MUST ignore unrecognized</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extensions.</td><td> </td><td class="right">      extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In prior versions of TLS, the CertificateRequest message carried a</td><td> </td><td class="right">   In prior versions of TLS, the CertificateRequest message carried a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   list of signature algorithms and certificate authorities which the</td><td> </td><td class="right">   list of signature algorithms and certificate authorities which the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0224" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server would accept.  In TLS 1.3 the former is expressed by sending</td><td> </td><td class="rblock">   server would accept.  In TLS 1.3<span class="insert">,</span> the former is expressed by sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the "signature_algorithms" and optionally "signature_algorithms_cert"</td><td> </td><td class="right">   the "signature_algorithms" and optionally "signature_algorithms_cert"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions.  The latter is expressed by sending the</td><td> </td><td class="right">   extensions.  The latter is expressed by sending the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "certificate_authorities" extension (see Section 4.2.4).</td><td> </td><td class="right">   "certificate_authorities" extension (see Section 4.2.4).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers which are authenticating with a PSK MUST NOT send the</td><td> </td><td class="right">   Servers which are authenticating with a PSK MUST NOT send the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateRequest message in the main handshake, though they MAY</td><td> </td><td class="right">   CertificateRequest message in the main handshake, though they MAY</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   send it in post-handshake authentication (see Section 4.6.2) provided</td><td> </td><td class="right">   send it in post-handshake authentication (see Section 4.6.2) provided</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that the client has sent the "post_handshake_auth" extension (see</td><td> </td><td class="right">   that the client has sent the "post_handshake_auth" extension (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 4.2.6).</td><td> </td><td class="right">   Section 4.2.6).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.  Authentication Messages</td><td> </td><td class="right">4.4.  Authentication Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As discussed in Section 2, TLS generally uses a common set of</td><td> </td><td class="right">   As discussed in Section 2, TLS generally uses a common set of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages for authentication, key confirmation, and handshake</td><td> </td><td class="right">   messages for authentication, key confirmation, and handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0225" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   integrity: Certificate, CertificateVerify, and Finished.  (The</td><td> </td><td class="rblock">   integrity: Certificate, CertificateVerify, and Finished.  (The <span class="insert">PSK</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">PreSharedKey</span> binders also perform key confirmation, in a similar</td><td> </td><td class="rblock">   binders also perform key confirmation, in a similar fashion.)  These</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   fashion.)  These three messages are always sent as the last messages</td><td> </td><td class="rblock">   three messages are always sent as the last messages in their</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   in their handshake flight.  The Certificate and CertificateVerify</td><td> </td><td class="rblock">   handshake flight.  The Certificate and CertificateVerify messages are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   messages are only sent under certain circumstances, as defined below.</td><td> </td><td class="rblock">   only sent under certain circumstances, as defined below.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The Finished message is always sent as part of the Authentication</td><td> </td><td class="rblock">   Finished message is always sent as part of the Authentication <span class="insert">Block.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">block.</span>  These messages are encrypted under keys derived from</td><td> </td><td class="rblock">   These messages are encrypted under keys derived from <span class="insert">the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [sender]_handshake_traffic_secret.</td><td> </td><td class="right">   [sender]_handshake_traffic_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The computations for the Authentication messages all uniformly take</td><td> </td><td class="right">   The computations for the Authentication messages all uniformly take</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the following inputs:</td><td> </td><td class="right">   the following inputs:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The certificate and signing key to be used.</td><td> </td><td class="right">   -  The certificate and signing key to be used.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A Handshake Context consisting of the set of messages to be</td><td> </td><td class="right">   -  A Handshake Context consisting of the set of messages to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      included in the transcript hash.</td><td> </td><td class="right">      included in the transcript hash.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0226" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  A <span class="delete">base k</span>ey to be used to compute a MAC key.</td><td> </td><td class="rblock">   -  A <span class="insert">Base K</span>ey to be used to compute a MAC key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Based on these inputs, the messages then contain:</td><td> </td><td class="right">   Based on these inputs, the messages then contain:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0227" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Certificate  The certificate to be used for authentication, and any</td><td> </td><td class="rblock">   Certificate<span class="insert">:</span>  The certificate to be used for authentication, and any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      supporting certificates in the chain.  Note that certificate-based</td><td> </td><td class="right">      supporting certificates in the chain.  Note that certificate-based</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0228" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      client authentication is not available in PSK (including <span class="delete">0-RTT)</span></td><td> </td><td class="rblock">      client authentication is not available in PSK <span class="insert">handshake flows</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      flows.</span></td><td> </td><td class="rblock">      (including <span class="insert">0-RTT).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0229" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">CertificateVerify</span>  A signature over the value <span class="delete">Transcript-</span></td><td> </td><td class="rblock">   <span class="insert">CertificateVerify:</span>  A signature over the value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Hash(Handshake</span> Context, <span class="delete">Certificate)</span></td><td> </td><td class="rblock">      <span class="insert">Transcript-Hash(Handshake</span> Context, <span class="insert">Certificate).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0230" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Finished  A MAC over the value Transcript-Hash(Handshake Context,</td><td> </td><td class="rblock">   Finished<span class="insert">:</span>  A MAC over the value Transcript-Hash(Handshake Context,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificate, CertificateVerify) using a MAC key derived from the</td><td> </td><td class="right">      Certificate, CertificateVerify) using a MAC key derived from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0231" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">base k</span>ey.</td><td> </td><td class="rblock">      <span class="insert">Base K</span>ey.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following table defines the Handshake Context and MAC Base Key</td><td> </td><td class="right">   The following table defines the Handshake Context and MAC Base Key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for each scenario:</td><td> </td><td class="right">   for each scenario:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0232" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">+-----------+----------------------------+--------------------------+</span></td><td> </td><td class="rblock">   <span class="insert">+-----------+-------------------------+-----------------------------+</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   | Mode      | Handshake Context          | Base Key                 |</td><td> </td><td class="rblock">   | Mode      | Handshake Context       | Base Key                    |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">+-----------+----------------------------+--------------------------+</span></td><td> </td><td class="rblock">   <span class="insert">+-----------+-------------------------+-----------------------------+</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   | Server    | ClientHello ... later <span class="delete">of E</span> | <span class="delete">server_handshake_traffic</span> |</td><td> </td><td class="rblock">   | Server    | ClientHello ... later   | <span class="insert">server_handshake_traffic_</span>   |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   |           | <span class="delete">ncryptedExtensions/Certifi</span> | <span class="delete">_secret</span>                  |</td><td> </td><td class="rblock">   |           | <span class="insert">of EncryptedExtensions/</span> | <span class="insert">secret</span>                      |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   |           | <span class="delete">cateRequest</span>                |                          |</td><td> </td><td class="rblock">   |           | <span class="insert">CertificateRequest</span>      |                             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   |           |                            |                          |</td><td> </td><td class="rblock">   |           |                         |                             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   | Client    | ClientHello ... later <span class="delete">of</span>   | <span class="delete">client_handshake_traffic</span> |</td><td> </td><td class="rblock">   | Client    | ClientHello ... later   | <span class="insert">client_handshake_traffic_</span>   |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   |           | server                     | <span class="delete">_secret</span>                  |</td><td> </td><td class="rblock">   |           | <span class="insert">of</span> server               | <span class="insert">secret</span>                      |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   |           | Finished/EndOfEarlyData    |                          |</td><td> </td><td class="rblock">   |           | Finished/EndOfEarlyData |                             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   |           |                            |                          |</td><td> </td><td class="rblock">   |           |                         |                             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   | Post-     | ClientHello ... client     | <span class="delete">client_application_traff</span> |</td><td> </td><td class="rblock">   | Post-     | ClientHello ... client  | <span class="insert">client_application_traffic_</span> |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   | Handshake | Finished +                 | <span class="delete">ic_secret_N</span>              |</td><td> </td><td class="rblock">   | Handshake | Finished +              | <span class="insert">secret_N</span>                    |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   |           | CertificateRequest         |                          |</td><td> </td><td class="rblock">   |           | CertificateRequest      |                             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">+-----------+----------------------------+--------------------------+</span></td><td> </td><td class="rblock">   <span class="insert">+-----------+-------------------------+-----------------------------+</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.1.  The Transcript Hash</td><td> </td><td class="right">4.4.1.  The Transcript Hash</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Many of the cryptographic computations in TLS make use of a</td><td> </td><td class="right">   Many of the cryptographic computations in TLS make use of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transcript hash.  This value is computed by hashing the concatenation</td><td> </td><td class="right">   transcript hash.  This value is computed by hashing the concatenation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of each included handshake message, including the handshake message</td><td> </td><td class="right">   of each included handshake message, including the handshake message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   header carrying the handshake message type and length fields, but not</td><td> </td><td class="right">   header carrying the handshake message type and length fields, but not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   including record layer headers.  I.e.,</td><td> </td><td class="right">   including record layer headers.  I.e.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    Transcript-Hash(M1, M2, ... Mn) = Hash(M1 || M2 || ... || Mn)</td><td> </td><td class="right">    Transcript-Hash(M1, M2, ... Mn) = Hash(M1 || M2 || ... || Mn)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As an exception to this general rule, when the server responds to a</td><td> </td><td class="right">   As an exception to this general rule, when the server responds to a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello with a HelloRetryRequest, the value of ClientHello1 is</td><td> </td><td class="right">   ClientHello with a HelloRetryRequest, the value of ClientHello1 is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   replaced with a special synthetic handshake message of handshake type</td><td> </td><td class="right">   replaced with a special synthetic handshake message of handshake type</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "message_hash" containing Hash(ClientHello1).  I.e.,</td><td> </td><td class="right">   "message_hash" containing Hash(ClientHello1).  I.e.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  Transcript-Hash(ClientHello1, HelloRetryRequest, ... Mn) =</td><td> </td><td class="right">  Transcript-Hash(ClientHello1, HelloRetryRequest, ... Mn) =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Hash(message_hash ||        /* Handshake type */</td><td> </td><td class="right">      Hash(message_hash ||        /* Handshake type */</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0233" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           00 00 Hash.length <span class="delete">|| </span>  /* Handshake message length (bytes) */</td><td> </td><td class="rblock">           00 00 Hash.length <span class="insert"> ||</span>  /* Handshake message length (bytes) */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           Hash(ClientHello1) ||  /* Hash of ClientHello1 */</td><td> </td><td class="right">           Hash(ClientHello1) ||  /* Hash of ClientHello1 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0234" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           HelloRetryRequest || ... || Mn)</td><td> </td><td class="rblock">           HelloRetryRequest <span class="insert"> </span>|| ... || Mn)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The reason for this construction is to allow the server to do a</td><td> </td><td class="right">   The reason for this construction is to allow the server to do a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   stateless HelloRetryRequest by storing just the hash of ClientHello1</td><td> </td><td class="right">   stateless HelloRetryRequest by storing just the hash of ClientHello1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in the cookie, rather than requiring it to export the entire</td><td> </td><td class="right">   in the cookie, rather than requiring it to export the entire</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   intermediate hash state (see Section 4.2.2).</td><td> </td><td class="right">   intermediate hash state (see Section 4.2.2).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For concreteness, the transcript hash is always taken from the</td><td> </td><td class="right">   For concreteness, the transcript hash is always taken from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   following sequence of handshake messages, starting at the first</td><td> </td><td class="right">   following sequence of handshake messages, starting at the first</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello and including only those messages that were sent:</td><td> </td><td class="right">   ClientHello and including only those messages that were sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0235" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                         </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello, HelloRetryRequest, ClientHello, ServerHello,</td><td> </td><td class="right">   ClientHello, HelloRetryRequest, ClientHello, ServerHello,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   EncryptedExtensions, server CertificateRequest, server Certificate,</td><td> </td><td class="right">   EncryptedExtensions, server CertificateRequest, server Certificate,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server CertificateVerify, server Finished, EndOfEarlyData, client</td><td> </td><td class="right">   server CertificateVerify, server Finished, EndOfEarlyData, client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Certificate, client CertificateVerify, client Finished.</td><td> </td><td class="right">   Certificate, client CertificateVerify, client Finished.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In general, implementations can implement the transcript by keeping a</td><td> </td><td class="right">   In general, implementations can implement the transcript by keeping a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   running transcript hash value based on the negotiated hash.  Note,</td><td> </td><td class="right">   running transcript hash value based on the negotiated hash.  Note,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   however, that subsequent post-handshake authentications do not</td><td> </td><td class="right">   however, that subsequent post-handshake authentications do not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   include each other, just the messages through the end of the main</td><td> </td><td class="right">   include each other, just the messages through the end of the main</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake.</td><td> </td><td class="right">   handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l25" /><small>skipping to change at</small><em> page 67, line 22</em></th><th> </th><th><a name="part-r25" /><small>skipping to change at</small><em> page 64, line 11</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   however, that subsequent post-handshake authentications do not</td><td> </td><td class="right">   however, that subsequent post-handshake authentications do not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   include each other, just the messages through the end of the main</td><td> </td><td class="right">   include each other, just the messages through the end of the main</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake.</td><td> </td><td class="right">   handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.2.  Certificate</td><td> </td><td class="right">4.4.2.  Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This message conveys the endpoint's certificate chain to the peer.</td><td> </td><td class="right">   This message conveys the endpoint's certificate chain to the peer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server MUST send a Certificate message whenever the agreed-upon</td><td> </td><td class="right">   The server MUST send a Certificate message whenever the agreed-upon</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   key exchange method uses certificates for authentication (this</td><td> </td><td class="right">   key exchange method uses certificates for authentication (this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0236" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   includes all key exchange methods defined in this document except</td><td> </td><td class="rblock">   includes all key exchange methods defined in this document</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   PSK).</td><td> </td><td class="rblock">   except PSK).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client MUST send a Certificate message if and only if the server</td><td> </td><td class="right">   The client MUST send a Certificate message if and only if the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   has requested client authentication via a CertificateRequest message</td><td> </td><td class="right">   has requested client authentication via a CertificateRequest message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (Section 4.3.2).  If the server requests client authentication but no</td><td> </td><td class="right">   (Section 4.3.2).  If the server requests client authentication but no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   suitable certificate is available, the client MUST send a Certificate</td><td> </td><td class="right">   suitable certificate is available, the client MUST send a Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message containing no certificates (i.e., with the "certificate_list"</td><td> </td><td class="right">   message containing no certificates (i.e., with the "certificate_list"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   field having length 0).  A Finished message MUST be sent regardless</td><td> </td><td class="right">   field having length 0).  A Finished message MUST be sent regardless</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of whether the Certificate message is empty.</td><td> </td><td class="right">   of whether the Certificate message is empty.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0237" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      /* Managed by IANA */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          X509(0),</td><td> </td><td class="right">          X509(0),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          RawPublicKey(2),</td><td> </td><td class="right">          RawPublicKey(2),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (255)</td><td> </td><td class="right">          (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateType;</td><td> </td><td class="right">      } CertificateType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (certificate_type) {</td><td> </td><td class="right">          select (certificate_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case RawPublicKey:</td><td> </td><td class="right">              case RawPublicKey:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                /* From RFC 7250 ASN.1_subjectPublicKeyInfo */</td><td> </td><td class="right">                /* From RFC 7250 ASN.1_subjectPublicKeyInfo */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l26" /><small>skipping to change at</small><em> page 68, line 29</em></th><th> </th><th><a name="part-r26" /><small>skipping to change at</small><em> page 65, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                opaque cert_data&lt;1..2^24-1&gt;;</td><td> </td><td class="right">                opaque cert_data&lt;1..2^24-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          };</td><td> </td><td class="right">          };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateEntry;</td><td> </td><td class="right">      } CertificateEntry;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque certificate_request_context&lt;0..2^8-1&gt;;</td><td> </td><td class="right">          opaque certificate_request_context&lt;0..2^8-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          CertificateEntry certificate_list&lt;0..2^24-1&gt;;</td><td> </td><td class="right">          CertificateEntry certificate_list&lt;0..2^24-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Certificate;</td><td> </td><td class="right">      } Certificate;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0238" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate_request_context  If this message is in response to a</td><td> </td><td class="rblock">   certificate_request_context<span class="insert">:</span>  If this message is in response to a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      CertificateRequest, the value of certificate_request_context in</td><td> </td><td class="right">      CertificateRequest, the value of certificate_request_context in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      that message.  Otherwise (in the case of server authentication),</td><td> </td><td class="right">      that message.  Otherwise (in the case of server authentication),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      this field SHALL be zero length.</td><td> </td><td class="right">      this field SHALL be zero length.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0239" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">certificate_list  This is a</span> sequence (chain) of CertificateEntry</td><td> </td><td class="rblock">   <span class="insert">certificate_list:  A</span> sequence (chain) of CertificateEntry structures,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      structures, each containing a single certificate and set of</td><td> </td><td class="rblock">      each containing a single certificate and set of extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      extensions.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions:  A set of extension values for the CertificateEntry.  The</td><td> </td><td class="right">   extensions:  A set of extension values for the CertificateEntry.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "Extension" format is defined in Section 4.2.  Valid extensions</td><td> </td><td class="right">      "Extension" format is defined in Section 4.2.  Valid extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0240" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      for server certificates at present include OCSP Status extension</td><td> </td><td class="rblock">      for server certificates at present include <span class="insert">the</span> OCSP Status</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">([RFC6066])</span> and <span class="delete">SignedCertificateTimestamps ([RFC6962]);</span> future</td><td> </td><td class="rblock">      extension <span class="insert">[RFC6066]</span> and <span class="insert">the SignedCertificateTimestamp extension</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      extensions may be defined for this message as well.  Extensions in</td><td> </td><td class="rblock"><span class="insert">      [RFC6962];</span> future extensions may be defined for this message as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the Certificate message from the server MUST correspond to ones</td><td> </td><td class="rblock">      well.  Extensions in the Certificate message from the server MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      from the ClientHello message.  Extensions in the Certificate from</td><td> </td><td class="rblock">      correspond to ones from the ClientHello message.  Extensions in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the client MUST correspond <span class="delete">with</span> extensions in the</td><td> </td><td class="rblock">      the Certificate <span class="insert">message</span> from the client MUST correspond <span class="insert">to</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      CertificateRequest message from the server.  If an extension</td><td> </td><td class="rblock">      extensions in the CertificateRequest message from the server.  If</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      applies to the entire chain, it SHOULD be included in the first</td><td> </td><td class="rblock">      an extension applies to the entire chain, it SHOULD be included in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      CertificateEntry.</td><td> </td><td class="rblock">      the first CertificateEntry.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the corresponding certificate type extension</td><td> </td><td class="right">   If the corresponding certificate type extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ("server_certificate_type" or "client_certificate_type") was not</td><td> </td><td class="right">   ("server_certificate_type" or "client_certificate_type") was not</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0241" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   negotiated in Encrypted<span class="delete"> </span>Extensions, or the X.509 certificate type was</td><td> </td><td class="rblock">   negotiated in EncryptedExtensions, or the X.509 certificate type was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiated, then each CertificateEntry contains a DER-encoded X.509</td><td> </td><td class="right">   negotiated, then each CertificateEntry contains a DER-encoded X.509</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate.  The sender's certificate MUST come in the first</td><td> </td><td class="right">   certificate.  The sender's certificate MUST come in the first</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateEntry in the list.  Each following certificate SHOULD</td><td> </td><td class="right">   CertificateEntry in the list.  Each following certificate SHOULD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   directly certify the one immediately preceding it.  Because</td><td> </td><td class="right">   directly certify the one immediately preceding it.  Because</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate validation requires that trust anchors be distributed</td><td> </td><td class="right">   certificate validation requires that trust anchors be distributed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   independently, a certificate that specifies a trust anchor MAY be</td><td> </td><td class="right">   independently, a certificate that specifies a trust anchor MAY be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   omitted from the chain, provided that supported peers are known to</td><td> </td><td class="right">   omitted from the chain, provided that supported peers are known to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   possess any omitted certificates.</td><td> </td><td class="right">   possess any omitted certificates.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Prior to TLS 1.3, "certificate_list" ordering required each</td><td> </td><td class="right">   Note: Prior to TLS 1.3, "certificate_list" ordering required each</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l27" /><small>skipping to change at</small><em> page 69, line 44</em></th><th> </th><th><a name="part-r27" /><small>skipping to change at</small><em> page 66, line 20</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   authentication request.</td><td> </td><td class="right">   authentication request.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.2.1.  OCSP Status and SCT Extensions</td><td> </td><td class="right">4.4.2.1.  OCSP Status and SCT Extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6066] and [RFC6961] provide extensions to negotiate the server</td><td> </td><td class="right">   [RFC6066] and [RFC6961] provide extensions to negotiate the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sending OCSP responses to the client.  In TLS 1.2 and below, the</td><td> </td><td class="right">   sending OCSP responses to the client.  In TLS 1.2 and below, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server replies with an empty extension to indicate negotiation of</td><td> </td><td class="right">   server replies with an empty extension to indicate negotiation of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   this extension and the OCSP information is carried in a</td><td> </td><td class="right">   this extension and the OCSP information is carried in a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateStatus message.  In TLS 1.3, the server's OCSP information</td><td> </td><td class="right">   CertificateStatus message.  In TLS 1.3, the server's OCSP information</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is carried in an extension in the CertificateEntry containing the</td><td> </td><td class="right">   is carried in an extension in the CertificateEntry containing the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0242" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   associated certificate.  Specifically<span class="delete">: T</span>he body of the</td><td> </td><td class="rblock">   associated certificate.  Specifically<span class="insert">, t</span>he body of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "status_request" extension from the server MUST be a</td><td> </td><td class="right">   "status_request" extension from the server MUST be a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateStatus structure as defined in [RFC6066], which is</td><td> </td><td class="right">   CertificateStatus structure as defined in [RFC6066], which is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   interpreted as defined in [RFC6960].</td><td> </td><td class="right">   interpreted as defined in [RFC6960].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0243" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note: status_request_v2 extension <span class="delete">([RFC6961])</span> is deprecated.  TLS 1.3</td><td> </td><td class="rblock">   Note: <span class="insert">The</span> status_request_v2 extension <span class="insert">[RFC6961]</span> is deprecated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   servers MUST NOT act upon its presence or information in it when</td><td> </td><td class="rblock">   TLS 1.3 servers MUST NOT act upon its presence or information in it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   processing <span class="delete">Client Hello,</span> in <span class="delete">particular</span> they MUST NOT send the</td><td> </td><td class="rblock">   when processing <span class="insert">ClientHello messages;</span> in <span class="insert">particular,</span> they MUST NOT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   status_request_v2 extension in the <span class="delete">Encrypted Extensions, Certificate</span></td><td> </td><td class="rblock">   send the status_request_v2 extension in the <span class="insert">EncryptedExtensions,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Request</span> or <span class="delete">the</span> Certificate messages.  TLS 1.3 servers MUST be able to</td><td> </td><td class="rblock"><span class="insert">   CertificateRequest,</span> or Certificate messages.  TLS 1.3 servers MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   process <span class="delete">Client Hello</span> messages that include it, as it MAY be sent by</td><td> </td><td class="rblock">   able to process <span class="insert">ClientHello</span> messages that include it, as it MAY be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   clients that wish to use it in earlier protocol versions.</td><td> </td><td class="rblock">   sent by clients that wish to use it in earlier protocol versions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A server MAY request that a client present an OCSP response with its</td><td> </td><td class="right">   A server MAY request that a client present an OCSP response with its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate by sending an empty "status_request" extension in its</td><td> </td><td class="right">   certificate by sending an empty "status_request" extension in its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateRequest message.  If the client opts to send an OCSP</td><td> </td><td class="right">   CertificateRequest message.  If the client opts to send an OCSP</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   response, the body of its "status_request" extension MUST be a</td><td> </td><td class="right">   response, the body of its "status_request" extension MUST be a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateStatus structure as defined in [RFC6066].</td><td> </td><td class="right">   CertificateStatus structure as defined in [RFC6066].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Similarly, [RFC6962] provides a mechanism for a server to send a</td><td> </td><td class="right">   Similarly, [RFC6962] provides a mechanism for a server to send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Signed Certificate Timestamp (SCT) as an extension in the ServerHello</td><td> </td><td class="right">   Signed Certificate Timestamp (SCT) as an extension in the ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in TLS 1.2 and below.  In TLS 1.3, the server's SCT information is</td><td> </td><td class="right">   in TLS 1.2 and below.  In TLS 1.3, the server's SCT information is</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0244" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   carried in an extension in CertificateEntry.</td><td> </td><td class="rblock">   carried in an extension in <span class="insert">the </span>CertificateEntry.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.2.2.  Server Certificate Selection</td><td> </td><td class="right">4.4.2.2.  Server Certificate Selection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following rules apply to the certificates sent by the server:</td><td> </td><td class="right">   The following rules apply to the certificates sent by the server:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The certificate type MUST be X.509v3 [RFC5280], unless explicitly</td><td> </td><td class="right">   -  The certificate type MUST be X.509v3 [RFC5280], unless explicitly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiated otherwise (e.g., [RFC7250]).</td><td> </td><td class="right">      negotiated otherwise (e.g., [RFC7250]).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The server's end-entity certificate's public key (and associated</td><td> </td><td class="right">   -  The server's end-entity certificate's public key (and associated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      restrictions) MUST be compatible with the selected authentication</td><td> </td><td class="right">      restrictions) MUST be compatible with the selected authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l28" /><small>skipping to change at</small><em> page 70, line 44</em></th><th> </th><th><a name="part-r28" /><small>skipping to change at</small><em> page 67, line 29</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      present) with a signature scheme indicated in the client's</td><td> </td><td class="right">      present) with a signature scheme indicated in the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "signature_algorithms"/"signature_algorithms_cert" extensions (see</td><td> </td><td class="right">      "signature_algorithms"/"signature_algorithms_cert" extensions (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 4.2.3).</td><td> </td><td class="right">      Section 4.2.3).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The "server_name" [RFC6066] and "certificate_authorities"</td><td> </td><td class="right">   -  The "server_name" [RFC6066] and "certificate_authorities"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extensions are used to guide certificate selection.  As servers</td><td> </td><td class="right">      extensions are used to guide certificate selection.  As servers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MAY require the presence of the "server_name" extension, clients</td><td> </td><td class="right">      MAY require the presence of the "server_name" extension, clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SHOULD send this extension, when applicable.</td><td> </td><td class="right">      SHOULD send this extension, when applicable.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All certificates provided by the server MUST be signed by a signature</td><td> </td><td class="right">   All certificates provided by the server MUST be signed by a signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0245" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   algorithm advertised by the client<span class="delete">,</span> if it is able to provide such a</td><td> </td><td class="rblock">   algorithm advertised by the client if it is able to provide such a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   chain (see Section 4.2.3).  Certificates that are self-signed or</td><td> </td><td class="right">   chain (see Section 4.2.3).  Certificates that are self-signed or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates that are expected to be trust anchors are not validated</td><td> </td><td class="right">   certificates that are expected to be trust anchors are not validated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as part of the chain and therefore MAY be signed with any algorithm.</td><td> </td><td class="right">   as part of the chain and therefore MAY be signed with any algorithm.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server cannot produce a certificate chain that is signed only</td><td> </td><td class="right">   If the server cannot produce a certificate chain that is signed only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   via the indicated supported algorithms, then it SHOULD continue the</td><td> </td><td class="right">   via the indicated supported algorithms, then it SHOULD continue the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake by sending the client a certificate chain of its choice</td><td> </td><td class="right">   handshake by sending the client a certificate chain of its choice</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that may include algorithms that are not known to be supported by the</td><td> </td><td class="right">   that may include algorithms that are not known to be supported by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client.  This fallback chain SHOULD NOT use the deprecated SHA-1 hash</td><td> </td><td class="right">   client.  This fallback chain SHOULD NOT use the deprecated SHA-1 hash</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   algorithm in general, but MAY do so if the client's advertisement</td><td> </td><td class="right">   algorithm in general, but MAY do so if the client's advertisement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   permits it, and MUST NOT do so otherwise.</td><td> </td><td class="right">   permits it, and MUST NOT do so otherwise.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the client cannot construct an acceptable chain using the provided</td><td> </td><td class="right">   If the client cannot construct an acceptable chain using the provided</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates and decides to abort the handshake, then it MUST abort</td><td> </td><td class="right">   certificates and decides to abort the handshake, then it MUST abort</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the handshake with an appropriate certificate-related alert (by</td><td> </td><td class="right">   the handshake with an appropriate certificate-related alert (by</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0246" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   default, "unsupported_certificate"; see Section 6.2 for <span class="delete">more).</span></td><td> </td><td class="rblock">   default, "unsupported_certificate"; see Section 6.2 for <span class="insert">more</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   information).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server has multiple certificates, it chooses one of them based</td><td> </td><td class="right">   If the server has multiple certificates, it chooses one of them based</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   on the above-mentioned criteria (in addition to other criteria, such</td><td> </td><td class="right">   on the above-mentioned criteria (in addition to other criteria, such</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0247" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   as transport<span class="delete"> layer endpoint, local configuration</span> and preferences).</td><td> </td><td class="rblock">   as transport<span class="insert">-layer endpoint, local configuration,</span> and preferences).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.2.3.  Client Certificate Selection</td><td> </td><td class="right">4.4.2.3.  Client Certificate Selection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following rules apply to certificates sent by the client:</td><td> </td><td class="right">   The following rules apply to certificates sent by the client:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The certificate type MUST be X.509v3 [RFC5280], unless explicitly</td><td> </td><td class="right">   -  The certificate type MUST be X.509v3 [RFC5280], unless explicitly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiated otherwise (e.g., [RFC7250]).</td><td> </td><td class="right">      negotiated otherwise (e.g., [RFC7250]).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  If the "certificate_authorities" extension in the</td><td> </td><td class="right">   -  If the "certificate_authorities" extension in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      CertificateRequest message was present, at least one of the</td><td> </td><td class="right">      CertificateRequest message was present, at least one of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l29" /><small>skipping to change at</small><em> page 71, line 40</em></th><th> </th><th><a name="part-r29" /><small>skipping to change at</small><em> page 68, line 27</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The certificates MUST be signed using an acceptable signature</td><td> </td><td class="right">   -  The certificates MUST be signed using an acceptable signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      algorithm, as described in Section 4.3.2.  Note that this relaxes</td><td> </td><td class="right">      algorithm, as described in Section 4.3.2.  Note that this relaxes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the constraints on certificate-signing algorithms found in prior</td><td> </td><td class="right">      the constraints on certificate-signing algorithms found in prior</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      versions of TLS.</td><td> </td><td class="right">      versions of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  If the CertificateRequest message contained a non-empty</td><td> </td><td class="right">   -  If the CertificateRequest message contained a non-empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "oid_filters" extension, the end-entity certificate MUST match the</td><td> </td><td class="right">      "oid_filters" extension, the end-entity certificate MUST match the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extension OIDs that are recognized by the client, as described in</td><td> </td><td class="right">      extension OIDs that are recognized by the client, as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 4.2.5.</td><td> </td><td class="right">      Section 4.2.5.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0248" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Note that, as with the server certificate, there are certificates</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   that use algorithm combinations that cannot be currently used with</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   TLS.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.2.4.  Receiving a Certificate Message</td><td> </td><td class="right">4.4.2.4.  Receiving a Certificate Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In general, detailed certificate validation procedures are out of</td><td> </td><td class="right">   In general, detailed certificate validation procedures are out of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   scope for TLS (see [RFC5280]).  This section provides TLS-specific</td><td> </td><td class="right">   scope for TLS (see [RFC5280]).  This section provides TLS-specific</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requirements.</td><td> </td><td class="right">   requirements.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server supplies an empty Certificate message, the client MUST</td><td> </td><td class="right">   If the server supplies an empty Certificate message, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   abort the handshake with a "decode_error" alert.</td><td> </td><td class="right">   abort the handshake with a "decode_error" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the client does not send any certificates (i.e., it sends an empty</td><td> </td><td class="right">   If the client does not send any certificates (i.e., it sends an empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Certificate message), the server MAY at its discretion either</td><td> </td><td class="right">   Certificate message), the server MAY at its discretion either</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0249" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   continue the handshake without client authentication<span class="delete">,</span> or abort the</td><td> </td><td class="rblock">   continue the handshake without client authentication or abort the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake with a "certificate_required" alert.  Also, if some aspect</td><td> </td><td class="right">   handshake with a "certificate_required" alert.  Also, if some aspect</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the certificate chain was unacceptable (e.g., it was not signed by</td><td> </td><td class="right">   of the certificate chain was unacceptable (e.g., it was not signed by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a known, trusted CA), the server MAY at its discretion either</td><td> </td><td class="right">   a known, trusted CA), the server MAY at its discretion either</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   continue the handshake (considering the client unauthenticated) or</td><td> </td><td class="right">   continue the handshake (considering the client unauthenticated) or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   abort the handshake.</td><td> </td><td class="right">   abort the handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Any endpoint receiving any certificate which it would need to</td><td> </td><td class="right">   Any endpoint receiving any certificate which it would need to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   validate using any signature algorithm using an MD5 hash MUST abort</td><td> </td><td class="right">   validate using any signature algorithm using an MD5 hash MUST abort</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0250" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the handshake with a "bad_certificate" alert.  SHA-1 is deprecated</td><td> </td><td class="rblock">   the handshake with a "bad_certificate" alert.  SHA-1 is deprecated<span class="insert">,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and it is RECOMMENDED that any endpoint receiving any certificate</td><td> </td><td class="right">   and it is RECOMMENDED that any endpoint receiving any certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which it would need to validate using any signature algorithm using a</td><td> </td><td class="right">   which it would need to validate using any signature algorithm using a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SHA-1 hash abort the handshake with a "bad_certificate" alert.  For</td><td> </td><td class="right">   SHA-1 hash abort the handshake with a "bad_certificate" alert.  For</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0251" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   clarity, this means that endpoints <span class="delete">MAY</span> accept these algorithms for</td><td> </td><td class="rblock">   clarity, this means that endpoints <span class="insert">can</span> accept these algorithms for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates that are self-signed or are trust anchors.</td><td> </td><td class="right">   certificates that are self-signed or are trust anchors.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All endpoints are RECOMMENDED to transition to SHA-256 or better as</td><td> </td><td class="right">   All endpoints are RECOMMENDED to transition to SHA-256 or better as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   soon as possible to maintain interoperability with implementations</td><td> </td><td class="right">   soon as possible to maintain interoperability with implementations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   currently in the process of phasing out SHA-1 support.</td><td> </td><td class="right">   currently in the process of phasing out SHA-1 support.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that a certificate containing a key for one signature algorithm</td><td> </td><td class="right">   Note that a certificate containing a key for one signature algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MAY be signed using a different signature algorithm (for instance, an</td><td> </td><td class="right">   MAY be signed using a different signature algorithm (for instance, an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RSA key signed with an ECDSA key).</td><td> </td><td class="right">   RSA key signed with an ECDSA key).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l30" /><small>skipping to change at</small><em> page 72, line 51</em></th><th> </th><th><a name="part-r30" /><small>skipping to change at</small><em> page 69, line 33</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message.</td><td> </td><td class="right">   message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          SignatureScheme algorithm;</td><td> </td><td class="right">          SignatureScheme algorithm;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque signature&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          opaque signature&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateVerify;</td><td> </td><td class="right">      } CertificateVerify;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The algorithm field specifies the signature algorithm used (see</td><td> </td><td class="right">   The algorithm field specifies the signature algorithm used (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0252" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Section 4.2.3 for the definition of this <span class="delete">field</span>).  The signature is a</td><td> </td><td class="rblock">   Section 4.2.3 for the definition of this <span class="insert">type</span>).  The signature is a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   digital signature using that algorithm.  The content that is covered</td><td> </td><td class="right">   digital signature using that algorithm.  The content that is covered</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   under the signature is the hash output as described in Section 4.4.1,</td><td> </td><td class="right">   under the signature is the hash output as described in Section 4.4.1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   namely:</td><td> </td><td class="right">   namely:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Transcript-Hash(Handshake Context, Certificate)</td><td> </td><td class="right">      Transcript-Hash(Handshake Context, Certificate)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The digital signature is then computed over the concatenation of:</td><td> </td><td class="right">   The digital signature is then computed over the concatenation of:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A string that consists of octet 32 (0x20) repeated 64 times</td><td> </td><td class="right">   -  A string that consists of octet 32 (0x20) repeated 64 times</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l31" /><small>skipping to change at</small><em> page 73, line 18</em></th><th> </th><th><a name="part-r31" /><small>skipping to change at</small><em> page 70, line 4</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The digital signature is then computed over the concatenation of:</td><td> </td><td class="right">   The digital signature is then computed over the concatenation of:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A string that consists of octet 32 (0x20) repeated 64 times</td><td> </td><td class="right">   -  A string that consists of octet 32 (0x20) repeated 64 times</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The context string</td><td> </td><td class="right">   -  The context string</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A single 0 byte which serves as the separator</td><td> </td><td class="right">   -  A single 0 byte which serves as the separator</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The content to be signed</td><td> </td><td class="right">   -  The content to be signed</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0253" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                         </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This structure is intended to prevent an attack on previous versions</td><td> </td><td class="right">   This structure is intended to prevent an attack on previous versions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of TLS in which the ServerKeyExchange format meant that attackers</td><td> </td><td class="right">   of TLS in which the ServerKeyExchange format meant that attackers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   could obtain a signature of a message with a chosen 32-byte prefix</td><td> </td><td class="right">   could obtain a signature of a message with a chosen 32-byte prefix</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (ClientHello.random).  The initial 64-byte pad clears that prefix</td><td> </td><td class="right">   (ClientHello.random).  The initial 64-byte pad clears that prefix</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   along with the server-controlled ServerHello.random.</td><td> </td><td class="right">   along with the server-controlled ServerHello.random.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0254" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The context string for a server signature <span class="delete">is:</span> "TLS 1.3, server</td><td> </td><td class="rblock">   The context string for a server signature <span class="insert">is</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">CertificateVerify"</span> The context string for a client signature <span class="delete">is:</span> "TLS</td><td> </td><td class="rblock">   "TLS 1.3, server <span class="insert">CertificateVerify".</span>  The context string for a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3, client <span class="delete">CertificateVerify"</span> It is used to provide separation</td><td> </td><td class="rblock">   client signature <span class="insert">is</span> "TLS 1.3, client <span class="insert">CertificateVerify".</span>  It is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   between signatures made in different contexts, helping against</td><td> </td><td class="rblock">   used to provide separation between signatures made in different</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   potential cross-protocol attacks.</td><td> </td><td class="rblock">   contexts, helping against potential cross-protocol attacks.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For example, if the transcript hash was 32 bytes of 01 (this length</td><td> </td><td class="right">   For example, if the transcript hash was 32 bytes of 01 (this length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   would make sense for SHA-256), the content covered by the digital</td><td> </td><td class="right">   would make sense for SHA-256), the content covered by the digital</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signature for a server CertificateVerify would be:</td><td> </td><td class="right">   signature for a server CertificateVerify would be:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      2020202020202020202020202020202020202020202020202020202020202020</td><td> </td><td class="right">      2020202020202020202020202020202020202020202020202020202020202020</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      2020202020202020202020202020202020202020202020202020202020202020</td><td> </td><td class="right">      2020202020202020202020202020202020202020202020202020202020202020</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      544c5320312e332c207365727665722043657274696669636174655665726966</td><td> </td><td class="right">      544c5320312e332c207365727665722043657274696669636174655665726966</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      79</td><td> </td><td class="right">      79</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      00</td><td> </td><td class="right">      00</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      0101010101010101010101010101010101010101010101010101010101010101</td><td> </td><td class="right">      0101010101010101010101010101010101010101010101010101010101010101</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0255" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   On the sender side the process for computing the signature field of</td><td> </td><td class="rblock">   On the sender side<span class="insert">,</span> the process for computing the signature field of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the CertificateVerify message takes as input:</td><td> </td><td class="right">   the CertificateVerify message takes as input:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The content covered by the digital signature</td><td> </td><td class="right">   -  The content covered by the digital signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The private signing key corresponding to the certificate sent in</td><td> </td><td class="right">   -  The private signing key corresponding to the certificate sent in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the previous message</td><td> </td><td class="right">      the previous message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the CertificateVerify message is sent by a server, the signature</td><td> </td><td class="right">   If the CertificateVerify message is sent by a server, the signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   algorithm MUST be one offered in the client's "signature_algorithms"</td><td> </td><td class="right">   algorithm MUST be one offered in the client's "signature_algorithms"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension unless no valid certificate chain can be produced without</td><td> </td><td class="right">   extension unless no valid certificate chain can be produced without</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l32" /><small>skipping to change at</small><em> page 74, line 27</em></th><th> </th><th><a name="part-r32" /><small>skipping to change at</small><em> page 71, line 15</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All SHA-1 signature algorithms in this specification are defined</td><td> </td><td class="right">   All SHA-1 signature algorithms in this specification are defined</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   solely for use in legacy certificates and are not valid for</td><td> </td><td class="right">   solely for use in legacy certificates and are not valid for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateVerify signatures.</td><td> </td><td class="right">   CertificateVerify signatures.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The receiver of a CertificateVerify message MUST verify the signature</td><td> </td><td class="right">   The receiver of a CertificateVerify message MUST verify the signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   field.  The verification process takes as input:</td><td> </td><td class="right">   field.  The verification process takes as input:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The content covered by the digital signature</td><td> </td><td class="right">   -  The content covered by the digital signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The public key contained in the end-entity certificate found in</td><td> </td><td class="right">   -  The public key contained in the end-entity certificate found in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0256" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the associated Certificate message<span class="delete">.</span></td><td> </td><td class="rblock">      the associated Certificate message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The digital signature received in the signature field of the</td><td> </td><td class="right">   -  The digital signature received in the signature field of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      CertificateVerify message</td><td> </td><td class="right">      CertificateVerify message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the verification fails, the receiver MUST terminate the handshake</td><td> </td><td class="right">   If the verification fails, the receiver MUST terminate the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with a "decrypt_error" alert.</td><td> </td><td class="right">   with a "decrypt_error" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.4.4.  Finished</td><td> </td><td class="right">4.4.4.  Finished</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0257" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The Finished message is the final message in the <span class="delete">authentication</span></td><td> </td><td class="rblock">   The Finished message is the final message in the <span class="insert">Authentication</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   block.</span>  It is essential for providing authentication of the handshake</td><td> </td><td class="rblock"><span class="insert">   Block.</span>  It is essential for providing authentication of the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and of the computed keys.</td><td> </td><td class="right">   and of the computed keys.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Recipients of Finished messages MUST verify that the contents are</td><td> </td><td class="right">   Recipients of Finished messages MUST verify that the contents are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   correct and if incorrect MUST terminate the connection with a</td><td> </td><td class="right">   correct and if incorrect MUST terminate the connection with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "decrypt_error" alert.</td><td> </td><td class="right">   "decrypt_error" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0258" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Once a side has sent its Finished message and received and validated</td><td> </td><td class="rblock">   Once a side has sent its Finished message and <span class="insert">has</span> received and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the Finished message from its peer, it may begin to send and receive</td><td> </td><td class="rblock">   validated the Finished message from its peer, it may begin to send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">application data</span> over the connection.  There are two settings in</td><td> </td><td class="rblock">   and receive <span class="insert">Application Data</span> over the connection.  There are two</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   which it is permitted to send data prior to receiving the peer's</td><td> </td><td class="rblock">   settings in which it is permitted to send data prior to receiving the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Finished:</td><td> </td><td class="rblock">   peer's Finished:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   1.  Clients sending 0-RTT data as described in Section 4.2.10.</td><td> </td><td class="right">   1.  Clients sending 0-RTT data as described in Section 4.2.10.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   2.  Servers MAY send data after sending their first flight, but</td><td> </td><td class="right">   2.  Servers MAY send data after sending their first flight, but</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       because the handshake is not yet complete, they have no assurance</td><td> </td><td class="right">       because the handshake is not yet complete, they have no assurance</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0259" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       of either the peer's identity or <span class="delete">of </span>its liveness (i.e., the</td><td> </td><td class="rblock">       of either the peer's identity or its liveness (i.e., the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       ClientHello might have been replayed).</td><td> </td><td class="right">       ClientHello might have been replayed).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The key used to compute the Finished message is computed from the</td><td> </td><td class="right">   The key used to compute the Finished message is computed from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0260" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Base <span class="delete">k</span>ey defined in Section 4.4 using HKDF (see Section 7.1).</td><td> </td><td class="rblock">   Base <span class="insert">K</span>ey defined in Section 4.4 using HKDF (see Section 7.1).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Specifically:</td><td> </td><td class="right">   Specifically:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   finished_key =</td><td> </td><td class="right">   finished_key =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       HKDF-Expand-Label(BaseKey, "finished", "", Hash.length)</td><td> </td><td class="right">       HKDF-Expand-Label(BaseKey, "finished", "", Hash.length)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque verify_data[Hash.length];</td><td> </td><td class="right">          opaque verify_data[Hash.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Finished;</td><td> </td><td class="right">      } Finished;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l33" /><small>skipping to change at</small><em> page 75, line 40</em></th><th> </th><th><a name="part-r33" /><small>skipping to change at</small><em> page 72, line 35</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      * Only included if present.</td><td> </td><td class="right">      * Only included if present.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HMAC [RFC2104] uses the Hash algorithm for the handshake.  As noted</td><td> </td><td class="right">   HMAC [RFC2104] uses the Hash algorithm for the handshake.  As noted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   above, the HMAC input can generally be implemented by a running hash,</td><td> </td><td class="right">   above, the HMAC input can generally be implemented by a running hash,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   i.e., just the handshake hash at this point.</td><td> </td><td class="right">   i.e., just the handshake hash at this point.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In previous versions of TLS, the verify_data was always 12 octets</td><td> </td><td class="right">   In previous versions of TLS, the verify_data was always 12 octets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   long.  In TLS 1.3, it is the size of the HMAC output for the Hash</td><td> </td><td class="right">   long.  In TLS 1.3, it is the size of the HMAC output for the Hash</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   used for the handshake.</td><td> </td><td class="right">   used for the handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0261" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note: Alerts and any other record types are not handshake messages</td><td> </td><td class="rblock">   Note: Alerts and any other <span class="insert">non-handshake</span> record types are not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and are not included in the hash computations.</td><td> </td><td class="rblock">   handshake messages and are not included in the hash computations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Any records following a Finished message MUST be encrypted under the</td><td> </td><td class="right">   Any records following a Finished message MUST be encrypted under the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   appropriate application traffic key as described in Section 7.2.  In</td><td> </td><td class="right">   appropriate application traffic key as described in Section 7.2.  In</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   particular, this includes any alerts sent by the server in response</td><td> </td><td class="right">   particular, this includes any alerts sent by the server in response</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to client Certificate and CertificateVerify messages.</td><td> </td><td class="right">   to client Certificate and CertificateVerify messages.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.5.  End of Early Data</td><td> </td><td class="right">4.5.  End of Early Data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {} EndOfEarlyData;</td><td> </td><td class="right">      struct {} EndOfEarlyData;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0262" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If the server sent an "early_data" <span class="delete">extension,</span> the client MUST send an</td><td> </td><td class="rblock">   If the server sent an "early_data" <span class="insert">extension in EncryptedExtensions,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   EndOfEarlyData message after receiving the server Finished.  If the</td><td> </td><td class="rblock">   the client MUST send an EndOfEarlyData message after receiving the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server does not send an "early_data" <span class="delete">extension,</span> then the client MUST</td><td> </td><td class="rblock">   server Finished.  If the server does not send an "early_data"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   NOT send an EndOfEarlyData message.  This message indicates that all</td><td> </td><td class="rblock">   <span class="insert">extension in EncryptedExtensions,</span> then the client MUST NOT send an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   0-RTT application_data messages, if any, have been transmitted and</td><td> </td><td class="rblock">   EndOfEarlyData message.  This message indicates that all 0-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that the following records are protected under handshake traffic</td><td> </td><td class="rblock">   application_data messages, if any, have been transmitted and that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   keys.  Servers MUST NOT send this <span class="delete">message</span> and clients receiving it</td><td> </td><td class="rblock">   following records are protected under handshake traffic keys.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   MUST terminate the connection with an "unexpected_message" alert.</td><td> </td><td class="rblock">   Servers MUST NOT send this <span class="insert">message,</span> and clients receiving it MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This message is encrypted under keys derived from the</td><td> </td><td class="rblock">   terminate the connection with an "unexpected_message" alert.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   message is encrypted under keys derived from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client_early_traffic_secret.</td><td> </td><td class="right">   client_early_traffic_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.6.  Post-Handshake Messages</td><td> </td><td class="right">4.6.  Post-Handshake Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS also allows other messages to be sent after the main handshake.</td><td> </td><td class="right">   TLS also allows other messages to be sent after the main handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These messages use a handshake content type and are encrypted under</td><td> </td><td class="right">   These messages use a handshake content type and are encrypted under</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the appropriate application traffic key.</td><td> </td><td class="right">   the appropriate application traffic key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.6.1.  New Session Ticket Message</td><td> </td><td class="right">4.6.1.  New Session Ticket Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   At any time after the server has received the client Finished</td><td> </td><td class="right">   At any time after the server has received the client Finished</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message, it MAY send a NewSessionTicket message.  This message</td><td> </td><td class="right">   message, it MAY send a NewSessionTicket message.  This message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   creates a unique association between the ticket value and a secret</td><td> </td><td class="right">   creates a unique association between the ticket value and a secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0263" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   PSK derived from the resumption master secret (see Section 7.</td><td> </td><td class="rblock">   PSK derived from the resumption master secret (see Section 7<span class="insert">)</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client MAY use this PSK for future handshakes by including the</td><td> </td><td class="right">   The client MAY use this PSK for future handshakes by including the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ticket value in the "pre_shared_key" extension in its ClientHello</td><td> </td><td class="right">   ticket value in the "pre_shared_key" extension in its ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (Section 4.2.11).  Servers MAY send multiple tickets on a single</td><td> </td><td class="right">   (Section 4.2.11).  Servers MAY send multiple tickets on a single</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection, either immediately after each other or after specific</td><td> </td><td class="right">   connection, either immediately after each other or after specific</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   events (see Appendix C.4).  For instance, the server might send a new</td><td> </td><td class="right">   events (see Appendix C.4).  For instance, the server might send a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ticket after post-handshake authentication in order to encapsulate</td><td> </td><td class="right">   ticket after post-handshake authentication in order to encapsulate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the additional client authentication state.  Multiple tickets are</td><td> </td><td class="right">   the additional client authentication state.  Multiple tickets are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   useful for clients for a variety of purposes, including:</td><td> </td><td class="right">   useful for clients for a variety of purposes, including:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Opening multiple parallel HTTP connections.</td><td> </td><td class="right">   -  Opening multiple parallel HTTP connections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Performing connection racing across interfaces and address</td><td> </td><td class="right">   -  Performing connection racing across interfaces and address</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0264" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      families via<span class="delete">, e.g.,</span> Happy Eyeballs [RFC8305] or related</td><td> </td><td class="rblock">      families via<span class="insert"> (for example)</span> Happy Eyeballs [RFC8305] or related</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      techniques.</td><td> </td><td class="right">      techniques.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Any ticket MUST only be resumed with a cipher suite that has the same</td><td> </td><td class="right">   Any ticket MUST only be resumed with a cipher suite that has the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   KDF hash algorithm as that used to establish the original connection.</td><td> </td><td class="right">   KDF hash algorithm as that used to establish the original connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Clients MUST only resume if the new SNI value is valid for the server</td><td> </td><td class="right">   Clients MUST only resume if the new SNI value is valid for the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0265" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate presented in the original session<span class="delete">,</span> and SHOULD only resume</td><td> </td><td class="rblock">   certificate presented in the original session and SHOULD only resume</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   if the SNI value matches the one used in the original session.  The</td><td> </td><td class="right">   if the SNI value matches the one used in the original session.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   latter is a performance optimization: normally, there is no reason to</td><td> </td><td class="right">   latter is a performance optimization: normally, there is no reason to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   expect that different servers covered by a single certificate would</td><td> </td><td class="right">   expect that different servers covered by a single certificate would</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0266" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   be able to accept each other's tickets<span class="delete">, hence</span> attempting resumption</td><td> </td><td class="rblock">   be able to accept each other's tickets<span class="insert">; hence,</span> attempting resumption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in that case would waste a single-use ticket.  If such an indication</td><td> </td><td class="right">   in that case would waste a single-use ticket.  If such an indication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is provided (externally or by any other means), clients MAY resume</td><td> </td><td class="right">   is provided (externally or by any other means), clients MAY resume</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with a different SNI value.</td><td> </td><td class="right">   with a different SNI value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   On resumption, if reporting an SNI value to the calling application,</td><td> </td><td class="right">   On resumption, if reporting an SNI value to the calling application,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementations MUST use the value sent in the resumption ClientHello</td><td> </td><td class="right">   implementations MUST use the value sent in the resumption ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   rather than the value sent in the previous session.  Note that if a</td><td> </td><td class="right">   rather than the value sent in the previous session.  Note that if a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server implementation declines all PSK identities with different SNI</td><td> </td><td class="right">   server implementation declines all PSK identities with different SNI</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   values, these two values are always the same.</td><td> </td><td class="right">   values, these two values are always the same.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Although the resumption master secret depends on the client's</td><td> </td><td class="right">   Note: Although the resumption master secret depends on the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0267" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   second flight, <span class="delete">servers</span> which <span class="delete">do</span> not request client authentication MAY</td><td> </td><td class="rblock">   second flight, <span class="insert">a server</span> which <span class="insert">does</span> not request client authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   compute the remainder of the transcript independently and then send a</td><td> </td><td class="rblock">   MAY compute the remainder of the transcript independently and then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   NewSessionTicket immediately upon sending its Finished rather than</td><td> </td><td class="rblock">   send a NewSessionTicket immediately upon sending its Finished rather</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   waiting for the client Finished.  This might be appropriate in cases</td><td> </td><td class="rblock">   than waiting for the client Finished.  This might be appropriate in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   where the client is expected to open multiple TLS connections in</td><td> </td><td class="rblock">   cases where the client is expected to open multiple TLS connections</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   parallel and would benefit from the reduced overhead of a resumption</td><td> </td><td class="rblock">   in parallel and would benefit from the reduced overhead of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake, for example.</td><td> </td><td class="rblock">   resumption handshake, for example.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint32 ticket_lifetime;</td><td> </td><td class="right">          uint32 ticket_lifetime;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint32 ticket_age_add;</td><td> </td><td class="right">          uint32 ticket_age_add;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque ticket_nonce&lt;0..255&gt;;</td><td> </td><td class="right">          opaque ticket_nonce&lt;0..255&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque ticket&lt;1..2^16-1&gt;;</td><td> </td><td class="right">          opaque ticket&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;0..2^16-2&gt;;</td><td> </td><td class="right">          Extension extensions&lt;0..2^16-2&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } NewSessionTicket;</td><td> </td><td class="right">      } NewSessionTicket;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0268" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ticket_lifetime  Indicates the lifetime in seconds as a 32-bit</td><td> </td><td class="rblock">   ticket_lifetime<span class="insert">:</span>  Indicates the lifetime in seconds as a 32-bit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      unsigned integer in network byte order from the time of ticket</td><td> </td><td class="right">      unsigned integer in network byte order from the time of ticket</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0269" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      issuance.  Servers MUST NOT use any value greater than 604800</td><td> </td><td class="rblock">      issuance.  Servers MUST NOT use any value greater than</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      seconds (7 days).  The value of zero indicates that the ticket</td><td> </td><td class="rblock">      604800 seconds (7 days).  The value of zero indicates that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      should be discarded immediately.  Clients MUST NOT cache tickets</td><td> </td><td class="rblock">      ticket should be discarded immediately.  Clients MUST NOT cache</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      for longer than 7 days, regardless of the ticket_lifetime, and MAY</td><td> </td><td class="rblock">      tickets for longer than 7 days, regardless of the ticket_lifetime,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      delete tickets earlier based on local policy.  A server MAY treat</td><td> </td><td class="rblock">      and MAY delete tickets earlier based on local policy.  A server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      a ticket as valid for a shorter period of time than what is stated</td><td> </td><td class="rblock">      MAY treat a ticket as valid for a shorter period of time than what</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      in the ticket_lifetime.</td><td> </td><td class="rblock">      is stated in the ticket_lifetime.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0270" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ticket_age_add  A securely generated, random 32-bit value that is</td><td> </td><td class="rblock">   ticket_age_add<span class="insert">:</span>  A securely generated, random 32-bit value that is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      used to obscure the age of the ticket that the client includes in</td><td> </td><td class="right">      used to obscure the age of the ticket that the client includes in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the "pre_shared_key" extension.  The client-side ticket age is</td><td> </td><td class="right">      the "pre_shared_key" extension.  The client-side ticket age is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      added to this value modulo 2^32 to obtain the value that is</td><td> </td><td class="right">      added to this value modulo 2^32 to obtain the value that is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      transmitted by the client.  The server MUST generate a fresh value</td><td> </td><td class="right">      transmitted by the client.  The server MUST generate a fresh value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      for each ticket it sends.</td><td> </td><td class="right">      for each ticket it sends.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0271" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ticket_nonce  A per-ticket value that is unique across all tickets</td><td> </td><td class="rblock">   ticket_nonce<span class="insert">:</span>  A per-ticket value that is unique across all tickets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      issued on this connection.</td><td> </td><td class="right">      issued on this connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0272" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">ticket</span>  The value of the ticket to be used as the PSK identity.  The</td><td> </td><td class="rblock">   <span class="insert">ticket:</span>  The value of the ticket to be used as the PSK identity.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ticket itself is an opaque label.  It MAY <span class="delete">either</span> be a database</td><td> </td><td class="rblock">      ticket itself is an opaque label.  It MAY be <span class="insert">either</span> a database</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      lookup key or a self-encrypted and self-authenticated value.</td><td> </td><td class="right">      lookup key or a self-encrypted and self-authenticated value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0273" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">Section 4 of [RFC5077] describes a recommended ticket construction</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      mechanism.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0274" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   extensions  A set of extension values for the ticket.  The</td><td> </td><td class="rblock">   extensions<span class="insert">:</span>  A set of extension values for the ticket.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "Extension" format is defined in Section 4.2.  Clients MUST ignore</td><td> </td><td class="right">      "Extension" format is defined in Section 4.2.  Clients MUST ignore</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      unrecognized extensions.</td><td> </td><td class="right">      unrecognized extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The sole extension currently defined for NewSessionTicket is</td><td> </td><td class="right">   The sole extension currently defined for NewSessionTicket is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "early_data", indicating that the ticket may be used to send 0-RTT</td><td> </td><td class="right">   "early_data", indicating that the ticket may be used to send 0-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0275" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   data (Section 4.2.10)<span class="delete">)</span>.  It contains the following value:</td><td> </td><td class="rblock">   data (Section 4.2.10).  It contains the following value:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0276" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">max_early_data_size</span>  The maximum amount of 0-RTT data that the client</td><td> </td><td class="rblock">   <span class="insert">max_early_data_size:</span>  The maximum amount of 0-RTT data that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      is allowed to send when using this ticket, in bytes.  Only</td><td> </td><td class="rblock">      client is allowed to send when using this ticket, in bytes.  Only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Application Data payload (i.e., plaintext but not padding or the</td><td> </td><td class="right">      Application Data payload (i.e., plaintext but not padding or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      inner content type byte) is counted.  A server receiving more than</td><td> </td><td class="right">      inner content type byte) is counted.  A server receiving more than</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      max_early_data_size bytes of 0-RTT data SHOULD terminate the</td><td> </td><td class="right">      max_early_data_size bytes of 0-RTT data SHOULD terminate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      connection with an "unexpected_message" alert.  Note that servers</td><td> </td><td class="right">      connection with an "unexpected_message" alert.  Note that servers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      that reject early data due to lack of cryptographic material will</td><td> </td><td class="right">      that reject early data due to lack of cryptographic material will</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0277" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      be unable to differentiate padding from content, so clients SHOULD</td><td> </td><td class="rblock">      be unable to differentiate padding from content, so clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      NOT depend on being able to send large quantities of padding in</td><td> </td><td class="rblock">      SHOULD NOT depend on being able to send large quantities of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      early data records.</td><td> </td><td class="rblock">      padding in early data records.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The PSK associated with the ticket is computed as:</td><td> </td><td class="right">   The PSK associated with the ticket is computed as:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       HKDF-Expand-Label(resumption_master_secret,</td><td> </td><td class="right">       HKDF-Expand-Label(resumption_master_secret,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                        "resumption", ticket_nonce, Hash.length)</td><td> </td><td class="right">                        "resumption", ticket_nonce, Hash.length)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Because the ticket_nonce value is distinct for each NewSessionTicket</td><td> </td><td class="right">   Because the ticket_nonce value is distinct for each NewSessionTicket</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message, a different PSK will be derived for each ticket.</td><td> </td><td class="right">   message, a different PSK will be derived for each ticket.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that in principle it is possible to continue issuing new tickets</td><td> </td><td class="right">   Note that in principle it is possible to continue issuing new tickets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l34" /><small>skipping to change at</small><em> page 79, line 24</em></th><th> </th><th><a name="part-r34" /><small>skipping to change at</small><em> page 76, line 22</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Because client authentication could involve prompting the user,</td><td> </td><td class="right">   Note: Because client authentication could involve prompting the user,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   servers MUST be prepared for some delay, including receiving an</td><td> </td><td class="right">   servers MUST be prepared for some delay, including receiving an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   arbitrary number of other messages between sending the</td><td> </td><td class="right">   arbitrary number of other messages between sending the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateRequest and receiving a response.  In addition, clients</td><td> </td><td class="right">   CertificateRequest and receiving a response.  In addition, clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which receive multiple CertificateRequests in close succession MAY</td><td> </td><td class="right">   which receive multiple CertificateRequests in close succession MAY</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   respond to them in a different order than they were received (the</td><td> </td><td class="right">   respond to them in a different order than they were received (the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate_request_context value allows the server to disambiguate</td><td> </td><td class="right">   certificate_request_context value allows the server to disambiguate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the responses).</td><td> </td><td class="right">   the responses).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0278" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">4.6.3.  Key and <span class="delete">IV</span> Update</td><td> </td><td class="rblock">4.6.3.  Key and <span class="insert">Initialization Vector</span> Update</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The KeyUpdate handshake message is used to indicate that the sender</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is updating its sending cryptographic keys.  This message can be sent</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by either peer after it has sent a Finished message.  Implementations</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that receive a KeyUpdate message prior to receiving a Finished</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   message MUST terminate the connection with an "unexpected_message"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   alert.  After sending a KeyUpdate message, the sender SHALL send all</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   its traffic using the next generation of keys, computed as described</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in Section 7.2.  Upon receiving a KeyUpdate, the receiver MUST update</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   its receiving keys.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          update_not_requested(0), update_requested(1), (255)</td><td> </td><td class="right">          update_not_requested(0), update_requested(1), (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } KeyUpdateRequest;</td><td> </td><td class="right">      } KeyUpdateRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          KeyUpdateRequest request_update;</td><td> </td><td class="right">          KeyUpdateRequest request_update;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } KeyUpdate;</td><td> </td><td class="right">      } KeyUpdate;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0279" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   request_update  Indicates whether the recipient of the KeyUpdate</td><td> </td><td class="rblock">   request_update<span class="insert">:</span>  Indicates whether the recipient of the KeyUpdate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      should respond with its own KeyUpdate.  If an implementation</td><td> </td><td class="right">      should respond with its own KeyUpdate.  If an implementation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      receives any other value, it MUST terminate the connection with an</td><td> </td><td class="right">      receives any other value, it MUST terminate the connection with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "illegal_parameter" alert.</td><td> </td><td class="right">      "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0280" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">The KeyUpdate handshake message is used to indicate that the sender</span></td><td> </td><td class="rblock">   If the request_update field is set to <span class="insert">"update_requested",</span> then the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   is updating its sending cryptographic keys.  This message can be sent</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   by either peer after it has sent a Finished message.  Implementations</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   that receive a KeyUpdate message prior to receiving a Finished</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   message MUST terminate the connection with an "unexpected_message"</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   alert.  After sending a KeyUpdate message, the sender SHALL send all</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   its traffic using the next generation of keys, computed as described</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   in Section 7.2.  Upon receiving a KeyUpdate, the receiver MUST update</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   its receiving keys.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If the request_update field is set to <span class="delete">"update_requested"</span> then the</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receiver MUST send a KeyUpdate of its own with request_update set to</td><td> </td><td class="right">   receiver MUST send a KeyUpdate of its own with request_update set to</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0281" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "update_not_requested" prior to sending its next <span class="delete">application d</span>ata</td><td> </td><td class="rblock">   "update_not_requested" prior to sending its next <span class="insert">Application D</span>ata</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   record.  This mechanism allows either side to force an update to the</td><td> </td><td class="right">   record.  This mechanism allows either side to force an update to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   entire connection, but causes an implementation which receives</td><td> </td><td class="right">   entire connection, but causes an implementation which receives</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   multiple KeyUpdates while it is silent to respond with a single</td><td> </td><td class="right">   multiple KeyUpdates while it is silent to respond with a single</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   update.  Note that implementations may receive an arbitrary number of</td><td> </td><td class="right">   update.  Note that implementations may receive an arbitrary number of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages between sending a KeyUpdate with request_update set to</td><td> </td><td class="right">   messages between sending a KeyUpdate with request_update set to</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0282" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">update_requested</span> and receiving the peer's KeyUpdate, because those</td><td> </td><td class="rblock">   <span class="insert">"update_requested"</span> and receiving the peer's KeyUpdate, because those</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages may already be in flight.  However, because send and receive</td><td> </td><td class="right">   messages may already be in flight.  However, because send and receive</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   keys are derived from independent traffic secrets, retaining the</td><td> </td><td class="right">   keys are derived from independent traffic secrets, retaining the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receive traffic secret does not threaten the forward secrecy of data</td><td> </td><td class="right">   receive traffic secret does not threaten the forward secrecy of data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sent before the sender changed keys.</td><td> </td><td class="right">   sent before the sender changed keys.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If implementations independently send their own KeyUpdates with</td><td> </td><td class="right">   If implementations independently send their own KeyUpdates with</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0283" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   request_update set to "update_requested"<span class="delete">,</span> and they cross in flight,</td><td> </td><td class="rblock">   request_update set to "update_requested" and they cross in flight,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   then each side will also send a response, with the result that each</td><td> </td><td class="right">   then each side will also send a response, with the result that each</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   side increments by two generations.</td><td> </td><td class="right">   side increments by two generations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Both sender and receiver MUST encrypt their KeyUpdate messages with</td><td> </td><td class="right">   Both sender and receiver MUST encrypt their KeyUpdate messages with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the old keys.  Additionally, both sides MUST enforce that a KeyUpdate</td><td> </td><td class="right">   the old keys.  Additionally, both sides MUST enforce that a KeyUpdate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with the old key is received before accepting any messages encrypted</td><td> </td><td class="right">   with the old key is received before accepting any messages encrypted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with the new key.  Failure to do so may allow message truncation</td><td> </td><td class="right">   with the new key.  Failure to do so may allow message truncation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attacks.</td><td> </td><td class="right">   attacks.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.  Record Protocol</td><td> </td><td class="right">5.  Record Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS record protocol takes messages to be transmitted, fragments</td><td> </td><td class="right">   The TLS record protocol takes messages to be transmitted, fragments</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the data into manageable blocks, protects the records, and transmits</td><td> </td><td class="right">   the data into manageable blocks, protects the records, and transmits</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the result.  Received data is verified, decrypted, reassembled, and</td><td> </td><td class="right">   the result.  Received data is verified, decrypted, reassembled, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   then delivered to higher-level clients.</td><td> </td><td class="right">   then delivered to higher-level clients.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS records are typed, which allows multiple higher-level protocols</td><td> </td><td class="right">   TLS records are typed, which allows multiple higher-level protocols</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to be multiplexed over the same record layer.  This document</td><td> </td><td class="right">   to be multiplexed over the same record layer.  This document</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0284" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   specifies four content types: handshake, application<span class="delete"> </span>data, alert, and</td><td> </td><td class="rblock">   specifies four content types: handshake, application<span class="insert">_</span>data, alert, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   change_cipher_spec.  The change_cipher_spec record is used only for</td><td> </td><td class="right">   change_cipher_spec.  The change_cipher_spec record is used only for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compatibility purposes (see Appendix D.4).</td><td> </td><td class="right">   compatibility purposes (see Appendix D.4).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An implementation may receive an unencrypted record of type</td><td> </td><td class="right">   An implementation may receive an unencrypted record of type</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   change_cipher_spec consisting of the single byte value 0x01 at any</td><td> </td><td class="right">   change_cipher_spec consisting of the single byte value 0x01 at any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   time after the first ClientHello message has been sent or received</td><td> </td><td class="right">   time after the first ClientHello message has been sent or received</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and before the peer's Finished message has been received and MUST</td><td> </td><td class="right">   and before the peer's Finished message has been received and MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   simply drop it without further processing.  Note that this record may</td><td> </td><td class="right">   simply drop it without further processing.  Note that this record may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   appear at a point at the handshake where the implementation is</td><td> </td><td class="right">   appear at a point at the handshake where the implementation is</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0285" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   expecting protected records and so it is necessary to detect this</td><td> </td><td class="rblock">   expecting protected records<span class="insert">,</span> and so it is necessary to detect this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   condition prior to attempting to deprotect the record.  An</td><td> </td><td class="right">   condition prior to attempting to deprotect the record.  An</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementation which receives any other change_cipher_spec value or</td><td> </td><td class="right">   implementation which receives any other change_cipher_spec value or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which receives a protected change_cipher_spec record MUST abort the</td><td> </td><td class="right">   which receives a protected change_cipher_spec record MUST abort the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0286" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake with an "unexpected_message" alert.  <span class="delete">A</span> change_cipher_spec</td><td> </td><td class="rblock">   handshake with an "unexpected_message" alert.  <span class="insert">If an implementation</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   record received before the first ClientHello message or after the</td><td> </td><td class="rblock"><span class="insert">   detects a</span> change_cipher_spec record received before the first</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   peer's Finished <span class="delete">message</span> MUST be treated as an unexpected record type</td><td> </td><td class="rblock">   ClientHello message or after the peer's Finished <span class="insert">message, it</span> MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (though stateless servers may not be able to distinguish these cases</td><td> </td><td class="rblock">   treated as an unexpected record type (though stateless servers may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   from allowed cases).</td><td> </td><td class="rblock">   not be able to distinguish these cases from allowed cases).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST NOT send record types not defined in this</td><td> </td><td class="right">   Implementations MUST NOT send record types not defined in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document unless negotiated by some extension.  If a TLS</td><td> </td><td class="right">   document unless negotiated by some extension.  If a TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementation receives an unexpected record type, it MUST terminate</td><td> </td><td class="right">   implementation receives an unexpected record type, it MUST terminate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the connection with an "unexpected_message" alert.  New record</td><td> </td><td class="right">   the connection with an "unexpected_message" alert.  New record</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0287" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   content type values are assigned by IANA in the TLS <span class="delete">Content Type</span></td><td> </td><td class="rblock">   content type values are assigned by IANA in the TLS <span class="insert">ContentType</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Registry</span> as described in Section 11.</td><td> </td><td class="rblock"><span class="insert">   registry</span> as described in Section 11.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.1.  Record Layer</td><td> </td><td class="right">5.1.  Record Layer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The record layer fragments information blocks into TLSPlaintext</td><td> </td><td class="right">   The record layer fragments information blocks into TLSPlaintext</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   records carrying data in chunks of 2^14 bytes or less.  Message</td><td> </td><td class="right">   records carrying data in chunks of 2^14 bytes or less.  Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   boundaries are handled differently depending on the underlying</td><td> </td><td class="right">   boundaries are handled differently depending on the underlying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ContentType.  Any future content types MUST specify appropriate</td><td> </td><td class="right">   ContentType.  Any future content types MUST specify appropriate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   rules.  Note that these rules are stricter than what was enforced in</td><td> </td><td class="right">   rules.  Note that these rules are stricter than what was enforced in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.2.</td><td> </td><td class="right">   TLS 1.2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l35" /><small>skipping to change at</small><em> page 81, line 41</em></th><th> </th><th><a name="part-r35" /><small>skipping to change at</small><em> page 78, line 39</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MUST verify that all messages immediately preceding a key change</td><td> </td><td class="right">      MUST verify that all messages immediately preceding a key change</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      align with a record boundary; if not, then they MUST terminate the</td><td> </td><td class="right">      align with a record boundary; if not, then they MUST terminate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      connection with an "unexpected_message" alert.  Because the</td><td> </td><td class="right">      connection with an "unexpected_message" alert.  Because the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello, EndOfEarlyData, ServerHello, Finished, and KeyUpdate</td><td> </td><td class="right">      ClientHello, EndOfEarlyData, ServerHello, Finished, and KeyUpdate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      messages can immediately precede a key change, implementations</td><td> </td><td class="right">      messages can immediately precede a key change, implementations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MUST send these messages in alignment with a record boundary.</td><td> </td><td class="right">      MUST send these messages in alignment with a record boundary.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST NOT send zero-length fragments of Handshake</td><td> </td><td class="right">   Implementations MUST NOT send zero-length fragments of Handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   types, even if those fragments contain padding.</td><td> </td><td class="right">   types, even if those fragments contain padding.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0288" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Alert messages (Section 6) MUST NOT be fragmented across <span class="delete">records</span> and</td><td> </td><td class="rblock">   Alert messages (Section 6) MUST NOT be fragmented across <span class="insert">records,</span> and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   multiple <span class="delete">Alert</span> messages MUST NOT be coalesced into a single</td><td> </td><td class="rblock">   multiple <span class="insert">alert</span> messages MUST NOT be coalesced into a single</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSPlaintext record.  In other words, a record with an Alert type</td><td> </td><td class="right">   TLSPlaintext record.  In other words, a record with an Alert type</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST contain exactly one message.</td><td> </td><td class="right">   MUST contain exactly one message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application Data messages contain data that is opaque to TLS.</td><td> </td><td class="right">   Application Data messages contain data that is opaque to TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application Data messages are always protected.  Zero-length</td><td> </td><td class="right">   Application Data messages are always protected.  Zero-length</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0289" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   fragments of Application Data MAY be sent as they are potentially</td><td> </td><td class="rblock">   fragments of Application Data MAY be sent<span class="insert">,</span> as they are potentially</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   useful as a traffic analysis countermeasure.  Application Data</td><td> </td><td class="right">   useful as a traffic analysis countermeasure.  Application Data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fragments MAY be split across multiple records or coalesced into a</td><td> </td><td class="right">   fragments MAY be split across multiple records or coalesced into a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   single record.</td><td> </td><td class="right">   single record.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          invalid(0),</td><td> </td><td class="right">          invalid(0),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          change_cipher_spec(20),</td><td> </td><td class="right">          change_cipher_spec(20),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          alert(21),</td><td> </td><td class="right">          alert(21),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          handshake(22),</td><td> </td><td class="right">          handshake(22),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          application_data(23),</td><td> </td><td class="right">          application_data(23),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (255)</td><td> </td><td class="right">          (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ContentType;</td><td> </td><td class="right">      } ContentType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ContentType type;</td><td> </td><td class="right">          ContentType type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ProtocolVersion legacy_record_version;</td><td> </td><td class="right">          ProtocolVersion legacy_record_version;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint16 length;</td><td> </td><td class="right">          uint16 length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque fragment[TLSPlaintext.length];</td><td> </td><td class="right">          opaque fragment[TLSPlaintext.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } TLSPlaintext;</td><td> </td><td class="right">      } TLSPlaintext;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0290" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   type  The higher-level protocol used to process the enclosed</td><td> </td><td class="rblock">   type<span class="insert">:</span>  The higher-level protocol used to process the enclosed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      fragment.</td><td> </td><td class="right">      fragment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0291" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">legacy_record_version  This value</span> MUST be set to 0x0303 for all</td><td> </td><td class="rblock">   <span class="insert">legacy_record_version:</span>  MUST be set to 0x0303 for all records</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      records generated by a TLS 1.3 implementation other than an</td><td> </td><td class="rblock">      generated by a TLS 1.3 implementation other than an initial</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      initial ClientHello (i.e., one not generated after a</td><td> </td><td class="rblock">      ClientHello (i.e., one not generated after a HelloRetryRequest),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      HelloRetryRequest), where it MAY also be 0x0301 for compatibility</td><td> </td><td class="rblock">      where it MAY also be 0x0301 for compatibility purposes.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      purposes.  This field is deprecated and MUST be ignored for all</td><td> </td><td class="rblock">      field is deprecated and MUST be ignored for all purposes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      purposes.  Previous versions of TLS would use other values in this</td><td> </td><td class="rblock">      Previous versions of TLS would use other values in this field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      field under some circumstances.</td><td> </td><td class="rblock">      under some circumstances.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0292" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">length</span>  The length (in bytes) of the following TLSPlaintext.fragment.</td><td> </td><td class="rblock">   <span class="insert">length:</span>  The length (in bytes) of the following</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      The length MUST NOT exceed 2^14 bytes.  An endpoint that receives</td><td> </td><td class="rblock">      TLSPlaintext.fragment.  The length MUST NOT exceed 2^14 bytes.  An</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      a record that exceeds this length MUST terminate the connection</td><td> </td><td class="rblock">      endpoint that receives a record that exceeds this length MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      with a "record_overflow" alert.</td><td> </td><td class="rblock">      terminate the connection with a "record_overflow" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0293" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   fragment  The data being transmitted.  This value is transparent and</td><td> </td><td class="rblock">   fragment<span class="insert">:</span>  The data being transmitted.  This value is transparent and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is treated as an independent block to be dealt with by the higher-</td><td> </td><td class="right">      is treated as an independent block to be dealt with by the higher-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      level protocol specified by the type field.</td><td> </td><td class="right">      level protocol specified by the type field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document describes TLS 1.3, which uses the version 0x0304.  This</td><td> </td><td class="right">   This document describes TLS 1.3, which uses the version 0x0304.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0294" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   version value is historical, deriving from the use of 0x0301 for TLS</td><td> </td><td class="rblock">   version value is historical, deriving from the use of 0x0301 for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.0 and 0x0300 for SSL 3.0.  In order to maximize <span class="delete">backwards</span></td><td> </td><td class="rblock">   TLS 1.0 and 0x0300 for SSL 3.0.  In order to maximize <span class="insert">backward</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   compatibility, <span class="delete">records</span> containing an initial ClientHello SHOULD have</td><td> </td><td class="rblock">   compatibility, <span class="insert">a record</span> containing an initial ClientHello SHOULD have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   version 0x0301 and a record containing a second ClientHello or a</td><td> </td><td class="rblock">   version 0x0301 <span class="insert">(reflecting TLS 1.0)</span> and a record containing a second</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ServerHello MUST have version <span class="delete">0x0303, reflecting TLS 1.0 and</span> TLS <span class="delete">1.2</span></td><td> </td><td class="rblock">   ClientHello or a ServerHello MUST have version <span class="insert">0x0303 (reflecting</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   respectively.</span>  When negotiating prior versions of TLS, endpoints</td><td> </td><td class="rblock">   TLS <span class="insert">1.2).</span>  When negotiating prior versions of TLS, endpoints follow</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   follow the procedure and requirements in Appendix D.</td><td> </td><td class="rblock">   the procedure and requirements <span class="insert">provided</span> in Appendix D.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When record protection has not yet been engaged, TLSPlaintext</td><td> </td><td class="right">   When record protection has not yet been engaged, TLSPlaintext</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   structures are written directly onto the wire.  Once record</td><td> </td><td class="right">   structures are written directly onto the wire.  Once record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protection has started, TLSPlaintext records are protected and sent</td><td> </td><td class="right">   protection has started, TLSPlaintext records are protected and sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0295" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   as described in the following section.  Note that <span class="delete">application d</span>ata</td><td> </td><td class="rblock">   as described in the following section.  Note that <span class="insert">Application D</span>ata</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   records MUST NOT be written to the wire unprotected (see Section 2</td><td> </td><td class="right">   records MUST NOT be written to the wire unprotected (see Section 2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for details).</td><td> </td><td class="right">   for details).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.2.  Record Payload Protection</td><td> </td><td class="right">5.2.  Record Payload Protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The record protection functions translate a TLSPlaintext structure</td><td> </td><td class="right">   The record protection functions translate a TLSPlaintext structure</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0296" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   into a <span class="delete">TLSCiphertext.</span>  The deprotection functions reverse the</td><td> </td><td class="rblock">   into a <span class="insert">TLSCiphertext structure.</span>  The deprotection functions reverse</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   process.  In TLS 1.3, as opposed to previous versions of TLS, all</td><td> </td><td class="rblock">   the process.  In TLS 1.3, as opposed to previous versions of TLS, all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ciphers are modeled as "Authenticated Encryption with <span class="delete">Additional</span></td><td> </td><td class="rblock">   ciphers are modeled as "Authenticated Encryption with <span class="insert">Associated</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Data" (AEAD) [RFC5116].  AEAD functions provide <span class="delete">an</span> unified encryption</td><td> </td><td class="rblock">   Data" (AEAD) [RFC5116].  AEAD functions provide <span class="insert">a</span> unified encryption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and authentication operation which turns plaintext into authenticated</td><td> </td><td class="right">   and authentication operation which turns plaintext into authenticated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ciphertext and back again.  Each encrypted record consists of a</td><td> </td><td class="right">   ciphertext and back again.  Each encrypted record consists of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   plaintext header followed by an encrypted body, which itself contains</td><td> </td><td class="right">   plaintext header followed by an encrypted body, which itself contains</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a type and optional padding.</td><td> </td><td class="right">   a type and optional padding.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque content[TLSPlaintext.length];</td><td> </td><td class="right">          opaque content[TLSPlaintext.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ContentType type;</td><td> </td><td class="right">          ContentType type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8 zeros[length_of_padding];</td><td> </td><td class="right">          uint8 zeros[length_of_padding];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } TLSInnerPlaintext;</td><td> </td><td class="right">      } TLSInnerPlaintext;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ContentType opaque_type = application_data; /* 23 */</td><td> </td><td class="right">          ContentType opaque_type = application_data; /* 23 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ProtocolVersion legacy_record_version = 0x0303; /* TLS v1.2 */</td><td> </td><td class="right">          ProtocolVersion legacy_record_version = 0x0303; /* TLS v1.2 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint16 length;</td><td> </td><td class="right">          uint16 length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque encrypted_record[TLSCiphertext.length];</td><td> </td><td class="right">          opaque encrypted_record[TLSCiphertext.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } TLSCiphertext;</td><td> </td><td class="right">      } TLSCiphertext;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0297" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   content<span class="delete">  The TLSPL</span>aintext.fragment value, containing the byte</td><td> </td><td class="rblock">   content<span class="insert">:  The TLSPl</span>aintext.fragment value, containing the byte</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      encoding of a handshake or an alert message, or the raw bytes of</td><td> </td><td class="right">      encoding of a handshake or an alert message, or the raw bytes of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the application's data to send.</td><td> </td><td class="right">      the application's data to send.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0298" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   type  The TLSPlaintext.type value containing the content type of the</td><td> </td><td class="rblock">   type<span class="insert">:</span>  The TLSPlaintext.type value containing the content type of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      record.</td><td> </td><td class="right">      record.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0299" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">zeros</span>  An arbitrary-length run of zero-valued bytes may appear in the</td><td> </td><td class="rblock">   <span class="insert">zeros:</span>  An arbitrary-length run of zero-valued bytes may appear in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      cleartext after the type field.  This provides an opportunity for</td><td> </td><td class="rblock">      the cleartext after the type field.  This provides an opportunity</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      senders to pad any TLS record by a chosen amount as long as the</td><td> </td><td class="rblock">      for senders to pad any TLS record by a chosen amount as long as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      total stays within record size limits.  See Section 5.4 for more</td><td> </td><td class="rblock">      the total stays within record size limits.  See Section 5.4 for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      details.</td><td> </td><td class="rblock">      more details.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0300" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">opaque_type</span>  The outer opaque_type field of a TLSCiphertext record is</td><td> </td><td class="rblock">   <span class="insert">opaque_type:</span>  The outer opaque_type field of a TLSCiphertext record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      always set to the value 23 (application_data) for outward</td><td> </td><td class="rblock">      is always set to the value 23 (application_data) for outward</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compatibility with middleboxes accustomed to parsing previous</td><td> </td><td class="right">      compatibility with middleboxes accustomed to parsing previous</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      versions of TLS.  The actual content type of the record is found</td><td> </td><td class="right">      versions of TLS.  The actual content type of the record is found</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      in TLSInnerPlaintext.type after decryption.</td><td> </td><td class="right">      in TLSInnerPlaintext.type after decryption.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0301" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">legacy_record_version</span>  The legacy_record_version field is always</td><td> </td><td class="rblock">   <span class="insert">legacy_record_version:</span>  The legacy_record_version field is always</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      0x0303.  TLS 1.3 TLSCiphertexts are not generated until after TLS</td><td> </td><td class="rblock">      0x0303.  TLS 1.3 TLSCiphertexts are not generated until after</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.3 has been negotiated, so there are no historical compatibility</td><td> </td><td class="rblock">      TLS 1.3 has been negotiated, so there are no historical</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      concerns where other values might be received.  Note that the</td><td> </td><td class="rblock">      compatibility concerns where other values might be received.  Note</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      handshake <span class="delete">protocol</span> including the ClientHello and ServerHello</td><td> </td><td class="rblock">      that the handshake <span class="insert">protocol,</span> including the ClientHello and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">messages</span> authenticates the protocol version, so this value is</td><td> </td><td class="rblock">      ServerHello <span class="insert">messages,</span> authenticates the protocol version, so this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      redundant.</td><td> </td><td class="rblock">      value is redundant.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0302" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   length  The length (in bytes) of the following</td><td> </td><td class="rblock">   length<span class="insert">:</span>  The length (in bytes) of the following</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TLSCiphertext.encrypted_record, which is the sum of the lengths of</td><td> </td><td class="right">      TLSCiphertext.encrypted_record, which is the sum of the lengths of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the content and the padding, plus one for the inner content type,</td><td> </td><td class="right">      the content and the padding, plus one for the inner content type,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0303" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      plus any expansion added by the AEAD algorithm.  The length MUST</td><td> </td><td class="rblock">      plus any expansion added by the AEAD algorithm.  The length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      NOT exceed 2^14 + 256 bytes.  An endpoint that receives a record</td><td> </td><td class="rblock">      MUST NOT exceed 2^14 + 256 bytes.  An endpoint that receives a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      that exceeds this length MUST terminate the connection with a</td><td> </td><td class="rblock">      record that exceeds this length MUST terminate the connection with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "record_overflow" alert.</td><td> </td><td class="rblock">      a "record_overflow" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0304" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   encrypted_record  The AEAD-encrypted form of the serialized</td><td> </td><td class="rblock">   encrypted_record<span class="insert">:</span>  The AEAD-encrypted form of the serialized</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TLSInnerPlaintext structure.</td><td> </td><td class="right">      TLSInnerPlaintext structure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   AEAD algorithms take as input a single key, a nonce, a plaintext, and</td><td> </td><td class="right">   AEAD algorithms take as input a single key, a nonce, a plaintext, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "additional data" to be included in the authentication check, as</td><td> </td><td class="right">   "additional data" to be included in the authentication check, as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   described in Section 2.1 of [RFC5116].  The key is either the</td><td> </td><td class="right">   described in Section 2.1 of [RFC5116].  The key is either the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client_write_key or the server_write_key, the nonce is derived from</td><td> </td><td class="right">   client_write_key or the server_write_key, the nonce is derived from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the sequence number and the client_write_iv or server_write_iv (see</td><td> </td><td class="right">   the sequence number and the client_write_iv or server_write_iv (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 5.3), and the additional data input is the record header.</td><td> </td><td class="right">   Section 5.3), and the additional data input is the record header.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0305" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   I.e.,</td><td> </td><td class="right">   I.e.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      additional_data = TLSCiphertext.opaque_type ||</td><td> </td><td class="right">      additional_data = TLSCiphertext.opaque_type ||</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                        TLSCiphertext.legacy_record_version ||</td><td> </td><td class="right">                        TLSCiphertext.legacy_record_version ||</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                        TLSCiphertext.length</td><td> </td><td class="right">                        TLSCiphertext.length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The plaintext input to the AEAD algorithm is the encoded</td><td> </td><td class="right">   The plaintext input to the AEAD algorithm is the encoded</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSInnerPlaintext structure.  Derivation of traffic keys is defined</td><td> </td><td class="right">   TLSInnerPlaintext structure.  Derivation of traffic keys is defined</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in Section 7.3.</td><td> </td><td class="right">   in Section 7.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l36" /><small>skipping to change at</small><em> page 84, line 46</em></th><th> </th><th><a name="part-r36" /><small>skipping to change at</small><em> page 82, line 4</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The plaintext input to the AEAD algorithm is the encoded</td><td> </td><td class="right">   The plaintext input to the AEAD algorithm is the encoded</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSInnerPlaintext structure.  Derivation of traffic keys is defined</td><td> </td><td class="right">   TLSInnerPlaintext structure.  Derivation of traffic keys is defined</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in Section 7.3.</td><td> </td><td class="right">   in Section 7.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The AEAD output consists of the ciphertext output from the AEAD</td><td> </td><td class="right">   The AEAD output consists of the ciphertext output from the AEAD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   encryption operation.  The length of the plaintext is greater than</td><td> </td><td class="right">   encryption operation.  The length of the plaintext is greater than</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the corresponding TLSPlaintext.length due to the inclusion of</td><td> </td><td class="right">   the corresponding TLSPlaintext.length due to the inclusion of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSInnerPlaintext.type and any padding supplied by the sender.  The</td><td> </td><td class="right">   TLSInnerPlaintext.type and any padding supplied by the sender.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   length of the AEAD output will generally be larger than the</td><td> </td><td class="right">   length of the AEAD output will generally be larger than the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   plaintext, but by an amount that varies with the AEAD algorithm.</td><td> </td><td class="right">   plaintext, but by an amount that varies with the AEAD algorithm.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0306" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Since the ciphers might incorporate padding, the amount of overhead</td><td> </td><td class="right">   Since the ciphers might incorporate padding, the amount of overhead</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   could vary with different lengths of plaintext.  Symbolically,</td><td> </td><td class="right">   could vary with different lengths of plaintext.  Symbolically,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      AEADEncrypted =</td><td> </td><td class="right">      AEADEncrypted =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          AEAD-Encrypt(write_key, nonce, additional_data, plaintext)</td><td> </td><td class="right">          AEAD-Encrypt(write_key, nonce, additional_data, plaintext)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0307" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Then the</span> encrypted_record field of TLSCiphertext is set to</td><td> </td><td class="rblock">   <span class="insert">The</span> encrypted_record field of TLSCiphertext is set to AEADEncrypted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   AEADEncrypted.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to decrypt and verify, the cipher takes as input the key,</td><td> </td><td class="right">   In order to decrypt and verify, the cipher takes as input the key,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   nonce, additional data, and the AEADEncrypted value.  The output is</td><td> </td><td class="right">   nonce, additional data, and the AEADEncrypted value.  The output is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   either the plaintext or an error indicating that the decryption</td><td> </td><td class="right">   either the plaintext or an error indicating that the decryption</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0308" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   failed.  There is no separate integrity check.  <span class="delete">That is:</span></td><td> </td><td class="rblock">   failed.  There is no separate integrity check.  <span class="insert">Symbolically,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0309" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   plaintext of encrypted_record =</td><td> </td><td class="rblock">      plaintext of encrypted_record =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       AEAD-Decrypt(peer_write_key, nonce, additional_data, AEADEncrypted)</td><td> </td><td class="rblock">          AEAD-Decrypt(peer_write_key, nonce,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                       additional_data, AEADEncrypted)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the decryption fails, the receiver MUST terminate the connection</td><td> </td><td class="right">   If the decryption fails, the receiver MUST terminate the connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with a "bad_record_mac" alert.</td><td> </td><td class="right">   with a "bad_record_mac" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An AEAD algorithm used in TLS 1.3 MUST NOT produce an expansion</td><td> </td><td class="right">   An AEAD algorithm used in TLS 1.3 MUST NOT produce an expansion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   greater than 255 octets.  An endpoint that receives a record from its</td><td> </td><td class="right">   greater than 255 octets.  An endpoint that receives a record from its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   peer with TLSCiphertext.length larger than 2^14 + 256 octets MUST</td><td> </td><td class="right">   peer with TLSCiphertext.length larger than 2^14 + 256 octets MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   terminate the connection with a "record_overflow" alert.  This limit</td><td> </td><td class="right">   terminate the connection with a "record_overflow" alert.  This limit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is derived from the maximum TLSInnerPlaintext length of 2^14 octets +</td><td> </td><td class="right">   is derived from the maximum TLSInnerPlaintext length of 2^14 octets +</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   1 octet for ContentType + the maximum AEAD expansion of 255 octets.</td><td> </td><td class="right">   1 octet for ContentType + the maximum AEAD expansion of 255 octets.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l37" /><small>skipping to change at</small><em> page 85, line 37</em></th><th> </th><th><a name="part-r37" /><small>skipping to change at</small><em> page 82, line 43</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A 64-bit sequence number is maintained separately for reading and</td><td> </td><td class="right">   A 64-bit sequence number is maintained separately for reading and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   writing records.  The appropriate sequence number is incremented by</td><td> </td><td class="right">   writing records.  The appropriate sequence number is incremented by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   one after reading or writing each record.  Each sequence number is</td><td> </td><td class="right">   one after reading or writing each record.  Each sequence number is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   set to zero at the beginning of a connection and whenever the key is</td><td> </td><td class="right">   set to zero at the beginning of a connection and whenever the key is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   changed; the first record transmitted under a particular traffic key</td><td> </td><td class="right">   changed; the first record transmitted under a particular traffic key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST use sequence number 0.</td><td> </td><td class="right">   MUST use sequence number 0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Because the size of sequence numbers is 64-bit, they should not wrap.</td><td> </td><td class="right">   Because the size of sequence numbers is 64-bit, they should not wrap.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If a TLS implementation would need to wrap a sequence number, it MUST</td><td> </td><td class="right">   If a TLS implementation would need to wrap a sequence number, it MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0310" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   either re<span class="delete">-</span>key (Section 4.6.3) or terminate the connection.</td><td> </td><td class="rblock">   either rekey (Section 4.6.3) or terminate the connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Each AEAD algorithm will specify a range of possible lengths for the</td><td> </td><td class="right">   Each AEAD algorithm will specify a range of possible lengths for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0311" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   per-record nonce, from N_MIN bytes to N_MAX bytes of input</td><td> </td><td class="rblock">   per-record nonce, from N_MIN bytes to N_MAX bytes of input <span class="insert">[RFC5116].</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">([RFC5116]).</span>  The length of the TLS per-record nonce (iv_length) is</td><td> </td><td class="rblock">   The length of the TLS per-record nonce (iv_length) is set to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   set to the larger of 8 bytes and N_MIN for the AEAD algorithm (see</td><td> </td><td class="rblock">   larger of 8 bytes and N_MIN for the AEAD algorithm (see <span class="insert">[RFC5116],</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[RFC5116]</span> Section 4).  An AEAD algorithm where N_MAX is less than 8</td><td> </td><td class="rblock">   Section 4).  An AEAD algorithm where N_MAX is less than 8 bytes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   bytes MUST NOT be used with TLS.  The per-record nonce for the AEAD</td><td> </td><td class="rblock">   MUST NOT be used with TLS.  The per-record nonce for the AEAD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   construction is formed as follows:</td><td> </td><td class="right">   construction is formed as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   1.  The 64-bit record sequence number is encoded in network byte</td><td> </td><td class="right">   1.  The 64-bit record sequence number is encoded in network byte</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       order and padded to the left with zeros to iv_length.</td><td> </td><td class="right">       order and padded to the left with zeros to iv_length.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0312" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   2.  The padded sequence number is XORed with the static</td><td> </td><td class="rblock">   2.  The padded sequence number is XORed with <span class="insert">either</span> the static</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       client_write_iv or <span class="delete">server_write_iv, depending</span> on the <span class="delete">role.</span></td><td> </td><td class="rblock">       client_write_iv or <span class="insert">server_write_iv (depending</span> on the <span class="insert">role).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0313" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The resulting quantity (of length iv_length) is used as the <span class="delete">per-</span></td><td> </td><td class="rblock">   The resulting quantity (of length iv_length) is used as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   record</span> nonce.</td><td> </td><td class="rblock">   <span class="insert">per-record</span> nonce.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: This is a different construction from that in TLS 1.2, which</td><td> </td><td class="right">   Note: This is a different construction from that in TLS 1.2, which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specified a partially explicit nonce.</td><td> </td><td class="right">   specified a partially explicit nonce.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.4.  Record Padding</td><td> </td><td class="right">5.4.  Record Padding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All encrypted TLS records can be padded to inflate the size of the</td><td> </td><td class="right">   All encrypted TLS records can be padded to inflate the size of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSCiphertext.  This allows the sender to hide the size of the</td><td> </td><td class="right">   TLSCiphertext.  This allows the sender to hide the size of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic from an observer.</td><td> </td><td class="right">   traffic from an observer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When generating a TLSCiphertext record, implementations MAY choose to</td><td> </td><td class="right">   When generating a TLSCiphertext record, implementations MAY choose to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pad.  An unpadded record is just a record with a padding length of</td><td> </td><td class="right">   pad.  An unpadded record is just a record with a padding length of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   zero.  Padding is a string of zero-valued bytes appended to the</td><td> </td><td class="right">   zero.  Padding is a string of zero-valued bytes appended to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ContentType field before encryption.  Implementations MUST set the</td><td> </td><td class="right">   ContentType field before encryption.  Implementations MUST set the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   padding octets to all zeros before encrypting.</td><td> </td><td class="right">   padding octets to all zeros before encrypting.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application Data records may contain a zero-length</td><td> </td><td class="right">   Application Data records may contain a zero-length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSInnerPlaintext.content if the sender desires.  This permits</td><td> </td><td class="right">   TLSInnerPlaintext.content if the sender desires.  This permits</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0314" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   generation of plausibly<span class="delete">-</span>sized cover traffic in contexts where the</td><td> </td><td class="rblock">   generation of plausibly<span class="insert"> </span>sized cover traffic in contexts where the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   presence or absence of activity may be sensitive.  Implementations</td><td> </td><td class="right">   presence or absence of activity may be sensitive.  Implementations</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0315" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   MUST NOT send Handshake <span class="delete">or</span> Alert records that have a zero-length</td><td> </td><td class="rblock">   MUST NOT send Handshake <span class="insert">and</span> Alert records that have a zero-length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSInnerPlaintext.content; if such a message is received, the</td><td> </td><td class="right">   TLSInnerPlaintext.content; if such a message is received, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receiving implementation MUST terminate the connection with an</td><td> </td><td class="right">   receiving implementation MUST terminate the connection with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "unexpected_message" alert.</td><td> </td><td class="right">   "unexpected_message" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The padding sent is automatically verified by the record protection</td><td> </td><td class="right">   The padding sent is automatically verified by the record protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanism; upon successful decryption of a</td><td> </td><td class="right">   mechanism; upon successful decryption of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSCiphertext.encrypted_record, the receiving implementation scans</td><td> </td><td class="right">   TLSCiphertext.encrypted_record, the receiving implementation scans</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the field from the end toward the beginning until it finds a non-zero</td><td> </td><td class="right">   the field from the end toward the beginning until it finds a non-zero</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   octet.  This non-zero octet is the content type of the message.  This</td><td> </td><td class="right">   octet.  This non-zero octet is the content type of the message.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   padding scheme was selected because it allows padding of any</td><td> </td><td class="right">   padding scheme was selected because it allows padding of any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l38" /><small>skipping to change at</small><em> page 86, line 49</em></th><th> </th><th><a name="part-r38" /><small>skipping to change at</small><em> page 84, line 22</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   size limits) without introducing new content types.  The design also</td><td> </td><td class="right">   size limits) without introducing new content types.  The design also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   enforces all-zero padding octets, which allows for quick detection of</td><td> </td><td class="right">   enforces all-zero padding octets, which allows for quick detection of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   padding errors.</td><td> </td><td class="right">   padding errors.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST limit their scanning to the cleartext returned</td><td> </td><td class="right">   Implementations MUST limit their scanning to the cleartext returned</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   from the AEAD decryption.  If a receiving implementation does not</td><td> </td><td class="right">   from the AEAD decryption.  If a receiving implementation does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   find a non-zero octet in the cleartext, it MUST terminate the</td><td> </td><td class="right">   find a non-zero octet in the cleartext, it MUST terminate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection with an "unexpected_message" alert.</td><td> </td><td class="right">   connection with an "unexpected_message" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The presence of padding does not change the overall record size</td><td> </td><td class="right">   The presence of padding does not change the overall record size</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0316" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">limitations -</span> the full encoded TLSInnerPlaintext MUST NOT exceed 2^14</td><td> </td><td class="rblock">   <span class="insert">limitations:</span> the full encoded TLSInnerPlaintext MUST NOT exceed 2^14</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   + 1 octets.  If the maximum fragment length is <span class="delete">reduced, as</span> for</td><td> </td><td class="rblock">   + 1 octets.  If the maximum fragment length is <span class="insert">reduced -- as,</span> for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">example</span> by the <span class="delete">max_fragment_length</span> extension from <span class="delete">[RFC6066],</span> then the</td><td> </td><td class="rblock">   <span class="insert">example,</span> by the <span class="insert">record_size_limit</span> extension from <span class="insert">[RFC8449] --</span> then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   reduced limit applies to the full plaintext, including the content</td><td> </td><td class="rblock">   the reduced limit applies to the full plaintext, including the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   type and padding.</td><td> </td><td class="rblock">   content type and padding.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Selecting a padding policy that suggests when and how much to pad is</td><td> </td><td class="right">   Selecting a padding policy that suggests when and how much to pad is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a complex topic and is beyond the scope of this specification.  If</td><td> </td><td class="right">   a complex topic and is beyond the scope of this specification.  If</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0317" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the <span class="delete">application layer</span> protocol on top of TLS has its own padding, it</td><td> </td><td class="rblock">   the <span class="insert">application-layer</span> protocol on top of TLS has its own padding, it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   may be preferable to pad <span class="delete">application_data</span> TLS records within the</td><td> </td><td class="rblock">   may be preferable to pad <span class="insert">Application Data</span> TLS records within the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   application layer.  Padding for encrypted <span class="delete">handshake and alert TLS</span></td><td> </td><td class="rblock">   application layer.  Padding for encrypted <span class="insert">Handshake or Alert</span> records</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   records must still be handled at the TLS layer, though.  Later</td><td> </td><td class="rblock">   must still be handled at the TLS layer, though.  Later documents may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   documents may define padding selection algorithms or define a padding</td><td> </td><td class="rblock">   define padding selection algorithms or define a padding policy</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   policy request mechanism through TLS extensions or some other means.</td><td> </td><td class="rblock">   request mechanism through TLS extensions or some other means.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.5.  Limits on Key Usage</td><td> </td><td class="right">5.5.  Limits on Key Usage</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   There are cryptographic limits on the amount of plaintext which can</td><td> </td><td class="right">   There are cryptographic limits on the amount of plaintext which can</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be safely encrypted under a given set of keys.  [AEAD-LIMITS]</td><td> </td><td class="right">   be safely encrypted under a given set of keys.  [AEAD-LIMITS]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provides an analysis of these limits under the assumption that the</td><td> </td><td class="right">   provides an analysis of these limits under the assumption that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   underlying primitive (AES or ChaCha20) has no weaknesses.</td><td> </td><td class="right">   underlying primitive (AES or ChaCha20) has no weaknesses.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations SHOULD do a key update as described in Section 4.6.3</td><td> </td><td class="right">   Implementations SHOULD do a key update as described in Section 4.6.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   prior to reaching these limits.</td><td> </td><td class="right">   prior to reaching these limits.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For AES-GCM, up to 2^24.5 full-size records (about 24 million) may be</td><td> </td><td class="right">   For AES-GCM, up to 2^24.5 full-size records (about 24 million) may be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   encrypted on a given connection while keeping a safety margin of</td><td> </td><td class="right">   encrypted on a given connection while keeping a safety margin of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   approximately 2^-57 for Authenticated Encryption (AE) security.  For</td><td> </td><td class="right">   approximately 2^-57 for Authenticated Encryption (AE) security.  For</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ChaCha20/Poly1305, the record sequence number would wrap before the</td><td> </td><td class="right">   ChaCha20/Poly1305, the record sequence number would wrap before the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   safety limit is reached.</td><td> </td><td class="right">   safety limit is reached.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.  Alert Protocol</td><td> </td><td class="right">6.  Alert Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0318" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">One of the content types supported by the</span> TLS <span class="delete">record layer is the</span></td><td> </td><td class="rblock">   TLS <span class="insert">provides an Alert content type to indicate closure information</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   alert type.</span>  Like other messages, alert messages are encrypted as</td><td> </td><td class="rblock"><span class="insert">   and errors.</span>  Like other messages, alert messages are encrypted as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specified by the current connection state.</td><td> </td><td class="right">   specified by the current connection state.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Alert messages convey a description of the alert and a legacy field</td><td> </td><td class="right">   Alert messages convey a description of the alert and a legacy field</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0319" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that conveyed the severity of the message in previous versions of</td><td> </td><td class="rblock">   that conveyed the severity <span class="insert">level</span> of the message in previous versions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS.  Alerts are divided into two classes: closure alerts and error</td><td> </td><td class="rblock">   of TLS.  Alerts are divided into two classes: closure alerts and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   alerts.  In TLS 1.3, the severity is implicit in the type of alert</td><td> </td><td class="rblock">   error alerts.  In TLS 1.3, the severity is implicit in the type of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   being sent, and the <span class="delete">'level'</span> field can safely be ignored.  The</td><td> </td><td class="rblock">   alert being sent, and the <span class="insert">"level"</span> field can safely be ignored.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "close_notify" alert is used to indicate orderly closure of one</td><td> </td><td class="right">   "close_notify" alert is used to indicate orderly closure of one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   direction of the connection.  Upon receiving such an alert, the TLS</td><td> </td><td class="right">   direction of the connection.  Upon receiving such an alert, the TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementation SHOULD indicate end-of-data to the application.</td><td> </td><td class="right">   implementation SHOULD indicate end-of-data to the application.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Error alerts indicate abortive closure of the connection (see</td><td> </td><td class="right">   Error alerts indicate abortive closure of the connection (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 6.2).  Upon receiving an error alert, the TLS implementation</td><td> </td><td class="right">   Section 6.2).  Upon receiving an error alert, the TLS implementation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SHOULD indicate an error to the application and MUST NOT allow any</td><td> </td><td class="right">   SHOULD indicate an error to the application and MUST NOT allow any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   further data to be sent or received on the connection.  Servers and</td><td> </td><td class="right">   further data to be sent or received on the connection.  Servers and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   clients MUST forget the secret values and keys established in failed</td><td> </td><td class="right">   clients MUST forget the secret values and keys established in failed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connections, with the exception of the PSKs associated with session</td><td> </td><td class="right">   connections, with the exception of the PSKs associated with session</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   tickets, which SHOULD be discarded if possible.</td><td> </td><td class="right">   tickets, which SHOULD be discarded if possible.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All the alerts listed in Section 6.2 MUST be sent with</td><td> </td><td class="right">   All the alerts listed in Section 6.2 MUST be sent with</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0320" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   AlertLevel=fatal and MUST be treated as error alerts regardless of</td><td> </td><td class="rblock">   AlertLevel=fatal and MUST be treated as error alerts <span class="insert">when received</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the AlertLevel in the message.  Unknown <span class="delete">alert</span> types MUST be treated</td><td> </td><td class="rblock">   regardless of the AlertLevel in the message.  Unknown <span class="insert">Alert</span> types</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   as error alerts.</td><td> </td><td class="rblock">   MUST be treated as error alerts.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: TLS defines two generic alerts (see Section 6) to use upon</td><td> </td><td class="right">   Note: TLS defines two generic alerts (see Section 6) to use upon</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   failure to parse a message.  Peers which receive a message which</td><td> </td><td class="right">   failure to parse a message.  Peers which receive a message which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cannot be parsed according to the syntax (e.g., have a length</td><td> </td><td class="right">   cannot be parsed according to the syntax (e.g., have a length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extending beyond the message boundary or contain an out-of-range</td><td> </td><td class="right">   extending beyond the message boundary or contain an out-of-range</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   length) MUST terminate the connection with a "decode_error" alert.</td><td> </td><td class="right">   length) MUST terminate the connection with a "decode_error" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Peers which receive a message which is syntactically correct but</td><td> </td><td class="right">   Peers which receive a message which is syntactically correct but</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   semantically invalid (e.g., a DHE share of p - 1, or an invalid enum)</td><td> </td><td class="right">   semantically invalid (e.g., a DHE share of p - 1, or an invalid enum)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST terminate the connection with an "illegal_parameter" alert.</td><td> </td><td class="right">   MUST terminate the connection with an "illegal_parameter" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l39" /><small>skipping to change at</small><em> page 89, line 48</em></th><th> </th><th><a name="part-r39" /><small>skipping to change at</small><em> page 87, line 10</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          AlertLevel level;</td><td> </td><td class="right">          AlertLevel level;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          AlertDescription description;</td><td> </td><td class="right">          AlertDescription description;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Alert;</td><td> </td><td class="right">      } Alert;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.1.  Closure Alerts</td><td> </td><td class="right">6.1.  Closure Alerts</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client and the server must share knowledge that the connection is</td><td> </td><td class="right">   The client and the server must share knowledge that the connection is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ending in order to avoid a truncation attack.</td><td> </td><td class="right">   ending in order to avoid a truncation attack.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0321" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   close_notify  This alert notifies the recipient that the sender will</td><td> </td><td class="rblock">   close_notify<span class="insert">:</span>  This alert notifies the recipient that the sender will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      not send any more messages on this connection.  Any data received</td><td> </td><td class="right">      not send any more messages on this connection.  Any data received</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      after a closure alert has been received MUST be ignored.</td><td> </td><td class="right">      after a closure alert has been received MUST be ignored.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0322" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   user_canceled  This alert notifies the recipient that the sender is</td><td> </td><td class="rblock">   user_canceled<span class="insert">:</span>  This alert notifies the recipient that the sender is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      canceling the handshake for some reason unrelated to a protocol</td><td> </td><td class="right">      canceling the handshake for some reason unrelated to a protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      failure.  If a user cancels an operation after the handshake is</td><td> </td><td class="right">      failure.  If a user cancels an operation after the handshake is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      complete, just closing the connection by sending a "close_notify"</td><td> </td><td class="right">      complete, just closing the connection by sending a "close_notify"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is more appropriate.  This alert SHOULD be followed by a</td><td> </td><td class="right">      is more appropriate.  This alert SHOULD be followed by a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "close_notify".  This alert generally has AlertLevel=warning.</td><td> </td><td class="right">      "close_notify".  This alert generally has AlertLevel=warning.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Either party MAY initiate a close of its write side of the connection</td><td> </td><td class="right">   Either party MAY initiate a close of its write side of the connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   by sending a "close_notify" alert.  Any data received after a closure</td><td> </td><td class="right">   by sending a "close_notify" alert.  Any data received after a closure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alert has been received MUST be ignored.  If a transport-level close</td><td> </td><td class="right">   alert has been received MUST be ignored.  If a transport-level close</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is received prior to a "close_notify", the receiver cannot know that</td><td> </td><td class="right">   is received prior to a "close_notify", the receiver cannot know that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l40" /><small>skipping to change at</small><em> page 90, line 33</em></th><th> </th><th><a name="part-r40" /><small>skipping to change at</small><em> page 87, line 42</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   discarding pending writes and sending an immediate "close_notify"</td><td> </td><td class="right">   discarding pending writes and sending an immediate "close_notify"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alert of their own.  That previous requirement could cause truncation</td><td> </td><td class="right">   alert of their own.  That previous requirement could cause truncation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in the read side.  Both parties need not wait to receive a</td><td> </td><td class="right">   in the read side.  Both parties need not wait to receive a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "close_notify" alert before closing their read side of the</td><td> </td><td class="right">   "close_notify" alert before closing their read side of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection, though doing so would introduce the possibility of</td><td> </td><td class="right">   connection, though doing so would introduce the possibility of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   truncation.</td><td> </td><td class="right">   truncation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the application protocol using TLS provides that any data may be</td><td> </td><td class="right">   If the application protocol using TLS provides that any data may be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   carried over the underlying transport after the TLS connection is</td><td> </td><td class="right">   carried over the underlying transport after the TLS connection is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   closed, the TLS implementation MUST receive a "close_notify" alert</td><td> </td><td class="right">   closed, the TLS implementation MUST receive a "close_notify" alert</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0323" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   before indicating end-of-data to the application<span class="delete">-</span>layer.  No part of</td><td> </td><td class="rblock">   before indicating end-of-data to the application<span class="insert"> </span>layer.  No part of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   this standard should be taken to dictate the manner in which a usage</td><td> </td><td class="right">   this standard should be taken to dictate the manner in which a usage</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   profile for TLS manages its data transport, including when</td><td> </td><td class="right">   profile for TLS manages its data transport, including when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connections are opened or closed.</td><td> </td><td class="right">   connections are opened or closed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: It is assumed that closing the write side of a connection</td><td> </td><td class="right">   Note: It is assumed that closing the write side of a connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   reliably delivers pending data before destroying the transport.</td><td> </td><td class="right">   reliably delivers pending data before destroying the transport.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.2.  Error Alerts</td><td> </td><td class="right">6.2.  Error Alerts</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0324" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Error handling in <span class="delete">the</span> TLS <span class="delete">Handshake Protocol</span> is very simple.  When an</td><td> </td><td class="rblock">   Error handling in TLS is very simple.  When an error is detected, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   error is detected, the detecting party sends a message to its peer.</td><td> </td><td class="rblock">   detecting party sends a message to its peer.  Upon transmission or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Upon transmission or receipt of a fatal alert message, both parties</td><td> </td><td class="rblock">   receipt of a fatal alert message, both parties MUST immediately close</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   MUST immediately close the connection.</td><td> </td><td class="rblock">   the connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Whenever an implementation encounters a fatal error condition, it</td><td> </td><td class="right">   Whenever an implementation encounters a fatal error condition, it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SHOULD send an appropriate fatal alert and MUST close the connection</td><td> </td><td class="right">   SHOULD send an appropriate fatal alert and MUST close the connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   without sending or receiving any additional data.  In the rest of</td><td> </td><td class="right">   without sending or receiving any additional data.  In the rest of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   this specification, when the phrases "terminate the connection" and</td><td> </td><td class="right">   this specification, when the phrases "terminate the connection" and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "abort the handshake" are used without a specific alert it means that</td><td> </td><td class="right">   "abort the handshake" are used without a specific alert it means that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the implementation SHOULD send the alert indicated by the</td><td> </td><td class="right">   the implementation SHOULD send the alert indicated by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0325" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   descriptions below.  The phrases "terminate the connection with <span class="delete">a</span> X</td><td> </td><td class="rblock">   descriptions below.  The phrases "terminate the connection with <span class="insert">an</span> X</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   alert" and "abort the handshake with <span class="delete">a</span> X alert" mean that the</td><td> </td><td class="rblock">   alert" and "abort the handshake with <span class="insert">an</span> X alert" mean that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementation MUST send alert X if it sends any alert.  All alerts</td><td> </td><td class="right">   implementation MUST send alert X if it sends any alert.  All alerts</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0326" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   defined <span class="delete">in this section below</span>, as well as all unknown alerts, are</td><td> </td><td class="rblock">   defined <span class="insert">below in this section</span>, as well as all unknown alerts, are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   universally considered fatal as of TLS 1.3 (see Section 6).  The</td><td> </td><td class="right">   universally considered fatal as of TLS 1.3 (see Section 6).  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementation SHOULD provide a way to facilitate logging the sending</td><td> </td><td class="right">   implementation SHOULD provide a way to facilitate logging the sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and receiving of alerts.</td><td> </td><td class="right">   and receiving of alerts.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following error alerts are defined:</td><td> </td><td class="right">   The following error alerts are defined:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0327" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">unexpected_message</span>  An inappropriate message (e.g., the wrong</td><td> </td><td class="rblock">   <span class="insert">unexpected_message:</span>  An inappropriate message (e.g., the wrong</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      handshake message, premature <span class="delete">application data,</span> etc.) was received.</td><td> </td><td class="rblock">      handshake message, premature <span class="insert">Application Data,</span> etc.) was received.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This alert should never be observed in communication between</td><td> </td><td class="right">      This alert should never be observed in communication between</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      proper implementations.</td><td> </td><td class="right">      proper implementations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0328" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   bad_record_mac  This alert is returned if a record is received which</td><td> </td><td class="rblock">   bad_record_mac<span class="insert">:</span>  This alert is returned if a record is received which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      cannot be deprotected.  Because AEAD algorithms combine decryption</td><td> </td><td class="right">      cannot be deprotected.  Because AEAD algorithms combine decryption</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0329" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      and verification, and also to avoid side<span class="delete"> </span>channel attacks, this</td><td> </td><td class="rblock">      and verification, and also to avoid side<span class="insert">-</span>channel attacks, this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      alert is used for all deprotection failures.  This alert should</td><td> </td><td class="right">      alert is used for all deprotection failures.  This alert should</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      never be observed in communication between proper implementations,</td><td> </td><td class="right">      never be observed in communication between proper implementations,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      except when messages were corrupted in the network.</td><td> </td><td class="right">      except when messages were corrupted in the network.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0330" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   record_overflow  A TLSCiphertext record was received that had a</td><td> </td><td class="rblock">   record_overflow<span class="insert">:</span>  A TLSCiphertext record was received that had a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      length more than 2^14 + 256 bytes, or a record decrypted to a</td><td> </td><td class="right">      length more than 2^14 + 256 bytes, or a record decrypted to a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TLSPlaintext record with more than 2^14 bytes (or some other</td><td> </td><td class="right">      TLSPlaintext record with more than 2^14 bytes (or some other</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiated limit).  This alert should never be observed in</td><td> </td><td class="right">      negotiated limit).  This alert should never be observed in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      communication between proper implementations, except when messages</td><td> </td><td class="right">      communication between proper implementations, except when messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      were corrupted in the network.</td><td> </td><td class="right">      were corrupted in the network.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0331" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake_failure  Receipt of a "handshake_failure" alert message</td><td> </td><td class="rblock">   handshake_failure<span class="insert">:</span>  Receipt of a "handshake_failure" alert message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      indicates that the sender was unable to negotiate an acceptable</td><td> </td><td class="right">      indicates that the sender was unable to negotiate an acceptable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      set of security parameters given the options available.</td><td> </td><td class="right">      set of security parameters given the options available.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0332" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">bad_certificate</span>  A certificate was corrupt, contained signatures that</td><td> </td><td class="rblock">   <span class="insert">bad_certificate:</span>  A certificate was corrupt, contained signatures</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      did not verify correctly, etc.</td><td> </td><td class="rblock">      that did not verify correctly, etc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0333" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   unsupported_certificate  A certificate was of an unsupported type.</td><td> </td><td class="rblock">   unsupported_certificate<span class="insert">:</span>  A certificate was of an unsupported type.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0334" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate_revoked  A certificate was revoked by its signer.</td><td> </td><td class="rblock">   certificate_revoked<span class="insert">:</span>  A certificate was revoked by its signer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0335" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate_expired  A certificate has expired or is not currently</td><td> </td><td class="rblock">   certificate_expired<span class="insert">:</span>  A certificate has expired or is not currently</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      valid.</td><td> </td><td class="right">      valid.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0336" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate_unknown  Some other (unspecified) issue arose in</td><td> </td><td class="rblock">   certificate_unknown<span class="insert">:</span>  Some other (unspecified) issue arose in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      processing the certificate, rendering it unacceptable.</td><td> </td><td class="right">      processing the certificate, rendering it unacceptable.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0337" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   illegal_parameter  A field in the handshake was incorrect or</td><td> </td><td class="rblock">   illegal_parameter<span class="insert">:</span>  A field in the handshake was incorrect or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      inconsistent with other fields.  This alert is used for errors</td><td> </td><td class="right">      inconsistent with other fields.  This alert is used for errors</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      which conform to the formal protocol syntax but are otherwise</td><td> </td><td class="right">      which conform to the formal protocol syntax but are otherwise</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      incorrect.</td><td> </td><td class="right">      incorrect.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0338" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   unknown_ca  A valid certificate chain or partial chain was received,</td><td> </td><td class="rblock">   unknown_ca<span class="insert">:</span>  A valid certificate chain or partial chain was received,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      but the certificate was not accepted because the CA certificate</td><td> </td><td class="right">      but the certificate was not accepted because the CA certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      could not be located or could not be matched with a known trust</td><td> </td><td class="right">      could not be located or could not be matched with a known trust</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      anchor.</td><td> </td><td class="right">      anchor.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0339" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   access_denied  A valid certificate or PSK was received, but when</td><td> </td><td class="rblock">   access_denied<span class="insert">:</span>  A valid certificate or PSK was received, but when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      access control was applied, the sender decided not to proceed with</td><td> </td><td class="right">      access control was applied, the sender decided not to proceed with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiation.</td><td> </td><td class="right">      negotiation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0340" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   decode_error  A message could not be decoded because some field was</td><td> </td><td class="rblock">   decode_error<span class="insert">:</span>  A message could not be decoded because some field was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      out of the specified range or the length of the message was</td><td> </td><td class="right">      out of the specified range or the length of the message was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      incorrect.  This alert is used for errors where the message does</td><td> </td><td class="right">      incorrect.  This alert is used for errors where the message does</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      not conform to the formal protocol syntax.  This alert should</td><td> </td><td class="right">      not conform to the formal protocol syntax.  This alert should</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      never be observed in communication between proper implementations,</td><td> </td><td class="right">      never be observed in communication between proper implementations,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      except when messages were corrupted in the network.</td><td> </td><td class="right">      except when messages were corrupted in the network.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0341" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">decrypt_error</span>  A handshake (not <span class="delete">record-layer)</span> cryptographic operation</td><td> </td><td class="rblock">   <span class="insert">decrypt_error:</span>  A handshake (not <span class="insert">record layer)</span> cryptographic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      failed, including being unable to correctly verify a signature or</td><td> </td><td class="rblock">      operation failed, including being unable to correctly verify a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      validate a Finished message or a PSK binder.</td><td> </td><td class="rblock">      signature or validate a Finished message or a PSK binder.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0342" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">protocol_version</span>  The protocol version the peer has attempted to</td><td> </td><td class="rblock">   <span class="insert">protocol_version:</span>  The protocol version the peer has attempted to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      negotiate is recognized but not <span class="delete">supported.</span> (see Appendix <span class="delete">D)</span></td><td> </td><td class="rblock">      negotiate is recognized but not <span class="insert">supported</span> (see Appendix <span class="insert">D).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0343" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">insufficient_security</span>  Returned instead of "handshake_failure" when a</td><td> </td><td class="rblock">   <span class="insert">insufficient_security:</span>  Returned instead of "handshake_failure" when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      negotiation has failed specifically because the server requires</td><td> </td><td class="rblock">      a negotiation has failed specifically because the server requires</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      parameters more secure than those supported by the client.</td><td> </td><td class="right">      parameters more secure than those supported by the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0344" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   internal_error  An internal error unrelated to the peer or the</td><td> </td><td class="rblock">   internal_error<span class="insert">:</span>  An internal error unrelated to the peer or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      correctness of the protocol (such as a memory allocation failure)</td><td> </td><td class="right">      correctness of the protocol (such as a memory allocation failure)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      makes it impossible to continue.</td><td> </td><td class="right">      makes it impossible to continue.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0345" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   inappropriate_fallback  Sent by a server in response to an invalid</td><td> </td><td class="rblock">   inappropriate_fallback<span class="insert">:</span>  Sent by a server in response to an invalid</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      connection retry attempt from a client (see [RFC7507]).</td><td> </td><td class="right">      connection retry attempt from a client (see [RFC7507]).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0346" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">missing_extension</span>  Sent by endpoints that receive a handshake message</td><td> </td><td class="rblock">   <span class="insert">missing_extension:</span>  Sent by endpoints that receive a handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      not containing an extension that is mandatory to send for the</td><td> </td><td class="rblock">      message not containing an extension that is mandatory to send for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      offered TLS version or other negotiated parameters.</td><td> </td><td class="rblock">      the offered TLS version or other negotiated parameters.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0347" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   unsupported_extension  Sent by endpoints receiving any handshake</td><td> </td><td class="rblock">   unsupported_extension<span class="insert">:</span>  Sent by endpoints receiving any handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message containing an extension known to be prohibited for</td><td> </td><td class="right">      message containing an extension known to be prohibited for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      inclusion in the given handshake message, or including any</td><td> </td><td class="right">      inclusion in the given handshake message, or including any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extensions in a ServerHello or Certificate not first offered in</td><td> </td><td class="right">      extensions in a ServerHello or Certificate not first offered in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0348" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the corresponding ClientHello.</td><td> </td><td class="rblock">      the corresponding ClientHello<span class="insert"> or CertificateRequest</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0349" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   unrecognized_name  Sent by servers when no server exists identified</td><td> </td><td class="rblock">   unrecognized_name<span class="insert">:</span>  Sent by servers when no server exists identified</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      by the name provided by the client via the "server_name" extension</td><td> </td><td class="right">      by the name provided by the client via the "server_name" extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (see [RFC6066]).</td><td> </td><td class="right">      (see [RFC6066]).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0350" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   bad_certificate_status_response  Sent by clients when an invalid or</td><td> </td><td class="rblock">   bad_certificate_status_response<span class="insert">:</span>  Sent by clients when an invalid or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      unacceptable OCSP response is provided by the server via the</td><td> </td><td class="right">      unacceptable OCSP response is provided by the server via the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "status_request" extension (see [RFC6066]).</td><td> </td><td class="right">      "status_request" extension (see [RFC6066]).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0351" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   unknown_psk_identity  Sent by servers when PSK key establishment is</td><td> </td><td class="rblock">   unknown_psk_identity<span class="insert">:</span>  Sent by servers when PSK key establishment is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      desired but no acceptable PSK identity is provided by the client.</td><td> </td><td class="right">      desired but no acceptable PSK identity is provided by the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Sending this alert is OPTIONAL; servers MAY instead choose to send</td><td> </td><td class="right">      Sending this alert is OPTIONAL; servers MAY instead choose to send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      a "decrypt_error" alert to merely indicate an invalid PSK</td><td> </td><td class="right">      a "decrypt_error" alert to merely indicate an invalid PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      identity.</td><td> </td><td class="right">      identity.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0352" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate_required  Sent by servers when a client certificate is</td><td> </td><td class="rblock">   certificate_required<span class="insert">:</span>  Sent by servers when a client certificate is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      desired but none was provided by the client.</td><td> </td><td class="right">      desired but none was provided by the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0353" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   no_application_protocol  Sent by servers when a client</td><td> </td><td class="rblock">   no_application_protocol<span class="insert">:</span>  Sent by servers when a client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "application_layer_protocol_negotiation" extension advertises only</td><td> </td><td class="right">      "application_layer_protocol_negotiation" extension advertises only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      protocols that the server does not support (see [RFC7301]).</td><td> </td><td class="right">      protocols that the server does not support (see [RFC7301]).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New Alert values are assigned by IANA as described in Section 11.</td><td> </td><td class="right">   New Alert values are assigned by IANA as described in Section 11.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.  Cryptographic Computations</td><td> </td><td class="right">7.  Cryptographic Computations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS handshake establishes one or more input secrets which are</td><td> </td><td class="right">   The TLS handshake establishes one or more input secrets which are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   combined to create the actual working keying material, as detailed</td><td> </td><td class="right">   combined to create the actual working keying material, as detailed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   below.  The key derivation process incorporates both the input</td><td> </td><td class="right">   below.  The key derivation process incorporates both the input</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secrets and the handshake transcript.  Note that because the</td><td> </td><td class="right">   secrets and the handshake transcript.  Note that because the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake transcript includes the random values from the Hello</td><td> </td><td class="right">   handshake transcript includes the random values from the Hello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages, any given handshake will have different traffic secrets,</td><td> </td><td class="right">   messages, any given handshake will have different traffic secrets,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   even if the same input secrets are used, as is the case when the same</td><td> </td><td class="right">   even if the same input secrets are used, as is the case when the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSK is used for multiple connections.</td><td> </td><td class="right">   PSK is used for multiple connections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.1.  Key Schedule</td><td> </td><td class="right">7.1.  Key Schedule</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0354" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The key derivation process makes use of the HKDF-Extract and <span class="delete">HKDF-</span></td><td> </td><td class="rblock">   The key derivation process makes use of the HKDF-Extract and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Expand</span> functions as defined for HKDF [RFC5869], as well as the</td><td> </td><td class="rblock">   <span class="insert">HKDF-Expand</span> functions as defined for HKDF [RFC5869], as well as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   functions defined below:</td><td> </td><td class="right">   functions defined below:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       HKDF-Expand-Label(Secret, Label, Context, Length) =</td><td> </td><td class="right">       HKDF-Expand-Label(Secret, Label, Context, Length) =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            HKDF-Expand(Secret, HkdfLabel, Length)</td><td> </td><td class="right">            HKDF-Expand(Secret, HkdfLabel, Length)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Where HkdfLabel is specified as:</td><td> </td><td class="right">       Where HkdfLabel is specified as:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       struct {</td><td> </td><td class="right">       struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           uint16 length = Length;</td><td> </td><td class="right">           uint16 length = Length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           opaque label&lt;7..255&gt; = "tls13 " + Label;</td><td> </td><td class="right">           opaque label&lt;7..255&gt; = "tls13 " + Label;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l41" /><small>skipping to change at</small><em> page 94, line 26</em></th><th> </th><th><a name="part-r41" /><small>skipping to change at</small><em> page 91, line 32</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       Derive-Secret(Secret, Label, Messages) =</td><td> </td><td class="right">       Derive-Secret(Secret, Label, Messages) =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            HKDF-Expand-Label(Secret, Label,</td><td> </td><td class="right">            HKDF-Expand-Label(Secret, Label,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                              Transcript-Hash(Messages), Hash.length)</td><td> </td><td class="right">                              Transcript-Hash(Messages), Hash.length)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The Hash function used by Transcript-Hash and HKDF is the cipher</td><td> </td><td class="right">   The Hash function used by Transcript-Hash and HKDF is the cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   suite hash algorithm.  Hash.length is its output length in bytes.</td><td> </td><td class="right">   suite hash algorithm.  Hash.length is its output length in bytes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Messages is the concatenation of the indicated handshake messages,</td><td> </td><td class="right">   Messages is the concatenation of the indicated handshake messages,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   including the handshake message type and length fields, but not</td><td> </td><td class="right">   including the handshake message type and length fields, but not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   including record layer headers.  Note that in some cases a zero-</td><td> </td><td class="right">   including record layer headers.  Note that in some cases a zero-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   length Context (indicated by "") is passed to HKDF-Expand-Label.  The</td><td> </td><td class="right">   length Context (indicated by "") is passed to HKDF-Expand-Label.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0355" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Labels specified in this document are all ASCII strings,</span> and do not</td><td> </td><td class="rblock">   <span class="insert">labels specified in this document are all ASCII strings</span> and do not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   include a trailing NUL byte.</td><td> </td><td class="right">   include a trailing NUL byte.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0356" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note: <span class="delete">w</span>ith common hash functions, any label longer than 12 characters</td><td> </td><td class="rblock">   Note: <span class="insert">W</span>ith common hash functions, any label longer than 12 characters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requires an additional iteration of the hash function to compute.</td><td> </td><td class="right">   requires an additional iteration of the hash function to compute.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The labels in this specification have all been chosen to fit within</td><td> </td><td class="right">   The labels in this specification have all been chosen to fit within</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   this limit.</td><td> </td><td class="right">   this limit.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Keys are derived from two input secrets using the HKDF-Extract and</td><td> </td><td class="right">   Keys are derived from two input secrets using the HKDF-Extract and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Derive-Secret functions.  The general pattern for adding a new secret</td><td> </td><td class="right">   Derive-Secret functions.  The general pattern for adding a new secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0357" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   is to use HKDF-Extract with the <span class="delete">salt</span> being the current secret state</td><td> </td><td class="rblock">   is to use HKDF-Extract with the <span class="insert">Salt</span> being the current secret state</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and the <span class="delete">IKM</span> being the new secret to be added.  In this version of TLS</td><td> </td><td class="rblock">   and the <span class="insert">Input Keying Material (IKM)</span> being the new secret to be added.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3, the two input secrets are:</td><td> </td><td class="rblock">   In this version of TLS 1.3, the two input secrets are:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  PSK (a pre-shared key established externally or derived from the</td><td> </td><td class="right">   -  PSK (a pre-shared key established externally or derived from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      resumption_master_secret value from a previous connection)</td><td> </td><td class="right">      resumption_master_secret value from a previous connection)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  (EC)DHE shared secret (Section 7.4)</td><td> </td><td class="right">   -  (EC)DHE shared secret (Section 7.4)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This produces a full key derivation schedule shown in the diagram</td><td> </td><td class="right">   This produces a full key derivation schedule shown in the diagram</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   below.  In this diagram, the following formatting conventions apply:</td><td> </td><td class="right">   below.  In this diagram, the following formatting conventions apply:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  HKDF-Extract is drawn as taking the Salt argument from the top and</td><td> </td><td class="right">   -  HKDF-Extract is drawn as taking the Salt argument from the top and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the IKM argument from the left, with its output to the bottom and</td><td> </td><td class="right">      the IKM argument from the left, with its output to the bottom and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the name of the output on the right.</td><td> </td><td class="right">      the name of the output on the right.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Derive-Secret's Secret argument is indicated by the incoming</td><td> </td><td class="right">   -  Derive-Secret's Secret argument is indicated by the incoming</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      arrow.  For instance, the Early Secret is the Secret for</td><td> </td><td class="right">      arrow.  For instance, the Early Secret is the Secret for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      generating the client_early_traffic_secret.</td><td> </td><td class="right">      generating the client_early_traffic_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0358" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  "0" indicates a string of Hash<span class="delete">-lengths bytes set to 0</span>.</td><td> </td><td class="rblock">   -  "0" indicates a string of Hash<span class="insert">.length bytes set to zero</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0359" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 0</td><td> </td><td class="rblock">             0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 v</td><td> </td><td class="rblock">             v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSK -&gt;  HKDF-Extract = Early Secret</td><td> </td><td class="right">   PSK -&gt;  HKDF-Extract = Early Secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0360" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(.,</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "ext binder" | "res binder", "")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 <span class="delete">|</span>                     "ext binder" |</td><td> </td><td class="rblock">             |                     = binder_key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 <span class="delete">|</span>                     "res binder",</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 <span class="delete">|</span>                     "")</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "c e traffic", ClientHello)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = binder_key</td><td> </td><td class="rblock">             |                     = client_early_traffic_secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "c e traffic",</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "e exp master", ClientHello)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 <span class="delete">|</span>                     ClientHello)</td><td> </td><td class="rblock">             |                     = early_exporter_master_secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = client_early_traffic_secret</td><td> </td><td class="rblock">             v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">       Derive-Secret(., "derived", "")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "e exp master",</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 <span class="delete">|</span>                     ClientHello)</td><td> </td><td class="rblock">             v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = early_exporter_master_secret</td><td> </td><td class="rblock">   (EC)DHE -&gt; HKDF-Extract = Handshake Secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 v</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           Derive-Secret(., "derived", "")</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "c hs traffic",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             |                     ClientHello...ServerHello)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 v</td><td> </td><td class="rblock">             |                     = client_handshake_traffic_secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">(EC)DHE -&gt; HKDF-Extract = Handshake Secret</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "s hs traffic",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "c hs traffic",</td><td> </td><td class="rblock">             |                     ClientHello...ServerHello)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     ClientHello...ServerHello)</td><td> </td><td class="rblock">             |                     = server_handshake_traffic_secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = client_handshake_traffic_secret</td><td> </td><td class="rblock">             v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">       Derive-Secret(., "derived", "")</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "s hs traffic",</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     ClientHello...ServerHello)</td><td> </td><td class="rblock">             v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = server_handshake_traffic_secret</td><td> </td><td class="rblock">   0 -&gt; HKDF-Extract = Master Secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 v</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           Derive-Secret(., "derived", "")</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "c ap traffic",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             |                     ClientHello...server Finished)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 v</td><td> </td><td class="rblock">             |                     = client_application_traffic_secret_0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      0 -&gt; HKDF-Extract = Master Secret</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "s ap traffic",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "c ap traffic",</td><td> </td><td class="rblock">             |                     ClientHello...server Finished)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     ClientHello...server Finished)</td><td> </td><td class="rblock">             |                     = server_application_traffic_secret_0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = client_application_traffic_secret_0</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "exp master",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "s ap traffic",</td><td> </td><td class="rblock">             |                     ClientHello...server Finished)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     ClientHello...server Finished)</td><td> </td><td class="rblock">             |                     = exporter_master_secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = server_application_traffic_secret_0</td><td> </td><td class="rblock">             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock">             +-----&gt; Derive-Secret(., "res master",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "exp master",</td><td> </td><td class="rblock">                                   ClientHello...client Finished)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     ClientHello...server Finished)</td><td> </td><td class="rblock">                                   = resumption_master_secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |                     = exporter_master_secret</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 |</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 +-----&gt; Derive-Secret(., "res master",</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       ClientHello...client Finished)</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                       = resumption_master_secret</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The general pattern here is that the secrets shown down the left side</td><td> </td><td class="right">   The general pattern here is that the secrets shown down the left side</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the diagram are just raw entropy without context, whereas the</td><td> </td><td class="right">   of the diagram are just raw entropy without context, whereas the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0361" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   secrets down the right side include <span class="delete">handshake c</span>ontext and therefore</td><td> </td><td class="rblock">   secrets down the right side include <span class="insert">Handshake C</span>ontext and therefore</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   can be used to derive working keys without additional context.  Note</td><td> </td><td class="right">   can be used to derive working keys without additional context.  Note</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that the different calls to Derive-Secret may take different Messages</td><td> </td><td class="right">   that the different calls to Derive-Secret may take different Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0362" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   arguments, even with the same secret.  In a 0-RTT exchange, <span class="delete">Derive-</span></td><td> </td><td class="rblock">   arguments, even with the same secret.  In a 0-RTT exchange,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Secret</span> is called with four distinct transcripts; in a 1-RTT-only</td><td> </td><td class="rblock">   <span class="insert">Derive-Secret</span> is called with four distinct transcripts; in a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">exchange</span> with three distinct transcripts.</td><td> </td><td class="rblock">   1-RTT-only <span class="insert">exchange, it is called</span> with three distinct transcripts.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If a given secret is not available, then the 0-value consisting of a</td><td> </td><td class="right">   If a given secret is not available, then the 0-value consisting of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   string of Hash.length bytes set to zeros is used.  Note that this</td><td> </td><td class="right">   string of Hash.length bytes set to zeros is used.  Note that this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0363" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   does not mean skipping rounds, so if PSK is not in use Early Secret</td><td> </td><td class="rblock">   does not mean skipping rounds, so if PSK is not in use<span class="insert">,</span> Early Secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   will still be HKDF-Extract(0, 0).  For the computation of the</td><td> </td><td class="right">   will still be HKDF-Extract(0, 0).  For the computation of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0364" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   binder_<span class="delete">secret</span>, the label is "ext binder" for external PSKs (those</td><td> </td><td class="rblock">   binder_<span class="insert">key</span>, the label is "ext binder" for external PSKs (those</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provisioned outside of TLS) and "res binder" for resumption PSKs</td><td> </td><td class="right">   provisioned outside of TLS) and "res binder" for resumption PSKs</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (those provisioned as the resumption master secret of a previous</td><td> </td><td class="right">   (those provisioned as the resumption master secret of a previous</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake).  The different labels prevent the substitution of one</td><td> </td><td class="right">   handshake).  The different labels prevent the substitution of one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   type of PSK for the other.</td><td> </td><td class="right">   type of PSK for the other.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0365" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   There are multiple potential Early Secret values depending on which</td><td> </td><td class="rblock">   There are multiple potential Early Secret values<span class="insert">,</span> depending on which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PSK the server ultimately selects.  The client will need to compute</td><td> </td><td class="right">   PSK the server ultimately selects.  The client will need to compute</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   one for each potential PSK; if no PSK is selected, it will then need</td><td> </td><td class="right">   one for each potential PSK; if no PSK is selected, it will then need</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0366" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   to compute the <span class="delete">early s</span>ecret corresponding to the zero PSK.</td><td> </td><td class="rblock">   to compute the <span class="insert">Early S</span>ecret corresponding to the zero PSK.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once all the values which are to be derived from a given secret have</td><td> </td><td class="right">   Once all the values which are to be derived from a given secret have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   been computed, that secret SHOULD be erased.</td><td> </td><td class="right">   been computed, that secret SHOULD be erased.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.2.  Updating Traffic Secrets</td><td> </td><td class="right">7.2.  Updating Traffic Secrets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the handshake is complete, it is possible for either side to</td><td> </td><td class="right">   Once the handshake is complete, it is possible for either side to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   update its sending traffic keys using the KeyUpdate handshake message</td><td> </td><td class="right">   update its sending traffic keys using the KeyUpdate handshake message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   defined in Section 4.6.3.  The next generation of traffic keys is</td><td> </td><td class="right">   defined in Section 4.6.3.  The next generation of traffic keys is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   computed by generating client_/server_application_traffic_secret_N+1</td><td> </td><td class="right">   computed by generating client_/server_application_traffic_secret_N+1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   from client_/server_application_traffic_secret_N as described in this</td><td> </td><td class="right">   from client_/server_application_traffic_secret_N as described in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0367" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   section then re-deriving the traffic keys as described in</td><td> </td><td class="rblock">   section <span class="insert">and </span>then re-deriving the traffic keys as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 7.3.</td><td> </td><td class="right">   Section 7.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The next-generation application_traffic_secret is computed as:</td><td> </td><td class="right">   The next-generation application_traffic_secret is computed as:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       application_traffic_secret_N+1 =</td><td> </td><td class="right">       application_traffic_secret_N+1 =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           HKDF-Expand-Label(application_traffic_secret_N,</td><td> </td><td class="right">           HKDF-Expand-Label(application_traffic_secret_N,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             "traffic upd", "", Hash.length)</td><td> </td><td class="right">                             "traffic upd", "", Hash.length)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0368" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Once client/server_application_traffic_secret_N+1 and its associated</td><td> </td><td class="rblock">   Once client<span class="insert">_</span>/server_application_traffic_secret_N+1 and its associated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic keys have been computed, implementations SHOULD delete</td><td> </td><td class="right">   traffic keys have been computed, implementations SHOULD delete</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client_/server_application_traffic_secret_N and its associated</td><td> </td><td class="right">   client_/server_application_traffic_secret_N and its associated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic keys.</td><td> </td><td class="right">   traffic keys.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.3.  Traffic Key Calculation</td><td> </td><td class="right">7.3.  Traffic Key Calculation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The traffic keying material is generated from the following input</td><td> </td><td class="right">   The traffic keying material is generated from the following input</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   values:</td><td> </td><td class="right">   values:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A secret value</td><td> </td><td class="right">   -  A secret value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A purpose value indicating the specific value being generated</td><td> </td><td class="right">   -  A purpose value indicating the specific value being generated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The length of the key being generated</td><td> </td><td class="right">   -  The length of the key being generated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The traffic keying material is generated from an input traffic secret</td><td> </td><td class="right">   The traffic keying material is generated from an input traffic secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   value using:</td><td> </td><td class="right">   value using:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0369" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    [sender]_write_key = HKDF-Expand-Label(Secret, "key", "", key_length)</td><td> </td><td class="rblock">   [sender]_write_key = HKDF-Expand-Label(Secret, "key", "", key_length)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    [sender]_write_iv  = HKDF-Expand-Label(Secret, <span class="delete">"iv" ,</span> "", iv_length)</td><td> </td><td class="rblock">   [sender]_write_iv  = HKDF-Expand-Label(Secret, <span class="insert">"iv",</span> "", iv_length)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0370" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [sender] denotes the sending side.  The <span class="delete">Secret</span> value for each record</td><td> </td><td class="rblock">   [sender] denotes the sending side.  The value <span class="insert">of Secret</span> for each</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   type is shown in the table below.</td><td> </td><td class="rblock">   record type is shown in the table below.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       +-------------------+---------------------------------------+</td><td> </td><td class="right">       +-------------------+---------------------------------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       | Record Type       | Secret                                |</td><td> </td><td class="right">       | Record Type       | Secret                                |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       +-------------------+---------------------------------------+</td><td> </td><td class="right">       +-------------------+---------------------------------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       | 0-RTT Application | client_early_traffic_secret           |</td><td> </td><td class="right">       | 0-RTT Application | client_early_traffic_secret           |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       |                   |                                       |</td><td> </td><td class="right">       |                   |                                       |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       | Handshake         | [sender]_handshake_traffic_secret     |</td><td> </td><td class="right">       | Handshake         | [sender]_handshake_traffic_secret     |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       |                   |                                       |</td><td> </td><td class="right">       |                   |                                       |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       | Application Data  | [sender]_application_traffic_secret_N |</td><td> </td><td class="right">       | Application Data  | [sender]_application_traffic_secret_N |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       +-------------------+---------------------------------------+</td><td> </td><td class="right">       +-------------------+---------------------------------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All the traffic keying material is recomputed whenever the underlying</td><td> </td><td class="right">   All the traffic keying material is recomputed whenever the underlying</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0371" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Secret changes (e.g., when changing from the handshake to <span class="delete">application</span></td><td> </td><td class="rblock">   Secret changes (e.g., when changing from the handshake to <span class="insert">Application</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   data</span> keys or upon a key update).</td><td> </td><td class="rblock"><span class="insert">   Data</span> keys or upon a key update).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.4.  (EC)DHE Shared Secret Calculation</td><td> </td><td class="right">7.4.  (EC)DHE Shared Secret Calculation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.4.1.  Finite Field Diffie-Hellman</td><td> </td><td class="right">7.4.1.  Finite Field Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For finite field groups, a conventional Diffie-Hellman [DH76]</td><td> </td><td class="right">   For finite field groups, a conventional Diffie-Hellman [DH76]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   computation is performed.  The negotiated key (Z) is converted to a</td><td> </td><td class="right">   computation is performed.  The negotiated key (Z) is converted to a</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0372" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   byte string by encoding in big-endian and <span class="delete">left padded</span> with zeros up</td><td> </td><td class="rblock">   byte string by encoding in big-endian <span class="insert">form</span> and <span class="insert">left-padded</span> with zeros</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   to the size of the prime.  This byte string is used as the shared</td><td> </td><td class="rblock">   up to the size of the prime.  This byte string is used as the shared</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secret in the key schedule as specified above.</td><td> </td><td class="right">   secret in the key schedule as specified above.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that this construction differs from previous versions of TLS</td><td> </td><td class="right">   Note that this construction differs from previous versions of TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0373" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   which remove leading zeros.</td><td> </td><td class="rblock">   which remove<span class="insert">d</span> leading zeros.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.4.2.  Elliptic Curve Diffie-Hellman</td><td> </td><td class="right">7.4.2.  Elliptic Curve Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0374" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   For secp256r1, secp384r1 and secp521r1, ECDH calculations (including</td><td> </td><td class="rblock">   For secp256r1, secp384r1<span class="insert">,</span> and secp521r1, ECDH calculations (including</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parameter and key generation as well as the shared secret</td><td> </td><td class="right">   parameter and key generation as well as the shared secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0375" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   calculation) are performed according to [IEEE1363] using the <span class="delete">ECKAS-</span></td><td> </td><td class="rblock">   calculation) are performed according to [IEEE1363] using the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   DH1</span> scheme with the identity map as key derivation function (KDF), so</td><td> </td><td class="rblock">   <span class="insert">ECKAS-DH1</span> scheme with the identity map as <span class="insert">the</span> key derivation function</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that the shared secret is the x-coordinate of the ECDH shared secret</td><td> </td><td class="rblock">   (KDF), so that the shared secret is the x-coordinate of the ECDH</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   elliptic curve point represented as an octet string.  Note that this</td><td> </td><td class="rblock">   shared secret elliptic curve point represented as an octet string.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   octet string <span class="delete">(Z</span> in IEEE 1363 terminology) as output by <span class="delete">FE2OSP, the</span></td><td> </td><td class="rblock">   Note that this octet string <span class="insert">("Z"</span> in IEEE 1363 terminology) as output</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Field Element to Octet String Conversion <span class="delete">Primitive,</span> has constant</td><td> </td><td class="rblock">   by <span class="insert">FE2OSP (the</span> Field Element to Octet String Conversion <span class="insert">Primitive)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   length for any given field; leading zeros found in this octet string</td><td> </td><td class="rblock">   has constant length for any given field; leading zeros found in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   MUST NOT be truncated.</td><td> </td><td class="rblock">   octet string MUST NOT be truncated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (Note that this use of the identity KDF is a technicality.  The</td><td> </td><td class="right">   (Note that this use of the identity KDF is a technicality.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   complete picture is that ECDH is employed with a non-trivial KDF</td><td> </td><td class="right">   complete picture is that ECDH is employed with a non-trivial KDF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   because TLS does not directly use this secret for anything other than</td><td> </td><td class="right">   because TLS does not directly use this secret for anything other than</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for computing other secrets.)</td><td> </td><td class="right">   for computing other secrets.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0376" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">ECDH functions are used</span> as follows:</td><td> </td><td class="rblock">   <span class="insert">For X25519 and X448, the ECDH calculations are</span> as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The public key to put into the KeyShareEntry.key_exchange</td><td> </td><td class="right">   -  The public key to put into the KeyShareEntry.key_exchange</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      structure is the result of applying the ECDH scalar multiplication</td><td> </td><td class="right">      structure is the result of applying the ECDH scalar multiplication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      function to the secret key of appropriate length (into scalar</td><td> </td><td class="right">      function to the secret key of appropriate length (into scalar</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      input) and the standard public basepoint (into u-coordinate point</td><td> </td><td class="right">      input) and the standard public basepoint (into u-coordinate point</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      input).</td><td> </td><td class="right">      input).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The ECDH shared secret is the result of applying the ECDH scalar</td><td> </td><td class="right">   -  The ECDH shared secret is the result of applying the ECDH scalar</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      multiplication function to the secret key (into scalar input) and</td><td> </td><td class="right">      multiplication function to the secret key (into scalar input) and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the peer's public key (into u-coordinate point input).  The output</td><td> </td><td class="right">      the peer's public key (into u-coordinate point input).  The output</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is used raw, with no processing.</td><td> </td><td class="right">      is used raw, with no processing.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0377" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   For <span class="delete">X25519 and X448,</span> implementations SHOULD use the approach</td><td> </td><td class="rblock">   For <span class="insert">these curves,</span> implementations SHOULD use the approach specified</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   specified in [RFC7748] to calculate the Diffie-Hellman shared secret.</td><td> </td><td class="rblock">   in [RFC7748] to calculate the Diffie-Hellman shared secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST check whether the computed Diffie-Hellman shared</td><td> </td><td class="right">   Implementations MUST check whether the computed Diffie-Hellman shared</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secret is the all-zero value and abort if so, as described in</td><td> </td><td class="right">   secret is the all-zero value and abort if so, as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 6 of [RFC7748].  If implementors use an alternative</td><td> </td><td class="right">   Section 6 of [RFC7748].  If implementors use an alternative</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementation of these elliptic curves, they SHOULD perform the</td><td> </td><td class="right">   implementation of these elliptic curves, they SHOULD perform the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   additional checks specified in Section 7 of [RFC7748].</td><td> </td><td class="right">   additional checks specified in Section 7 of [RFC7748].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.5.  Exporters</td><td> </td><td class="right">7.5.  Exporters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5705] defines keying material exporters for TLS in terms of the</td><td> </td><td class="right">   [RFC5705] defines keying material exporters for TLS in terms of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS pseudorandom function (PRF).  This document replaces the PRF with</td><td> </td><td class="right">   TLS pseudorandom function (PRF).  This document replaces the PRF with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l42" /><small>skipping to change at</small><em> page 99, line 30</em></th><th> </th><th><a name="part-r42" /><small>skipping to change at</small><em> page 97, line 27</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Where Secret is either the early_exporter_master_secret or the</td><td> </td><td class="right">   Where Secret is either the early_exporter_master_secret or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exporter_master_secret.  Implementations MUST use the</td><td> </td><td class="right">   exporter_master_secret.  Implementations MUST use the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exporter_master_secret unless explicitly specified by the</td><td> </td><td class="right">   exporter_master_secret unless explicitly specified by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application.  The early_exporter_master_secret is defined for use in</td><td> </td><td class="right">   application.  The early_exporter_master_secret is defined for use in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   settings where an exporter is needed for 0-RTT data.  A separate</td><td> </td><td class="right">   settings where an exporter is needed for 0-RTT data.  A separate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   interface for the early exporter is RECOMMENDED; this avoids the</td><td> </td><td class="right">   interface for the early exporter is RECOMMENDED; this avoids the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exporter user accidentally using an early exporter when a regular one</td><td> </td><td class="right">   exporter user accidentally using an early exporter when a regular one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is desired or vice versa.</td><td> </td><td class="right">   is desired or vice versa.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0378" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If no context is provided, the context_value is zero<span class="delete">-</span>length.</td><td> </td><td class="rblock">   If no context is provided, the context_value is zero<span class="insert"> </span>length.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Consequently, providing no context computes the same value as</td><td> </td><td class="right">   Consequently, providing no context computes the same value as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   providing an empty context.  This is a change from previous versions</td><td> </td><td class="right">   providing an empty context.  This is a change from previous versions</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0379" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   of TLS where an empty context produced a different output t<span class="delete">o</span> an</td><td> </td><td class="rblock">   of TLS where an empty context produced a different output t<span class="insert">han</span> an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   absent context.  As of this document's publication, no allocated</td><td> </td><td class="right">   absent context.  As of this document's publication, no allocated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exporter label is used both with and without a context.  Future</td><td> </td><td class="right">   exporter label is used both with and without a context.  Future</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specifications MUST NOT define a use of exporters that permit both an</td><td> </td><td class="right">   specifications MUST NOT define a use of exporters that permit both an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   empty context and no context with the same label.  New uses of</td><td> </td><td class="right">   empty context and no context with the same label.  New uses of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exporters SHOULD provide a context in all exporter computations,</td><td> </td><td class="right">   exporters SHOULD provide a context in all exporter computations,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   though the value could be empty.</td><td> </td><td class="right">   though the value could be empty.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0380" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Requirements for the format of exporter labels are defined in <span class="delete">section</span></td><td> </td><td class="rblock">   Requirements for the format of exporter labels are defined in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   4 of [RFC5705].</td><td> </td><td class="rblock">   <span class="insert">Section</span> 4 of [RFC5705].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.  0-RTT and Anti-Replay</td><td> </td><td class="right">8.  0-RTT and Anti-Replay</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As noted in Section 2.3 and Appendix E.5, TLS does not provide</td><td> </td><td class="right">   As noted in Section 2.3 and Appendix E.5, TLS does not provide</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   inherent replay protections for 0-RTT data.  There are two potential</td><td> </td><td class="right">   inherent replay protections for 0-RTT data.  There are two potential</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   threats to be concerned with:</td><td> </td><td class="right">   threats to be concerned with:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Network attackers who mount a replay attack by simply duplicating</td><td> </td><td class="right">   -  Network attackers who mount a replay attack by simply duplicating</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      a flight of 0-RTT data.</td><td> </td><td class="right">      a flight of 0-RTT data.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l43" /><small>skipping to change at</small><em> page 100, line 23</em></th><th> </th><th><a name="part-r43" /><small>skipping to change at</small><em> page 98, line 32</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      zone B, then an attacker can duplicate a ClientHello and early</td><td> </td><td class="right">      zone B, then an attacker can duplicate a ClientHello and early</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      data intended for A to both A and B.  At A, the data will be</td><td> </td><td class="right">      data intended for A to both A and B.  At A, the data will be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      accepted in 0-RTT, but at B the server will reject 0-RTT data and</td><td> </td><td class="right">      accepted in 0-RTT, but at B the server will reject 0-RTT data and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      instead force a full handshake.  If the attacker blocks the</td><td> </td><td class="right">      instead force a full handshake.  If the attacker blocks the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ServerHello from A, then the client will complete the handshake</td><td> </td><td class="right">      ServerHello from A, then the client will complete the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      with B and probably retry the request, leading to duplication on</td><td> </td><td class="right">      with B and probably retry the request, leading to duplication on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the server system as a whole.</td><td> </td><td class="right">      the server system as a whole.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The first class of attack can be prevented by sharing state to</td><td> </td><td class="right">   The first class of attack can be prevented by sharing state to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   guarantee that the 0-RTT data is accepted at most once.  Servers</td><td> </td><td class="right">   guarantee that the 0-RTT data is accepted at most once.  Servers</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0381" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   SHOULD provide that level of replay <span class="delete">safety,</span> by implementing one of</td><td> </td><td class="rblock">   SHOULD provide that level of replay <span class="insert">safety</span> by implementing one of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the methods described in this section or by equivalent means.  It is</td><td> </td><td class="rblock">   methods described in this section or by equivalent means.  It is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   understood, however, that due to operational concerns not all</td><td> </td><td class="right">   understood, however, that due to operational concerns not all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   deployments will maintain state at that level.  Therefore, in normal</td><td> </td><td class="right">   deployments will maintain state at that level.  Therefore, in normal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   operation, clients will not know which, if any, of these mechanisms</td><td> </td><td class="right">   operation, clients will not know which, if any, of these mechanisms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   servers actually implement and hence MUST only send early data which</td><td> </td><td class="right">   servers actually implement and hence MUST only send early data which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   they deem safe to be replayed.</td><td> </td><td class="right">   they deem safe to be replayed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In addition to the direct effects of replays, there is a class of</td><td> </td><td class="right">   In addition to the direct effects of replays, there is a class of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attacks where even operations normally considered idempotent could be</td><td> </td><td class="right">   attacks where even operations normally considered idempotent could be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exploited by a large number of replays (timing attacks, resource</td><td> </td><td class="right">   exploited by a large number of replays (timing attacks, resource</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0382" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   limit exhaustion and <span class="delete">others</span> described in Appendix E.5).  Those can be</td><td> </td><td class="rblock">   limit exhaustion and <span class="insert">others, as</span> described in Appendix E.5).  Those</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   mitigated by ensuring that every 0-RTT payload can be replayed only a</td><td> </td><td class="rblock">   can be mitigated by ensuring that every 0-RTT payload can be replayed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   limited number of times.  The server MUST ensure that any instance of</td><td> </td><td class="rblock">   only a limited number of times.  The server MUST ensure that any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   it (be it a machine, a <span class="delete">thread</span> or any other entity within the relevant</td><td> </td><td class="rblock">   instance of it (be it a machine, a <span class="insert">thread,</span> or any other entity within</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   serving infrastructure) would accept 0-RTT for the same 0-RTT</td><td> </td><td class="rblock">   the relevant serving infrastructure) would accept 0-RTT for the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake at most once; this limits the number of replays to the</td><td> </td><td class="rblock">   0-RTT handshake at most once; this limits the number of replays to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   number of server instances in the deployment.  Such a guarantee can</td><td> </td><td class="rblock">   the number of server instances in the deployment.  Such a guarantee</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   be accomplished by locally recording data from <span class="delete">recently-received</span></td><td> </td><td class="rblock">   can be accomplished by locally recording data from <span class="insert">recently received</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHellos and rejecting repeats, or by any other method that</td><td> </td><td class="right">   ClientHellos and rejecting repeats, or by any other method that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provides the same or a stronger guarantee.  The "at most once per</td><td> </td><td class="right">   provides the same or a stronger guarantee.  The "at most once per</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server instance" guarantee is a minimum requirement; servers SHOULD</td><td> </td><td class="right">   server instance" guarantee is a minimum requirement; servers SHOULD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   limit 0-RTT replays further when feasible.</td><td> </td><td class="right">   limit 0-RTT replays further when feasible.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The second class of attack cannot be prevented at the TLS layer and</td><td> </td><td class="right">   The second class of attack cannot be prevented at the TLS layer and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST be dealt with by any application.  Note that any application</td><td> </td><td class="right">   MUST be dealt with by any application.  Note that any application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   whose clients implement any kind of retry behavior already needs to</td><td> </td><td class="right">   whose clients implement any kind of retry behavior already needs to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implement some sort of anti-replay defense.</td><td> </td><td class="right">   implement some sort of anti-replay defense.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.1.  Single-Use Tickets</td><td> </td><td class="right">8.1.  Single-Use Tickets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The simplest form of anti-replay defense is for the server to only</td><td> </td><td class="right">   The simplest form of anti-replay defense is for the server to only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   allow each session ticket to be used once.  For instance, the server</td><td> </td><td class="right">   allow each session ticket to be used once.  For instance, the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0383" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   can maintain a database of all outstanding valid tickets<span class="delete">;</span> deleting</td><td> </td><td class="rblock">   can maintain a database of all outstanding valid tickets<span class="insert">,</span> deleting</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   each ticket from the database as it is used.  If an unknown ticket is</td><td> </td><td class="right">   each ticket from the database as it is used.  If an unknown ticket is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provided, the server would then fall back to a full handshake.</td><td> </td><td class="right">   provided, the server would then fall back to a full handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the tickets are not self-contained but rather are database keys,</td><td> </td><td class="right">   If the tickets are not self-contained but rather are database keys,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and the corresponding PSKs are deleted upon use, then connections</td><td> </td><td class="right">   and the corresponding PSKs are deleted upon use, then connections</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   established using PSKs enjoy forward secrecy.  This improves security</td><td> </td><td class="right">   established using PSKs enjoy forward secrecy.  This improves security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for all 0-RTT data and PSK usage when PSK is used without (EC)DHE.</td><td> </td><td class="right">   for all 0-RTT data and PSK usage when PSK is used without (EC)DHE.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Because this mechanism requires sharing the session database between</td><td> </td><td class="right">   Because this mechanism requires sharing the session database between</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server nodes in environments with multiple distributed servers, it</td><td> </td><td class="right">   server nodes in environments with multiple distributed servers, it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l44" /><small>skipping to change at</small><em> page 101, line 38</em></th><th> </th><th><a name="part-r44" /><small>skipping to change at</small><em> page 99, line 46</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An alternative form of anti-replay is to record a unique value</td><td> </td><td class="right">   An alternative form of anti-replay is to record a unique value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   derived from the ClientHello (generally either the random value or</td><td> </td><td class="right">   derived from the ClientHello (generally either the random value or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the PSK binder) and reject duplicates.  Recording all ClientHellos</td><td> </td><td class="right">   the PSK binder) and reject duplicates.  Recording all ClientHellos</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   causes state to grow without bound, but a server can instead record</td><td> </td><td class="right">   causes state to grow without bound, but a server can instead record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHellos within a given time window and use the</td><td> </td><td class="right">   ClientHellos within a given time window and use the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "obfuscated_ticket_age" to ensure that tickets aren't reused outside</td><td> </td><td class="right">   "obfuscated_ticket_age" to ensure that tickets aren't reused outside</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that window.</td><td> </td><td class="right">   that window.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to implement this, when a ClientHello is received, the</td><td> </td><td class="right">   In order to implement this, when a ClientHello is received, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0384" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server first verifies the PSK binder as described Section 4.2.11.  It</td><td> </td><td class="rblock">   server first verifies the PSK binder as described <span class="insert">in</span> Section 4.2.11.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   then computes the expected_arrival_time as described in the next</td><td> </td><td class="rblock">   It then computes the expected_arrival_time as described in the next</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   section and rejects 0-RTT if it is outside the recording window,</td><td> </td><td class="right">   section and rejects 0-RTT if it is outside the recording window,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   falling back to the 1-RTT handshake.</td><td> </td><td class="right">   falling back to the 1-RTT handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0385" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If the expected<span class="delete"> arrival </span>time is in the window, then the server checks</td><td> </td><td class="rblock">   If the expected<span class="insert">_arrival_</span>time is in the window, then the server checks</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to see if it has recorded a matching ClientHello.  If one is found,</td><td> </td><td class="right">   to see if it has recorded a matching ClientHello.  If one is found,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it either aborts the handshake with an "illegal_parameter" alert or</td><td> </td><td class="right">   it either aborts the handshake with an "illegal_parameter" alert or</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0386" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   accepts the PSK but reject 0-RTT.  If no matching ClientHello is</td><td> </td><td class="rblock">   accepts the PSK but reject<span class="insert">s</span> 0-RTT.  If no matching ClientHello is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   found, then it accepts 0-RTT and then stores the ClientHello for as</td><td> </td><td class="right">   found, then it accepts 0-RTT and then stores the ClientHello for as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   long as the expected_arrival_time is inside the window.  Servers MAY</td><td> </td><td class="right">   long as the expected_arrival_time is inside the window.  Servers MAY</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   also implement data stores with false positives, such as Bloom</td><td> </td><td class="right">   also implement data stores with false positives, such as Bloom</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   filters, in which case they MUST respond to apparent replay by</td><td> </td><td class="right">   filters, in which case they MUST respond to apparent replay by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   rejecting 0-RTT but MUST NOT abort the handshake.</td><td> </td><td class="right">   rejecting 0-RTT but MUST NOT abort the handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server MUST derive the storage key only from validated sections</td><td> </td><td class="right">   The server MUST derive the storage key only from validated sections</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the ClientHello.  If the ClientHello contains multiple PSK</td><td> </td><td class="right">   of the ClientHello.  If the ClientHello contains multiple PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   identities, then an attacker can create multiple ClientHellos with</td><td> </td><td class="right">   identities, then an attacker can create multiple ClientHellos with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   different binder values for the less-preferred identity on the</td><td> </td><td class="right">   different binder values for the less-preferred identity on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0387" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   assumption that the server will not verify <span class="delete">it, as</span> recommended by</td><td> </td><td class="rblock">   assumption that the server will not verify <span class="insert">it (as</span> recommended by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Section <span class="delete">4.2.11.</span>  I.e., if the client sends PSKs A and B but the</td><td> </td><td class="rblock">   Section <span class="insert">4.2.11).</span>  I.e., if the client sends PSKs A and B but the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server prefers A, then the attacker can change the binder for B</td><td> </td><td class="right">   server prefers A, then the attacker can change the binder for B</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   without affecting the binder for A.  If the binder for B is part of</td><td> </td><td class="right">   without affecting the binder for A.  If the binder for B is part of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the storage key, then this ClientHello will not appear as a</td><td> </td><td class="right">   the storage key, then this ClientHello will not appear as a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   duplicate, which will cause the ClientHello to be accepted, and may</td><td> </td><td class="right">   duplicate, which will cause the ClientHello to be accepted, and may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cause side effects such as replay cache pollution, although any 0-RTT</td><td> </td><td class="right">   cause side effects such as replay cache pollution, although any 0-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   data will not be decryptable because it will use different keys.  If</td><td> </td><td class="right">   data will not be decryptable because it will use different keys.  If</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0388" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the validated binder or the ClientHello.random <span class="delete">are</span> used as the</td><td> </td><td class="rblock">   the validated binder or the ClientHello.random <span class="insert">is</span> used as the storage</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   storage key, then this attack is not possible.</td><td> </td><td class="rblock">   key, then this attack is not possible.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Because this mechanism does not require storing all outstanding</td><td> </td><td class="right">   Because this mechanism does not require storing all outstanding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   tickets, it may be easier to implement in distributed systems with</td><td> </td><td class="right">   tickets, it may be easier to implement in distributed systems with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   high rates of resumption and 0-RTT, at the cost of potentially weaker</td><td> </td><td class="right">   high rates of resumption and 0-RTT, at the cost of potentially weaker</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   anti-replay defense because of the difficulty of reliably storing and</td><td> </td><td class="right">   anti-replay defense because of the difficulty of reliably storing and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   retrieving the received ClientHello messages.  In many such systems,</td><td> </td><td class="right">   retrieving the received ClientHello messages.  In many such systems,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it is impractical to have globally consistent storage of all the</td><td> </td><td class="right">   it is impractical to have globally consistent storage of all the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   received ClientHellos.  In this case, the best anti-replay protection</td><td> </td><td class="right">   received ClientHellos.  In this case, the best anti-replay protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is provided by having a single storage zone be authoritative for a</td><td> </td><td class="right">   is provided by having a single storage zone be authoritative for a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   given ticket and refusing 0-RTT for that ticket in any other zone.</td><td> </td><td class="right">   given ticket and refusing 0-RTT for that ticket in any other zone.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l45" /><small>skipping to change at</small><em> page 102, line 40</em></th><th> </th><th><a name="part-r45" /><small>skipping to change at</small><em> page 101, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   zone will accept 0-RTT data.  A weaker design is to implement</td><td> </td><td class="right">   zone will accept 0-RTT data.  A weaker design is to implement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   separate storage for each zone but allow 0-RTT in any zone.  This</td><td> </td><td class="right">   separate storage for each zone but allow 0-RTT in any zone.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   approach limits the number of replays to once per zone.  Application</td><td> </td><td class="right">   approach limits the number of replays to once per zone.  Application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message duplication of course remains possible with either design.</td><td> </td><td class="right">   message duplication of course remains possible with either design.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When implementations are freshly started, they SHOULD reject 0-RTT as</td><td> </td><td class="right">   When implementations are freshly started, they SHOULD reject 0-RTT as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   long as any portion of their recording window overlaps the startup</td><td> </td><td class="right">   long as any portion of their recording window overlaps the startup</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   time.  Otherwise, they run the risk of accepting replays which were</td><td> </td><td class="right">   time.  Otherwise, they run the risk of accepting replays which were</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   originally sent during that period.</td><td> </td><td class="right">   originally sent during that period.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0389" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note: If the client's clock is running much faster than the server's</td><td> </td><td class="rblock">   Note: If the client's clock is running much faster than the server's<span class="insert">,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   then a ClientHello may be received that is outside the window in the</td><td> </td><td class="right">   then a ClientHello may be received that is outside the window in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   future, in which case it might be accepted for 1-RTT, causing a</td><td> </td><td class="right">   future, in which case it might be accepted for 1-RTT, causing a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client retry, and then acceptable later for 0-RTT.  This is another</td><td> </td><td class="right">   client retry, and then acceptable later for 0-RTT.  This is another</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0390" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   variant of the second form of attack described <span class="delete">above</span>.</td><td> </td><td class="rblock">   variant of the second form of attack described <span class="insert">in Section 8</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.3.  Freshness Checks</td><td> </td><td class="right">8.3.  Freshness Checks</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Because the ClientHello indicates the time at which the client sent</td><td> </td><td class="right">   Because the ClientHello indicates the time at which the client sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it, it is possible to efficiently determine whether a ClientHello was</td><td> </td><td class="right">   it, it is possible to efficiently determine whether a ClientHello was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   likely sent reasonably recently and only accept 0-RTT for such a</td><td> </td><td class="right">   likely sent reasonably recently and only accept 0-RTT for such a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello, otherwise falling back to a 1-RTT handshake.  This is</td><td> </td><td class="right">   ClientHello, otherwise falling back to a 1-RTT handshake.  This is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   necessary for the ClientHello storage mechanism described in</td><td> </td><td class="right">   necessary for the ClientHello storage mechanism described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 8.2 because otherwise the server needs to store an unlimited</td><td> </td><td class="right">   Section 8.2 because otherwise the server needs to store an unlimited</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0391" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   number of ClientHellos and is a useful optimization for self-</td><td> </td><td class="rblock">   number of ClientHellos<span class="insert">,</span> and is a useful optimization for self-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   contained single-use tickets because it allows efficient rejection of</td><td> </td><td class="right">   contained single-use tickets because it allows efficient rejection of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHellos which cannot be used for 0-RTT.</td><td> </td><td class="right">   ClientHellos which cannot be used for 0-RTT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to implement this mechanism, a server needs to store the</td><td> </td><td class="right">   In order to implement this mechanism, a server needs to store the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   time that the server generated the session ticket, offset by an</td><td> </td><td class="right">   time that the server generated the session ticket, offset by an</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0392" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   estimate of the round<span class="delete"> </span>trip time between client and server.  I.e.,</td><td> </td><td class="rblock">   estimate of the round<span class="insert">-</span>trip time between client and server.  I.e.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       adjusted_creation_time = creation_time + estimated_RTT</td><td> </td><td class="right">       adjusted_creation_time = creation_time + estimated_RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This value can be encoded in the ticket, thus avoiding the need to</td><td> </td><td class="right">   This value can be encoded in the ticket, thus avoiding the need to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   keep state for each outstanding ticket.  The server can determine the</td><td> </td><td class="right">   keep state for each outstanding ticket.  The server can determine the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client's view of the age of the ticket by subtracting the ticket's</td><td> </td><td class="right">   client's view of the age of the ticket by subtracting the ticket's</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0393" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "ticket_age_add<span class="delete"> value"</span> from the "obfuscated_ticket_age" parameter in</td><td> </td><td class="rblock">   "ticket_age_add<span class="insert">" value</span> from the "obfuscated_ticket_age" parameter in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client's "pre_shared_key" extension.  The server can determine</td><td> </td><td class="right">   the client's "pre_shared_key" extension.  The server can determine</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0394" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the <span class="delete">"expected arrival time"</span> of the ClientHello as:</td><td> </td><td class="rblock">   the <span class="insert">expected_arrival_time</span> of the ClientHello as:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     expected_arrival_time = adjusted_creation_time + clients_ticket_age</td><td> </td><td class="right">     expected_arrival_time = adjusted_creation_time + clients_ticket_age</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When a new ClientHello is received, the expected_arrival_time is then</td><td> </td><td class="right">   When a new ClientHello is received, the expected_arrival_time is then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compared against the current server wall clock time and if they</td><td> </td><td class="right">   compared against the current server wall clock time and if they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   differ by more than a certain amount, 0-RTT is rejected, though the</td><td> </td><td class="right">   differ by more than a certain amount, 0-RTT is rejected, though the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   1-RTT handshake can be allowed to complete.</td><td> </td><td class="right">   1-RTT handshake can be allowed to complete.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   There are several potential sources of error that might cause</td><td> </td><td class="right">   There are several potential sources of error that might cause</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0395" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   mismatches between the expected<span class="delete"> arrival </span>time and the measured time.</td><td> </td><td class="rblock">   mismatches between the expected<span class="insert">_arrival_</span>time and the measured time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Variations in client and server clock rates are likely to be minimal,</td><td> </td><td class="right">   Variations in client and server clock rates are likely to be minimal,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   though potentially the absolute times may be off by large values.</td><td> </td><td class="right">   though potentially the absolute times may be off by large values.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Network propagation delays are the most likely causes of a mismatch</td><td> </td><td class="right">   Network propagation delays are the most likely causes of a mismatch</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in legitimate values for elapsed time.  Both the NewSessionTicket and</td><td> </td><td class="right">   in legitimate values for elapsed time.  Both the NewSessionTicket and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello messages might be retransmitted and therefore delayed,</td><td> </td><td class="right">   ClientHello messages might be retransmitted and therefore delayed,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which might be hidden by TCP.  For clients on the Internet, this</td><td> </td><td class="right">   which might be hidden by TCP.  For clients on the Internet, this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implies windows on the order of ten seconds to account for errors in</td><td> </td><td class="right">   implies windows on the order of ten seconds to account for errors in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   clocks and variations in measurements; other deployment scenarios may</td><td> </td><td class="right">   clocks and variations in measurements; other deployment scenarios may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   have different needs.  Clock skew distributions are not symmetric, so</td><td> </td><td class="right">   have different needs.  Clock skew distributions are not symmetric, so</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the optimal tradeoff may involve an asymmetric range of permissible</td><td> </td><td class="right">   the optimal tradeoff may involve an asymmetric range of permissible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mismatch values.</td><td> </td><td class="right">   mismatch values.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that freshness checking alone is not sufficient to prevent</td><td> </td><td class="right">   Note that freshness checking alone is not sufficient to prevent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   replays because it does not detect them during the error window,</td><td> </td><td class="right">   replays because it does not detect them during the error window,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0396" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   which<span class="delete">, depending on bandwidth and system capacity</span> could include</td><td> </td><td class="rblock">   which<span class="insert"> -- depending on bandwidth and system capacity --</span> could include</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   billions of replays in real-world settings.  In addition, this</td><td> </td><td class="right">   billions of replays in real-world settings.  In addition, this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   freshness checking is only done at the time the ClientHello is</td><td> </td><td class="right">   freshness checking is only done at the time the ClientHello is</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0397" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   received<span class="delete">, and not when later early application d</span>ata records are</td><td> </td><td class="rblock">   received<span class="insert"> and not when subsequent early Application D</span>ata records are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   received.  After early data is accepted, records may continue to be</td><td> </td><td class="right">   received.  After early data is accepted, records may continue to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   streamed to the server over a longer time period.</td><td> </td><td class="right">   streamed to the server over a longer time period.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.  Compliance Requirements</td><td> </td><td class="right">9.  Compliance Requirements</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.1.  Mandatory-to-Implement Cipher Suites</td><td> </td><td class="right">9.1.  Mandatory-to-Implement Cipher Suites</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the absence of an application profile standard specifying</td><td> </td><td class="right">   In the absence of an application profile standard specifying</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0398" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">otherwise, a</span> TLS-compliant application MUST implement the</td><td> </td><td class="rblock">   <span class="insert">otherwise:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS_AES_128_GCM_SHA256 [GCM] cipher suite and SHOULD implement the</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS_AES_256_GCM_SHA384 [GCM] and TLS_CHACHA20_POLY1305_SHA256</td><td> </td><td class="rblock"><span class="insert">   A</span> TLS-compliant application MUST implement the TLS_AES_128_GCM_SHA256</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[RFC7539]</span> cipher <span class="delete">suites.</span>  (see Appendix <span class="delete">B.4)</span></td><td> </td><td class="rblock">   [GCM] cipher suite and SHOULD implement the TLS_AES_256_GCM_SHA384</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   [GCM] and TLS_CHACHA20_POLY1305_SHA256 <span class="insert">[RFC8439]</span> cipher <span class="insert">suites</span> (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Appendix <span class="insert">B.4).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A TLS-compliant application MUST support digital signatures with</td><td> </td><td class="right">   A TLS-compliant application MUST support digital signatures with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   rsa_pkcs1_sha256 (for certificates), rsa_pss_rsae_sha256 (for</td><td> </td><td class="right">   rsa_pkcs1_sha256 (for certificates), rsa_pss_rsae_sha256 (for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateVerify and certificates), and ecdsa_secp256r1_sha256.  A</td><td> </td><td class="right">   CertificateVerify and certificates), and ecdsa_secp256r1_sha256.  A</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS-compliant application MUST support key exchange with secp256r1</td><td> </td><td class="right">   TLS-compliant application MUST support key exchange with secp256r1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (NIST P-256) and SHOULD support key exchange with X25519 [RFC7748].</td><td> </td><td class="right">   (NIST P-256) and SHOULD support key exchange with X25519 [RFC7748].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.2.  Mandatory-to-Implement Extensions</td><td> </td><td class="right">9.2.  Mandatory-to-Implement Extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the absence of an application profile standard specifying</td><td> </td><td class="right">   In the absence of an application profile standard specifying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l46" /><small>skipping to change at</small><em> page 104, line 45</em></th><th> </th><th><a name="part-r46" /><small>skipping to change at</small><em> page 103, line 29</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Negotiated Groups ("supported_groups"; Section 4.2.7)</td><td> </td><td class="right">   -  Negotiated Groups ("supported_groups"; Section 4.2.7)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Key Share ("key_share"; Section 4.2.8)</td><td> </td><td class="right">   -  Key Share ("key_share"; Section 4.2.8)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Server Name Indication ("server_name"; Section 3 of [RFC6066])</td><td> </td><td class="right">   -  Server Name Indication ("server_name"; Section 3 of [RFC6066])</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All implementations MUST send and use these extensions when offering</td><td> </td><td class="right">   All implementations MUST send and use these extensions when offering</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   applicable features:</td><td> </td><td class="right">   applicable features:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0399" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  "supported_versions" is REQUIRED for all ClientHello, ServerHello</td><td> </td><td class="rblock">   -  "supported_versions" is REQUIRED for all ClientHello, ServerHello<span class="insert">,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and HelloRetryRequest messages.</td><td> </td><td class="right">      and HelloRetryRequest messages.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  "signature_algorithms" is REQUIRED for certificate authentication.</td><td> </td><td class="right">   -  "signature_algorithms" is REQUIRED for certificate authentication.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  "supported_groups" is REQUIRED for ClientHello messages using DHE</td><td> </td><td class="right">   -  "supported_groups" is REQUIRED for ClientHello messages using DHE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      or ECDHE key exchange.</td><td> </td><td class="right">      or ECDHE key exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  "key_share" is REQUIRED for DHE or ECDHE key exchange.</td><td> </td><td class="right">   -  "key_share" is REQUIRED for DHE or ECDHE key exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  "pre_shared_key" is REQUIRED for PSK key agreement.</td><td> </td><td class="right">   -  "pre_shared_key" is REQUIRED for PSK key agreement.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l47" /><small>skipping to change at</small><em> page 105, line 28</em></th><th> </th><th><a name="part-r47" /><small>skipping to change at</small><em> page 104, line 22</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extension.</td><td> </td><td class="right">      extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  If containing a "supported_groups" extension, it MUST also contain</td><td> </td><td class="right">   -  If containing a "supported_groups" extension, it MUST also contain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      a "key_share" extension, and vice versa.  An empty</td><td> </td><td class="right">      a "key_share" extension, and vice versa.  An empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      KeyShare.client_shares vector is permitted.</td><td> </td><td class="right">      KeyShare.client_shares vector is permitted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers receiving a ClientHello which does not conform to these</td><td> </td><td class="right">   Servers receiving a ClientHello which does not conform to these</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requirements MUST abort the handshake with a "missing_extension"</td><td> </td><td class="right">   requirements MUST abort the handshake with a "missing_extension"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alert.</td><td> </td><td class="right">   alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0400" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Additionally, all implementations MUST support use of the</td><td> </td><td class="rblock">   Additionally, all implementations MUST support <span class="insert">the </span>use of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "server_name" extension with applications capable of using it.</td><td> </td><td class="right">   "server_name" extension with applications capable of using it.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers MAY require clients to send a valid "server_name" extension.</td><td> </td><td class="right">   Servers MAY require clients to send a valid "server_name" extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers requiring this extension SHOULD respond to a ClientHello</td><td> </td><td class="right">   Servers requiring this extension SHOULD respond to a ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   lacking a "server_name" extension by terminating the connection with</td><td> </td><td class="right">   lacking a "server_name" extension by terminating the connection with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a "missing_extension" alert.</td><td> </td><td class="right">   a "missing_extension" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.3.  Protocol Invariants</td><td> </td><td class="right">9.3.  Protocol Invariants</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This section describes invariants that TLS endpoints and middleboxes</td><td> </td><td class="right">   This section describes invariants that TLS endpoints and middleboxes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST follow.  It also applies to earlier versions of TLS.</td><td> </td><td class="right">   MUST follow.  It also applies to earlier versions of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l48" /><small>skipping to change at</small><em> page 106, line 11</em></th><th> </th><th><a name="part-r48" /><small>skipping to change at</small><em> page 105, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For this to work, implementations MUST correctly handle extensible</td><td> </td><td class="right">   For this to work, implementations MUST correctly handle extensible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fields:</td><td> </td><td class="right">   fields:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A client sending a ClientHello MUST support all parameters</td><td> </td><td class="right">   -  A client sending a ClientHello MUST support all parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      advertised in it.  Otherwise, the server may fail to interoperate</td><td> </td><td class="right">      advertised in it.  Otherwise, the server may fail to interoperate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      by selecting one of those parameters.</td><td> </td><td class="right">      by selecting one of those parameters.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A server receiving a ClientHello MUST correctly ignore all</td><td> </td><td class="right">   -  A server receiving a ClientHello MUST correctly ignore all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      unrecognized cipher suites, extensions, and other parameters.</td><td> </td><td class="right">      unrecognized cipher suites, extensions, and other parameters.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0401" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Otherwise, it may fail to interoperate with newer clients.  In TLS</td><td> </td><td class="rblock">      Otherwise, it may fail to interoperate with newer clients.  In</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.3, a client receiving a CertificateRequest or NewSessionTicket</td><td> </td><td class="rblock">      TLS 1.3, a client receiving a CertificateRequest or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      MUST also ignore all unrecognized extensions.</td><td> </td><td class="rblock">      NewSessionTicket MUST also ignore all unrecognized extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A middlebox which terminates a TLS connection MUST behave as a</td><td> </td><td class="right">   -  A middlebox which terminates a TLS connection MUST behave as a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compliant TLS server (to the original client), including having a</td><td> </td><td class="right">      compliant TLS server (to the original client), including having a</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0402" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      certificate which the client is willing to accept, and as a</td><td> </td><td class="rblock">      certificate which the client is willing to accept, and a<span class="insert">lso a</span>s a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compliant TLS client (to the original server), including verifying</td><td> </td><td class="right">      compliant TLS client (to the original server), including verifying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the original server's certificate.  In particular, it MUST</td><td> </td><td class="right">      the original server's certificate.  In particular, it MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      generate its own ClientHello containing only parameters it</td><td> </td><td class="right">      generate its own ClientHello containing only parameters it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      understands, and it MUST generate a fresh ServerHello random</td><td> </td><td class="right">      understands, and it MUST generate a fresh ServerHello random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      value, rather than forwarding the endpoint's value.</td><td> </td><td class="right">      value, rather than forwarding the endpoint's value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Note that TLS's protocol requirements and security analysis only</td><td> </td><td class="right">      Note that TLS's protocol requirements and security analysis only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      apply to the two connections separately.  Safely deploying a TLS</td><td> </td><td class="right">      apply to the two connections separately.  Safely deploying a TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      terminator requires additional security considerations which are</td><td> </td><td class="right">      terminator requires additional security considerations which are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      beyond the scope of this document.</td><td> </td><td class="right">      beyond the scope of this document.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0403" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  A<span class="delete">n</span> middlebox which forwards ClientHello parameters it does not</td><td> </td><td class="rblock">   -  A middlebox which forwards ClientHello parameters it does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      understand MUST NOT process any messages beyond that ClientHello.</td><td> </td><td class="right">      understand MUST NOT process any messages beyond that ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      It MUST forward all subsequent traffic unmodified.  Otherwise, it</td><td> </td><td class="right">      It MUST forward all subsequent traffic unmodified.  Otherwise, it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      may fail to interoperate with newer clients and servers.</td><td> </td><td class="right">      may fail to interoperate with newer clients and servers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Forwarded ClientHellos may contain advertisements for features not</td><td> </td><td class="right">      Forwarded ClientHellos may contain advertisements for features not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      supported by the middlebox, so the response may include future TLS</td><td> </td><td class="right">      supported by the middlebox, so the response may include future TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      additions the middlebox does not recognize.  These additions MAY</td><td> </td><td class="right">      additions the middlebox does not recognize.  These additions MAY</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      change any message beyond the ClientHello arbitrarily.  In</td><td> </td><td class="right">      change any message beyond the ClientHello arbitrarily.  In</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      particular, the values sent in the ServerHello might change, the</td><td> </td><td class="right">      particular, the values sent in the ServerHello might change, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ServerHello format might change, and the TLSCiphertext format</td><td> </td><td class="right">      ServerHello format might change, and the TLSCiphertext format</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      might change.</td><td> </td><td class="right">      might change.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0404" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The design of TLS 1.3 was constrained by <span class="delete">widely-deployed non-</span></td><td> </td><td class="rblock">   The design of TLS 1.3 was constrained by <span class="insert">widely deployed</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   compliant</span> TLS middleboxes (see Appendix <span class="delete">D.4), however</span> it does not</td><td> </td><td class="rblock"><span class="insert">   non-compliant</span> TLS middleboxes (see Appendix <span class="insert">D.4); however,</span> it does</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   relax the invariants.  Those middleboxes continue to be <span class="delete">non-</span></td><td> </td><td class="rblock">   not relax the invariants.  Those middleboxes continue to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   compliant.</span></td><td> </td><td class="rblock">   <span class="insert">non-compliant.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">10.  Security Considerations</td><td> </td><td class="right">10.  Security Considerations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Security issues are discussed throughout this memo, especially in</td><td> </td><td class="right">   Security issues are discussed throughout this memo, especially in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0405" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendi<span class="delete">x C, Appendix D, and Appendix</span> E.</td><td> </td><td class="rblock">   Appendi<span class="insert">ces C, D, and</span> E.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">11.  IANA Considerations</td><td> </td><td class="right">11.  IANA Considerations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document uses several registries that were originally created in</td><td> </td><td class="right">   This document uses several registries that were originally created in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0406" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[RFC4346].</span>  IANA <span class="delete">[SHALL update/has updated]</span> these to reference this</td><td> </td><td class="rblock">   <span class="insert">[RFC4346] and updated in [RFC8447].</span>  IANA <span class="insert">has updated</span> these to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   document.  The registries and their allocation policies are below:</td><td> </td><td class="rblock">   reference this document.  The registries and their allocation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   policies are below:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0407" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  TLS Cipher <span class="delete">Suite Registry:</span> values with the first byte in the range</td><td> </td><td class="rblock">   -  TLS Cipher <span class="insert">Suites registry:</span> values with the first byte in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      0-254 (decimal) are assigned via Specification Required [RFC8126].</td><td> </td><td class="rblock">      range 0-254 (decimal) are assigned via Specification Required</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Values with the first byte 255 (decimal) are reserved for Private</td><td> </td><td class="rblock">      [RFC8126].  Values with the first byte 255 (decimal) are reserved</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Use [RFC8126].</td><td> </td><td class="rblock">      for Private Use [RFC8126].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0408" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      IANA <span class="delete">[SHALL add/has added]</span> the cipher suites listed in</td><td> </td><td class="rblock">      IANA <span class="insert">has added</span> the cipher suites listed in Appendix B.4 to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Appendix B.4 to the registry.  The "Value" and "Description"</td><td> </td><td class="rblock">      registry.  The "Value" and "Description" columns are taken from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      columns are taken from the table.  The "DTLS-OK" and "Recommended"</td><td> </td><td class="rblock">      the table.  The "DTLS-OK" and "Recommended" columns are both</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      columns are both marked as <span class="delete">"Yes"</span> for each new cipher suite.</td><td> </td><td class="rblock">      marked as <span class="insert">"Y"</span> for each new cipher suite.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">[[This assumes [I-D.ietf-tls-iana-registry-updates] has been</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      applied.]]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0409" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  TLS ContentType <span class="delete">R</span>egistry: Future values are allocated via</td><td> </td><td class="rblock">   -  TLS ContentType <span class="insert">r</span>egistry: Future values are allocated via</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Standards Action [RFC8126].</td><td> </td><td class="right">      Standards Action [RFC8126].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0410" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  TLS <span class="delete">Alert Registry:</span> Future values are allocated via Standards</td><td> </td><td class="rblock">   -  TLS <span class="insert">Alerts registry:</span> Future values are allocated via Standards</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Action [RFC8126].  IANA <span class="delete">[SHALL update/has updated]</span> this registry</td><td> </td><td class="rblock">      Action [RFC8126].  IANA <span class="insert">has populated</span> this registry <span class="insert">with the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">to include</span> values <span class="delete">for "missing_extension" and</span></td><td> </td><td class="rblock">      values <span class="insert">from Appendix B.2.</span>  The "DTLS-OK" column is marked as <span class="insert">"Y"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      "certificate_required".</span>  The "DTLS-OK" column is marked as <span class="delete">"Yes"</span></td><td> </td><td class="rblock">      for <span class="insert">all such values.  Values marked as "_RESERVED" have comments</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      for <span class="delete">each new alert.</span></td><td> </td><td class="rblock"><span class="insert">      describing their previous usage.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0411" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  TLS HandshakeType <span class="delete">Registry:</span> Future values are allocated via</td><td> </td><td class="rblock">   -  TLS HandshakeType <span class="insert">registry:</span> Future values are allocated via</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Standards Action [RFC8126].  IANA <span class="delete">[SHALL update/has updated]</span> this</td><td> </td><td class="rblock">      Standards Action [RFC8126].  IANA <span class="insert">has updated</span> this registry to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      registry to rename item 4 from "NewSessionTicket" to</td><td> </td><td class="rblock">      rename item 4 from "NewSessionTicket" to "new_session_ticket" and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "new_session_ticket" and <span class="delete">to add</span> the</td><td> </td><td class="rblock">      <span class="insert">populated this registry with</span> the <span class="insert">values from Appendix B.3.</span>  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">"hello_retry_request_RESERVED", "encrypted_extensions",</span></td><td> </td><td class="rblock">      "DTLS-OK" <span class="insert">column is</span> marked as <span class="insert">"Y"</span> for <span class="insert">all such values.  Values</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      "end_of_early_data", "key_update", and "message_hash" values.</span>  The</td><td> </td><td class="rblock"><span class="insert">      marked "_RESERVED" have comments describing their previous or</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "DTLS-OK" <span class="delete">are</span> marked as <span class="delete">"Yes"</span> for <span class="delete">each of these additions.</span></td><td> </td><td class="rblock"><span class="insert">      temporary usage.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0412" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This document also uses the TLS ExtensionType <span class="delete">Registry</span> originally</td><td> </td><td class="rblock">   This document also uses the TLS ExtensionType <span class="insert">Values registry</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   created in [RFC4366].  IANA has updated it to reference this</td><td> </td><td class="rblock">   originally created in [RFC4366].  IANA has updated it to reference</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   document.  Changes to the registry follow:</td><td> </td><td class="rblock">   this document.  Changes to the registry follow:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0413" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  IANA <span class="delete">[SHALL update/has updated]</span> the registration policy as</td><td> </td><td class="rblock">   -  IANA <span class="insert">has updated</span> the registration policy as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      follows:</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Values with the first byte in the range 0-254 (decimal) are</td><td> </td><td class="right">      Values with the first byte in the range 0-254 (decimal) are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      assigned via Specification Required [RFC8126].  Values with the</td><td> </td><td class="right">      assigned via Specification Required [RFC8126].  Values with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      first byte 255 (decimal) are reserved for Private Use [RFC8126].</td><td> </td><td class="right">      first byte 255 (decimal) are reserved for Private Use [RFC8126].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0414" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  IANA <span class="delete">[SHALL update/has updated]</span> this registry to include the</td><td> </td><td class="rblock">   -  IANA <span class="insert">has updated</span> this registry to include the "key_share",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "key_share", "pre_shared_key", "psk_key_exchange_modes",</td><td> </td><td class="rblock">      "pre_shared_key", "psk_key_exchange_modes", "early_data",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "early_data", "cookie", "supported_versions",</td><td> </td><td class="rblock">      "cookie", "supported_versions", "certificate_authorities",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "certificate_authorities", "oid_filters", "post_handshake_auth",</td><td> </td><td class="rblock">      "oid_filters", "post_handshake_auth", and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      and <span class="delete">"signature_algorithms_cert",</span> extensions with the values</td><td> </td><td class="rblock">      <span class="insert">"signature_algorithms_cert"</span> extensions with the values defined in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      defined in this document and the <span class="delete">Recommended</span> value of <span class="delete">"Yes".</span></td><td> </td><td class="rblock">      this document and the <span class="insert">"Recommended"</span> value of <span class="insert">"Y".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0415" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  IANA <span class="delete">[SHALL update/has updated]</span> this registry to include a "TLS</td><td> </td><td class="rblock">   -  IANA <span class="insert">has updated</span> this registry to include a "TLS 1.3" column which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      1.3" column which lists the messages in which the extension may</td><td> </td><td class="rblock">      lists the messages in which the extension may appear.  This column</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      appear.  This column <span class="delete">[SHALL be/has been]</span> initially populated from</td><td> </td><td class="rblock">      <span class="insert">has been</span> initially populated from the table in Section <span class="insert">4.2,</span> with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the table in Section <span class="delete">4.2</span> with any extension not listed there</td><td> </td><td class="rblock">      any extension not listed there marked as "-" to indicate that it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      marked as "-" to indicate that it is not used by TLS 1.3.</td><td> </td><td class="rblock">      is not used by TLS 1.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0416" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   In addition, this document defines two new registries <span class="delete">to be</span></td><td> </td><td class="rblock">   <span class="insert">This document updates an entry in the TLS Certificate Types registry</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   originally created in [RFC6091] and updated in [RFC8447].  IANA has</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   updated the entry for value 1 to have the name "OpenPGP_RESERVED",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   "Recommended" value "N", and comment "Used in TLS versions prior</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to 1.3."</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This document updates an entry in the TLS Certificate Status Types</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registry originally created in [RFC6961].  IANA has updated the entry</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   for value 2 to have the name "ocsp_multi_RESERVED" and comment "Used</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in TLS versions prior to 1.3".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This document updates two entries in the TLS Supported Groups</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registry (created under a different name by [RFC4492]; now maintained</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by [RFC8422]) and updated by [RFC7919] and [RFC8447].  The entries</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   for values 29 and 30 (x25519 and x448) have been updated to also</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   refer to this document.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   In addition, this document defines two new registries <span class="insert">that are</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   maintained by IANA:</td><td> </td><td class="right">   maintained by IANA:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0417" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  TLS SignatureScheme <span class="delete">R</span>egistry: Values with the first byte in the</td><td> </td><td class="rblock">   -  TLS SignatureScheme <span class="insert">r</span>egistry: Values with the first byte in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      range 0-253 (decimal) are assigned via Specification Required</td><td> </td><td class="right">      range 0-253 (decimal) are assigned via Specification Required</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [RFC8126].  Values with the first byte 254 or 255 (decimal) are</td><td> </td><td class="right">      [RFC8126].  Values with the first byte 254 or 255 (decimal) are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      reserved for Private Use [RFC8126].  Values with the first byte in</td><td> </td><td class="right">      reserved for Private Use [RFC8126].  Values with the first byte in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the range 0-6 or with the second byte in the range 0-3 that are</td><td> </td><td class="right">      the range 0-6 or with the second byte in the range 0-3 that are</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0418" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      not currently allocated are reserved for <span class="delete">backwards</span> compatibility.</td><td> </td><td class="rblock">      not currently allocated are reserved for <span class="insert">backward</span> compatibility.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      This registry <span class="delete">SHALL have</span> a "Recommended" column.  The registry</td><td> </td><td class="rblock">      This registry <span class="insert">has</span> a "Recommended" column.  The registry has <span class="insert">been</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">[shall be/</span> has <span class="delete">been]</span> initially populated with the values described</td><td> </td><td class="rblock">      initially populated with the values described in Section 4.2.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      in Section 4.2.3.  The following values <span class="delete">SHALL be</span> marked as</td><td> </td><td class="rblock">      The following values <span class="insert">are</span> marked as "Recommended":</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "Recommended": ecdsa_secp256r1_sha256, ecdsa_secp384r1_sha384,</td><td> </td><td class="rblock">      ecdsa_secp256r1_sha256, ecdsa_secp384r1_sha384,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      rsa_pss_rsae_sha256, rsa_pss_rsae_sha384, rsa_pss_rsae_sha512,</td><td> </td><td class="right">      rsa_pss_rsae_sha256, rsa_pss_rsae_sha384, rsa_pss_rsae_sha512,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      rsa_pss_pss_sha256, rsa_pss_pss_sha384, rsa_pss_pss_sha512, and</td><td> </td><td class="right">      rsa_pss_pss_sha256, rsa_pss_pss_sha384, rsa_pss_pss_sha512, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0419" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ed25519.</td><td> </td><td class="rblock">      ed25519.  <span class="insert">The "Recommended" column is assigned a value of "N"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      unless explicitly requested, and adding a value with a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      "Recommended" value of "Y" requires Standards Action [RFC8126].</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IESG Approval is REQUIRED for a Y-&gt;N transition.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0420" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  TLS PskKeyExchangeMode <span class="delete">R</span>egistry: Values in the range 0-253</td><td> </td><td class="rblock">   -  TLS PskKeyExchangeMode <span class="insert">r</span>egistry: Values in the range 0-253</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (decimal) are assigned via Specification Required [RFC8126].</td><td> </td><td class="right">      (decimal) are assigned via Specification Required [RFC8126].</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0421" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">Values with the first byte</span> 254 <span class="delete">or</span> 255 (decimal) are reserved for</td><td> </td><td class="rblock">      <span class="insert">The values</span> 254 <span class="insert">and</span> 255 (decimal) are reserved for Private Use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Private Use [RFC8126].  This registry <span class="delete">SHALL have</span> a "Recommended"</td><td> </td><td class="rblock">      [RFC8126].  This registry <span class="insert">has</span> a "Recommended" column.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      column.  The registry <span class="delete">[shall be/</span> has <span class="delete">been]</span> initially populated</td><td> </td><td class="rblock">      registry has <span class="insert">been</span> initially populated <span class="insert">with</span> psk_ke (0) and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      psk_ke (0) and psk_dhe_ke (1).  Both <span class="delete">SHALL be</span> marked as</td><td> </td><td class="rblock">      psk_dhe_ke (1).  Both <span class="insert">are</span> marked as "Recommended".  <span class="insert">The</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      "Recommended".</td><td> </td><td class="rblock"><span class="insert">      "Recommended" column is assigned a value of "N" unless explicitly</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      requested, and adding a value with a "Recommended" value of "Y"</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      requires Standards Action [RFC8126].  IESG Approval is REQUIRED</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      for a Y-&gt;N transition.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">12.  References</td><td> </td><td class="right">12.  References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">12.1.  Normative References</td><td> </td><td class="right">12.1.  Normative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0422" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[DH]       Diffie, W. and M. Hellman, "New Directions in</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Cryptography", IEEE Transactions on Information Theory,</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              V.IT-22 n.6 , June 1977.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [DH76]     Diffie, W. and M. Hellman, "New directions in</td><td> </td><td class="right">   [DH76]     Diffie, W. and M. Hellman, "New directions in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              cryptography", IEEE Transactions on Information</td><td> </td><td class="right">              cryptography", IEEE Transactions on Information</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0423" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">Theory</span> Vol. <span class="delete">22,</span> pp. 644-654, DOI <span class="delete">10.1109/tit.1976.1055638,</span></td><td> </td><td class="rblock">              <span class="insert">Theory,</span> Vol. <span class="insert">22 No. 6,</span> pp. 644-654,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              November 1976.</td><td> </td><td class="rblock">              DOI <span class="insert">10.1109/TIT.1976.1055638,</span> November 1976.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[ECDSA]    American National Standards Institute, "Public Key</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Cryptography for the Financial Services Industry: The</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Elliptic Curve Digital Signature Algorithm (ECDSA)",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              ANSI ANS X9.62-2005, November 2005.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [GCM]      Dworkin, M., "Recommendation for Block Cipher Modes of</td><td> </td><td class="right">   [GCM]      Dworkin, M., "Recommendation for Block Cipher Modes of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Operation: Galois/Counter Mode (GCM) and GMAC",</td><td> </td><td class="right">              Operation: Galois/Counter Mode (GCM) and GMAC",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0424" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              NIST Special Publication 800-38D, November 2007.</td><td> </td><td class="rblock">              NIST Special Publication 800-38D,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              <span class="insert">DOI 10.6028/NIST.SP.800-38D,</span> November 2007.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-</td><td> </td><td class="right">   [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Hashing for Message Authentication", RFC 2104,</td><td> </td><td class="right">              Hashing for Message Authentication", RFC 2104,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC2104, February 1997,</td><td> </td><td class="right">              DOI 10.17487/RFC2104, February 1997,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2104&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2104&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td> </td><td class="right">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Requirement Levels", BCP 14, RFC 2119,</td><td> </td><td class="right">              Requirement Levels", BCP 14, RFC 2119,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC2119, March 1997,</td><td> </td><td class="right">              DOI 10.17487/RFC2119, March 1997,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l49" /><small>skipping to change at</small><em> page 110, line 22</em></th><th> </th><th><a name="part-r49" /><small>skipping to change at</small><em> page 110, line 37</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Multiple Certificate Status Request Extension", RFC 6961,</td><td> </td><td class="right">              Multiple Certificate Status Request Extension", RFC 6961,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC6961, June 2013,</td><td> </td><td class="right">              DOI 10.17487/RFC6961, June 2013,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6961&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6961&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6962]  Laurie, B., Langley, A., and E. Kasper, "Certificate</td><td> </td><td class="right">   [RFC6962]  Laurie, B., Langley, A., and E. Kasper, "Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Transparency", RFC 6962, DOI 10.17487/RFC6962, June 2013,</td><td> </td><td class="right">              Transparency", RFC 6962, DOI 10.17487/RFC6962, June 2013,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6962&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6962&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6979]  Pornin, T., "Deterministic Usage of the Digital Signature</td><td> </td><td class="right">   [RFC6979]  Pornin, T., "Deterministic Usage of the Digital Signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Algorithm (DSA) and Elliptic Curve Digital Signature</td><td> </td><td class="right">              Algorithm (DSA) and Elliptic Curve Digital Signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0425" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Algorithm (ECDSA)", RFC 6979, DOI 10.17487/RFC6979, August</td><td> </td><td class="rblock">              Algorithm (ECDSA)", RFC 6979, DOI 10.17487/RFC6979,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2013, &lt;https://www.rfc-editor.org/info/rfc6979&gt;.</td><td> </td><td class="rblock">              August 2013, &lt;https://www.rfc-editor.org/info/rfc6979&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC7301]  Friedl, S., Popov, A., Langley, A., and E. Stephan,</td><td> </td><td class="right">   [RFC7301]  Friedl, S., Popov, A., Langley, A., and E. Stephan,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Transport Layer Security (TLS) Application-Layer Protocol</td><td> </td><td class="right">              "Transport Layer Security (TLS) Application-Layer Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Negotiation Extension", RFC 7301, DOI 10.17487/RFC7301,</td><td> </td><td class="right">              Negotiation Extension", RFC 7301, DOI 10.17487/RFC7301,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              July 2014, &lt;https://www.rfc-editor.org/info/rfc7301&gt;.</td><td> </td><td class="right">              July 2014, &lt;https://www.rfc-editor.org/info/rfc7301&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC7507]  Moeller, B. and A. Langley, "TLS Fallback Signaling Cipher</td><td> </td><td class="right">   [RFC7507]  Moeller, B. and A. Langley, "TLS Fallback Signaling Cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Suite Value (SCSV) for Preventing Protocol Downgrade</td><td> </td><td class="right">              Suite Value (SCSV) for Preventing Protocol Downgrade</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Attacks", RFC 7507, DOI 10.17487/RFC7507, April 2015,</td><td> </td><td class="right">              Attacks", RFC 7507, DOI 10.17487/RFC7507, April 2015,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc7507&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc7507&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0426" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[RFC7539]  Nir, Y. and A. Langley, "ChaCha20 and Poly1305 for IETF</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Protocols", RFC 7539, DOI 10.17487/RFC7539, May 2015,</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              &lt;https://www.rfc-editor.org/info/rfc7539&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves</td><td> </td><td class="right">   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0427" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              for Security", RFC 7748, DOI 10.17487/RFC7748, January</td><td> </td><td class="rblock">              for Security", RFC 7748, DOI 10.17487/RFC7748,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2016, &lt;https://www.rfc-editor.org/info/rfc7748&gt;.</td><td> </td><td class="rblock">              January 2016, &lt;https://www.rfc-editor.org/info/rfc7748&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC7919]  Gillmor, D., "Negotiated Finite Field Diffie-Hellman</td><td> </td><td class="right">   [RFC7919]  Gillmor, D., "Negotiated Finite Field Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Ephemeral Parameters for Transport Layer Security (TLS)",</td><td> </td><td class="right">              Ephemeral Parameters for Transport Layer Security (TLS)",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              RFC 7919, DOI 10.17487/RFC7919, August 2016,</td><td> </td><td class="right">              RFC 7919, DOI 10.17487/RFC7919, August 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc7919&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc7919&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC8017]  Moriarty, K., Ed., Kaliski, B., Jonsson, J., and A. Rusch,</td><td> </td><td class="right">   [RFC8017]  Moriarty, K., Ed., Kaliski, B., Jonsson, J., and A. Rusch,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "PKCS #1: RSA Cryptography Specifications Version 2.2",</td><td> </td><td class="right">              "PKCS #1: RSA Cryptography Specifications Version 2.2",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              RFC 8017, DOI 10.17487/RFC8017, November 2016,</td><td> </td><td class="right">              RFC 8017, DOI 10.17487/RFC8017, November 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8017&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8017&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l50" /><small>skipping to change at</small><em> page 111, line 15</em></th><th> </th><th><a name="part-r50" /><small>skipping to change at</small><em> page 111, line 25</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC8032]  Josefsson, S. and I. Liusvaara, "Edwards-Curve Digital</td><td> </td><td class="right">   [RFC8032]  Josefsson, S. and I. Liusvaara, "Edwards-Curve Digital</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Signature Algorithm (EdDSA)", RFC 8032,</td><td> </td><td class="right">              Signature Algorithm (EdDSA)", RFC 8032,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC8032, January 2017,</td><td> </td><td class="right">              DOI 10.17487/RFC8032, January 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8032&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8032&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for</td><td> </td><td class="right">   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Writing an IANA Considerations Section in RFCs", BCP 26,</td><td> </td><td class="right">              Writing an IANA Considerations Section in RFCs", BCP 26,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              RFC 8126, DOI 10.17487/RFC8126, June 2017,</td><td> </td><td class="right">              RFC 8126, DOI 10.17487/RFC8126, June 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8126&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8126&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0428" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td> </td><td class="rblock">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,</td><td> </td><td class="rblock">              RFC 2119 Key Words", BCP 14, RFC 8174,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td> </td><td class="rblock">              DOI 10.17487/RFC8174, May 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0429" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[SHS]      Dang, Q., "Secure Hash Standard", National Institute of</span></td><td> </td><td class="rblock">   <span class="insert">[RFC8439]  Nir, Y.</span> and <span class="insert">A. Langley, "ChaCha20 and Poly1305 for IETF</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Standards</span> and <span class="delete">Technology report,</span></td><td> </td><td class="rblock"><span class="insert">              Protocols", RFC 8439,</span> DOI <span class="insert">10.17487/RFC8439, June 2018,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              DOI <span class="delete">10.6028/nist.fips.180-4, July 2015.</span></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc8439&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0430" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [X690]     ITU-T, "Information technology <span class="delete">-</span> ASN.1 encoding <span class="delete">Rules:</span></td><td> </td><td class="rblock">   <span class="insert">[SHS]      Dang, Q., "Secure Hash Standard (SHS)", National Institute</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              of Standards and Technology report,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.6028/NIST.FIPS.180-4, August 2015.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   [X690]     ITU-T, "Information technology <span class="insert">--</span> ASN.1 encoding <span class="insert">rules:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Specification of Basic Encoding Rules (BER), Canonical</td><td> </td><td class="right">              Specification of Basic Encoding Rules (BER), Canonical</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Encoding Rules (CER) and Distinguished Encoding Rules</td><td> </td><td class="right">              Encoding Rules (CER) and Distinguished Encoding Rules</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0431" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              (DER)", ISO/IEC <span class="delete">8825-1:2002, 2002.</span></td><td> </td><td class="rblock">              (DER)", ISO/IEC <span class="insert">8825-1:2015, November 2015.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [X962]     ANSI, "Public Key Cryptography For The Financial Services</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Industry: The Elliptic Curve Digital Signature Algorithm</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              (ECDSA)", ANSI X9.62, 1998.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">12.2.  Informative References</td><td> </td><td class="right">12.2.  Informative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [AEAD-LIMITS]</td><td> </td><td class="right">   [AEAD-LIMITS]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Luykx, A. and K. Paterson, "Limits on Authenticated</td><td> </td><td class="right">              Luykx, A. and K. Paterson, "Limits on Authenticated</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0432" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Encryption Use in TLS", <span class="delete">2016</span>,</td><td> </td><td class="rblock">              Encryption Use in TLS", <span class="insert">August 2017</span>,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://www.isg.rhul.ac.uk/~kp/TLS-AEbounds.pdf&gt;.</td><td> </td><td class="right">              &lt;http://www.isg.rhul.ac.uk/~kp/TLS-AEbounds.pdf&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0433" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[Anon18]   Anonymous, A., "Secure Channels for Multiplexed Data</span></td><td> </td><td class="rblock">   <span class="insert">[BBFGKZ16]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Streams: Analyzing the TLS 1.3 Record Layer Without</span></td><td> </td><td class="rblock">              Bhargavan, K., Brzuska, C., Fournet, C., <span class="insert">Green, M.,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Elision", In submission to CRYPTO 2018. RFC EDITOR: PLEASE</span></td><td> </td><td class="rblock">              Kohlweiss, M., and <span class="insert">S. Zanella-Beguelin,</span> "Downgrade</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              UPDATE THIS REFERENCE AFTER FINAL NOTIFICATION</span></td><td> </td><td class="rblock">              Resilience in Key-Exchange Protocols", Proceedings of IEEE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              (2018-4-29). , 2018.</span></td><td> </td><td class="rblock">              Symposium on Security and Privacy <span class="insert">(San Jose),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1109/SP.2016.37, May</span> 2016.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [BBFKZG16]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Bhargavan, K., Brzuska, C., Fournet, C., Kohlweiss, M.,</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">Zanella-Beguelin, S.,</span> and <span class="delete">M. Green,</span> "Downgrade Resilience</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              in Key-Exchange Protocols", Proceedings of IEEE Symposium</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              on Security and Privacy <span class="delete">(Oakland) 2016 ,</span> 2016.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [BBK17]    Bhargavan, K., Blanchet, B., and N. Kobeissi, "Verified</td><td> </td><td class="right">   [BBK17]    Bhargavan, K., Blanchet, B., and N. Kobeissi, "Verified</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Models and Reference Implementations for the TLS 1.3</td><td> </td><td class="right">              Models and Reference Implementations for the TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Standard Candidate", Proceedings of IEEE Symposium on</td><td> </td><td class="right">              Standard Candidate", Proceedings of IEEE Symposium on</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0434" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Security and Privacy <span class="delete">(Oakland) 2017 ,</span> 2017.</td><td> </td><td class="rblock">              Security and Privacy <span class="insert">(San Jose), DOI 10.1109/SP.2017.26,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              May</span> 2017.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [BDFKPPRSZZ16]</td><td> </td><td class="right">   [BDFKPPRSZZ16]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Bhargavan, K., Delignat-Lavaud, A., Fournet, C.,</td><td> </td><td class="right">              Bhargavan, K., Delignat-Lavaud, A., Fournet, C.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Kohlweiss, M., Pan, J., Protzenko, J., Rastogi, A., Swamy,</td><td> </td><td class="right">              Kohlweiss, M., Pan, J., Protzenko, J., Rastogi, A., Swamy,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              N., Zanella-Beguelin, S., and J. Zinzindohoue,</td><td> </td><td class="right">              N., Zanella-Beguelin, S., and J. Zinzindohoue,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Implementing and Proving the TLS 1.3 Record Layer",</td><td> </td><td class="right">              "Implementing and Proving the TLS 1.3 Record Layer",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0435" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Proceedings of IEEE Symposium on Security and Privacy</td><td> </td><td class="rblock">              Proceedings of IEEE Symposium on Security and Privacy <span class="insert">(San</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">(Oakland) 2017 , December 2016,</span></td><td> </td><td class="rblock"><span class="insert">              Jose), May 2017,</span> &lt;https://eprint.iacr.org/2016/1178&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              &lt;https://eprint.iacr.org/2016/1178&gt;.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0436" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [Ben17a]   Benjamin, D., "Presentation before the TLS WG at IETF</td><td> </td><td class="rblock">   [Ben17a]   Benjamin, D., "Presentation before the TLS WG at</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              100", 2017,</td><td> </td><td class="rblock">              IETF 100", <span class="insert">November</span> 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://datatracker.ietf.org/meeting/100/materials/</td><td> </td><td class="right">              &lt;https://datatracker.ietf.org/meeting/100/materials/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              slides-100-tls-sessa-tls13/&gt;.</td><td> </td><td class="right">              slides-100-tls-sessa-tls13/&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Ben17b]   Benjamin, D., "Additional TLS 1.3 results from Chrome",</td><td> </td><td class="right">   [Ben17b]   Benjamin, D., "Additional TLS 1.3 results from Chrome",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0437" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2017, &lt;https://www.ietf.org/mail-archive/web/tls/current/</td><td> </td><td class="rblock">              <span class="insert">message to the TLS mailing list, 18 December</span> 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              &lt;https://www.ietf.org/mail-archive/web/tls/current/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              msg25168.html&gt;.</td><td> </td><td class="right">              msg25168.html&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0438" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[BMMT15]</span>   Badertscher, C., Matt, C., Maurer, U., and B. Tackmann,</td><td> </td><td class="rblock">   <span class="insert">[Blei98]   Bleichenbacher, D., "Chosen Ciphertext Attacks against</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              "Augmented Secure Channels and the Goal of the TLS 1.3</td><td> </td><td class="rblock"><span class="insert">              Protocols Based on RSA Encryption Standard PKCS #1",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Record Layer", ProvSec <span class="delete">2015 ,</span> September 2015,</td><td> </td><td class="rblock"><span class="insert">              Proceedings of CRYPTO '98, 1998.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [BMMRT15]</span>  Badertscher, C., Matt, C., Maurer, U., <span class="insert">Rogaway, P.,</span> and B.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              Tackmann, "Augmented Secure Channels and the Goal of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              TLS 1.3 Record Layer", ProvSec <span class="insert">2015,</span> September 2015,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://eprint.iacr.org/2015/394&gt;.</td><td> </td><td class="right">              &lt;https://eprint.iacr.org/2015/394&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [BT16]     Bellare, M. and B. Tackmann, "The Multi-User Security of</td><td> </td><td class="right">   [BT16]     Bellare, M. and B. Tackmann, "The Multi-User Security of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Authenticated Encryption: AES-GCM in TLS 1.3", Proceedings</td><td> </td><td class="right">              Authenticated Encryption: AES-GCM in TLS 1.3", Proceedings</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0439" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              of CRYPTO <span class="delete">2016 ,</span> 2016, &lt;https://eprint.iacr.org/2016/564&gt;.</td><td> </td><td class="rblock">              of CRYPTO <span class="insert">2016, July</span> 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              &lt;https://eprint.iacr.org/2016/564&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0440" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [CCG16]    Cohn-Gordon, K., Cremers, C., and L. Garratt, "On <span class="delete">Post-</span></td><td> </td><td class="rblock">   [CCG16]    Cohn-Gordon, K., Cremers, C., and L. Garratt, "On</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Compromise</span> Security", IEEE Computer Security Foundations</td><td> </td><td class="rblock">              <span class="insert">Post-compromise</span> Security", IEEE Computer Security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">Symposium ,</span> 2015.</td><td> </td><td class="rblock">              Foundations <span class="insert">Symposium, DOI 10.1109/CSF.2016.19, July</span> 2015.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [CHECKOWAY]</td><td> </td><td class="right">   [CHECKOWAY]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Checkoway, S., Maskiewicz, J., Garman, C., Fried, J.,</td><td> </td><td class="right">              Checkoway, S., Maskiewicz, J., Garman, C., Fried, J.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Cohney, S., Green, M., Heninger, N., Weinmann, R.,</td><td> </td><td class="right">              Cohney, S., Green, M., Heninger, N., Weinmann, R.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Rescorla, E., and H. Shacham, "A Systematic Analysis of</td><td> </td><td class="right">              Rescorla, E., and H. Shacham, "A Systematic Analysis of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              the Juniper Dual EC Incident", Proceedings of the 2016 ACM</td><td> </td><td class="right">              the Juniper Dual EC Incident", Proceedings of the 2016 ACM</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0441" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              SIGSAC Conference on Computer and Communications <span class="delete">Security,</span></td><td> </td><td class="rblock">              SIGSAC Conference on Computer and Communications <span class="insert">Security</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              DOI 10.1145/2976749.2978395, October 2016.</td><td> </td><td class="rblock"><span class="insert">              - CCS '16,</span> DOI 10.1145/2976749.2978395, October 2016.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0442" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [CHHSV17]  Cremers, C., Horvat, M., Hoyland, J., van der Merwe, <span class="delete">T.,</span></td><td> </td><td class="rblock">   [CHHSV17]  Cremers, C., Horvat, M., Hoyland, J., <span class="insert">Scott, S., and T.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              and S. Scott,</span> "Awkward Handshake: Possible mismatch of</td><td> </td><td class="rblock">              van der Merwe, "Awkward Handshake: Possible mismatch of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              client/server view on client authentication in <span class="delete">post-</span></td><td> </td><td class="rblock">              client/server view on client authentication in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              handshake</span> mode in Revision 18", 2017,</td><td> </td><td class="rblock">              <span class="insert">post-handshake</span> mode in Revision 18", <span class="insert">message to the TLS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">&lt;https://www.ietf.org/mail-archive/web/tls/current/</span></td><td> </td><td class="rblock"><span class="insert">              mailing list, 10 February</span> 2017, <span class="insert">&lt;https://www.ietf.org/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              msg22382.html&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              mail-archive/web/tls/current/msg22382.html&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [CHSV16]   Cremers, C., Horvat, M., Scott, S., and T. van der Merwe,</td><td> </td><td class="right">   [CHSV16]   Cremers, C., Horvat, M., Scott, S., and T. van der Merwe,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Automated Analysis and Verification of TLS 1.3: 0-RTT,</td><td> </td><td class="right">              "Automated Analysis and Verification of TLS 1.3: 0-RTT,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Resumption and Delayed Authentication", Proceedings of</td><td> </td><td class="right">              Resumption and Delayed Authentication", Proceedings of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0443" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              IEEE Symposium on Security and Privacy <span class="delete">(Oakland) 2016 ,</span></td><td> </td><td class="rblock">              IEEE Symposium on Security and Privacy <span class="insert">(San Jose),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2016, <span class="delete">&lt;http://ieeexplore.ieee.org/document/7546518/&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1109/SP.2016.35, May</span> 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              <span class="insert">&lt;https://ieeexplore.ieee.org/document/7546518/&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [CK01]     Canetti, R. and H. Krawczyk, "Analysis of Key-Exchange</td><td> </td><td class="right">   [CK01]     Canetti, R. and H. Krawczyk, "Analysis of Key-Exchange</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Protocols and Their Use for Building Secure Channels",</td><td> </td><td class="right">              Protocols and Their Use for Building Secure Channels",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0444" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Proceedings of Eurocrypt <span class="delete">2001 ,</span> 2001.</td><td> </td><td class="rblock">              Proceedings of Eurocrypt <span class="insert">2001,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1007/3-540-44987-6_28, April</span> 2001.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [CLINIC]   Miller, B., Huang, L., Joseph, A., and J. Tygar, "I Know</td><td> </td><td class="right">   [CLINIC]   Miller, B., Huang, L., Joseph, A., and J. Tygar, "I Know</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Why You Went to the Clinic: Risks and Realization of HTTPS</td><td> </td><td class="right">              Why You Went to the Clinic: Risks and Realization of HTTPS</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0445" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Traffic Analysis", Privacy Enhancing Technologies pp.</td><td> </td><td class="rblock">              Traffic Analysis", Privacy Enhancing Technologies<span class="insert">,</span> pp.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              143-163, DOI 10.1007/978-3-319-08506-7_8, 2014.</td><td> </td><td class="right">              143-163, DOI 10.1007/978-3-319-08506-7_8, 2014.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [DFGS15]   Dowling, B., Fischlin, M., Guenther, F., and D. Stebila,</td><td> </td><td class="right">   [DFGS15]   Dowling, B., Fischlin, M., Guenther, F., and D. Stebila,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0446" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              "A Cryptographic Analysis of the TLS 1.3 <span class="delete">draft-10 Full and</span></td><td> </td><td class="rblock">              "A Cryptographic Analysis of the TLS 1.3 Handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Pre-shared Key</span> Handshake <span class="delete">Protocol",</span> Proceedings of ACM CCS</td><td> </td><td class="rblock">              <span class="insert">Protocol Candidates",</span> Proceedings of ACM CCS <span class="insert">2015,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">2015 ,</span> 2015, &lt;https://eprint.iacr.org/2015/914&gt;.</td><td> </td><td class="rblock"><span class="insert">              October</span> 2015, &lt;https://eprint.iacr.org/2015/914&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [DFGS16]   Dowling, B., Fischlin, M., Guenther, F., and D. Stebila,</td><td> </td><td class="right">   [DFGS16]   Dowling, B., Fischlin, M., Guenther, F., and D. Stebila,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0447" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              "A Cryptographic Analysis of the TLS 1.3 <span class="delete">draft-10</span> Full and</td><td> </td><td class="rblock">              "A Cryptographic Analysis of the TLS 1.3 Full and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Pre-shared Key Handshake Protocol", TRON <span class="delete">2016 ,</span> 2016,</td><td> </td><td class="rblock">              Pre-shared Key Handshake Protocol", TRON <span class="insert">2016,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              &lt;https://eprint.iacr.org/2016/081&gt;.</td><td> </td><td class="rblock"><span class="insert">              February</span> 2016, &lt;https://eprint.iacr.org/2016/081&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [DOW92]    Diffie, W., van Oorschot, P., and M. Wiener,</td><td> </td><td class="right">   [DOW92]    Diffie, W., van Oorschot, P., and M. Wiener,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Authentication and authenticated key exchanges", Designs,</td><td> </td><td class="right">              "Authentication and authenticated key exchanges", Designs,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0448" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Codes and Cryptography<span class="delete"> ,</span> 1992.</td><td> </td><td class="rblock">              Codes and Cryptography<span class="insert">, DOI 10.1007/BF00124891, June</span> 1992.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [DSS]      National Institute of Standards and Technology, U.S.</td><td> </td><td class="right">   [DSS]      National Institute of Standards and Technology, U.S.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0449" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Department of Commerce, "Digital Signature <span class="delete">Standard,</span></td><td> </td><td class="rblock">              Department of Commerce, "Digital Signature <span class="insert">Standard</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              version 4",</span> NIST FIPS PUB 186-4, 2013.</td><td> </td><td class="rblock"><span class="insert">              (DSS)",</span> NIST FIPS PUB 186-4, <span class="insert">DOI 10.6028/NIST.FIPS.186-4,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"><span class="insert">              July</span> 2013.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[ECDSA]    American National Standards Institute, "Public Key</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Cryptography for the Financial Services Industry: The</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Elliptic Curve Digital Signature Algorithm (ECDSA)",</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              ANSI ANS X9.62-2005, November 2005.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [FG17]     Fischlin, M. and F. Guenther, "Replay Attacks on Zero</td><td> </td><td class="right">   [FG17]     Fischlin, M. and F. Guenther, "Replay Attacks on Zero</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Round-Trip Time: The Case of the TLS 1.3 Handshake</td><td> </td><td class="right">              Round-Trip Time: The Case of the TLS 1.3 Handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0450" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Candidates", Proceedings of Euro<span class="delete"> S"P 2017 ,</span> 2017,</td><td> </td><td class="rblock">              Candidates", Proceedings of Euro<span class="insert">S&amp;P 2017, April</span> 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://eprint.iacr.org/2017/082&gt;.</td><td> </td><td class="right">              &lt;https://eprint.iacr.org/2017/082&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [FGSW16]   Fischlin, M., Guenther, F., Schmidt, B., and B. Warinschi,</td><td> </td><td class="right">   [FGSW16]   Fischlin, M., Guenther, F., Schmidt, B., and B. Warinschi,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Key Confirmation in Key Exchange: A Formal Treatment and</td><td> </td><td class="right">              "Key Confirmation in Key Exchange: A Formal Treatment and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Implications for TLS 1.3", Proceedings of IEEE Symposium</td><td> </td><td class="right">              Implications for TLS 1.3", Proceedings of IEEE Symposium</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0451" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              on Security and Privacy <span class="delete">(Oakland) 2016 ,</span> 2016,</td><td> </td><td class="rblock">              on Security and Privacy <span class="insert">(San Jose),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">&lt;http://ieeexplore.ieee.org/document/7546517/&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1109/SP.2016.34, May</span> 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              <span class="insert">&lt;https://ieeexplore.ieee.org/document/7546517/&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0452" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [FW15]     <span class="delete">Florian</span> Weimer, <span class="delete">.,</span> "Factoring RSA Keys With TLS Perfect</td><td> </td><td class="rblock">   [FW15]     Weimer, <span class="insert">F.,</span> "Factoring RSA Keys With TLS Perfect Forward</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Forward Secrecy", September 2015.</td><td> </td><td class="rblock">              Secrecy", September 2015.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0453" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[HCJ16]</span>    Husak, M., <span class="delete">&amp;#268;ermak,</span> M., Jirsik, T., and P.</td><td> </td><td class="rblock">   <span class="insert">[HCJC16]</span>   Husak, M., <span class="insert">Cermak,</span> M., Jirsik, T., and P. <span class="insert">Celeda,</span> "HTTPS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">&amp;#268;eleda,</span> "HTTPS traffic analysis and client</td><td> </td><td class="rblock">              traffic analysis and client identification using passive</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              identification using passive SSL/TLS fingerprinting",</td><td> </td><td class="rblock">              SSL/TLS fingerprinting", EURASIP Journal on Information</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              EURASIP Journal on Information <span class="delete">Security</span> Vol. 2016,</td><td> </td><td class="rblock">              <span class="insert">Security,</span> Vol. 2016, DOI 10.1186/s13635-016-0030-7,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              DOI 10.1186/s13635-016-0030-7, February 2016.</td><td> </td><td class="rblock">              February 2016.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [HGFS15]   Hlauschek, C., Gruber, M., Fankhauser, F., and C. Schanes,</td><td> </td><td class="right">   [HGFS15]   Hlauschek, C., Gruber, M., Fankhauser, F., and C. Schanes,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Prying Open Pandora's Box: KCI Attacks against TLS",</td><td> </td><td class="right">              "Prying Open Pandora's Box: KCI Attacks against TLS",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0454" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Proceedings of USENIX Workshop on Offensive <span class="delete">Technologies ,</span></td><td> </td><td class="rblock">              Proceedings of USENIX Workshop on Offensive <span class="insert">Technologies,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2015.</td><td> </td><td class="rblock"><span class="insert">              August</span> 2015.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[I-D.ietf-tls-iana-registry-updates]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Salowey, J. and S. Turner, "IANA Registry Updates for</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Transport Layer Security (TLS) and Datagram Transport</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Layer Security (DTLS)", draft-ietf-tls-iana-registry-</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              updates-05 (work in progress), May 2018.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [I-D.ietf-tls-tls13-vectors]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Thomson, M., "Example Handshake Traces for TLS 1.3",</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              draft-ietf-tls-tls13-vectors-07 (work in progress),</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              September 2018.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [IEEE1363]</td><td> </td><td class="right">   [IEEE1363]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0455" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              IEEE, <span class="delete">"Standard</span> Specifications for Public Key</td><td> </td><td class="rblock">              IEEE, <span class="insert">"IEEE Standard</span> Specifications for Public Key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Cryptography", IEEE <span class="delete">1363 , 2000.</span></td><td> </td><td class="rblock">              Cryptography", IEEE <span class="insert">Std. 1363-2000,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1109/IEEESTD.2000.92292.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [JSS15]    Jager, T., Schwenk, J., and J. Somorovsky, "On the</td><td> </td><td class="right">   [JSS15]    Jager, T., Schwenk, J., and J. Somorovsky, "On the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Security of TLS 1.3 and QUIC Against Weaknesses in PKCS#1</td><td> </td><td class="right">              Security of TLS 1.3 and QUIC Against Weaknesses in PKCS#1</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0456" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              v1.5 Encryption", Proceedings of ACM CCS <span class="delete">2015 ,</span> 2015,</td><td> </td><td class="rblock">              v1.5 Encryption", Proceedings of ACM CCS <span class="insert">2015,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1145/2810103.2813657, October</span> 2015,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.nds.rub.de/media/nds/</td><td> </td><td class="right">              &lt;https://www.nds.rub.de/media/nds/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              veroeffentlichungen/2015/08/21/Tls13QuicAttacks.pdf&gt;.</td><td> </td><td class="right">              veroeffentlichungen/2015/08/21/Tls13QuicAttacks.pdf&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [KEYAGREEMENT]</td><td> </td><td class="right">   [KEYAGREEMENT]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0457" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Barker, E., Chen, L., Roginsky, A., and <span class="delete">M. Smid,</span></td><td> </td><td class="rblock">              Barker, E., Chen, L., Roginsky, A., <span class="insert">Vassilev, A.,</span> and <span class="insert">R.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              "Recommendation for Pair-Wise Key Establishment Schemes</td><td> </td><td class="rblock"><span class="insert">              Davis,</span> "Recommendation for Pair-Wise Key Establishment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Using Discrete Logarithm Cryptography", National Institute</td><td> </td><td class="rblock">              Schemes Using Discrete Logarithm Cryptography", National</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              of Standards and <span class="delete">Technology report,</span></td><td> </td><td class="rblock">              Institute of Standards and <span class="insert">Technology,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              DOI <span class="delete">10.6028/nist.sp.800-56ar2, May 2013.</span></td><td> </td><td class="rblock">              DOI <span class="insert">10.6028/NIST.SP.800-56Ar3, April 2018.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Kraw10]   Krawczyk, H., "Cryptographic Extraction and Key</td><td> </td><td class="right">   [Kraw10]   Krawczyk, H., "Cryptographic Extraction and Key</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0458" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Derivation: The HKDF Scheme", Proceedings of CRYPTO <span class="delete">2010 ,</span></td><td> </td><td class="rblock">              Derivation: The HKDF Scheme", Proceedings of CRYPTO <span class="insert">2010,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2010, &lt;https://eprint.iacr.org/2010/264&gt;.</td><td> </td><td class="rblock"><span class="insert">              August</span> 2010, &lt;https://eprint.iacr.org/2010/264&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Kraw16]   Krawczyk, H., "A Unilateral-to-Mutual Authentication</td><td> </td><td class="right">   [Kraw16]   Krawczyk, H., "A Unilateral-to-Mutual Authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Compiler for Key Exchange (with Applications to Client</td><td> </td><td class="right">              Compiler for Key Exchange (with Applications to Client</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0459" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Authentication in TLS 1.3", Proceedings of ACM CCS <span class="delete">2016 ,</span></td><td> </td><td class="rblock">              Authentication in TLS 1.3", Proceedings of ACM CCS <span class="insert">2016,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2016, &lt;https://eprint.iacr.org/2016/711&gt;.</td><td> </td><td class="rblock"><span class="insert">              October</span> 2016, &lt;https://eprint.iacr.org/2016/711&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [KW16]     Krawczyk, H. and H. Wee, "The OPTLS Protocol and TLS 1.3",</td><td> </td><td class="right">   [KW16]     Krawczyk, H. and H. Wee, "The OPTLS Protocol and TLS 1.3",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0460" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Proceedings of Euro<span class="delete"> S"P 2016 ,</span> 2016,</td><td> </td><td class="rblock">              Proceedings of Euro<span class="insert">S&amp;P 2016, March</span> 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://eprint.iacr.org/2015/978&gt;.</td><td> </td><td class="right">              &lt;https://eprint.iacr.org/2015/978&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0461" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [LXZFH16]  Li, X., Xu, J., <span class="delete">Feng, D., Zhang, Z</span>., and H. Hu, "Multiple</td><td> </td><td class="rblock">   [LXZFH16]  Li, X., Xu, J., <span class="insert">Zhang, Z., Feng, D</span>., and H. Hu, "Multiple</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Handshakes Security of TLS 1.3 Candidates", Proceedings of</td><td> </td><td class="right">              Handshakes Security of TLS 1.3 Candidates", Proceedings of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0462" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              IEEE Symposium on Security and Privacy <span class="delete">(Oakland) 2016 ,</span></td><td> </td><td class="rblock">              IEEE Symposium on Security and Privacy <span class="insert">(San Jose),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2016, <span class="delete">&lt;http://ieeexplore.ieee.org/document/7546519/&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1109/SP.2016.36, May</span> 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              <span class="insert">&lt;https://ieeexplore.ieee.org/document/7546519/&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0463" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [Mac17]    MacCarthaigh, C., "Security Review of TLS1.3 0-RTT", 2017,</td><td> </td><td class="rblock">   [Mac17]    MacCarthaigh, C., "Security Review of TLS1.3 0-RTT",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">&lt;https://github.com/tlswg/tls13-spec/issues/1001&gt;.</span></td><td> </td><td class="rblock">              <span class="insert">March</span> 2017, <span class="insert">&lt;https://github.com/tlswg/tls13-spec/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              issues/1001&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [PS18]     Patton, C. and T. Shrimpton, "Partially specified</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              channels: The TLS 1.3 record layer without elision", 2018,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://eprint.iacr.org/2018/634&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [PSK-FINISHED]</td><td> </td><td class="right">   [PSK-FINISHED]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0464" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">Cremers, C., Horvat, M., van der Merwe, T., and S. Scott</span>,</td><td> </td><td class="rblock">              <span class="insert">Scott, S., Cremers, C., Horvat, M., and T. van der Merwe</span>,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Revision 10: possible attack if client authentication is</td><td> </td><td class="right">              "Revision 10: possible attack if client authentication is</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0465" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              allowed during PSK", 2015, <span class="delete">&lt;https://www.ietf.org/mail-</span></td><td> </td><td class="rblock">              allowed during PSK", <span class="insert">message to the TLS mailing list,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              archive/web/tls/current/msg18215.html&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              31 October</span> 2015, <span class="insert">&lt;https://www.ietf.org/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              mail-archive/web/tls/current/msg18215.html&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [REKEY]    Abdalla, M. and M. Bellare, "Increasing the Lifetime of a</td><td> </td><td class="right">   [REKEY]    Abdalla, M. and M. Bellare, "Increasing the Lifetime of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Key: A Comparative Analysis of the Security of Re-keying</td><td> </td><td class="right">              Key: A Comparative Analysis of the Security of Re-keying</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0466" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Techniques", <span class="delete">ASIACRYPT2000 ,</span> October 2000.</td><td> </td><td class="rblock">              Techniques", <span class="insert">ASIACRYPT 2000, DOI 10.1007/3-540-44448-3_42,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              October 2000.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Res17a]   Rescorla, E., "Preliminary data on Firefox TLS 1.3</td><td> </td><td class="right">   [Res17a]   Rescorla, E., "Preliminary data on Firefox TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0467" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Middlebox experiment", 2017, <span class="delete">&lt;https://www.ietf.org/mail-</span></td><td> </td><td class="rblock">              Middlebox experiment", <span class="insert">message to the TLS mailing list,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              archive/web/tls/current/msg25091.html&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              5 December</span> 2017, <span class="insert">&lt;https://www.ietf.org/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              mail-archive/web/tls/current/msg25091.html&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Res17b]   Rescorla, E., "More compatibility measurement results",</td><td> </td><td class="right">   [Res17b]   Rescorla, E., "More compatibility measurement results",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0468" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2017, &lt;https://www.ietf.org/mail-archive/web/tls/current/</td><td> </td><td class="rblock">              <span class="insert">message to the TLS mailing list, 22 December</span> 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              &lt;https://www.ietf.org/mail-archive/web/tls/current/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              msg25179.html&gt;.</td><td> </td><td class="right">              msg25179.html&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC3552]  Rescorla, E. and B. Korver, "Guidelines for Writing RFC</td><td> </td><td class="right">   [RFC3552]  Rescorla, E. and B. Korver, "Guidelines for Writing RFC</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Text on Security Considerations", BCP 72, RFC 3552,</td><td> </td><td class="right">              Text on Security Considerations", BCP 72, RFC 3552,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC3552, July 2003,</td><td> </td><td class="right">              DOI 10.17487/RFC3552, July 2003,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc3552&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc3552&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC4086]  Eastlake 3rd, D., Schiller, J., and S. Crocker,</td><td> </td><td class="right">   [RFC4086]  Eastlake 3rd, D., Schiller, J., and S. Crocker,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Randomness Requirements for Security", BCP 106, RFC 4086,</td><td> </td><td class="right">              "Randomness Requirements for Security", BCP 106, RFC 4086,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC4086, June 2005,</td><td> </td><td class="right">              DOI 10.17487/RFC4086, June 2005,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l51" /><small>skipping to change at</small><em> page 117, line 10</em></th><th> </th><th><a name="part-r51" /><small>skipping to change at</small><em> page 117, line 25</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5929]  Altman, J., Williams, N., and L. Zhu, "Channel Bindings</td><td> </td><td class="right">   [RFC5929]  Altman, J., Williams, N., and L. Zhu, "Channel Bindings</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              for TLS", RFC 5929, DOI 10.17487/RFC5929, July 2010,</td><td> </td><td class="right">              for TLS", RFC 5929, DOI 10.17487/RFC5929, July 2010,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc5929&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc5929&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6091]  Mavrogiannopoulos, N. and D. Gillmor, "Using OpenPGP Keys</td><td> </td><td class="right">   [RFC6091]  Mavrogiannopoulos, N. and D. Gillmor, "Using OpenPGP Keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              for Transport Layer Security (TLS) Authentication",</td><td> </td><td class="right">              for Transport Layer Security (TLS) Authentication",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              RFC 6091, DOI 10.17487/RFC6091, February 2011,</td><td> </td><td class="right">              RFC 6091, DOI 10.17487/RFC6091, February 2011,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6091&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6091&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0469" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC6101]  Freier, A., Karlton, P., and P. Kocher, "The Secure</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Sockets Layer (SSL) Protocol Version 3.0", RFC 6101,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC6101, August 2011,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc6101&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6176]  Turner, S. and T. Polk, "Prohibiting Secure Sockets Layer</td><td> </td><td class="right">   [RFC6176]  Turner, S. and T. Polk, "Prohibiting Secure Sockets Layer</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0470" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              (SSL) Version 2.0", RFC 6176, DOI 10.17487/RFC6176, March</td><td> </td><td class="rblock">              (SSL) Version 2.0", RFC 6176, DOI 10.17487/RFC6176,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              2011, &lt;https://www.rfc-editor.org/info/rfc6176&gt;.</td><td> </td><td class="rblock">              March 2011, &lt;https://www.rfc-editor.org/info/rfc6176&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6347]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer</td><td> </td><td class="right">   [RFC6347]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Security Version 1.2", RFC 6347, DOI 10.17487/RFC6347,</td><td> </td><td class="right">              Security Version 1.2", RFC 6347, DOI 10.17487/RFC6347,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              January 2012, &lt;https://www.rfc-editor.org/info/rfc6347&gt;.</td><td> </td><td class="right">              January 2012, &lt;https://www.rfc-editor.org/info/rfc6347&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6520]  Seggelmann, R., Tuexen, M., and M. Williams, "Transport</td><td> </td><td class="right">   [RFC6520]  Seggelmann, R., Tuexen, M., and M. Williams, "Transport</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Layer Security (TLS) and Datagram Transport Layer Security</td><td> </td><td class="right">              Layer Security (TLS) and Datagram Transport Layer Security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              (DTLS) Heartbeat Extension", RFC 6520,</td><td> </td><td class="right">              (DTLS) Heartbeat Extension", RFC 6520,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC6520, February 2012,</td><td> </td><td class="right">              DOI 10.17487/RFC6520, February 2012,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6520&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6520&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l52" /><small>skipping to change at</small><em> page 118, line 15</em></th><th> </th><th><a name="part-r52" /><small>skipping to change at</small><em> page 118, line 40</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC7924]  Santesson, S. and H. Tschofenig, "Transport Layer Security</td><td> </td><td class="right">   [RFC7924]  Santesson, S. and H. Tschofenig, "Transport Layer Security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              (TLS) Cached Information Extension", RFC 7924,</td><td> </td><td class="right">              (TLS) Cached Information Extension", RFC 7924,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC7924, July 2016,</td><td> </td><td class="right">              DOI 10.17487/RFC7924, July 2016,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc7924&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc7924&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC8305]  Schinazi, D. and T. Pauly, "Happy Eyeballs Version 2:</td><td> </td><td class="right">   [RFC8305]  Schinazi, D. and T. Pauly, "Happy Eyeballs Version 2:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Better Connectivity Using Concurrency", RFC 8305,</td><td> </td><td class="right">              Better Connectivity Using Concurrency", RFC 8305,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC8305, December 2017,</td><td> </td><td class="right">              DOI 10.17487/RFC8305, December 2017,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8305&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8305&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0471" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC8422]  Nir, Y., Josefsson, S., and M. Pegourie-Gonnard, "Elliptic</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Curve Cryptography (ECC) Cipher Suites for Transport Layer</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Security (TLS) Versions 1.2 and Earlier", RFC 8422,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC8422, August 2018,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc8422&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [RFC8447]  Salowey, J. and S. Turner, "IANA Registry Updates for TLS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              and DTLS", RFC 8447, DOI 10.17487/RFC8447, August 2018,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc8447&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [RFC8449]  Thomson, M., "Record Size Limit Extension for TLS",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              RFC 8449, DOI 10.17487/RFC8449, August 2018,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc8449&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RSA]      Rivest, R., Shamir, A., and L. Adleman, "A Method for</td><td> </td><td class="right">   [RSA]      Rivest, R., Shamir, A., and L. Adleman, "A Method for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Obtaining Digital Signatures and Public-Key</td><td> </td><td class="right">              Obtaining Digital Signatures and Public-Key</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0472" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Cryptosystems", Communications of the <span class="delete">ACM v. 21, n.</span> 2, pp.</td><td> </td><td class="rblock">              Cryptosystems", Communications of the <span class="insert">ACM, Vol. 21 No.</span> 2,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">120-126.,</span> February 1978.</td><td> </td><td class="rblock">              pp. <span class="insert">120-126, DOI 10.1145/359340.359342,</span> February 1978.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0473" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [SIGMA]    Krawczyk, H., "SIGMA: <span class="delete">the</span> 'SIGn-and-MAc' <span class="delete">approach</span> to</td><td> </td><td class="rblock">   [SIGMA]    Krawczyk, H., "SIGMA: <span class="insert">The</span> 'SIGn-and-MAc' <span class="insert">Approach</span> to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">authenticated</span> Diffie-Hellman and its <span class="delete">use</span> in the IKE</td><td> </td><td class="rblock">              <span class="insert">Authenticated</span> Diffie-Hellman and its <span class="insert">Use</span> in the IKE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">protocols",</span> Proceedings of CRYPTO <span class="delete">2003 ,</span> 2003.</td><td> </td><td class="rblock">              <span class="insert">Protocols",</span> Proceedings of CRYPTO <span class="insert">2003,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.1007/978-3-540-45146-4_24, August</span> 2003.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [SLOTH]    Bhargavan, K. and G. Leurent, "Transcript Collision</td><td> </td><td class="right">   [SLOTH]    Bhargavan, K. and G. Leurent, "Transcript Collision</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Attacks: Breaking Authentication in TLS, IKE, and SSH",</td><td> </td><td class="right">              Attacks: Breaking Authentication in TLS, IKE, and SSH",</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0474" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Network and Distributed System Security Symposium (NDSS</td><td> </td><td class="rblock">              Network and Distributed System Security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">2016) ,</span> 2016.</td><td> </td><td class="rblock">              Symposium (NDSS <span class="insert">2016), DOI 10.14722/ndss.2016.23418,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              February</span> 2016.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [SSL2]     Hickman, K., "The SSL Protocol", February 1995.</td><td> </td><td class="right">   [SSL2]     Hickman, K., "The SSL Protocol", February 1995.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0475" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[SSL3]     Freier, A., Karlton, P., and P. Kocher, "The SSL 3.0</span></td><td> </td><td class="rblock">   [TIMING]   Boneh, D. and D. Brumley, "Remote <span class="insert">Timing Attacks Are</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              Protocol", November 1996.</span></td><td> </td><td class="rblock"><span class="insert">              Practical",</span> USENIX Security Symposium, <span class="insert">August</span> 2003.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [TIMING]   Boneh, D. and D. Brumley, "Remote <span class="delete">timing attacks are</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              practical",</span> USENIX Security Symposium, 2003.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[X501]     "Information Technology - Open Systems Interconnection -</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              The Directory: Models", ITU-T X.501, 1993.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">12.3.  URIs</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [1] mailto:tls@ietf.org</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0476" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[2] https://www.ietf.org/mailman/listinfo/tls</span></td><td> </td><td class="rblock">   <span class="insert">[TLS13-TRACES]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Thomson, M., "Example Handshake Traces for TLS 1.3", Work</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              in Progress, draft-ietf-tls-tls13-vectors-06, July 2018.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0477" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[3] https://www.ietf.org/mail-archive/web/tls/current/index.html</span></td><td> </td><td class="rblock">   <span class="insert">[X501]     ITU-T, "Information Technology - Open Systems</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Interconnection - The Directory: Models", ITU-T X.501,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              October 2016, &lt;https://www.itu.int/rec/T-REC-X.501/en&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix A.  State Machine</td><td> </td><td class="right">Appendix A.  State Machine</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0478" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This <span class="delete">section</span> provides a summary of the legal state transitions for</td><td> </td><td class="rblock">   This <span class="insert">appendix</span> provides a summary of the legal state transitions for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client and server handshakes.  State names (in all capitals,</td><td> </td><td class="right">   the client and server handshakes.  State names (in all capitals,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   e.g., START) have no formal meaning but are provided for ease of</td><td> </td><td class="right">   e.g., START) have no formal meaning but are provided for ease of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   comprehension.  Actions which are taken only in certain circumstances</td><td> </td><td class="right">   comprehension.  Actions which are taken only in certain circumstances</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are indicated in [].  The notation "K_{send,recv} = foo" means "set</td><td> </td><td class="right">   are indicated in [].  The notation "K_{send,recv} = foo" means "set</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the send/recv key to the given key".</td><td> </td><td class="right">   the send/recv key to the given key".</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">A.1.  Client</td><td> </td><td class="right">A.1.  Client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                              START &lt;----+</td><td> </td><td class="right">                              START &lt;----+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Send ClientHello |        | Recv HelloRetryRequest</td><td> </td><td class="right">               Send ClientHello |        | Recv HelloRetryRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l53" /><small>skipping to change at</small><em> page 120, line 50</em></th><th> </th><th><a name="part-r53" /><small>skipping to change at</small><em> page 122, line 7</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       |             |       | Recv</td><td> </td><td class="right">                       |             |       | Recv</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       |             v       | CertificateVerify</td><td> </td><td class="right">                       |             v       | CertificateVerify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       +-&gt; WAIT_FINISHED &lt;---+</td><td> </td><td class="right">                       +-&gt; WAIT_FINISHED &lt;---+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                | Recv Finished</td><td> </td><td class="right">                                | Recv Finished</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                | K_recv = application</td><td> </td><td class="right">                                | K_recv = application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                v</td><td> </td><td class="right">                                v</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                            CONNECTED</td><td> </td><td class="right">                            CONNECTED</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix B.  Protocol Data Structures and Constant Values</td><td> </td><td class="right">Appendix B.  Protocol Data Structures and Constant Values</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0479" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This <span class="delete">section</span> provides the normative protocol types and <span class="delete">constants</span></td><td> </td><td class="rblock">   This <span class="insert">appendix</span> provides the normative protocol types and <span class="insert">the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   definitions.</span>  Values listed as <span class="delete">_RESERVED</span> were used in previous</td><td> </td><td class="rblock"><span class="insert">   definitions for constants.</span>  Values listed as <span class="insert">"_RESERVED"</span> were used in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   versions of TLS and are listed here for completeness.  TLS 1.3</td><td> </td><td class="rblock">   previous versions of TLS and are listed here for completeness.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   implementations MUST NOT send them but might receive them from older</td><td> </td><td class="rblock">   TLS 1.3 implementations MUST NOT send them but might receive them</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS implementations.</td><td> </td><td class="rblock">   from older TLS implementations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">B.1.  Record Layer</td><td> </td><td class="right">B.1.  Record Layer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          invalid(0),</td><td> </td><td class="right">          invalid(0),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          change_cipher_spec(20),</td><td> </td><td class="right">          change_cipher_spec(20),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          alert(21),</td><td> </td><td class="right">          alert(21),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          handshake(22),</td><td> </td><td class="right">          handshake(22),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          application_data(23),</td><td> </td><td class="right">          application_data(23),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0480" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          heartbeat(24),  /* RFC 6520 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (255)</td><td> </td><td class="right">          (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ContentType;</td><td> </td><td class="right">      } ContentType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ContentType type;</td><td> </td><td class="right">          ContentType type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ProtocolVersion legacy_record_version;</td><td> </td><td class="right">          ProtocolVersion legacy_record_version;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint16 length;</td><td> </td><td class="right">          uint16 length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque fragment[TLSPlaintext.length];</td><td> </td><td class="right">          opaque fragment[TLSPlaintext.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } TLSPlaintext;</td><td> </td><td class="right">      } TLSPlaintext;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l54" /><small>skipping to change at</small><em> page 123, line 23</em></th><th> </th><th><a name="part-r54" /><small>skipping to change at</small><em> page 124, line 23</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          end_of_early_data(5),</td><td> </td><td class="right">          end_of_early_data(5),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          hello_retry_request_RESERVED(6),</td><td> </td><td class="right">          hello_retry_request_RESERVED(6),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          encrypted_extensions(8),</td><td> </td><td class="right">          encrypted_extensions(8),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate(11),</td><td> </td><td class="right">          certificate(11),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          server_key_exchange_RESERVED(12),</td><td> </td><td class="right">          server_key_exchange_RESERVED(12),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate_request(13),</td><td> </td><td class="right">          certificate_request(13),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          server_hello_done_RESERVED(14),</td><td> </td><td class="right">          server_hello_done_RESERVED(14),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate_verify(15),</td><td> </td><td class="right">          certificate_verify(15),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          client_key_exchange_RESERVED(16),</td><td> </td><td class="right">          client_key_exchange_RESERVED(16),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          finished(20),</td><td> </td><td class="right">          finished(20),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0481" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">          <span class="insert">certificate_url_RESERVED(21),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          certificate_status_RESERVED(22),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          supplemental_data_RESERVED(23),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          key_update(24),</td><td> </td><td class="right">          key_update(24),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          message_hash(254),</td><td> </td><td class="right">          message_hash(254),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (255)</td><td> </td><td class="right">          (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } HandshakeType;</td><td> </td><td class="right">      } HandshakeType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          HandshakeType msg_type;    /* handshake type */</td><td> </td><td class="right">          HandshakeType msg_type;    /* handshake type */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint24 length;             /* bytes in message */</td><td> </td><td class="right">          uint24 length;             /* bytes in message */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (Handshake.msg_type) {</td><td> </td><td class="right">          select (Handshake.msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case client_hello:          ClientHello;</td><td> </td><td class="right">              case client_hello:          ClientHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l55" /><small>skipping to change at</small><em> page 123, line 47</em></th><th> </th><th><a name="part-r55" /><small>skipping to change at</small><em> page 125, line 7</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate:           Certificate;</td><td> </td><td class="right">              case certificate:           Certificate;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate_verify:    CertificateVerify;</td><td> </td><td class="right">              case certificate_verify:    CertificateVerify;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case finished:              Finished;</td><td> </td><td class="right">              case finished:              Finished;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case new_session_ticket:    NewSessionTicket;</td><td> </td><td class="right">              case new_session_ticket:    NewSessionTicket;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case key_update:            KeyUpdate;</td><td> </td><td class="right">              case key_update:            KeyUpdate;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          };</td><td> </td><td class="right">          };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Handshake;</td><td> </td><td class="right">      } Handshake;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">B.3.1.  Key Exchange Messages</td><td> </td><td class="right">B.3.1.  Key Exchange Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0482" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   uint16 ProtocolVersion;</td><td> </td><td class="rblock">    uint16 ProtocolVersion;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   opaque Random[32];</td><td> </td><td class="rblock">    opaque Random[32];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">uint8 CipherSuite[2];    /* Cryptographic suite selector */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   struct {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ProtocolVersion legacy_version = 0x0303;    /* TLS v1.2 */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Random random;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       opaque legacy_session_id&lt;0..32&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       CipherSuite cipher_suites&lt;2..2^16-2&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       opaque legacy_compression_methods&lt;1..2^8-1&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Extension extensions&lt;8..2^16-1&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   } ClientHello;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0483" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">struct {</span></td><td> </td><td class="rblock">    <span class="insert">uint8 CipherSuite[2];</span>    /* <span class="insert">Cryptographic suite selector</span> */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       ProtocolVersion legacy_version = 0x0303;</span>    /* <span class="delete">TLS v1.2</span> */</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">Random random;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       opaque legacy_session_id_echo&lt;0..32&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       CipherSuite cipher_suite;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       uint8 legacy_compression_method = 0;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       Extension extensions&lt;6..2^16-1&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   } ServerHello;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0484" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">ExtensionType extension_type;</span></td><td> </td><td class="rblock">        <span class="insert">ProtocolVersion legacy_version = 0x0303;    /* TLS v1.2 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       opaque <span class="delete">extension_data&lt;0..2^16-1&gt;;</span></td><td> </td><td class="rblock"><span class="insert">        Random random;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } <span class="delete">Extension;</span></td><td> </td><td class="rblock">        opaque <span class="insert">legacy_session_id&lt;0..32&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        CipherSuite cipher_suites&lt;2..2^16-2&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        opaque legacy_compression_methods&lt;1..2^8-1&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        Extension extensions&lt;8..2^16-1&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">    } <span class="insert">ClientHello;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0485" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">enum</span> {</td><td> </td><td class="rblock">    <span class="insert">struct</span> {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">server_name(0),                             /* RFC 6066 */</span></td><td> </td><td class="rblock">        <span class="insert">ProtocolVersion legacy_version = 0x0303;    /* TLS v1.2 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       max_fragment_length(1),                     /* RFC 6066 */</span></td><td> </td><td class="rblock"><span class="insert">        Random random;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       status_request(5),                          /* RFC 6066 */</span></td><td> </td><td class="rblock"><span class="insert">        opaque legacy_session_id_echo&lt;0..32&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       supported_groups(10),                       /* RFC 4492, 7919 */</span></td><td> </td><td class="rblock"><span class="insert">        CipherSuite cipher_suite;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       signature_algorithms(13),                   /* [[this document]] */</span></td><td> </td><td class="rblock"><span class="insert">        uint8 legacy_compression_method = 0;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       use_srtp(14),                               /* RFC 5764 */</span></td><td> </td><td class="rblock"><span class="insert">        Extension extensions&lt;6..2^16-1&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       heartbeat(15),                              /* RFC 6520 */</span></td><td> </td><td class="rblock"><span class="insert">    } ServerHello;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       application_layer_protocol_negotiation(16), /* RFC 7301 */</span></td><td> </td><td class="rblock"><span class="insert">    struct {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       signed_certificate_timestamp(18),           /* RFC 6962 */</span></td><td> </td><td class="rblock"><span class="insert">        ExtensionType extension_type;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       client_certificate_type(19),                /* RFC 7250 */</span></td><td> </td><td class="rblock"><span class="insert">        opaque extension_data&lt;0..2^16-1&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       server_certificate_type(20),                /* RFC 7250 */</span></td><td> </td><td class="rblock"><span class="insert">    } Extension;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       padding(21),                                /* RFC 7685 */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       RESERVED(40),                               /* Used but never assigned */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       pre_shared_key(41),                         /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       early_data(42),                             /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       supported_versions(43),                     /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       cookie(44),                                 /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       psk_key_exchange_modes(45),                 /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       RESERVED(46),                               /* Used but never assigned */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       certificate_authorities(47),                /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       oid_filters(48),                            /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       post_handshake_auth(49),                    /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       signature_algorithms_cert(50),              /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       key_share(51),                              /* [[this document]] */</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       (65535)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0486" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } ExtensionType;</td><td> </td><td class="rblock">    <span class="insert">enum {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        server_name(0),                             /* RFC 6066 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        max_fragment_length(1),                     /* RFC 6066 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        status_request(5),                          /* RFC 6066 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        supported_groups(10),                       /* RFC 8422, 7919 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        signature_algorithms(13),                   /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        use_srtp(14),                               /* RFC 5764 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        heartbeat(15),                              /* RFC 6520 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        application_layer_protocol_negotiation(16), /* RFC 7301 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        signed_certificate_timestamp(18),           /* RFC 6962 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        client_certificate_type(19),                /* RFC 7250 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        server_certificate_type(20),                /* RFC 7250 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        padding(21),                                /* RFC 7685 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        RESERVED(40),                               /* Used but never</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                       assigned */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        pre_shared_key(41),                         /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        early_data(42),                             /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        supported_versions(43),                     /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        cookie(44),                                 /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        psk_key_exchange_modes(45),                 /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        RESERVED(46),                               /* Used but never</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                       assigned */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        certificate_authorities(47),                /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        oid_filters(48),                            /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        post_handshake_auth(49),                    /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        signature_algorithms_cert(50),              /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        key_share(51),                              /* RFC 8446 */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        (65535)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">    } ExtensionType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0487" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       NamedGroup group;</td><td> </td><td class="rblock">        NamedGroup group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       opaque key_exchange&lt;1..2^16-1&gt;;</td><td> </td><td class="rblock">        opaque key_exchange&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } KeyShareEntry;</td><td> </td><td class="rblock">    } KeyShareEntry;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0488" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       KeyShareEntry client_shares&lt;0..2^16-1&gt;;</td><td> </td><td class="rblock">        KeyShareEntry client_shares&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } KeyShareClientHello;</td><td> </td><td class="rblock">    } KeyShareClientHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0489" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       NamedGroup selected_group;</td><td> </td><td class="rblock">        NamedGroup selected_group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } KeyShareHelloRetryRequest;</td><td> </td><td class="rblock">    } KeyShareHelloRetryRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">    <span class="insert">struct {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        KeyShareEntry server_share;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    } KeyShareServerHello;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0490" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">KeyShareEntry server_share;</span></td><td> </td><td class="rblock">        <span class="insert">uint8 legacy_form = 4;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } <span class="delete">KeyShareServerHello;</span></td><td> </td><td class="rblock"><span class="insert">        opaque X[coordinate_length];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        opaque Y[coordinate_length];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">    } <span class="insert">UncompressedPointRepresentation;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0491" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">struct</span> {</td><td> </td><td class="rblock">    <span class="insert">enum</span> { <span class="insert">psk_ke(0), psk_dhe_ke(1), (255)</span> } <span class="insert">PskKeyExchangeMode;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">uint8 legacy_form = 4;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       opaque X[coordinate_length];</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       opaque Y[coordinate_length];</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } <span class="delete">UncompressedPointRepresentation;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0492" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">enum</span> { <span class="delete">psk_ke(0), psk_dhe_ke(1), (255)</span> } <span class="delete">PskKeyExchangeMode;</span></td><td> </td><td class="rblock">    <span class="insert">struct</span> {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">        <span class="insert">PskKeyExchangeMode ke_modes&lt;1..255&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">    } <span class="insert">PskKeyExchangeModes;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0493" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct <span class="delete">{</span></td><td> </td><td class="rblock">    struct <span class="insert">{} Empty;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       PskKeyExchangeMode ke_modes&lt;1..255&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   } PskKeyExchangeModes;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0494" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct <span class="delete">{}</span> Empty;</td><td> </td><td class="rblock">    struct <span class="insert">{</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        select (Handshake.msg_type) {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">            case new_session_ticket:   uint32 max_early_data_size;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">            case client_hello:</span>         Empty;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">            <span class="insert">case encrypted_extensions: Empty;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        };</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    } EarlyDataIndication;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0495" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">select (Handshake.msg_type) {</span></td><td> </td><td class="rblock">        <span class="insert">opaque identity&lt;1..2^16-1&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">           case new_session_ticket:</span>   uint32 <span class="delete">max_early_data_size;</span></td><td> </td><td class="rblock">        uint32 <span class="insert">obfuscated_ticket_age;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">           case client_hello:         Empty;</span></td><td> </td><td class="rblock">    } <span class="insert">PskIdentity;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">           case encrypted_extensions: Empty;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       };</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } <span class="delete">EarlyDataIndication;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0496" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">struct {</span></td><td> </td><td class="rblock">    opaque <span class="insert">PskBinderEntry&lt;32..255&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       opaque <span class="delete">identity&lt;1..2^16-1&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       uint32 obfuscated_ticket_age;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   } PskIdentity;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0497" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">opaque PskBinderEntry&lt;32..255&gt;;</span></td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">        PskIdentity identities&lt;7..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       PskIdentity identities&lt;7..2^16-1&gt;;</td><td> </td><td class="rblock">        PskBinderEntry binders&lt;33..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       PskBinderEntry binders&lt;33..2^16-1&gt;;</td><td> </td><td class="rblock">    } OfferedPsks;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } OfferedPsks;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0498" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   struct {</td><td> </td><td class="rblock">    struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       select (Handshake.msg_type) {</td><td> </td><td class="rblock">        select (Handshake.msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           case client_hello: OfferedPsks;</td><td> </td><td class="rblock">            case client_hello: OfferedPsks;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           case server_hello: uint16 selected_identity;</td><td> </td><td class="rblock">            case server_hello: uint16 selected_identity;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       };</td><td> </td><td class="rblock">        };</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   } PreSharedKeyExtension;</td><td> </td><td class="rblock">    } PreSharedKeyExtension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">B.3.1.1.  Version Extension</td><td> </td><td class="right">B.3.1.1.  Version Extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (Handshake.msg_type) {</td><td> </td><td class="right">          select (Handshake.msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case client_hello:</td><td> </td><td class="right">              case client_hello:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                   ProtocolVersion versions&lt;2..254&gt;;</td><td> </td><td class="right">                   ProtocolVersion versions&lt;2..254&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case server_hello: /* and HelloRetryRequest */</td><td> </td><td class="right">              case server_hello: /* and HelloRetryRequest */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                   ProtocolVersion selected_version;</td><td> </td><td class="right">                   ProtocolVersion selected_version;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l56" /><small>skipping to change at</small><em> page 130, line 4</em></th><th> </th><th><a name="part-r56" /><small>skipping to change at</small><em> page 132, line 6</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } EncryptedExtensions;</td><td> </td><td class="right">      } EncryptedExtensions;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque certificate_request_context&lt;0..2^8-1&gt;;</td><td> </td><td class="right">          opaque certificate_request_context&lt;0..2^8-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;2..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;2..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateRequest;</td><td> </td><td class="right">      } CertificateRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">B.3.3.  Authentication Messages</td><td> </td><td class="right">B.3.3.  Authentication Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0499" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">/* Managed by IANA */</span></td><td> </td><td class="rblock">      <span class="insert">                                                                   </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          X509(0),</td><td> </td><td class="right">          X509(0),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          OpenPGP_RESERVED(1),</td><td> </td><td class="right">          OpenPGP_RESERVED(1),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          RawPublicKey(2),</td><td> </td><td class="right">          RawPublicKey(2),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (255)</td><td> </td><td class="right">          (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateType;</td><td> </td><td class="right">      } CertificateType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (certificate_type) {</td><td> </td><td class="right">          select (certificate_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case RawPublicKey:</td><td> </td><td class="right">              case RawPublicKey:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l57" /><small>skipping to change at</small><em> page 131, line 34</em></th><th> </th><th><a name="part-r57" /><small>skipping to change at</small><em> page 133, line 34</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      +-----------+------------------------------------------------+</td><td> </td><td class="right">      +-----------+------------------------------------------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      | Component | Contents                                       |</td><td> </td><td class="right">      | Component | Contents                                       |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      +-----------+------------------------------------------------+</td><td> </td><td class="right">      +-----------+------------------------------------------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      | TLS       | The string "TLS"                               |</td><td> </td><td class="right">      | TLS       | The string "TLS"                               |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      |           |                                                |</td><td> </td><td class="right">      |           |                                                |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      | AEAD      | The AEAD algorithm used for record protection  |</td><td> </td><td class="right">      | AEAD      | The AEAD algorithm used for record protection  |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      |           |                                                |</td><td> </td><td class="right">      |           |                                                |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      | HASH      | The hash algorithm used with HKDF              |</td><td> </td><td class="right">      | HASH      | The hash algorithm used with HKDF              |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      |           |                                                |</td><td> </td><td class="right">      |           |                                                |</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0500" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      | VALUE     | The two<span class="delete"> </span>byte ID assigned for this cipher suite |</td><td> </td><td class="rblock">      | VALUE     | The two<span class="insert">-</span>byte ID assigned for this cipher suite |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      +-----------+------------------------------------------------+</td><td> </td><td class="right">      +-----------+------------------------------------------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This specification defines the following cipher suites for use with</td><td> </td><td class="right">   This specification defines the following cipher suites for use with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3.</td><td> </td><td class="right">   TLS 1.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              +------------------------------+-------------+</td><td> </td><td class="right">              +------------------------------+-------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              | Description                  | Value       |</td><td> </td><td class="right">              | Description                  | Value       |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              +------------------------------+-------------+</td><td> </td><td class="right">              +------------------------------+-------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              | TLS_AES_128_GCM_SHA256       | {0x13,0x01} |</td><td> </td><td class="right">              | TLS_AES_128_GCM_SHA256       | {0x13,0x01} |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              |                              |             |</td><td> </td><td class="right">              |                              |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l58" /><small>skipping to change at</small><em> page 132, line 7</em></th><th> </th><th><a name="part-r58" /><small>skipping to change at</small><em> page 134, line 7</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              |                              |             |</td><td> </td><td class="right">              |                              |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              | TLS_CHACHA20_POLY1305_SHA256 | {0x13,0x03} |</td><td> </td><td class="right">              | TLS_CHACHA20_POLY1305_SHA256 | {0x13,0x03} |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              |                              |             |</td><td> </td><td class="right">              |                              |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              | TLS_AES_128_CCM_SHA256       | {0x13,0x04} |</td><td> </td><td class="right">              | TLS_AES_128_CCM_SHA256       | {0x13,0x04} |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              |                              |             |</td><td> </td><td class="right">              |                              |             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              | TLS_AES_128_CCM_8_SHA256     | {0x13,0x05} |</td><td> </td><td class="right">              | TLS_AES_128_CCM_8_SHA256     | {0x13,0x05} |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              +------------------------------+-------------+</td><td> </td><td class="right">              +------------------------------+-------------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The corresponding AEAD algorithms AEAD_AES_128_GCM, AEAD_AES_256_GCM,</td><td> </td><td class="right">   The corresponding AEAD algorithms AEAD_AES_128_GCM, AEAD_AES_256_GCM,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and AEAD_AES_128_CCM are defined in [RFC5116].</td><td> </td><td class="right">   and AEAD_AES_128_CCM are defined in [RFC5116].</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0501" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   AEAD_CHACHA20_POLY1305 is defined in [RFC<span class="delete">75</span>39].  AEAD_AES_128_CCM_8</td><td> </td><td class="rblock">   AEAD_CHACHA20_POLY1305 is defined in [RFC<span class="insert">84</span>39].  AEAD_AES_128_CCM_8</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is defined in [RFC6655].  The corresponding hash algorithms are</td><td> </td><td class="right">   is defined in [RFC6655].  The corresponding hash algorithms are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   defined in [SHS].</td><td> </td><td class="right">   defined in [SHS].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Although TLS 1.3 uses the same cipher suite space as previous</td><td> </td><td class="right">   Although TLS 1.3 uses the same cipher suite space as previous</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   versions of TLS, TLS 1.3 cipher suites are defined differently, only</td><td> </td><td class="right">   versions of TLS, TLS 1.3 cipher suites are defined differently, only</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specifying the symmetric ciphers, and cannot be used for TLS 1.2.</td><td> </td><td class="right">   specifying the symmetric ciphers, and cannot be used for TLS 1.2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0502" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Similarly, TLS 1.2 and lower <span class="delete">cipher suites</span> cannot be used with TLS</td><td> </td><td class="rblock">   Similarly, <span class="insert">cipher suites for</span> TLS 1.2 and lower cannot be used with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3.</td><td> </td><td class="rblock">   TLS 1.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New cipher suite values are assigned by IANA as described in</td><td> </td><td class="right">   New cipher suite values are assigned by IANA as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 11.</td><td> </td><td class="right">   Section 11.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix C.  Implementation Notes</td><td> </td><td class="right">Appendix C.  Implementation Notes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS protocol cannot prevent many common security mistakes.  This</td><td> </td><td class="right">   The TLS protocol cannot prevent many common security mistakes.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0503" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">section</span> provides several recommendations to assist implementors.</td><td> </td><td class="rblock">   <span class="insert">appendix</span> provides several recommendations to assist implementors.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">[I-D.ietf-tls-tls13-vectors]</span> provides test vectors for TLS 1.3</td><td> </td><td class="rblock">   <span class="insert">[TLS13-TRACES]</span> provides test vectors for TLS 1.3 handshakes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshakes.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">C.1.  Random Number Generation and Seeding</td><td> </td><td class="right">C.1.  Random Number Generation and Seeding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS requires a cryptographically secure pseudorandom number generator</td><td> </td><td class="right">   TLS requires a cryptographically secure pseudorandom number generator</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (CSPRNG).  In most cases, the operating system provides an</td><td> </td><td class="right">   (CSPRNG).  In most cases, the operating system provides an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   appropriate facility such as /dev/urandom, which should be used</td><td> </td><td class="right">   appropriate facility such as /dev/urandom, which should be used</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0504" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   absent other <span class="delete">(performance)</span> concerns.  It is RECOMMENDED to use an</td><td> </td><td class="rblock">   absent other <span class="insert">(e.g., performance)</span> concerns.  It is RECOMMENDED to use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   existing CSPRNG implementation in preference to crafting a new one.</td><td> </td><td class="rblock">   an existing CSPRNG implementation in preference to crafting a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Many adequate cryptographic libraries are already available under</td><td> </td><td class="rblock">   one.  Many adequate cryptographic libraries are already available</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   favorable license terms.  Should those prove unsatisfactory,</td><td> </td><td class="rblock">   under favorable license terms.  Should those prove unsatisfactory,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC4086] provides guidance on the generation of random values.</td><td> </td><td class="right">   [RFC4086] provides guidance on the generation of random values.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0505" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS uses random values <span class="delete">both</span> in public protocol fields such as the</td><td> </td><td class="rblock">   TLS uses random values <span class="insert">(1)</span> in public protocol fields such as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   public Random values in the ClientHello and ServerHello and to</td><td> </td><td class="rblock">   public Random values in the ClientHello and ServerHello and <span class="insert">(2)</span> to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   generate keying material.  With a properly functioning CSPRNG, this</td><td> </td><td class="right">   generate keying material.  With a properly functioning CSPRNG, this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0506" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   does not present a security problem as it is not feasible to</td><td> </td><td class="rblock">   does not present a security problem<span class="insert">,</span> as it is not feasible to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   determine the CSPRNG state from its output.  However, with a broken</td><td> </td><td class="right">   determine the CSPRNG state from its output.  However, with a broken</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CSPRNG, it may be possible for an attacker to use the public output</td><td> </td><td class="right">   CSPRNG, it may be possible for an attacker to use the public output</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to determine the CSPRNG internal state and thereby predict the keying</td><td> </td><td class="right">   to determine the CSPRNG internal state and thereby predict the keying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   material, as documented in [CHECKOWAY].  Implementations can provide</td><td> </td><td class="right">   material, as documented in [CHECKOWAY].  Implementations can provide</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extra security against this form of attack by using separate CSPRNGs</td><td> </td><td class="right">   extra security against this form of attack by using separate CSPRNGs</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to generate public and private values.</td><td> </td><td class="right">   to generate public and private values.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">C.2.  Certificates and Authentication</td><td> </td><td class="right">C.2.  Certificates and Authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations are responsible for verifying the integrity of</td><td> </td><td class="right">   Implementations are responsible for verifying the integrity of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates and should generally support certificate revocation</td><td> </td><td class="right">   certificates and should generally support certificate revocation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages.  Absent a specific indication from an application profile,</td><td> </td><td class="right">   messages.  Absent a specific indication from an application profile,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0507" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Certificates</span> should always be verified to ensure proper signing by a</td><td> </td><td class="rblock">   <span class="insert">certificates</span> should always be verified to ensure proper signing by a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   trusted <span class="delete">Certificate Authority</span> (CA).  The selection and addition of</td><td> </td><td class="rblock">   trusted <span class="insert">certificate authority</span> (CA).  The selection and addition of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   trust anchors should be done very carefully.  Users should be able to</td><td> </td><td class="right">   trust anchors should be done very carefully.  Users should be able to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   view information about the certificate and trust anchor.</td><td> </td><td class="right">   view information about the certificate and trust anchor.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Applications SHOULD also enforce minimum and maximum key sizes.  For</td><td> </td><td class="right">   Applications SHOULD also enforce minimum and maximum key sizes.  For</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   example, certification paths containing keys or signatures weaker</td><td> </td><td class="right">   example, certification paths containing keys or signatures weaker</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   than 2048-bit RSA or 224-bit ECDSA are not appropriate for secure</td><td> </td><td class="right">   than 2048-bit RSA or 224-bit ECDSA are not appropriate for secure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   applications.</td><td> </td><td class="right">   applications.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">C.3.  Implementation Pitfalls</td><td> </td><td class="right">C.3.  Implementation Pitfalls</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementation experience has shown that certain parts of earlier TLS</td><td> </td><td class="right">   Implementation experience has shown that certain parts of earlier TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specifications are not easy to understand and have been a source of</td><td> </td><td class="right">   specifications are not easy to understand and have been a source of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   interoperability and security problems.  Many of these areas have</td><td> </td><td class="right">   interoperability and security problems.  Many of these areas have</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0508" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   been clarified in this document but this appendix contains a short</td><td> </td><td class="rblock">   been clarified in this document<span class="insert">,</span> but this appendix contains a short</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   list of the most important things that require special attention from</td><td> </td><td class="right">   list of the most important things that require special attention from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementors.</td><td> </td><td class="right">   implementors.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS protocol issues:</td><td> </td><td class="right">   TLS protocol issues:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you correctly handle handshake messages that are fragmented to</td><td> </td><td class="right">   -  Do you correctly handle handshake messages that are fragmented to</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0509" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      multiple TLS records (see Section 5.1)?  <span class="delete">Including</span> corner cases</td><td> </td><td class="rblock">      multiple TLS records (see Section 5.1)?  <span class="insert">Do you correctly handle</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      like a ClientHello that is split <span class="delete">to</span> several small fragments?  Do</td><td> </td><td class="rblock">      corner cases like a ClientHello that is split <span class="insert">into</span> several small</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      you fragment handshake messages that exceed the maximum fragment</td><td> </td><td class="rblock">      fragments?  Do you fragment handshake messages that exceed the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      size?  In particular, the Certificate and CertificateRequest</td><td> </td><td class="rblock">      maximum fragment size?  In particular, the Certificate and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      handshake messages can be large enough to require fragmentation.</td><td> </td><td class="rblock">      CertificateRequest handshake messages can be large enough to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      require fragmentation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you ignore the TLS record layer version number in all</td><td> </td><td class="right">   -  Do you ignore the TLS record layer version number in all</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0510" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      unencrypted TLS records<span class="delete">? (see Appendix D)</span></td><td> </td><td class="rblock">      unencrypted TLS records<span class="insert"> (see Appendix D)?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Have you ensured that all support for SSL, RC4, EXPORT ciphers,</td><td> </td><td class="right">   -  Have you ensured that all support for SSL, RC4, EXPORT ciphers,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and MD5 (via the "signature_algorithms" extension) is completely</td><td> </td><td class="right">      and MD5 (via the "signature_algorithms" extension) is completely</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      removed from all possible configurations that support TLS 1.3 or</td><td> </td><td class="right">      removed from all possible configurations that support TLS 1.3 or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      later, and that attempts to use these obsolete capabilities fail</td><td> </td><td class="right">      later, and that attempts to use these obsolete capabilities fail</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0511" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      correctly<span class="delete">? (see Appendix D)</span></td><td> </td><td class="rblock">      correctly<span class="insert"> (see Appendix D)?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0512" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Do you handle TLS extensions in ClientHello correctly, including</td><td> </td><td class="rblock">   -  Do you handle TLS extensions in ClientHello<span class="insert">s</span> correctly, including</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      unknown extensions?</td><td> </td><td class="right">      unknown extensions?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0513" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  When the server has requested a client <span class="delete">certificate,</span> but no</td><td> </td><td class="rblock">   -  When the server has requested a client <span class="insert">certificate</span> but no suitable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      suitable certificate is available, do you correctly send an empty</td><td> </td><td class="rblock">      certificate is available, do you correctly send an empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificate message, instead of omitting the whole message (see</td><td> </td><td class="right">      Certificate message, instead of omitting the whole message (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0514" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Section 4.4.2<span class="delete">.3</span>)?</td><td> </td><td class="rblock">      Section 4.4.2)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When processing the plaintext fragment produced by AEAD-Decrypt</td><td> </td><td class="right">   -  When processing the plaintext fragment produced by AEAD-Decrypt</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and scanning from the end for the ContentType, do you avoid</td><td> </td><td class="right">      and scanning from the end for the ContentType, do you avoid</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      scanning past the start of the cleartext in the event that the</td><td> </td><td class="right">      scanning past the start of the cleartext in the event that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0515" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      peer has sent a malformed plaintext of all<span class="delete">-</span>zeros?</td><td> </td><td class="rblock">      peer has sent a malformed plaintext of all<span class="insert"> </span>zeros?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you properly ignore unrecognized cipher suites (Section 4.1.2),</td><td> </td><td class="right">   -  Do you properly ignore unrecognized cipher suites (Section 4.1.2),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      hello extensions (Section 4.2), named groups (Section 4.2.7), key</td><td> </td><td class="right">      hello extensions (Section 4.2), named groups (Section 4.2.7), key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      shares (Section 4.2.8), supported versions (Section 4.2.1), and</td><td> </td><td class="right">      shares (Section 4.2.8), supported versions (Section 4.2.1), and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      signature algorithms (Section 4.2.3) in the ClientHello?</td><td> </td><td class="right">      signature algorithms (Section 4.2.3) in the ClientHello?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  As a server, do you send a HelloRetryRequest to clients which</td><td> </td><td class="right">   -  As a server, do you send a HelloRetryRequest to clients which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      support a compatible (EC)DHE group but do not predict it in the</td><td> </td><td class="right">      support a compatible (EC)DHE group but do not predict it in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "key_share" extension?  As a client, do you correctly handle a</td><td> </td><td class="right">      "key_share" extension?  As a client, do you correctly handle a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      HelloRetryRequest from the server?</td><td> </td><td class="right">      HelloRetryRequest from the server?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Cryptographic details:</td><td> </td><td class="right">   Cryptographic details:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  What countermeasures do you use to prevent timing attacks</td><td> </td><td class="right">   -  What countermeasures do you use to prevent timing attacks</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [TIMING]?</td><td> </td><td class="right">      [TIMING]?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When using Diffie-Hellman key exchange, do you correctly preserve</td><td> </td><td class="right">   -  When using Diffie-Hellman key exchange, do you correctly preserve</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      leading zero bytes in the negotiated key (see Section 7.4.1)?</td><td> </td><td class="right">      leading zero bytes in the negotiated key (see Section 7.4.1)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Does your TLS client check that the Diffie-Hellman parameters sent</td><td> </td><td class="right">   -  Does your TLS client check that the Diffie-Hellman parameters sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0516" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      by the server are acceptable<span class="delete">,</span> (see Section 4.2.8.1)?</td><td> </td><td class="rblock">      by the server are acceptable (see Section 4.2.8.1)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you use a strong and, most importantly, properly seeded random</td><td> </td><td class="right">   -  Do you use a strong and, most importantly, properly seeded random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      number generator (see Appendix C.1) when generating Diffie-Hellman</td><td> </td><td class="right">      number generator (see Appendix C.1) when generating Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      private values, the ECDSA "k" parameter, and other security-</td><td> </td><td class="right">      private values, the ECDSA "k" parameter, and other security-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      critical values?  It is RECOMMENDED that implementations implement</td><td> </td><td class="right">      critical values?  It is RECOMMENDED that implementations implement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "deterministic ECDSA" as specified in [RFC6979].</td><td> </td><td class="right">      "deterministic ECDSA" as specified in [RFC6979].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0517" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Do you zero-pad Diffie-Hellman public key values to the group size</td><td> </td><td class="rblock">   -  Do you zero-pad Diffie-Hellman public key values <span class="insert">and shared</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (see Section <span class="delete">4.2.8.1)?</span></td><td> </td><td class="rblock"><span class="insert">      secrets</span> to the group size (see Section <span class="insert">4.2.8.1 and Section 7.4.1)?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0518" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Do you verify signatures after making <span class="delete">them</span> to protect against <span class="delete">RSA-</span></td><td> </td><td class="rblock">   -  Do you verify signatures after making <span class="insert">them,</span> to protect against</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      CRT</span> key <span class="delete">leaks?  [FW15]</span></td><td> </td><td class="rblock">      <span class="insert">RSA-CRT</span> key <span class="insert">leaks [FW15]?</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">C.4.  Client Tracking Prevention</td><td> </td><td class="right">C.4.  Client Tracking Prevention</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Clients SHOULD NOT reuse a ticket for multiple connections.  Reuse of</td><td> </td><td class="right">   Clients SHOULD NOT reuse a ticket for multiple connections.  Reuse of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a ticket allows passive observers to correlate different connections.</td><td> </td><td class="right">   a ticket allows passive observers to correlate different connections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers that issue tickets SHOULD offer at least as many tickets as</td><td> </td><td class="right">   Servers that issue tickets SHOULD offer at least as many tickets as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the number of connections that a client might use; for example, a web</td><td> </td><td class="right">   the number of connections that a client might use; for example, a web</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   browser using HTTP/1.1 [RFC7230] might open six connections to a</td><td> </td><td class="right">   browser using HTTP/1.1 [RFC7230] might open six connections to a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server.  Servers SHOULD issue new tickets with every connection.</td><td> </td><td class="right">   server.  Servers SHOULD issue new tickets with every connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This ensures that clients are always able to use a new ticket when</td><td> </td><td class="right">   This ensures that clients are always able to use a new ticket when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l59" /><small>skipping to change at</small><em> page 135, line 23</em></th><th> </th><th><a name="part-r59" /><small>skipping to change at</small><em> page 137, line 34</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Raw public keys [RFC7250].</td><td> </td><td class="right">   -  Raw public keys [RFC7250].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Using a public key contained in a certificate but without</td><td> </td><td class="right">   -  Using a public key contained in a certificate but without</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      validation of the certificate chain or any of its contents.</td><td> </td><td class="right">      validation of the certificate chain or any of its contents.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Either technique used alone is vulnerable to man-in-the-middle</td><td> </td><td class="right">   Either technique used alone is vulnerable to man-in-the-middle</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attacks and therefore unsafe for general use.  However, it is also</td><td> </td><td class="right">   attacks and therefore unsafe for general use.  However, it is also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   possible to bind such connections to an external authentication</td><td> </td><td class="right">   possible to bind such connections to an external authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanism via out-of-band validation of the server's public key,</td><td> </td><td class="right">   mechanism via out-of-band validation of the server's public key,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   trust on first use, or a mechanism such as channel bindings (though</td><td> </td><td class="right">   trust on first use, or a mechanism such as channel bindings (though</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0519" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the channel bindings described in [RFC5929] are not defined for TLS</td><td> </td><td class="rblock">   the channel bindings described in [RFC5929] are not defined for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3).  If no such mechanism is used, then the connection has no</td><td> </td><td class="rblock">   TLS 1.3).  If no such mechanism is used, then the connection has no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   protection against active man-in-the-middle attack; applications MUST</td><td> </td><td class="rblock">   protection against active man-in-the-middle attack; applications</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   NOT use TLS in such a way absent explicit configuration or a specific</td><td> </td><td class="rblock">   MUST NOT use TLS in such a way absent explicit configuration or a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   application profile.</td><td> </td><td class="rblock">   specific application profile.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix D.  Backward Compatibility</td><td> </td><td class="right">Appendix D.  Backward Compatibility</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS protocol provides a built-in mechanism for version</td><td> </td><td class="right">   The TLS protocol provides a built-in mechanism for version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiation between endpoints potentially supporting different</td><td> </td><td class="right">   negotiation between endpoints potentially supporting different</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   versions of TLS.</td><td> </td><td class="right">   versions of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.x and SSL 3.0 use compatible ClientHello messages.  Servers can</td><td> </td><td class="right">   TLS 1.x and SSL 3.0 use compatible ClientHello messages.  Servers can</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   also handle clients trying to use future versions of TLS as long as</td><td> </td><td class="right">   also handle clients trying to use future versions of TLS as long as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the ClientHello format remains compatible and there is at least one</td><td> </td><td class="right">   the ClientHello format remains compatible and there is at least one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protocol version supported by both the client and the server.</td><td> </td><td class="right">   protocol version supported by both the client and the server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Prior versions of TLS used the record layer version number</td><td> </td><td class="right">   Prior versions of TLS used the record layer version number</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (TLSPlaintext.legacy_record_version and</td><td> </td><td class="right">   (TLSPlaintext.legacy_record_version and</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0520" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLSCiphertext.legacy_record_version) for various purposes.  As of TLS</td><td> </td><td class="rblock">   TLSCiphertext.legacy_record_version) for various purposes.  As of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.3, this field is deprecated.  The value of</td><td> </td><td class="rblock">   TLS 1.3, this field is deprecated.  The value of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSPlaintext.legacy_record_version MUST be ignored by all</td><td> </td><td class="right">   TLSPlaintext.legacy_record_version MUST be ignored by all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementations.  The value of TLSCiphertext.legacy_record_version is</td><td> </td><td class="right">   implementations.  The value of TLSCiphertext.legacy_record_version is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   included in the additional data for deprotection but MAY otherwise be</td><td> </td><td class="right">   included in the additional data for deprotection but MAY otherwise be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ignored or MAY be validated to match the fixed constant value.</td><td> </td><td class="right">   ignored or MAY be validated to match the fixed constant value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Version negotiation is performed using only the handshake versions</td><td> </td><td class="right">   Version negotiation is performed using only the handshake versions</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0521" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">(ClientHello.legacy_version,</span> ServerHello.legacy_version, as well as</td><td> </td><td class="rblock">   <span class="insert">(ClientHello.legacy_version and</span> ServerHello.legacy_version, as well</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the ClientHello, <span class="delete">HelloRetryRequest</span> and ServerHello</td><td> </td><td class="rblock">   as the ClientHello, <span class="insert">HelloRetryRequest,</span> and ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "supported_versions" extensions).  In order to maximize</td><td> </td><td class="right">   "supported_versions" extensions).  In order to maximize</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   interoperability with older endpoints, implementations that negotiate</td><td> </td><td class="right">   interoperability with older endpoints, implementations that negotiate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the use of TLS 1.0-1.2 SHOULD set the record layer version number to</td><td> </td><td class="right">   the use of TLS 1.0-1.2 SHOULD set the record layer version number to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the negotiated version for the ServerHello and all records</td><td> </td><td class="right">   the negotiated version for the ServerHello and all records</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   thereafter.</td><td> </td><td class="right">   thereafter.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For maximum compatibility with previously non-standard behavior and</td><td> </td><td class="right">   For maximum compatibility with previously non-standard behavior and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   misconfigured deployments, all implementations SHOULD support</td><td> </td><td class="right">   misconfigured deployments, all implementations SHOULD support</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   validation of certification paths based on the expectations in this</td><td> </td><td class="right">   validation of certification paths based on the expectations in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0522" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   document, even when handling prior TLS versions' <span class="delete">handshakes.</span> (see</td><td> </td><td class="rblock">   document, even when handling prior TLS versions' <span class="insert">handshakes</span> (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Section <span class="delete">4.4.2.2)</span></td><td> </td><td class="rblock">   Section <span class="insert">4.4.2.2).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.2 and prior supported an "Extended Master Secret" [RFC7627]</td><td> </td><td class="right">   TLS 1.2 and prior supported an "Extended Master Secret" [RFC7627]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension which digested large parts of the handshake transcript into</td><td> </td><td class="right">   extension which digested large parts of the handshake transcript into</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the master secret.  Because TLS 1.3 always hashes in the transcript</td><td> </td><td class="right">   the master secret.  Because TLS 1.3 always hashes in the transcript</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0523" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   up to the server <span class="delete">CertificateVerify,</span> implementations which support</td><td> </td><td class="rblock">   up to the server <span class="insert">Finished,</span> implementations which support both TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   both TLS 1.3 and earlier versions SHOULD indicate the use of the</td><td> </td><td class="rblock">   and earlier versions SHOULD indicate the use of the Extended Master</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Extended Master Secret extension in their APIs whenever TLS 1.3 is</td><td> </td><td class="rblock">   Secret extension in their APIs whenever TLS 1.3 is used.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   used.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0524" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">D.1.  Negotiating with an <span class="delete">older s</span>erver</td><td> </td><td class="rblock">D.1.  Negotiating with an <span class="insert">Older S</span>erver</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A TLS 1.3 client who wishes to negotiate with servers that do not</td><td> </td><td class="right">   A TLS 1.3 client who wishes to negotiate with servers that do not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   support TLS 1.3 will send a normal TLS 1.3 ClientHello containing</td><td> </td><td class="right">   support TLS 1.3 will send a normal TLS 1.3 ClientHello containing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0x0303 (TLS 1.2) in ClientHello.legacy_version but with the correct</td><td> </td><td class="right">   0x0303 (TLS 1.2) in ClientHello.legacy_version but with the correct</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   version(s) in the "supported_versions" extension.  If the server does</td><td> </td><td class="right">   version(s) in the "supported_versions" extension.  If the server does</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0525" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   not support TLS 1.3 it will respond with a ServerHello containing an</td><td> </td><td class="rblock">   not support TLS 1.3<span class="insert">,</span> it will respond with a ServerHello containing an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   older version number.  If the client agrees to use this version, the</td><td> </td><td class="right">   older version number.  If the client agrees to use this version, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiation will proceed as appropriate for the negotiated protocol.</td><td> </td><td class="right">   negotiation will proceed as appropriate for the negotiated protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A client using a ticket for resumption SHOULD initiate the connection</td><td> </td><td class="right">   A client using a ticket for resumption SHOULD initiate the connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   using the version that was previously negotiated.</td><td> </td><td class="right">   using the version that was previously negotiated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0526" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note that 0-RTT data is not compatible with older servers and SHOULD</td><td> </td><td class="rblock">   Note that 0-RTT data is not compatible with older servers and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   NOT be sent absent knowledge that the server supports TLS 1.3.  See</td><td> </td><td class="rblock">   SHOULD NOT be sent absent knowledge that the server supports TLS 1.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix D.3.</td><td> </td><td class="rblock">   See Appendix D.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the version chosen by the server is not supported by the client</td><td> </td><td class="right">   If the version chosen by the server is not supported by the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0527" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (or not acceptable), the client MUST abort the handshake with a</td><td> </td><td class="rblock">   (or <span class="insert">is </span>not acceptable), the client MUST abort the handshake with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "protocol_version" alert.</td><td> </td><td class="right">   "protocol_version" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Some legacy server implementations are known to not implement the TLS</td><td> </td><td class="right">   Some legacy server implementations are known to not implement the TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specification properly and might abort connections upon encountering</td><td> </td><td class="right">   specification properly and might abort connections upon encountering</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS extensions or versions which they are not aware of.</td><td> </td><td class="right">   TLS extensions or versions which they are not aware of.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Interoperability with buggy servers is a complex topic beyond the</td><td> </td><td class="right">   Interoperability with buggy servers is a complex topic beyond the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   scope of this document.  Multiple connection attempts may be required</td><td> </td><td class="right">   scope of this document.  Multiple connection attempts may be required</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0528" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   in order to negotiate a <span class="delete">backwards compatible</span> connection; however,</td><td> </td><td class="rblock">   in order to negotiate a <span class="insert">backward-compatible</span> connection; however, this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   this practice is vulnerable to downgrade attacks and is NOT</td><td> </td><td class="rblock">   practice is vulnerable to downgrade attacks and is NOT RECOMMENDED.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   RECOMMENDED.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0529" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">D.2.  Negotiating with an <span class="delete">older c</span>lient</td><td> </td><td class="rblock">D.2.  Negotiating with an <span class="insert">Older C</span>lient</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A TLS server can also receive a ClientHello indicating a version</td><td> </td><td class="right">   A TLS server can also receive a ClientHello indicating a version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   number smaller than its highest supported version.  If the</td><td> </td><td class="right">   number smaller than its highest supported version.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "supported_versions" extension is present, the server MUST negotiate</td><td> </td><td class="right">   "supported_versions" extension is present, the server MUST negotiate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   using that extension as described in Section 4.2.1.  If the</td><td> </td><td class="right">   using that extension as described in Section 4.2.1.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "supported_versions" extension is not present, the server MUST</td><td> </td><td class="right">   "supported_versions" extension is not present, the server MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiate the minimum of ClientHello.legacy_version and TLS 1.2.  For</td><td> </td><td class="right">   negotiate the minimum of ClientHello.legacy_version and TLS 1.2.  For</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   example, if the server supports TLS 1.0, 1.1, and 1.2, and</td><td> </td><td class="right">   example, if the server supports TLS 1.0, 1.1, and 1.2, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   legacy_version is TLS 1.0, the server will proceed with a TLS 1.0</td><td> </td><td class="right">   legacy_version is TLS 1.0, the server will proceed with a TLS 1.0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello.  If the "supported_versions" extension is absent and the</td><td> </td><td class="right">   ServerHello.  If the "supported_versions" extension is absent and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server only supports versions greater than</td><td> </td><td class="right">   server only supports versions greater than</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello.legacy_version, the server MUST abort the handshake with</td><td> </td><td class="right">   ClientHello.legacy_version, the server MUST abort the handshake with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a "protocol_version" alert.</td><td> </td><td class="right">   a "protocol_version" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that earlier versions of TLS did not clearly specify the record</td><td> </td><td class="right">   Note that earlier versions of TLS did not clearly specify the record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   layer version number value in all cases</td><td> </td><td class="right">   layer version number value in all cases</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (TLSPlaintext.legacy_record_version).  Servers will receive various</td><td> </td><td class="right">   (TLSPlaintext.legacy_record_version).  Servers will receive various</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.x versions in this field, but its value MUST always be ignored.</td><td> </td><td class="right">   TLS 1.x versions in this field, but its value MUST always be ignored.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0530" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">D.3.  0-RTT <span class="delete">backwards c</span>ompatibility</td><td> </td><td class="rblock">D.3.  0-RTT <span class="insert">Backward C</span>ompatibility</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0-RTT data is not compatible with older servers.  An older server</td><td> </td><td class="right">   0-RTT data is not compatible with older servers.  An older server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   will respond to the ClientHello with an older ServerHello, but it</td><td> </td><td class="right">   will respond to the ClientHello with an older ServerHello, but it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   will not correctly skip the 0-RTT data and will fail to complete the</td><td> </td><td class="right">   will not correctly skip the 0-RTT data and will fail to complete the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake.  This can cause issues when a client attempts to use</td><td> </td><td class="right">   handshake.  This can cause issues when a client attempts to use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0-RTT, particularly against multi-server deployments.  For example, a</td><td> </td><td class="right">   0-RTT, particularly against multi-server deployments.  For example, a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   deployment could deploy TLS 1.3 gradually with some servers</td><td> </td><td class="right">   deployment could deploy TLS 1.3 gradually with some servers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementing TLS 1.3 and some implementing TLS 1.2, or a TLS 1.3</td><td> </td><td class="right">   implementing TLS 1.3 and some implementing TLS 1.2, or a TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   deployment could be downgraded to TLS 1.2.</td><td> </td><td class="right">   deployment could be downgraded to TLS 1.2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A client that attempts to send 0-RTT data MUST fail a connection if</td><td> </td><td class="right">   A client that attempts to send 0-RTT data MUST fail a connection if</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0531" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   it receives a ServerHello with TLS 1.2 or older.  <span class="delete">A</span> client <span class="delete">that</span></td><td> </td><td class="rblock">   it receives a ServerHello with TLS 1.2 or older.  <span class="insert">It can then retry</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   attempts to repair this error</span> SHOULD NOT <span class="delete">send a</span> TLS <span class="delete">1.2 ClientHello,</span></td><td> </td><td class="rblock"><span class="insert">   the connection with 0-RTT disabled.  To avoid a downgrade attack, the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   but instead send a TLS 1.3 ClientHello without 0-RTT data.</span></td><td> </td><td class="rblock">   client SHOULD NOT <span class="insert">disable</span> TLS <span class="insert">1.3, only 0-RTT.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   To avoid this error condition, multi-server deployments SHOULD ensure</td><td> </td><td class="right">   To avoid this error condition, multi-server deployments SHOULD ensure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a uniform and stable deployment of TLS 1.3 without 0-RTT prior to</td><td> </td><td class="right">   a uniform and stable deployment of TLS 1.3 without 0-RTT prior to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   enabling 0-RTT.</td><td> </td><td class="right">   enabling 0-RTT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">D.4.  Middlebox Compatibility Mode</td><td> </td><td class="right">D.4.  Middlebox Compatibility Mode</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0532" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Field measurements <span class="delete">[Ben17a], [Ben17b], [Res17a],</span> [Res17b] have found</td><td> </td><td class="rblock">   Field measurements <span class="insert">[Ben17a] [Ben17b] [Res17a]</span> [Res17b] have found</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that a significant number of middleboxes misbehave when a TLS <span class="delete">client/</span></td><td> </td><td class="rblock">   that a significant number of middleboxes misbehave when a TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   server</span> pair negotiates TLS 1.3.  Implementations can increase the</td><td> </td><td class="rblock">   <span class="insert">client/server</span> pair negotiates TLS 1.3.  Implementations can increase</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   chance of making connections through those middleboxes by making the</td><td> </td><td class="rblock">   the chance of making connections through those middleboxes by making</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TLS 1.3 handshake look more like a TLS 1.2 handshake:</td><td> </td><td class="rblock">   the TLS 1.3 handshake look more like a TLS 1.2 handshake:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The client always provides a non-empty session ID in the</td><td> </td><td class="right">   -  The client always provides a non-empty session ID in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello, as described in the legacy_session_id section of</td><td> </td><td class="right">      ClientHello, as described in the legacy_session_id section of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 4.1.2.</td><td> </td><td class="right">      Section 4.1.2.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  If not offering early data, the client sends a dummy</td><td> </td><td class="right">   -  If not offering early data, the client sends a dummy</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0533" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      change_cipher_spec record (see the third paragraph of Section 5<span class="delete">.1</span>)</td><td> </td><td class="rblock">      change_cipher_spec record (see the third paragraph of Section 5)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      immediately before its second flight.  This may either be before</td><td> </td><td class="right">      immediately before its second flight.  This may either be before</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      its second ClientHello or before its encrypted handshake flight.</td><td> </td><td class="right">      its second ClientHello or before its encrypted handshake flight.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      If offering early data, the record is placed immediately after the</td><td> </td><td class="right">      If offering early data, the record is placed immediately after the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      first ClientHello.</td><td> </td><td class="right">      first ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The server sends a dummy change_cipher_spec record immediately</td><td> </td><td class="right">   -  The server sends a dummy change_cipher_spec record immediately</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      after its first handshake message.  This may either be after a</td><td> </td><td class="right">      after its first handshake message.  This may either be after a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ServerHello or a HelloRetryRequest.</td><td> </td><td class="right">      ServerHello or a HelloRetryRequest.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When put together, these changes make the TLS 1.3 handshake resemble</td><td> </td><td class="right">   When put together, these changes make the TLS 1.3 handshake resemble</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.2 session resumption, which improves the chance of successfully</td><td> </td><td class="right">   TLS 1.2 session resumption, which improves the chance of successfully</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connecting through middleboxes.  This "compatibility mode" is</td><td> </td><td class="right">   connecting through middleboxes.  This "compatibility mode" is</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0534" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   partially negotiated: <span class="delete">The</span> client can opt to provide a session ID or</td><td> </td><td class="rblock">   partially negotiated: <span class="insert">the</span> client can opt to provide a session ID or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">not</span> and the server has to echo it.  Either side can send</td><td> </td><td class="rblock">   <span class="insert">not,</span> and the server has to echo it.  Either side can send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   change_cipher_spec at any time during the handshake, as they must be</td><td> </td><td class="right">   change_cipher_spec at any time during the handshake, as they must be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ignored by the peer, but if the client sends a non-empty session ID,</td><td> </td><td class="right">   ignored by the peer, but if the client sends a non-empty session ID,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server MUST send the change_cipher_spec as described in this</td><td> </td><td class="right">   the server MUST send the change_cipher_spec as described in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0535" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">section</span>.</td><td> </td><td class="rblock">   <span class="insert">appendix</span>.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0536" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">D.5.  <span class="delete">Backwards Compatibility Security Restrictions</span></td><td> </td><td class="rblock">D.5.  <span class="insert">Security Restrictions Related to Backward Compatibility</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0537" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Implementations negotiating use of older versions of TLS SHOULD</td><td> </td><td class="rblock">   Implementations negotiating <span class="insert">the </span>use of older versions of TLS SHOULD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   prefer forward secret and AEAD cipher suites, when available.</td><td> </td><td class="right">   prefer forward secret and AEAD cipher suites, when available.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The security of RC4 cipher suites is considered insufficient for the</td><td> </td><td class="right">   The security of RC4 cipher suites is considered insufficient for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   reasons cited in [RFC7465].  Implementations MUST NOT offer or</td><td> </td><td class="right">   reasons cited in [RFC7465].  Implementations MUST NOT offer or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiate RC4 cipher suites for any version of TLS for any reason.</td><td> </td><td class="right">   negotiate RC4 cipher suites for any version of TLS for any reason.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Old versions of TLS permitted the use of very low strength ciphers.</td><td> </td><td class="right">   Old versions of TLS permitted the use of very low strength ciphers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Ciphers with a strength less than 112 bits MUST NOT be offered or</td><td> </td><td class="right">   Ciphers with a strength less than 112 bits MUST NOT be offered or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiated for any version of TLS for any reason.</td><td> </td><td class="right">   negotiated for any version of TLS for any reason.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0538" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The security of SSL 3.0 [<span class="delete">SSL3</span>] is considered insufficient for the</td><td> </td><td class="rblock">   The security of SSL 3.0 [<span class="insert">RFC6101</span>] is considered insufficient for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   reasons enumerated in [RFC7568], and it MUST NOT be negotiated for</td><td> </td><td class="right">   reasons enumerated in [RFC7568], and it MUST NOT be negotiated for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   any reason.</td><td> </td><td class="right">   any reason.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The security of SSL 2.0 [SSL2] is considered insufficient for the</td><td> </td><td class="right">   The security of SSL 2.0 [SSL2] is considered insufficient for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   reasons enumerated in [RFC6176], and it MUST NOT be negotiated for</td><td> </td><td class="right">   reasons enumerated in [RFC6176], and it MUST NOT be negotiated for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   any reason.</td><td> </td><td class="right">   any reason.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0539" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Implementations MUST NOT send an SSL version 2.0 compatible <span class="delete">CLIENT-</span></td><td> </td><td class="rblock">   Implementations MUST NOT send an SSL version 2.0 compatible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   HELLO.</span>  Implementations MUST NOT negotiate TLS 1.3 or later using an</td><td> </td><td class="rblock">   <span class="insert">CLIENT-HELLO.</span>  Implementations MUST NOT negotiate TLS 1.3 or later</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   SSL version 2.0 compatible CLIENT-HELLO.  Implementations are NOT</td><td> </td><td class="rblock">   using an SSL version 2.0 compatible CLIENT-HELLO.  Implementations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   RECOMMENDED to accept an SSL version 2.0 compatible CLIENT-HELLO in</td><td> </td><td class="rblock">   are NOT RECOMMENDED to accept an SSL version 2.0 compatible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   order to negotiate older versions of TLS.</td><td> </td><td class="rblock">   CLIENT-HELLO in order to negotiate older versions of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST NOT send a ClientHello.legacy_version or</td><td> </td><td class="right">   Implementations MUST NOT send a ClientHello.legacy_version or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello.legacy_version set to 0x0300 or less.  Any endpoint</td><td> </td><td class="right">   ServerHello.legacy_version set to 0x0300 or less.  Any endpoint</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receiving a Hello message with ClientHello.legacy_version or</td><td> </td><td class="right">   receiving a Hello message with ClientHello.legacy_version or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello.legacy_version set to 0x0300 MUST abort the handshake</td><td> </td><td class="right">   ServerHello.legacy_version set to 0x0300 MUST abort the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with a "protocol_version" alert.</td><td> </td><td class="right">   with a "protocol_version" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST NOT send any records with a version less than</td><td> </td><td class="right">   Implementations MUST NOT send any records with a version less than</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0x0300.  Implementations SHOULD NOT accept any records with a version</td><td> </td><td class="right">   0x0300.  Implementations SHOULD NOT accept any records with a version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   less than 0x0300 (but may inadvertently do so if the record version</td><td> </td><td class="right">   less than 0x0300 (but may inadvertently do so if the record version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   number is ignored completely).</td><td> </td><td class="right">   number is ignored completely).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST NOT use the Truncated HMAC extension, defined in</td><td> </td><td class="right">   Implementations MUST NOT use the Truncated HMAC extension, defined in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 7 of [RFC6066], as it is not applicable to AEAD algorithms</td><td> </td><td class="right">   Section 7 of [RFC6066], as it is not applicable to AEAD algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and has been shown to be insecure in some scenarios.</td><td> </td><td class="right">   and has been shown to be insecure in some scenarios.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix E.  Overview of Security Properties</td><td> </td><td class="right">Appendix E.  Overview of Security Properties</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A complete security analysis of TLS is outside the scope of this</td><td> </td><td class="right">   A complete security analysis of TLS is outside the scope of this</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0540" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   document.  In this <span class="delete">section,</span> we provide an informal description the</td><td> </td><td class="rblock">   document.  In this <span class="insert">appendix,</span> we provide an informal description <span class="insert">of</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   desired properties as well as references to more detailed work in the</td><td> </td><td class="rblock">   the desired properties as well as references to more detailed work in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   research literature which provides more formal definitions.</td><td> </td><td class="rblock">   the research literature which provides more formal definitions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   We cover properties of the handshake separately from those of the</td><td> </td><td class="right">   We cover properties of the handshake separately from those of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   record layer.</td><td> </td><td class="right">   record layer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.1.  Handshake</td><td> </td><td class="right">E.1.  Handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS handshake is an Authenticated Key Exchange (AKE) protocol</td><td> </td><td class="right">   The TLS handshake is an Authenticated Key Exchange (AKE) protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which is intended to provide both one-way authenticated (server-only)</td><td> </td><td class="right">   which is intended to provide both one-way authenticated (server-only)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and mutually authenticated (client and server) functionality.  At the</td><td> </td><td class="right">   and mutually authenticated (client and server) functionality.  At the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   completion of the handshake, each side outputs its view of the</td><td> </td><td class="right">   completion of the handshake, each side outputs its view of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   following values:</td><td> </td><td class="right">   following values:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  A set of "session keys" (the various secrets derived from the</td><td> </td><td class="right">   -  A set of "session keys" (the various secrets derived from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      master secret) from which can be derived a set of working keys.</td><td> </td><td class="right">      master secret) from which can be derived a set of working keys.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0541" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  A set of cryptographic parameters (algorithms, etc.)</td><td> </td><td class="rblock">   -  A set of cryptographic parameters (algorithms, etc.)<span class="insert">.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The identities of the communicating parties.</td><td> </td><td class="right">   -  The identities of the communicating parties.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   We assume the attacker to be an active network attacker, which means</td><td> </td><td class="right">   We assume the attacker to be an active network attacker, which means</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it has complete control over the network used to communicate between</td><td> </td><td class="right">   it has complete control over the network used to communicate between</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the parties [RFC3552].  Even under these conditions, the handshake</td><td> </td><td class="right">   the parties [RFC3552].  Even under these conditions, the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   should provide the properties listed below.  Note that these</td><td> </td><td class="right">   should provide the properties listed below.  Note that these</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   properties are not necessarily independent, but reflect the protocol</td><td> </td><td class="right">   properties are not necessarily independent, but reflect the protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   consumers' needs.</td><td> </td><td class="right">   consumers' needs.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0542" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Establishing the same session keys<span class="delete">.</span>  The handshake needs to output</td><td> </td><td class="rblock">   Establishing the same session keys<span class="insert">:</span>  The handshake needs to output</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the same set of session keys on both sides of the handshake,</td><td> </td><td class="right">      the same set of session keys on both sides of the handshake,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0543" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      provided that it completes successfully on each endpoint <span class="delete">(See</span></td><td> </td><td class="rblock">      provided that it completes successfully on each endpoint <span class="insert">(see</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      [CK01]; defn</span> 1, part 1).</td><td> </td><td class="rblock"><span class="insert">      [CK01], Definition</span> 1, part 1).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0544" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Secrecy of the session <span class="delete">keys.</span>  The shared session keys should be known</td><td> </td><td class="rblock">   Secrecy of the session <span class="insert">keys:</span>  The shared session keys should be known</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      only to the communicating parties and not to the attacker <span class="delete">(See</span></td><td> </td><td class="rblock">      only to the communicating parties and not to the attacker <span class="insert">(see</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      [CK01]; defn</span> 1, part 2).  Note that in a unilaterally</td><td> </td><td class="rblock"><span class="insert">      [CK01], Definition</span> 1, part 2).  Note that in a unilaterally</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authenticated connection, the attacker can establish its own</td><td> </td><td class="right">      authenticated connection, the attacker can establish its own</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      session keys with the server, but those session keys are distinct</td><td> </td><td class="right">      session keys with the server, but those session keys are distinct</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      from those established by the client.</td><td> </td><td class="right">      from those established by the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0545" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Peer <span class="delete">Authentication.</span>  The client's view of the peer identity should</td><td> </td><td class="rblock">   Peer <span class="insert">authentication:</span>  The client's view of the peer identity should</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      reflect the server's identity.  If the client is authenticated,</td><td> </td><td class="right">      reflect the server's identity.  If the client is authenticated,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the server's view of the peer identity should match the client's</td><td> </td><td class="right">      the server's view of the peer identity should match the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      identity.</td><td> </td><td class="right">      identity.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Uniqueness of the session keys:  Any two distinct handshakes should</td><td> </td><td class="right">   Uniqueness of the session keys:  Any two distinct handshakes should</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      produce distinct, unrelated session keys.  Individual session keys</td><td> </td><td class="right">      produce distinct, unrelated session keys.  Individual session keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      produced by a handshake should also be distinct and independent.</td><td> </td><td class="right">      produced by a handshake should also be distinct and independent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0546" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Downgrade protection<span class="delete">.</span>  The cryptographic parameters should be the</td><td> </td><td class="rblock">   Downgrade protection<span class="insert">:</span>  The cryptographic parameters should be the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      same on both sides and should be the same as if the peers had been</td><td> </td><td class="right">      same on both sides and should be the same as if the peers had been</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0547" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      communicating in the absence of an attack <span class="delete">(See [BBFKZG16]; defns</span> 8</td><td> </td><td class="rblock">      communicating in the absence of an attack <span class="insert">(see [BBFGKZ16],</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      and <span class="delete">9}).</span></td><td> </td><td class="rblock"><span class="insert">      Definitions</span> 8 and <span class="insert">9).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0548" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Forward secret with respect to long-term keys  If the long-term</td><td> </td><td class="rblock">   Forward secret with respect to long-term keys<span class="insert">:</span>  If the long-term</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      keying material (in this case the signature keys in certificate-</td><td> </td><td class="right">      keying material (in this case the signature keys in certificate-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      based authentication modes or the external/resumption PSK in PSK</td><td> </td><td class="right">      based authentication modes or the external/resumption PSK in PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      with (EC)DHE modes) is compromised after the handshake is</td><td> </td><td class="right">      with (EC)DHE modes) is compromised after the handshake is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      complete, this does not compromise the security of the session key</td><td> </td><td class="right">      complete, this does not compromise the security of the session key</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0549" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (<span class="delete">S</span>ee [DOW92]), as long as the session key itself has been erased.</td><td> </td><td class="rblock">      (<span class="insert">s</span>ee [DOW92]), as long as the session key itself has been erased.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The forward secrecy property is not satisfied when PSK is used in</td><td> </td><td class="right">      The forward secrecy property is not satisfied when PSK is used in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the "psk_ke" PskKeyExchangeMode.</td><td> </td><td class="right">      the "psk_ke" PskKeyExchangeMode.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0550" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Key Compromise Impersonation (KCI) <span class="delete">resistance</span>  In a <span class="delete">mutually-</span></td><td> </td><td class="rblock">   Key Compromise Impersonation (KCI) <span class="insert">resistance:</span>  In a <span class="insert">mutually</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      authenticated connection with certificates, compromising the <span class="delete">long-</span></td><td> </td><td class="rblock">      authenticated connection with certificates, compromising the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      term</span> secret of one actor should not break that actor's</td><td> </td><td class="rblock">      <span class="insert">long-term</span> secret of one actor should not break that actor's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authentication of their peer in the given connection (see</td><td> </td><td class="right">      authentication of their peer in the given connection (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [HGFS15]).  For example, if a client's signature key is</td><td> </td><td class="right">      [HGFS15]).  For example, if a client's signature key is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compromised, it should not be possible to impersonate arbitrary</td><td> </td><td class="right">      compromised, it should not be possible to impersonate arbitrary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      servers to that client in subsequent handshakes.</td><td> </td><td class="right">      servers to that client in subsequent handshakes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0551" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Protection of endpoint identities<span class="delete">.</span>  The server's identity</td><td> </td><td class="rblock">   Protection of endpoint identities<span class="insert">:</span>  The server's identity</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (certificate) should be protected against passive attackers.  The</td><td> </td><td class="right">      (certificate) should be protected against passive attackers.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client's identity should be protected against both passive and</td><td> </td><td class="right">      client's identity should be protected against both passive and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      active attackers.</td><td> </td><td class="right">      active attackers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Informally, the signature-based modes of TLS 1.3 provide for the</td><td> </td><td class="right">   Informally, the signature-based modes of TLS 1.3 provide for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   establishment of a unique, secret, shared key established by an</td><td> </td><td class="right">   establishment of a unique, secret, shared key established by an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (EC)DHE key exchange and authenticated by the server's signature over</td><td> </td><td class="right">   (EC)DHE key exchange and authenticated by the server's signature over</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the handshake transcript, as well as tied to the server's identity by</td><td> </td><td class="right">   the handshake transcript, as well as tied to the server's identity by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a MAC.  If the client is authenticated by a certificate, it also</td><td> </td><td class="right">   a MAC.  If the client is authenticated by a certificate, it also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signs over the handshake transcript and provides a MAC tied to both</td><td> </td><td class="right">   signs over the handshake transcript and provides a MAC tied to both</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l60" /><small>skipping to change at</small><em> page 141, line 36</em></th><th> </th><th><a name="part-r60" /><small>skipping to change at</small><em> page 144, line 16</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection, they are associated with different keys, so compromise of</td><td> </td><td class="right">   connection, they are associated with different keys, so compromise of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the PSK associated with one ticket does not lead to the compromise of</td><td> </td><td class="right">   the PSK associated with one ticket does not lead to the compromise of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connections established with PSKs associated with other tickets.</td><td> </td><td class="right">   connections established with PSKs associated with other tickets.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This property is most interesting if tickets are stored in a database</td><td> </td><td class="right">   This property is most interesting if tickets are stored in a database</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (and so can be deleted) rather than if they are self-encrypted.</td><td> </td><td class="right">   (and so can be deleted) rather than if they are self-encrypted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The PSK binder value forms a binding between a PSK and the current</td><td> </td><td class="right">   The PSK binder value forms a binding between a PSK and the current</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake, as well as between the session where the PSK was</td><td> </td><td class="right">   handshake, as well as between the session where the PSK was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   established and the current session.  This binding transitively</td><td> </td><td class="right">   established and the current session.  This binding transitively</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   includes the original handshake transcript, because that transcript</td><td> </td><td class="right">   includes the original handshake transcript, because that transcript</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0552" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   is digested into the values which produce the <span class="delete">Resumption Master</span></td><td> </td><td class="rblock">   is digested into the values which produce the <span class="insert">resumption master</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Secret.</span>  This requires that both the KDF used to produce the</td><td> </td><td class="rblock"><span class="insert">   secret.</span>  This requires that both the KDF used to produce the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   resumption master secret and the MAC used to compute the binder be</td><td> </td><td class="right">   resumption master secret and the MAC used to compute the binder be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   collision resistant.  See Appendix E.1.1 for more on this.  Note: The</td><td> </td><td class="right">   collision resistant.  See Appendix E.1.1 for more on this.  Note: The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   binder does not cover the binder values from other PSKs, though they</td><td> </td><td class="right">   binder does not cover the binder values from other PSKs, though they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are included in the Finished MAC.</td><td> </td><td class="right">   are included in the Finished MAC.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0553" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Note: </span>TLS does not currently permit the server to send a</td><td> </td><td class="rblock">   TLS does not currently permit the server to send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate_request message in non-certificate-based handshakes</td><td> </td><td class="right">   certificate_request message in non-certificate-based handshakes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (e.g., PSK).  If this restriction were to be relaxed in future, the</td><td> </td><td class="right">   (e.g., PSK).  If this restriction were to be relaxed in future, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client's signature would not cover the server's certificate directly.</td><td> </td><td class="right">   client's signature would not cover the server's certificate directly.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   However, if the PSK was established through a NewSessionTicket, the</td><td> </td><td class="right">   However, if the PSK was established through a NewSessionTicket, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client's signature would transitively cover the server's certificate</td><td> </td><td class="right">   client's signature would transitively cover the server's certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   through the PSK binder.  [PSK-FINISHED] describes a concrete attack</td><td> </td><td class="right">   through the PSK binder.  [PSK-FINISHED] describes a concrete attack</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   on constructions that do not bind to the server's certificate (see</td><td> </td><td class="right">   on constructions that do not bind to the server's certificate (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   also [Kraw16]).  It is unsafe to use certificate-based client</td><td> </td><td class="right">   also [Kraw16]).  It is unsafe to use certificate-based client</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0554" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   authentication when the client might potentially share the same <span class="delete">PSK/</span></td><td> </td><td class="rblock">   authentication when the client might potentially share the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   key-id</span> pair with two different endpoints.  Implementations MUST NOT</td><td> </td><td class="rblock">   <span class="insert">PSK/key-id</span> pair with two different endpoints.  Implementations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   combine external PSKs with certificate-based authentication of either</td><td> </td><td class="rblock">   MUST NOT combine external PSKs with certificate-based authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the client or the server unless negotiated by some extension.</td><td> </td><td class="rblock">   of either the client or the server unless negotiated by some</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If an exporter is used, then it produces values which are unique and</td><td> </td><td class="right">   If an exporter is used, then it produces values which are unique and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secret (because they are generated from a unique session key).</td><td> </td><td class="right">   secret (because they are generated from a unique session key).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Exporters computed with different labels and contexts are</td><td> </td><td class="right">   Exporters computed with different labels and contexts are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   computationally independent, so it is not feasible to compute one</td><td> </td><td class="right">   computationally independent, so it is not feasible to compute one</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0555" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   from another or the session secret from the exported value.  Note:</td><td> </td><td class="rblock">   from another or the session secret from the exported value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">exporters</span> can produce arbitrary-length <span class="delete">values.  If</span> exporters are to</td><td> </td><td class="rblock">   Note: <span class="insert">Exporters</span> can produce arbitrary-length <span class="insert">values; if</span> exporters are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   be used as channel bindings, the exported value MUST be large enough</td><td> </td><td class="rblock">   to be used as channel bindings, the exported value MUST be large</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   to provide collision resistance.  The exporters provided in TLS 1.3</td><td> </td><td class="rblock">   enough to provide collision resistance.  The exporters provided in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   are derived from the same <span class="delete">handshake contexts</span> as the early traffic</td><td> </td><td class="rblock">   TLS 1.3 are derived from the same <span class="insert">Handshake Contexts</span> as the early</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   keys and the application traffic <span class="delete">keys</span> respectively, and thus have</td><td> </td><td class="rblock">   traffic keys and the application traffic <span class="insert">keys,</span> respectively, and thus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   similar security properties.  Note that they do not include the</td><td> </td><td class="rblock">   have similar security properties.  Note that they do not include the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client's certificate; future applications which wish to bind to the</td><td> </td><td class="right">   client's certificate; future applications which wish to bind to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client's certificate may need to define a new exporter that includes</td><td> </td><td class="right">   client's certificate may need to define a new exporter that includes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the full handshake transcript.</td><td> </td><td class="right">   the full handshake transcript.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0556" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   For all handshake modes, the Finished MAC <span class="delete">(and</span> where present, the</td><td> </td><td class="rblock">   For all handshake modes, the Finished MAC <span class="insert">(and,</span> where present, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">signature),</span> prevents downgrade attacks.  In addition, the use of</td><td> </td><td class="rblock">   <span class="insert">signature)</span> prevents downgrade attacks.  In addition, the use of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certain bytes in the random nonces as described in Section 4.1.3</td><td> </td><td class="right">   certain bytes in the random nonces as described in Section 4.1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   allows the detection of downgrade to previous TLS versions.  See</td><td> </td><td class="right">   allows the detection of downgrade to previous TLS versions.  See</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0557" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [BBF<span class="delete">KZG16] for more detail</span> on TLS 1.3 and downgrade.</td><td> </td><td class="rblock">   [BBF<span class="insert">GKZ16] for more details</span> on TLS 1.3 and downgrade.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As soon as the client and the server have exchanged enough</td><td> </td><td class="right">   As soon as the client and the server have exchanged enough</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   information to establish shared keys, the remainder of the handshake</td><td> </td><td class="right">   information to establish shared keys, the remainder of the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is encrypted, thus providing protection against passive attackers,</td><td> </td><td class="right">   is encrypted, thus providing protection against passive attackers,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   even if the computed shared key is not authenticated.  Because the</td><td> </td><td class="right">   even if the computed shared key is not authenticated.  Because the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server authenticates before the client, the client can ensure that if</td><td> </td><td class="right">   server authenticates before the client, the client can ensure that if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it authenticates to the server, it only reveals its identity to an</td><td> </td><td class="right">   it authenticates to the server, it only reveals its identity to an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   authenticated server.  Note that implementations must use the</td><td> </td><td class="right">   authenticated server.  Note that implementations must use the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0558" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   provided record<span class="delete"> </span>padding mechanism during the handshake to avoid</td><td> </td><td class="rblock">   provided record<span class="insert">-</span>padding mechanism during the handshake to avoid</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   leaking information about the identities due to length.  The client's</td><td> </td><td class="right">   leaking information about the identities due to length.  The client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   proposed PSK identities are not encrypted, nor is the one that the</td><td> </td><td class="right">   proposed PSK identities are not encrypted, nor is the one that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server selects.</td><td> </td><td class="right">   server selects.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.1.1.  Key Derivation and HKDF</td><td> </td><td class="right">E.1.1.  Key Derivation and HKDF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0559" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Key derivation in TLS 1.3 uses <span class="delete">the</span> HKDF <span class="delete">function</span> defined in [RFC5869]</td><td> </td><td class="rblock">   Key derivation in TLS 1.3 uses HKDF <span class="insert">as</span> defined in [RFC5869] and its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   and its two components, HKDF-Extract and HKDF-Expand.  The full</td><td> </td><td class="rblock">   two components, HKDF-Extract and HKDF-Expand.  The full rationale for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   rationale for the HKDF construction can be found in [Kraw10] and the</td><td> </td><td class="rblock">   the HKDF construction can be found in [Kraw10] and the rationale for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   rationale for the way it is used in TLS 1.3 in [KW16].  Throughout</td><td> </td><td class="rblock">   the way it is used in TLS 1.3 in [KW16].  Throughout this document,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   this document, each application of HKDF-Extract is followed by one or</td><td> </td><td class="rblock">   each application of HKDF-Extract is followed by one or more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   more invocations of HKDF-Expand.  This ordering should always be</td><td> </td><td class="rblock">   invocations of HKDF-Expand.  This ordering should always be followed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   followed (including in future revisions of this <span class="delete">document),</span> in</td><td> </td><td class="rblock">   (including in future revisions of this <span class="insert">document);</span> in particular, one</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   particular, one SHOULD NOT use an output of HKDF-Extract as an input</td><td> </td><td class="rblock">   SHOULD NOT use an output of HKDF-Extract as an input to another</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   to another application of HKDF-Extract without an HKDF-Expand in</td><td> </td><td class="rblock">   application of HKDF-Extract without an HKDF-Expand in between.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   between.  <span class="delete">Consecutive</span> applications of HKDF-Expand are allowed as long</td><td> </td><td class="rblock">   <span class="insert">Multiple</span> applications of HKDF-Expand <span class="insert">to some of the same inputs</span> are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   as these are differentiated via the key and/or the labels.</td><td> </td><td class="rblock">   allowed as long as these are differentiated via the key and/or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   labels.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that HKDF-Expand implements a pseudorandom function (PRF) with</td><td> </td><td class="right">   Note that HKDF-Expand implements a pseudorandom function (PRF) with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   both inputs and outputs of variable length.  In some of the uses of</td><td> </td><td class="right">   both inputs and outputs of variable length.  In some of the uses of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HKDF in this document (e.g., for generating exporters and the</td><td> </td><td class="right">   HKDF in this document (e.g., for generating exporters and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   resumption_master_secret), it is necessary that the application of</td><td> </td><td class="right">   resumption_master_secret), it is necessary that the application of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0560" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   HKDF-Expand be collision<span class="delete">-resistant,</span> namely, it should be infeasible</td><td> </td><td class="rblock">   HKDF-Expand be collision<span class="insert"> resistant;</span> namely, it should be infeasible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to find two different inputs to HKDF-Expand that output the same</td><td> </td><td class="right">   to find two different inputs to HKDF-Expand that output the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   value.  This requires the underlying hash function to be collision</td><td> </td><td class="right">   value.  This requires the underlying hash function to be collision</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   resistant and the output length from HKDF-Expand to be of size at</td><td> </td><td class="right">   resistant and the output length from HKDF-Expand to be of size at</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   least 256 bits (or as much as needed for the hash function to prevent</td><td> </td><td class="right">   least 256 bits (or as much as needed for the hash function to prevent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   finding collisions).</td><td> </td><td class="right">   finding collisions).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.1.2.  Client Authentication</td><td> </td><td class="right">E.1.2.  Client Authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A client that has sent authentication data to a server, either during</td><td> </td><td class="right">   A client that has sent authentication data to a server, either during</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0561" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the handshake or in post-handshake authentication, cannot be sure <span class="delete">if</span></td><td> </td><td class="rblock">   the handshake or in post-handshake authentication, cannot be sure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the server afterwards considers the client to be authenticated or</td><td> </td><td class="rblock">   <span class="insert">whether</span> the server afterwards considers the client to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   not.  If the client needs to determine if the server considers the</td><td> </td><td class="rblock">   authenticated or not.  If the client needs to determine if the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   connection to be unilaterally or mutually authenticated, this has to</td><td> </td><td class="rblock">   considers the connection to be unilaterally or mutually</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   be provisioned by the application layer.  See [CHHSV17] for details.</td><td> </td><td class="rblock">   authenticated, this has to be provisioned by the application layer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   In addition, the analysis of post-handshake authentication from</td><td> </td><td class="rblock">   See [CHHSV17] for details.  In addition, the analysis of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [Kraw16] shows that the client identified by the certificate sent in</td><td> </td><td class="rblock">   post-handshake authentication from [Kraw16] shows that the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the post-handshake phase possesses the traffic key.  This party is</td><td> </td><td class="rblock">   identified by the certificate sent in the post-handshake phase</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   therefore the client that participated in the original handshake or</td><td> </td><td class="rblock">   possesses the traffic key.  This party is therefore the client that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   one to whom the original client delegated the traffic key (assuming</td><td> </td><td class="rblock">   participated in the original handshake or one to whom the original</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   that the traffic key has not been compromised).</td><td> </td><td class="rblock">   client delegated the traffic key (assuming that the traffic key has</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   not been compromised).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.1.3.  0-RTT</td><td> </td><td class="right">E.1.3.  0-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0562" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The 0-RTT mode of operation generally provides <span class="delete">similar</span> security</td><td> </td><td class="rblock">   The 0-RTT mode of operation generally provides security properties</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   properties <span class="delete">as</span> 1-RTT data, with the two exceptions that the 0-RTT</td><td> </td><td class="rblock">   <span class="insert">similar to those of</span> 1-RTT data, with the two exceptions that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   encryption keys do not provide full forward secrecy and that the</td><td> </td><td class="rblock">   0-RTT encryption keys do not provide full forward secrecy and that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server is not able to guarantee uniqueness of the handshake <span class="delete">(non-</span></td><td> </td><td class="rblock">   the server is not able to guarantee uniqueness of the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   replayability)</span> without keeping potentially undue amounts of state.</td><td> </td><td class="rblock">   <span class="insert">(non-replayability)</span> without keeping potentially undue amounts of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   See Section 8 for mechanisms to limit the exposure to replay.</td><td> </td><td class="rblock">   state.  See Section 8 for mechanisms to limit the exposure to replay.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.1.4.  Exporter Independence</td><td> </td><td class="right">E.1.4.  Exporter Independence</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The exporter_master_secret and early_exporter_master_secret are</td><td> </td><td class="right">   The exporter_master_secret and early_exporter_master_secret are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   derived to be independent of the traffic keys and therefore do not</td><td> </td><td class="right">   derived to be independent of the traffic keys and therefore do not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   represent a threat to the security of traffic encrypted with those</td><td> </td><td class="right">   represent a threat to the security of traffic encrypted with those</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   keys.  However, because these secrets can be used to compute any</td><td> </td><td class="right">   keys.  However, because these secrets can be used to compute any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exporter value, they SHOULD be erased as soon as possible.  If the</td><td> </td><td class="right">   exporter value, they SHOULD be erased as soon as possible.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   total set of exporter labels is known, then implementations SHOULD</td><td> </td><td class="right">   total set of exporter labels is known, then implementations SHOULD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pre-compute the inner Derive-Secret stage of the exporter computation</td><td> </td><td class="right">   pre-compute the inner Derive-Secret stage of the exporter computation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for all those labels, then erase the [early_]exporter_master_secret,</td><td> </td><td class="right">   for all those labels, then erase the [early_]exporter_master_secret,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0563" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   followed by each inner value<span class="delete">s</span> as soon as it is known that it will not</td><td> </td><td class="rblock">   followed by each inner value as soon as it is known that it will not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be needed again.</td><td> </td><td class="right">   be needed again.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.1.5.  Post-Compromise Security</td><td> </td><td class="right">E.1.5.  Post-Compromise Security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS does not provide security for handshakes which take place after</td><td> </td><td class="right">   TLS does not provide security for handshakes which take place after</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the peer's long-term secret (signature key or external PSK) is</td><td> </td><td class="right">   the peer's long-term secret (signature key or external PSK) is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compromised.  It therefore does not provide post-compromise security</td><td> </td><td class="right">   compromised.  It therefore does not provide post-compromise security</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0564" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [CCG16], sometimes also referred to as backward<span class="delete">s</span> or future secrecy.</td><td> </td><td class="rblock">   [CCG16], sometimes also referred to as backward or future secrecy.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This is in contrast to KCI resistance, which describes the security</td><td> </td><td class="right">   This is in contrast to KCI resistance, which describes the security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   guarantees that a party has after its own long-term secret has been</td><td> </td><td class="right">   guarantees that a party has after its own long-term secret has been</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compromised.</td><td> </td><td class="right">   compromised.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.1.6.  External References</td><td> </td><td class="right">E.1.6.  External References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The reader should refer to the following references for analysis of</td><td> </td><td class="right">   The reader should refer to the following references for analysis of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0565" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the TLS handshake: <span class="delete">[DFGS15] [CHSV16] [DFGS16] [KW16] [Kraw16]</span></td><td> </td><td class="rblock">   the TLS handshake: <span class="insert">[DFGS15], [CHSV16], [DFGS16], [KW16], [Kraw16],</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [FGSW16] [LXZFH16] [FG17]</span> [BBK17].</td><td> </td><td class="rblock"><span class="insert">   [FGSW16], [LXZFH16], [FG17], and</span> [BBK17].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.2.  Record Layer</td><td> </td><td class="right">E.2.  Record Layer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The record layer depends on the handshake producing strong traffic</td><td> </td><td class="right">   The record layer depends on the handshake producing strong traffic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secrets which can be used to derive bidirectional encryption keys and</td><td> </td><td class="right">   secrets which can be used to derive bidirectional encryption keys and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   nonces.  Assuming that is true, and the keys are used for no more</td><td> </td><td class="right">   nonces.  Assuming that is true, and the keys are used for no more</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0566" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   data than indicated in Section 5.5 then the record layer should</td><td> </td><td class="rblock">   data than indicated in Section 5.5<span class="insert">,</span> then the record layer should</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provide the following guarantees:</td><td> </td><td class="right">   provide the following guarantees:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0567" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Confidentiality<span class="delete">.</span>  An attacker should not be able to determine the</td><td> </td><td class="rblock">   Confidentiality<span class="insert">:</span>  An attacker should not be able to determine the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      plaintext contents of a given record.</td><td> </td><td class="right">      plaintext contents of a given record.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0568" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Integrity<span class="delete">.</span>  An attacker should not be able to craft a new record</td><td> </td><td class="rblock">   Integrity<span class="insert">:</span>  An attacker should not be able to craft a new record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      which is different from an existing record which will be accepted</td><td> </td><td class="right">      which is different from an existing record which will be accepted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      by the receiver.</td><td> </td><td class="right">      by the receiver.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0569" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Order <span class="delete">protection/non-replayability</span>  An attacker should not be able to</td><td> </td><td class="rblock">   Order <span class="insert">protection/non-replayability:</span>  An attacker should not be able</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      cause the receiver to accept a record which it has already</td><td> </td><td class="rblock">      to cause the receiver to accept a record which it has already</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      accepted or cause the receiver to accept record N+1 without having</td><td> </td><td class="right">      accepted or cause the receiver to accept record N+1 without having</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      first processed record N.</td><td> </td><td class="right">      first processed record N.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0570" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Length concealment<span class="delete">.</span>  Given a record with a given external length, the</td><td> </td><td class="rblock">   Length concealment<span class="insert">:</span>  Given a record with a given external length, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      attacker should not be able to determine the amount of the record</td><td> </td><td class="right">      attacker should not be able to determine the amount of the record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      that is content versus padding.</td><td> </td><td class="right">      that is content versus padding.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0571" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Forward secrecy after key change<span class="delete">.</span>  If the traffic key update</td><td> </td><td class="rblock">   Forward secrecy after key change<span class="insert">:</span>  If the traffic key update</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      mechanism described in Section 4.6.3 has been used and the</td><td> </td><td class="right">      mechanism described in Section 4.6.3 has been used and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      previous generation key is deleted, an attacker who compromises</td><td> </td><td class="right">      previous generation key is deleted, an attacker who compromises</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the endpoint should not be able to decrypt traffic encrypted with</td><td> </td><td class="right">      the endpoint should not be able to decrypt traffic encrypted with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the old key.</td><td> </td><td class="right">      the old key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Informally, TLS 1.3 provides these properties by AEAD-protecting the</td><td> </td><td class="right">   Informally, TLS 1.3 provides these properties by AEAD-protecting the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   plaintext with a strong key.  AEAD encryption [RFC5116] provides</td><td> </td><td class="right">   plaintext with a strong key.  AEAD encryption [RFC5116] provides</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   confidentiality and integrity for the data.  Non-replayability is</td><td> </td><td class="right">   confidentiality and integrity for the data.  Non-replayability is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provided by using a separate nonce for each record, with the nonce</td><td> </td><td class="right">   provided by using a separate nonce for each record, with the nonce</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   being derived from the record sequence number (Section 5.3), with the</td><td> </td><td class="right">   being derived from the record sequence number (Section 5.3), with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0572" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   sequence number being maintained independently at both sides<span class="delete"> thus</span></td><td> </td><td class="rblock">   sequence number being maintained independently at both sides<span class="insert">; thus,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   records which are delivered out of order result in AEAD deprotection</td><td> </td><td class="right">   records which are delivered out of order result in AEAD deprotection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   failures.  In order to prevent mass cryptanalysis when the same</td><td> </td><td class="right">   failures.  In order to prevent mass cryptanalysis when the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   plaintext is repeatedly encrypted by different users under the same</td><td> </td><td class="right">   plaintext is repeatedly encrypted by different users under the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   key (as is commonly the case for HTTP), the nonce is formed by mixing</td><td> </td><td class="right">   key (as is commonly the case for HTTP), the nonce is formed by mixing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the sequence number with a secret per-connection initialization</td><td> </td><td class="right">   the sequence number with a secret per-connection initialization</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   vector derived along with the traffic keys.  See [BT16] for analysis</td><td> </td><td class="right">   vector derived along with the traffic keys.  See [BT16] for analysis</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of this construction.</td><td> </td><td class="right">   of this construction.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0573" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The <span class="delete">re-keying</span> technique in TLS 1.3 (see Section 7.2) follows the</td><td> </td><td class="rblock">   The <span class="insert">rekeying</span> technique in TLS 1.3 (see Section 7.2) follows the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   construction of the serial generator in [REKEY], which shows that <span class="delete">re-</span></td><td> </td><td class="rblock">   construction of the serial generator <span class="insert">as discussed</span> in [REKEY], which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   keying</span> can allow keys to be used for a larger number of encryptions</td><td> </td><td class="rblock">   shows that <span class="insert">rekeying</span> can allow keys to be used for a larger number of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   than without <span class="delete">re-keying.</span>  This relies on the security of the <span class="delete">HKDF-</span></td><td> </td><td class="rblock">   encryptions than without <span class="insert">rekeying.</span>  This relies on the security of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Expand-Label</span> function as a pseudorandom function (PRF).  In addition,</td><td> </td><td class="rblock">   the <span class="insert">HKDF-Expand-Label</span> function as a pseudorandom function (PRF).  In</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   as long as this function is truly one way, it is not possible to</td><td> </td><td class="rblock">   addition, as long as this function is truly one way, it is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   compute traffic keys from prior to a key change (forward secrecy).</td><td> </td><td class="rblock">   possible to compute traffic keys from prior to a key change (forward</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   secrecy).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS does not provide security for data which is communicated on a</td><td> </td><td class="right">   TLS does not provide security for data which is communicated on a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection after a traffic secret of that connection is compromised.</td><td> </td><td class="right">   connection after a traffic secret of that connection is compromised.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   That is, TLS does not provide post-compromise security/future</td><td> </td><td class="right">   That is, TLS does not provide post-compromise security/future</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secrecy/backward secrecy with respect to the traffic secret.  Indeed,</td><td> </td><td class="right">   secrecy/backward secrecy with respect to the traffic secret.  Indeed,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   an attacker who learns a traffic secret can compute all future</td><td> </td><td class="right">   an attacker who learns a traffic secret can compute all future</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic secrets on that connection.  Systems which want such</td><td> </td><td class="right">   traffic secrets on that connection.  Systems which want such</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   guarantees need to do a fresh handshake and establish a new</td><td> </td><td class="right">   guarantees need to do a fresh handshake and establish a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection with an (EC)DHE exchange.</td><td> </td><td class="right">   connection with an (EC)DHE exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.2.1.  External References</td><td> </td><td class="right">E.2.1.  External References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The reader should refer to the following references for analysis of</td><td> </td><td class="right">   The reader should refer to the following references for analysis of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0574" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the TLS record layer: <span class="delete">[BMMT15] [BT16] [BDFKPPRSZZ16] [BBK17]</span></td><td> </td><td class="rblock">   the TLS record layer: <span class="insert">[BMMRT15], [BT16], [BDFKPPRSZZ16], [BBK17], and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [Anon18].</span></td><td> </td><td class="rblock"><span class="insert">   [PS18].</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.3.  Traffic Analysis</td><td> </td><td class="right">E.3.  Traffic Analysis</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS is susceptible to a variety of traffic analysis attacks based on</td><td> </td><td class="right">   TLS is susceptible to a variety of traffic analysis attacks based on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   observing the length and timing of encrypted packets [CLINIC]</td><td> </td><td class="right">   observing the length and timing of encrypted packets [CLINIC]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0575" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [HCJ16].  This is particularly easy when there is a small set of</td><td> </td><td class="rblock">   [HCJ<span class="insert">C</span>16].  This is particularly easy when there is a small set of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   possible messages to be distinguished, such as for a video server</td><td> </td><td class="right">   possible messages to be distinguished, such as for a video server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   hosting a fixed corpus of content, but still provides usable</td><td> </td><td class="right">   hosting a fixed corpus of content, but still provides usable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   information even in more complicated scenarios.</td><td> </td><td class="right">   information even in more complicated scenarios.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS does not provide any specific defenses against this form of</td><td> </td><td class="right">   TLS does not provide any specific defenses against this form of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attack but does include a padding mechanism for use by applications:</td><td> </td><td class="right">   attack but does include a padding mechanism for use by applications:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The plaintext protected by the AEAD function consists of content plus</td><td> </td><td class="right">   The plaintext protected by the AEAD function consists of content plus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   variable-length padding, which allows the application to produce</td><td> </td><td class="right">   variable-length padding, which allows the application to produce</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0576" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   arbitrary<span class="delete"> </span>length encrypted records as well as padding-only cover</td><td> </td><td class="rblock">   arbitrary<span class="insert">-</span>length encrypted records as well as padding-only cover</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic to conceal the difference between periods of transmission and</td><td> </td><td class="right">   traffic to conceal the difference between periods of transmission and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   periods of silence.  Because the padding is encrypted alongside the</td><td> </td><td class="right">   periods of silence.  Because the padding is encrypted alongside the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   actual content, an attacker cannot directly determine the length of</td><td> </td><td class="right">   actual content, an attacker cannot directly determine the length of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0577" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the padding<span class="delete">,</span> but may be able to measure it indirectly by the use of</td><td> </td><td class="rblock">   the padding but may be able to measure it indirectly by the use of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   timing channels exposed during record processing (i.e., seeing how</td><td> </td><td class="right">   timing channels exposed during record processing (i.e., seeing how</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   long it takes to process a record or trickling in records to see</td><td> </td><td class="right">   long it takes to process a record or trickling in records to see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which ones elicit a response from the server).  In general, it is not</td><td> </td><td class="right">   which ones elicit a response from the server).  In general, it is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0578" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   known how to remove all of these channels because even a <span class="delete">constant</span></td><td> </td><td class="rblock">   known how to remove all of these channels because even a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   time</span> padding removal function will likely feed the content into <span class="delete">data-</span></td><td> </td><td class="rblock">   <span class="insert">constant-time</span> padding removal function will likely feed the content</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   dependent</span> functions.  At minimum, a fully <span class="delete">constant time</span> server or</td><td> </td><td class="rblock">   into <span class="insert">data-dependent</span> functions.  At minimum, a fully <span class="insert">constant-time</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client would require close cooperation with the <span class="delete">application layer</span></td><td> </td><td class="rblock">   server or client would require close cooperation with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   protocol implementation, including making that <span class="delete">higher level</span> protocol</td><td> </td><td class="rblock">   <span class="insert">application-layer</span> protocol implementation, including making that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   constant time.</td><td> </td><td class="rblock">   <span class="insert">higher-level</span> protocol constant time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0579" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note: Robust traffic analysis <span class="delete">defences</span> will likely lead to inferior</td><td> </td><td class="rblock">   Note: Robust traffic analysis <span class="insert">defenses</span> will likely lead to inferior</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   performance due to <span class="delete">delay</span> in transmitting packets and increased</td><td> </td><td class="rblock">   performance due to <span class="insert">delays</span> in transmitting packets and increased</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic volume.</td><td> </td><td class="right">   traffic volume.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0580" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">E.4.  Side<span class="delete"> </span>Channel Attacks</td><td> </td><td class="rblock">E.4.  Side<span class="insert">-</span>Channel Attacks</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In general, TLS does not have specific defenses against side-channel</td><td> </td><td class="right">   In general, TLS does not have specific defenses against side-channel</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attacks (i.e., those which attack the communications via secondary</td><td> </td><td class="right">   attacks (i.e., those which attack the communications via secondary</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0581" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   channels such as timing) leaving those to the implementation of the</td><td> </td><td class="rblock">   channels such as timing)<span class="insert">,</span> leaving those to the implementation of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   relevant cryptographic primitives.  However, certain features of TLS</td><td> </td><td class="right">   relevant cryptographic primitives.  However, certain features of TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are designed to make it easier to write side-channel resistant code:</td><td> </td><td class="right">   are designed to make it easier to write side-channel resistant code:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Unlike previous versions of TLS which used a composite MAC-then-</td><td> </td><td class="right">   -  Unlike previous versions of TLS which used a composite MAC-then-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      encrypt structure, TLS 1.3 only uses AEAD algorithms, allowing</td><td> </td><td class="right">      encrypt structure, TLS 1.3 only uses AEAD algorithms, allowing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      implementations to use self-contained constant-time</td><td> </td><td class="right">      implementations to use self-contained constant-time</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      implementations of those primitives.</td><td> </td><td class="right">      implementations of those primitives.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS uses a uniform "bad_record_mac" alert for all decryption</td><td> </td><td class="right">   -  TLS uses a uniform "bad_record_mac" alert for all decryption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      errors, which is intended to prevent an attacker from gaining</td><td> </td><td class="right">      errors, which is intended to prevent an attacker from gaining</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l61" /><small>skipping to change at</small><em> page 147, line 19</em></th><th> </th><th><a name="part-r61" /><small>skipping to change at</small><em> page 150, line 17</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Replayable 0-RTT data presents a number of security threats to TLS-</td><td> </td><td class="right">   Replayable 0-RTT data presents a number of security threats to TLS-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   using applications, unless those applications are specifically</td><td> </td><td class="right">   using applications, unless those applications are specifically</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   engineered to be safe under replay (minimally, this means idempotent,</td><td> </td><td class="right">   engineered to be safe under replay (minimally, this means idempotent,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   but in many cases may also require other stronger conditions, such as</td><td> </td><td class="right">   but in many cases may also require other stronger conditions, such as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   constant-time response).  Potential attacks include:</td><td> </td><td class="right">   constant-time response).  Potential attacks include:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Duplication of actions which cause side effects (e.g., purchasing</td><td> </td><td class="right">   -  Duplication of actions which cause side effects (e.g., purchasing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      an item or transferring money) to be duplicated, thus harming the</td><td> </td><td class="right">      an item or transferring money) to be duplicated, thus harming the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      site or the user.</td><td> </td><td class="right">      site or the user.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0582" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   -  Attackers can store and replay 0-RTT messages in order to re<span class="delete">-</span>order</td><td> </td><td class="rblock">   -  Attackers can store and replay 0-RTT messages in order to reorder</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      them with respect to other messages (e.g., moving a delete to</td><td> </td><td class="right">      them with respect to other messages (e.g., moving a delete to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      after a create).</td><td> </td><td class="right">      after a create).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Exploiting cache timing behavior to discover the content of 0-RTT</td><td> </td><td class="right">   -  Exploiting cache timing behavior to discover the content of 0-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      messages by replaying a 0-RTT message to a different cache node</td><td> </td><td class="right">      messages by replaying a 0-RTT message to a different cache node</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and then using a separate connection to measure request latency,</td><td> </td><td class="right">      and then using a separate connection to measure request latency,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      to see if the two requests address the same resource.</td><td> </td><td class="right">      to see if the two requests address the same resource.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If data can be replayed a large number of times, additional attacks</td><td> </td><td class="right">   If data can be replayed a large number of times, additional attacks</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   become possible, such as making repeated measurements of the speed of</td><td> </td><td class="right">   become possible, such as making repeated measurements of the speed of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cryptographic operations.  In addition, they may be able to overload</td><td> </td><td class="right">   cryptographic operations.  In addition, they may be able to overload</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0583" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   rate-limiting systems.  For further description of these attacks, see</td><td> </td><td class="rblock">   rate-limiting systems.  For <span class="insert">a</span> further description of these attacks,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [Mac17].</td><td> </td><td class="rblock">   see [Mac17].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Ultimately, servers have the responsibility to protect themselves</td><td> </td><td class="right">   Ultimately, servers have the responsibility to protect themselves</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   against attacks employing 0-RTT data replication.  The mechanisms</td><td> </td><td class="right">   against attacks employing 0-RTT data replication.  The mechanisms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   described in Section 8 are intended to prevent replay at the TLS</td><td> </td><td class="right">   described in Section 8 are intended to prevent replay at the TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   layer but do not provide complete protection against receiving</td><td> </td><td class="right">   layer but do not provide complete protection against receiving</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   multiple copies of client data.  TLS 1.3 falls back to the 1-RTT</td><td> </td><td class="right">   multiple copies of client data.  TLS 1.3 falls back to the 1-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake when the server does not have any information about the</td><td> </td><td class="right">   handshake when the server does not have any information about the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client, e.g., because it is in a different cluster which does not</td><td> </td><td class="right">   client, e.g., because it is in a different cluster which does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   share state or because the ticket has been deleted as described in</td><td> </td><td class="right">   share state or because the ticket has been deleted as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0584" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Section 8.1.  If the application<span class="delete"> </span>layer protocol retransmits data in</td><td> </td><td class="rblock">   Section 8.1.  If the application<span class="insert">-</span>layer protocol retransmits data in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   this setting, then it is possible for an attacker to induce message</td><td> </td><td class="right">   this setting, then it is possible for an attacker to induce message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   duplication by sending the ClientHello to both the original cluster</td><td> </td><td class="right">   duplication by sending the ClientHello to both the original cluster</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (which processes the data immediately) and another cluster which will</td><td> </td><td class="right">   (which processes the data immediately) and another cluster which will</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0585" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   fall back to 1-RTT and process the data upon application<span class="delete"> </span>layer</td><td> </td><td class="rblock">   fall back to 1-RTT and process the data upon application<span class="insert">-</span>layer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   replay.  The scale of this attack is limited by the client's</td><td> </td><td class="right">   replay.  The scale of this attack is limited by the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   willingness to retry transactions and therefore only allows a limited</td><td> </td><td class="right">   willingness to retry transactions and therefore only allows a limited</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   amount of duplication, with each copy appearing as a new connection</td><td> </td><td class="right">   amount of duplication, with each copy appearing as a new connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   at the server.</td><td> </td><td class="right">   at the server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0586" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If implemented correctly, the mechanisms described in <span class="delete">Section</span> 8.1 and</td><td> </td><td class="rblock">   If implemented correctly, the mechanisms described in <span class="insert">Sections</span> 8.1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Section</span> 8.2 prevent a replayed ClientHello and its associated 0-RTT</td><td> </td><td class="rblock">   and 8.2 prevent a replayed ClientHello and its associated 0-RTT data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   data from being accepted multiple times by any cluster with</td><td> </td><td class="rblock">   from being accepted multiple times by any cluster with consistent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   consistent state; for servers which limit the use of 0-RTT to one</td><td> </td><td class="rblock">   state; for servers which limit the use of 0-RTT to one cluster for a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   cluster for a single ticket, then a given ClientHello and its</td><td> </td><td class="rblock">   single ticket, then a given ClientHello and its associated 0-RTT data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   associated 0-RTT data will only be accepted once.  However, if state</td><td> </td><td class="rblock">   will only be accepted once.  However, if state is not completely</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   is not completely consistent, then an attacker might be able to have</td><td> </td><td class="rblock">   consistent, then an attacker might be able to have multiple copies of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   multiple copies of the data be accepted during the replication</td><td> </td><td class="rblock">   the data be accepted during the replication window.  Because clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   window.  Because clients do not know the exact details of server</td><td> </td><td class="rblock">   do not know the exact details of server behavior, they MUST NOT send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   behavior, they MUST NOT send messages in early data which are not</td><td> </td><td class="rblock">   messages in early data which are not safe to have replayed and which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   safe to have replayed and which they would not be willing to retry</td><td> </td><td class="rblock">   they would not be willing to retry across multiple 1-RTT connections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   across multiple 1-RTT connections.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application protocols MUST NOT use 0-RTT data without a profile that</td><td> </td><td class="right">   Application protocols MUST NOT use 0-RTT data without a profile that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   defines its use.  That profile needs to identify which messages or</td><td> </td><td class="right">   defines its use.  That profile needs to identify which messages or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   interactions are safe to use with 0-RTT and how to handle the</td><td> </td><td class="right">   interactions are safe to use with 0-RTT and how to handle the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   situation when the server rejects 0-RTT and falls back to 1-RTT.</td><td> </td><td class="right">   situation when the server rejects 0-RTT and falls back to 1-RTT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In addition, to avoid accidental misuse, TLS implementations MUST NOT</td><td> </td><td class="right">   In addition, to avoid accidental misuse, TLS implementations MUST NOT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   enable 0-RTT (either sending or accepting) unless specifically</td><td> </td><td class="right">   enable 0-RTT (either sending or accepting) unless specifically</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requested by the application and MUST NOT automatically resend 0-RTT</td><td> </td><td class="right">   requested by the application and MUST NOT automatically resend 0-RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   data if it is rejected by the server unless instructed by the</td><td> </td><td class="right">   data if it is rejected by the server unless instructed by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l62" /><small>skipping to change at</small><em> page 148, line 40</em></th><th> </th><th><a name="part-r62" /><small>skipping to change at</small><em> page 151, line 39</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application layer, or delay processing until the handshake</td><td> </td><td class="right">   application layer, or delay processing until the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   completes).  In order to allow applications to implement this kind of</td><td> </td><td class="right">   completes).  In order to allow applications to implement this kind of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   processing, TLS implementations MUST provide a way for the</td><td> </td><td class="right">   processing, TLS implementations MUST provide a way for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application to determine if the handshake has completed.</td><td> </td><td class="right">   application to determine if the handshake has completed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.5.1.  Replay and Exporters</td><td> </td><td class="right">E.5.1.  Replay and Exporters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Replays of the ClientHello produce the same early exporter, thus</td><td> </td><td class="right">   Replays of the ClientHello produce the same early exporter, thus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requiring additional care by applications which use these exporters.</td><td> </td><td class="right">   requiring additional care by applications which use these exporters.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In particular, if these exporters are used as an authentication</td><td> </td><td class="right">   In particular, if these exporters are used as an authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0587" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   channel binding (e.g., by signing the output of the exporter) an</td><td> </td><td class="rblock">   channel binding (e.g., by signing the output of the exporter)<span class="insert">,</span> an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attacker who compromises the PSK can transplant authenticators</td><td> </td><td class="right">   attacker who compromises the PSK can transplant authenticators</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   between connections without compromising the authentication key.</td><td> </td><td class="right">   between connections without compromising the authentication key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In addition, the early exporter SHOULD NOT be used to generate</td><td> </td><td class="right">   In addition, the early exporter SHOULD NOT be used to generate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server-to-client encryption keys because that would entail the reuse</td><td> </td><td class="right">   server-to-client encryption keys because that would entail the reuse</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of those keys.  This parallels the use of the early application</td><td> </td><td class="right">   of those keys.  This parallels the use of the early application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic keys only in the client-to-server direction.</td><td> </td><td class="right">   traffic keys only in the client-to-server direction.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">E.6.  PSK Identity Exposure</td><td> </td><td class="right">E.6.  PSK Identity Exposure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Because implementations respond to an invalid PSK binder by aborting</td><td> </td><td class="right">   Because implementations respond to an invalid PSK binder by aborting</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the handshake, it may be possible for an attacker to verify whether a</td><td> </td><td class="right">   the handshake, it may be possible for an attacker to verify whether a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   given PSK identity is valid.  Specifically, if a server accepts both</td><td> </td><td class="right">   given PSK identity is valid.  Specifically, if a server accepts both</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0588" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">external PSK</span> and certificate-based handshakes, a valid PSK identity</td><td> </td><td class="rblock">   <span class="insert">external-PSK handshakes</span> and certificate-based handshakes, a valid PSK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   will result in a failed handshake, whereas an invalid identity will</td><td> </td><td class="rblock">   identity will result in a failed handshake, whereas an invalid</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   just be skipped and result in a successful certificate handshake.</td><td> </td><td class="rblock">   identity will just be skipped and result in a successful certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Servers which solely support PSK handshakes may be able to resist</td><td> </td><td class="rblock">   handshake.  Servers which solely support PSK handshakes may be able</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   this form of attack by treating the cases where there is no valid PSK</td><td> </td><td class="rblock">   to resist this form of attack by treating the cases where there is no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   identity and where there is an identity but it has an invalid binder</td><td> </td><td class="rblock">   valid PSK identity and where there is an identity but it has an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   identically.</td><td> </td><td class="rblock">   invalid binder identically.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0589" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">E.7.  Attacks on Static RSA</td><td> </td><td class="rblock">E.7.  <span class="insert">Sharing PSKs</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TLS 1.3 takes a conservative approach to PSKs by binding them to a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   specific KDF.  By contrast, TLS 1.2 allows PSKs to be used with any</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   hash function and the TLS 1.2 PRF.  Thus, any PSK which is used with</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   both TLS 1.2 and TLS 1.3 must be used with only one hash in TLS 1.3,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   which is less than optimal if users want to provision a single PSK.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The constructions in TLS 1.2 and TLS 1.3 are different, although they</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are both based on HMAC.  While there is no known way in which the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   same PSK might produce related output in both versions, only limited</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   analysis has been done.  Implementations can ensure safety from</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   cross-protocol related output by not reusing PSKs between TLS 1.3 and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TLS 1.2.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">E.8.</span>  Attacks on Static RSA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Although TLS 1.3 does not use RSA key transport and so is not</td><td> </td><td class="right">   Although TLS 1.3 does not use RSA key transport and so is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0590" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   directly susceptible to Bleichenbacher-type <span class="delete">attacks,</span> if TLS 1.3</td><td> </td><td class="rblock">   directly susceptible to Bleichenbacher-type <span class="insert">attacks [Blei98],</span> if TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   servers also support static RSA in the context of previous versions</td><td> </td><td class="rblock">   1.3 servers also support static RSA in the context of previous</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   of TLS, then it may be possible to impersonate the server for TLS 1.3</td><td> </td><td class="rblock">   versions of TLS, then it may be possible to impersonate the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   connections [JSS15].  TLS 1.3 implementations can prevent this attack</td><td> </td><td class="rblock">   for TLS 1.3 connections [JSS15].  TLS 1.3 implementations can prevent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   by disabling support for static RSA across all versions of TLS.  In</td><td> </td><td class="rblock">   this attack by disabling support for static RSA across all versions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   principle, implementations might also be able to separate</td><td> </td><td class="rblock">   of TLS.  In principle, implementations might also be able to separate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates with different keyUsage bits for static RSA decryption</td><td> </td><td class="right">   certificates with different keyUsage bits for static RSA decryption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and RSA signature, but this technique relies on clients refusing to</td><td> </td><td class="right">   and RSA signature, but this technique relies on clients refusing to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   accept signatures using keys in certificates that do not have the</td><td> </td><td class="right">   accept signatures using keys in certificates that do not have the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   digitalSignature bit set, and many clients do not enforce this</td><td> </td><td class="right">   digitalSignature bit set, and many clients do not enforce this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   restriction.</td><td> </td><td class="right">   restriction.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0591" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Appendix F.  Working Group Information</span></td><td> </td><td class="rblock">Contributors</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   The discussion list for the IETF TLS working group is located at the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   e-mail address tls@ietf.org [1].  Information on the group and</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   information on how to subscribe to the list is at</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   https://www.ietf.org/mailman/listinfo/tls [2]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Archives of the list can be found at: https://www.ietf.org/mail-</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   archive/web/tls/current/index.html [3]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Appendix G.</span>  Contributors</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Martin Abadi</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      University of California, Santa Cruz</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      abadi@cs.ucsc.edu</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Christopher Allen (co-editor of TLS 1.0)</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Alacrity Ventures</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ChristopherA@AlacrityManagement.com</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Richard Barnes</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Cisco</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      rlb@ipv.sx</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  Steven M.  Bellovin</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Columbia University</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      smb@cs.columbia.edu</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0592" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  David Benjamin</span></td><td> </td><td class="rblock">   <span class="insert">Martin Abadi</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Google</span></td><td> </td><td class="rblock"><span class="insert">   University of California, Santa Cruz</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      davidben@google.com</span></td><td> </td><td class="rblock"><span class="insert">   abadi@cs.ucsc.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0593" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Benjamin Beurdouche</span></td><td> </td><td class="rblock">   <span class="insert">Christopher Allen</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      INRIA &amp; Microsoft Research</span></td><td> </td><td class="rblock"><span class="insert">   (co-editor of TLS 1.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      benjamin.beurdouche@ens.fr</span></td><td> </td><td class="rblock"><span class="insert">   Alacrity Ventures</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ChristopherA@AlacrityManagement.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0594" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Karthikeyan Bhargavan (co-author of [RFC7627])</span></td><td> </td><td class="rblock">   <span class="insert">Richard Barnes</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      INRIA</span></td><td> </td><td class="rblock"><span class="insert">   Cisco</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      karthikeyan.bhargavan@inria.fr</span></td><td> </td><td class="rblock"><span class="insert">   rlb@ipv.sx</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0595" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Simon Blake-Wilson (co-author of [RFC4492])</span></td><td> </td><td class="rblock">   <span class="insert">Steven M. Bellovin</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      BCI</span></td><td> </td><td class="rblock"><span class="insert">   Columbia University</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      sblakewilson@bcisse.com</span></td><td> </td><td class="rblock"><span class="insert">   smb@cs.columbia.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0596" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Nelson Bolyard (co-author of [RFC4492])</span></td><td> </td><td class="rblock">   <span class="insert">David Benjamin</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Sun Microsystems, Inc.</span></td><td> </td><td class="rblock"><span class="insert">   Google</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      nelson@bolyard.com</span></td><td> </td><td class="rblock"><span class="insert">   davidben@google.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0597" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Ran Canetti</span></td><td> </td><td class="rblock">   <span class="insert">Benjamin Beurdouche</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      IBM</span></td><td> </td><td class="rblock"><span class="insert">   INRIA &amp; Microsoft Research</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      canetti@watson.ibm.com</span></td><td> </td><td class="rblock"><span class="insert">   benjamin.beurdouche@ens.fr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0598" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Matt Caswell</span></td><td> </td><td class="rblock">   <span class="insert">Karthikeyan Bhargavan</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      OpenSSL</span></td><td> </td><td class="rblock"><span class="insert">   (editor of [RFC7627])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      matt@openssl.org</span></td><td> </td><td class="rblock"><span class="insert">   INRIA</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   karthikeyan.bhargavan@inria.fr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0599" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Stephen Checkoway</span></td><td> </td><td class="rblock">   <span class="insert">Simon Blake-Wilson</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      University</span> of <span class="delete">Illinois at Chicago</span></td><td> </td><td class="rblock"><span class="insert">   (co-author</span> of <span class="insert">[RFC4492])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      sfc@uic.edu</span></td><td> </td><td class="rblock"><span class="insert">   BCI</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   sblakewilson@bcisse.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0600" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Pete Chown</span></td><td> </td><td class="rblock">   <span class="insert">Nelson Bolyard</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Skygate Technology Ltd</span></td><td> </td><td class="rblock"><span class="insert">   (co-author of [RFC4492])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      pc@skygate.co.uk</span></td><td> </td><td class="rblock"><span class="insert">   Sun Microsystems, Inc.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   nelson@bolyard.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0601" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Katriel Cohn-Gordon</span></td><td> </td><td class="rblock">   <span class="insert">Ran Canetti</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      University of Oxford</span></td><td> </td><td class="rblock"><span class="insert">   IBM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      me@katriel.co.uk</span></td><td> </td><td class="rblock"><span class="insert">   canetti@watson.ibm.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Matt Caswell</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   OpenSSL</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   matt@openssl.org</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0602" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Cas Cremers</span></td><td> </td><td class="rblock">   <span class="insert">Stephen Checkoway</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      University of <span class="delete">Oxford</span></td><td> </td><td class="rblock">   University of <span class="insert">Illinois at Chicago</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      cas.cremers@cs.ox.ac.uk</span></td><td> </td><td class="rblock"><span class="insert">   sfc@uic.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0603" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Antoine Delignat-Lavaud (co-author of [RFC7627])</span></td><td> </td><td class="rblock">   <span class="insert">Pete Chown</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      INRIA</span></td><td> </td><td class="rblock"><span class="insert">   Skygate Technology Ltd</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      antdl@microsoft.com</span></td><td> </td><td class="rblock"><span class="insert">   pc@skygate.co.uk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0604" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Tim Dierks (co-editor</span> of <span class="delete">TLS 1.0, 1.1, and 1.2)</span></td><td> </td><td class="rblock">   <span class="insert">Katriel Cohn-Gordon</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Independent</span></td><td> </td><td class="rblock"><span class="insert">   University</span> of <span class="insert">Oxford</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      tim@dierks.org</span></td><td> </td><td class="rblock"><span class="insert">   me@katriel.co.uk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0605" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Roelof DuToit</span></td><td> </td><td class="rblock">   <span class="insert">Cas Cremers</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Symantec Corporation</span></td><td> </td><td class="rblock"><span class="insert">   University of Oxford</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      roelof_dutoit@symantec.com</span></td><td> </td><td class="rblock"><span class="insert">   cas.cremers@cs.ox.ac.uk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0606" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Taher Elgamal</span></td><td> </td><td class="rblock">   <span class="insert">Antoine Delignat-Lavaud</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Securify</span></td><td> </td><td class="rblock"><span class="insert">   (co-author of [RFC7627])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      taher@securify.com</span></td><td> </td><td class="rblock"><span class="insert">   INRIA</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   antdl@microsoft.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0607" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Pasi Eronen</span></td><td> </td><td class="rblock">   <span class="insert">Tim Dierks</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Nokia</span></td><td> </td><td class="rblock"><span class="insert">   (co-author of TLS 1.0, co-editor of TLS 1.1 and 1.2)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      pasi.eronen@nokia.com</span></td><td> </td><td class="rblock"><span class="insert">   Independent</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   tim@dierks.org</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0608" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Cedric Fournet</span></td><td> </td><td class="rblock">   <span class="insert">Roelof DuToit</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Microsoft</span></td><td> </td><td class="rblock"><span class="insert">   Symantec Corporation</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      fournet@microsoft.com</span></td><td> </td><td class="rblock"><span class="insert">   roelof_dutoit@symantec.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0609" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Anil Gangolli</span></td><td> </td><td class="rblock">   <span class="insert">Taher Elgamal</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      anil@busybuddha.org</span></td><td> </td><td class="rblock"><span class="insert">   Securify</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   taher@securify.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0610" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  David M.  Garrett</span></td><td> </td><td class="rblock">   <span class="insert">Pasi Eronen</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      dave@nulldereference.com</span></td><td> </td><td class="rblock"><span class="insert">   Nokia</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   pasi.eronen@nokia.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0611" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Illya Gerasymchuk</span></td><td> </td><td class="rblock">   <span class="insert">Cedric Fournet</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Independent</span></td><td> </td><td class="rblock"><span class="insert">   Microsoft</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      illya@iluxonchik.me</span></td><td> </td><td class="rblock"><span class="insert">   fournet@microsoft.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Anil Gangolli</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   anil@busybuddha.org</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0612" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Alessandro Ghedini</span></td><td> </td><td class="rblock">   <span class="insert">David M. Garrett</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Cloudflare Inc.</span></td><td> </td><td class="rblock"><span class="insert">   dave@nulldereference.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      alessandro@cloudflare.com</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0613" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Daniel Kahn Gillmor</span></td><td> </td><td class="rblock">   <span class="insert">Illya Gerasymchuk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ACLU</span></td><td> </td><td class="rblock"><span class="insert">   Independent</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      dkg@fifthhorseman.net</span></td><td> </td><td class="rblock"><span class="insert">   illya@iluxonchik.me</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0614" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Matthew Green</span></td><td> </td><td class="rblock">   <span class="insert">Alessandro Ghedini</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Johns Hopkins University</span></td><td> </td><td class="rblock"><span class="insert">   Cloudflare Inc.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      mgreen@cs.jhu.edu</span></td><td> </td><td class="rblock"><span class="insert">   alessandro@cloudflare.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0615" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Jens Guballa</span></td><td> </td><td class="rblock">   <span class="insert">Daniel Kahn Gillmor</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ETAS</span></td><td> </td><td class="rblock"><span class="insert">   ACLU</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      jens.guballa@etas.com</span></td><td> </td><td class="rblock"><span class="insert">   dkg@fifthhorseman.net</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0616" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Felix Guenther</span></td><td> </td><td class="rblock">   <span class="insert">Matthew Green</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      TU Darmstadt</span></td><td> </td><td class="rblock"><span class="insert">   Johns Hopkins University</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      mail@felixguenther.info</span></td><td> </td><td class="rblock"><span class="insert">   mgreen@cs.jhu.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0617" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Vipul Gupta (co-author of [RFC4492])</span></td><td> </td><td class="rblock">   <span class="insert">Jens Guballa</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Sun Microsystems Laboratories</span></td><td> </td><td class="rblock"><span class="insert">   ETAS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      vipul.gupta@sun.com</span></td><td> </td><td class="rblock"><span class="insert">   jens.guballa@etas.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0618" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Chris Hawk (co-author of [RFC4492])</span></td><td> </td><td class="rblock">   <span class="insert">Felix Guenther</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Corriente Networks LLC</span></td><td> </td><td class="rblock"><span class="insert">   TU Darmstadt</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      chris@corriente.net</span></td><td> </td><td class="rblock"><span class="insert">   mail@felixguenther.info</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0619" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Kipp Hickman</span></td><td> </td><td class="rblock">   <span class="insert">Vipul Gupta</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (co-author of [RFC4492])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Sun Microsystems Laboratories</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   vipul.gupta@sun.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0620" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Alfred Hoenes</span></td><td> </td><td class="rblock">   <span class="insert">Chris Hawk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (co-author of [RFC4492])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Corriente Networks LLC</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   chris@corriente.net</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0621" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  David Hopwood</span></td><td> </td><td class="rblock">   <span class="insert">Kipp Hickman</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Independent Consultant</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      david.hopwood@blueyonder.co.uk</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0622" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Marko Horvat</span></td><td> </td><td class="rblock">   <span class="insert">Alfred Hoenes</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      MPI-SWS</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      mhorvat@mpi-sws.org</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0623" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Jonathan Hoyland</span></td><td> </td><td class="rblock">   <span class="insert">David Hopwood</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Royal Holloway, University of London jonathan.hoyland@gmail.com</span></td><td> </td><td class="rblock"><span class="insert">   Independent Consultant</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   david.hopwood@blueyonder.co.uk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Marko Horvat</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MPI-SWS</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   mhorvat@mpi-sws.org</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0624" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Subodh Iyengar</span></td><td> </td><td class="rblock">   <span class="insert">Jonathan Hoyland</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Facebook</span></td><td> </td><td class="rblock"><span class="insert">   Royal Holloway, University of London</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      subodh@fb.com</span></td><td> </td><td class="rblock"><span class="insert">   jonathan.hoyland@gmail.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0625" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Benjamin Kaduk</span></td><td> </td><td class="rblock">   <span class="insert">Subodh Iyengar</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Akamai</span></td><td> </td><td class="rblock"><span class="insert">   Facebook</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      kaduk@mit.edu</span></td><td> </td><td class="rblock"><span class="insert">   subodh@fb.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0626" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Hubert Kario</span></td><td> </td><td class="rblock">   <span class="insert">Benjamin Kaduk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Red Hat Inc.</span></td><td> </td><td class="rblock"><span class="insert">   Akamai Technologies</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      hkario@redhat.com</span></td><td> </td><td class="rblock"><span class="insert">   kaduk@mit.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0627" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Phil Karlton (co-author of SSL 3.0)</span></td><td> </td><td class="rblock">   <span class="insert">Hubert Kario</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Red Hat Inc.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   hkario@redhat.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0628" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Leon Klingele</span></td><td> </td><td class="rblock">   <span class="insert">Phil Karlton</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Independent</span></td><td> </td><td class="rblock"><span class="insert">   (co-author of SSL 3.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      mail@leonklingele.de</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0629" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Paul Kocher (co-author of SSL 3.0)</span></td><td> </td><td class="rblock">   <span class="insert">Leon Klingele</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Cryptography Research</span></td><td> </td><td class="rblock"><span class="insert">   Independent</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      paul@cryptography.com</span></td><td> </td><td class="rblock"><span class="insert">   mail@leonklingele.de</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0630" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Hugo Krawczyk</span></td><td> </td><td class="rblock">   <span class="insert">Paul Kocher</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      IBM</span></td><td> </td><td class="rblock"><span class="insert">   (co-author of SSL 3.0)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      hugokraw@us.ibm.com</span></td><td> </td><td class="rblock"><span class="insert">   Cryptography Research</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   paul@cryptography.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0631" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Adam Langley (co-author of [RFC7627])</span></td><td> </td><td class="rblock">   <span class="insert">Hugo Krawczyk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Google</span></td><td> </td><td class="rblock"><span class="insert">   IBM</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      agl@google.com</span></td><td> </td><td class="rblock"><span class="insert">   hugokraw@us.ibm.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0632" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Olivier Levillain</span></td><td> </td><td class="rblock">   <span class="insert">Adam Langley</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ANSSI</span></td><td> </td><td class="rblock"><span class="insert">   (co-author of [RFC7627])</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      olivier.levillain@ssi.gouv.fr</span></td><td> </td><td class="rblock"><span class="insert">   Google</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   agl@google.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0633" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Xiaoyin Liu</td><td> </td><td class="rblock">   <span class="insert">Olivier Levillain</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      University of North Carolina at Chapel Hill</td><td> </td><td class="rblock"><span class="insert">   ANSSI</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      xiaoyin.l@outlook.com</td><td> </td><td class="rblock"><span class="insert">   olivier.levillain@ssi.gouv.fr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Xiaoyin Liu</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   University of North Carolina at Chapel Hill</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   xiaoyin.l@outlook.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0634" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Ilari Liusvaara</td><td> </td><td class="rblock">   Ilari Liusvaara</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Independent</td><td> </td><td class="rblock">   Independent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ilariliusvaara@welho.com</td><td> </td><td class="rblock">   ilariliusvaara@welho.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0635" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Atul Luykx</td><td> </td><td class="rblock">   Atul Luykx</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      K.U.  Leuven</td><td> </td><td class="rblock">   K.U. Leuven</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      atul.luykx@kuleuven.be</td><td> </td><td class="rblock">   atul.luykx@kuleuven.be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0636" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Colm MacCarthaigh</td><td> </td><td class="rblock">   Colm MacCarthaigh</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Amazon Web Services</td><td> </td><td class="rblock">   Amazon Web Services</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      colm@allcosts.net</td><td> </td><td class="rblock">   colm@allcosts.net</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0637" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Carl Mehner</td><td> </td><td class="rblock">   Carl Mehner</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      USAA</td><td> </td><td class="rblock">   USAA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      carl.mehner@usaa.com</td><td> </td><td class="rblock">   carl.mehner@usaa.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0638" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Jan Mikkelsen</td><td> </td><td class="rblock">   Jan Mikkelsen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Transactionware</td><td> </td><td class="rblock">   Transactionware</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      janm@transactionware.com</td><td> </td><td class="rblock">   janm@transactionware.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0639" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Bodo Moeller (co-author of [RFC4492])</td><td> </td><td class="rblock">   Bodo Moeller</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Google</td><td> </td><td class="rblock">   (co-author of [RFC4492])</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      bodo@acm.org</td><td> </td><td class="rblock">   Google</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   bodo@acm.org</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0640" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Kyle Nekritz</td><td> </td><td class="rblock">   Kyle Nekritz</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Facebook</td><td> </td><td class="rblock">   Facebook</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      knekritz@fb.com</td><td> </td><td class="rblock">   knekritz@fb.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0641" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Erik Nygren</td><td> </td><td class="rblock">   Erik Nygren</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Akamai Technologies</td><td> </td><td class="rblock">   Akamai Technologies</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      erik+ietf@nygren.org</td><td> </td><td class="rblock">   erik+ietf@nygren.org</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0642" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Magnus Nystrom</td><td> </td><td class="rblock">   Magnus Nystrom</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Microsoft</td><td> </td><td class="rblock">   Microsoft</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      mnystrom@microsoft.com</td><td> </td><td class="rblock">   mnystrom@microsoft.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0643" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Kazuho Oku</td><td> </td><td class="rblock">   Kazuho Oku</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      DeNA Co., Ltd.</td><td> </td><td class="rblock">   DeNA Co., Ltd.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      kazuhooku@gmail.com</td><td> </td><td class="rblock">   kazuhooku@gmail.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Kenny Paterson</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Royal Holloway, University of London</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   kenny.paterson@rhul.ac.uk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0644" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Kenny Paterson</span></td><td> </td><td class="rblock">   <span class="insert">Christopher Patton</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Royal Holloway,</span> University of <span class="delete">London</span></td><td> </td><td class="rblock">   University of <span class="insert">Florida</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      kenny.paterson@rhul.ac.uk</span></td><td> </td><td class="rblock"><span class="insert">   cjpatton@ufl.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0645" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Alfredo Pironti (co-author of [RFC7627])</td><td> </td><td class="rblock">   Alfredo Pironti</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      INRIA</td><td> </td><td class="rblock">   (co-author of [RFC7627])</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      alfredo.pironti@inria.fr</td><td> </td><td class="rblock">   INRIA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   alfredo.pironti@inria.fr</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0646" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Andrei Popov</td><td> </td><td class="rblock">   Andrei Popov</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Microsoft</td><td> </td><td class="rblock">   Microsoft</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      andrei.popov@microsoft.com</td><td> </td><td class="rblock">   andrei.popov@microsoft.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0647" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Marsh Ray (co-author of [RFC7627])</td><td> </td><td class="rblock">   Marsh Ray</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Microsoft</td><td> </td><td class="rblock">   (co-author of [RFC7627])</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      maray@microsoft.com</td><td> </td><td class="rblock">   Microsoft</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   maray@microsoft.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0648" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Robert Relyea</td><td> </td><td class="rblock">   Robert Relyea</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Netscape Communications</td><td> </td><td class="rblock">   Netscape Communications</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      relyea@netscape.com</td><td> </td><td class="rblock">   relyea@netscape.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0649" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Kyle Rose</td><td> </td><td class="rblock">   Kyle Rose</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Akamai Technologies</td><td> </td><td class="rblock">   Akamai Technologies</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      krose@krose.org</td><td> </td><td class="rblock">   krose@krose.org</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0650" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Jim Roskind</td><td> </td><td class="rblock">   Jim Roskind</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Amazon</td><td> </td><td class="rblock">   Amazon</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      jroskind@amazon.com</td><td> </td><td class="rblock">   jroskind@amazon.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0651" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  </span>Michael Sabin</td><td> </td><td class="rblock">   Michael Sabin</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0652" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Joe Salowey</td><td> </td><td class="rblock">   Joe Salowey</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Tableau Software</td><td> </td><td class="rblock">   Tableau Software</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      joe@salowey.net</td><td> </td><td class="rblock">   joe@salowey.net</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0653" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Rich Salz</td><td> </td><td class="rblock">   Rich Salz</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Akamai</td><td> </td><td class="rblock">   Akamai</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      rsalz@akamai.com</td><td> </td><td class="rblock">   rsalz@akamai.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0654" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  David Schinazi</td><td> </td><td class="rblock">   David Schinazi</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Apple Inc.</td><td> </td><td class="rblock">   Apple Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      dschinazi@apple.com</td><td> </td><td class="rblock">   dschinazi@apple.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Sam Scott</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Royal Holloway, University of London</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   me@samjs.co.uk</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0655" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Sam Scott</span></td><td> </td><td class="rblock">   <span class="insert">Thomas Shrimpton</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Royal Holloway,</span> University of <span class="delete">London</span></td><td> </td><td class="rblock">   University of <span class="insert">Florida</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      me@samjs.co.uk</span></td><td> </td><td class="rblock"><span class="insert">   teshrim@ufl.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0656" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Dan Simon</td><td> </td><td class="rblock">   Dan Simon</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Microsoft, Inc.</td><td> </td><td class="rblock">   Microsoft, Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      dansimon@microsoft.com</td><td> </td><td class="rblock">   dansimon@microsoft.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0657" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Brian Smith</td><td> </td><td class="rblock">   Brian Smith</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Independent</td><td> </td><td class="rblock">   Independent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      brian@briansmith.org</td><td> </td><td class="rblock">   brian@briansmith.org</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0658" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Brian Sniffen</td><td> </td><td class="rblock">   Brian Sniffen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Akamai Technologies</td><td> </td><td class="rblock">   Akamai Technologies</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ietf@bts.evenmere.org</td><td> </td><td class="rblock">   ietf@bts.evenmere.org</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0659" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Nick Sullivan</td><td> </td><td class="rblock">   Nick Sullivan</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Cloudflare Inc.</td><td> </td><td class="rblock">   Cloudflare Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      nick@cloudflare.com</td><td> </td><td class="rblock">   nick@cloudflare.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0660" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Bjoern Tackmann</td><td> </td><td class="rblock">   Bjoern Tackmann</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      University of California, San Diego</td><td> </td><td class="rblock">   University of California, San Diego</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      btackmann@eng.ucsd.edu</td><td> </td><td class="rblock">   btackmann@eng.ucsd.edu</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0661" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Tim Taubert</td><td> </td><td class="rblock">   Tim Taubert</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Mozilla</td><td> </td><td class="rblock">   Mozilla</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ttaubert@mozilla.com</td><td> </td><td class="rblock">   ttaubert@mozilla.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0662" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Martin Thomson</td><td> </td><td class="rblock">   Martin Thomson</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Mozilla</td><td> </td><td class="rblock">   Mozilla</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      mt@mozilla.com</td><td> </td><td class="rblock">   mt@mozilla.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0663" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Sean Turner</span></td><td> </td><td class="rblock">   <span class="insert">Hannes Tschofenig</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      sn3rd</span></td><td> </td><td class="rblock"><span class="insert">   Arm Limited</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      sean@sn3rd.com</span></td><td> </td><td class="rblock"><span class="insert">   Hannes.Tschofenig@arm.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0664" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Steven Valdez</span></td><td> </td><td class="rblock">   <span class="insert">Sean Turner</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Google</span></td><td> </td><td class="rblock"><span class="insert">   sn3rd</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      svaldez@google.com</span></td><td> </td><td class="rblock"><span class="insert">   sean@sn3rd.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0665" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Filippo Valsorda</td><td> </td><td class="rblock">   <span class="insert">Steven Valdez</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Cloudflare Inc.</td><td> </td><td class="rblock"><span class="insert">   Google</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      filippo@cloudflare.com</td><td> </td><td class="rblock"><span class="insert">   svaldez@google.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Filippo Valsorda</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Cloudflare Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   filippo@cloudflare.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0666" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Thyla van der Merwe</td><td> </td><td class="rblock">   Thyla van der Merwe</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Royal Holloway, University of London</td><td> </td><td class="rblock">   Royal Holloway, University of London</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      tjvdmerwe@gmail.com</td><td> </td><td class="rblock">   tjvdmerwe@gmail.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0667" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Victor Vasiliev</td><td> </td><td class="rblock">   Victor Vasiliev</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Google</td><td> </td><td class="rblock">   Google</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      vasilvv@google.com</td><td> </td><td class="rblock">   vasilvv@google.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0668" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Tom Weinstein</span></td><td> </td><td class="rblock">   <span class="insert">Hoeteck Wee</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Ecole Normale Superieure, Paris</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   hoeteck@alum.mit.edu</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0669" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Hoeteck Wee</span></td><td> </td><td class="rblock">   <span class="insert">Tom Weinstein</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Ecole Normale Superieure, Paris</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      hoeteck@alum.mit.edu</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0670" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  David Wong</td><td> </td><td class="rblock">   David Wong</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      NCC Group</td><td> </td><td class="rblock">   NCC Group</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      david.wong@nccgroup.trust</td><td> </td><td class="rblock">   david.wong@nccgroup.trust</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0671" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Christopher A.  Wood</td><td> </td><td class="rblock">   Christopher A. Wood</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Apple Inc.</td><td> </td><td class="rblock">   Apple Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      cawood@apple.com</td><td> </td><td class="rblock">   cawood@apple.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0672" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Tim Wright</td><td> </td><td class="rblock">   Tim Wright</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Vodafone</td><td> </td><td class="rblock">   Vodafone</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      timothy.wright@vodafone.com</td><td> </td><td class="rblock">   timothy.wright@vodafone.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0673" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Peter Wu</td><td> </td><td class="rblock">   Peter Wu</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Independent</td><td> </td><td class="rblock">   Independent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      peter@lekensteyn.nl</td><td> </td><td class="rblock">   peter@lekensteyn.nl</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0674" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-</span>  Kazu Yamamoto</td><td> </td><td class="rblock">   Kazu Yamamoto</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Internet Initiative Japan Inc.</td><td> </td><td class="rblock">   Internet Initiative Japan Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      kazu@iij.ad.jp</td><td> </td><td class="rblock">   kazu@iij.ad.jp</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Author's Address</td><td> </td><td class="right">Author's Address</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Eric Rescorla</td><td> </td><td class="right">   Eric Rescorla</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0675" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">RTFM, Inc.</span></td><td> </td><td class="rblock">   <span class="insert">Mozilla</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0676" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   E<span class="delete">M</span>ail: ekr@rtfm.com</td><td> </td><td class="rblock">   E<span class="insert">m</span>ail: ekr@rtfm.com</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 676 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>2366 lines changed or deleted</i></th><th><i> </i></th><th><i>1963 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.42. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
